<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.tracom.bms.domain.PI0201.PI0201Mapper">

	<select id="PI0201G0R0" resultType="Map" parameterType="Map">
		SELECT VOC_ID, VOC_NM, DATE_FORMAT(PLAY_ST_DT, '%Y%m%d') PLAY_ST_DT, PLAY_TYPE, KR_TTS, EN_TTS, 
		SCR_TXT, SCR_TXT_EN, REMARK, PLAY_TM, VOC_DIV, CON_ID, DATE_FORMAT(PLAY_ED_DT, '%Y%m%d') PLAY_ED_DT, 
		DATE_FORMAT(UPD_DTM, '%Y%m%d%H%i') UPD_DTM, UPD_ID, CONCAT(DATE_FORMAT(PLAY_ST_DT, '%Y%m%d'), DATE_FORMAT(PLAY_ED_DT, '%Y%m%d')) PLAY_DATE 
		FROM BMS_VOC_INFO
		<where>
			<if test="Content != ''">
				VOC_ID LIKE CONCAT('%',#{Content},'%') OR VOC_NM LIKE CONCAT('%',#{Content},'%')
			</if>
		</where>
	</select>
	
	<select id="PI0201G0K0" resultType="Map">
		SELECT CONCAT('NO', LPAD(NEXTVAL(SEQ_BMS_VOC_INFO_0), 8, '0')) AS 'SEQ'
	</select>	

	<insert id="PI0201G0I0" parameterType="Map">	
		INSERT INTO BMS_NOTICE_MST(NOTICE_ID, VHC_RCPT_IDS, STTN_RCPT_IDS, TITLE, SEND_DIV, SEND_STS, REG_DTM, RSV_DTM, SEND_DTM, UPD_DTM, CONTENTS, UPD_ID) 
		VALUES (#{NOTICE_ID}, #{VHC_RCPT_IDS}, #{STTN_RCPT_IDS}, #{TITLE}, #{SEND_DIV}, #{SEND_STS}, STR_TO_DATE(#{REG_DTM}, '%Y%m%d%H%i'), STR_TO_DATE(#{RSV_DTM}, '%Y%m%d%H%i'), STR_TO_DATE(#{SEND_DTM}, '%Y%m%d%H%i'), #{UPD_DTM}, #{CONTENTS}, #{UPD_ID})
	</insert>

	<delete id="PI0201G0D0" parameterType="Map">
		DELETE FROM BMS_NOTICE_MST WHERE NOTICE_ID = #{NOTICE_ID};
		DELETE FROM BMS_NOTICE_VHC_CMPSTN WHERE NOTICE_ID = #{NOTICE_ID};
		DELETE FROM BMS_NOTICE_STTN_CMPSTN WHERE NOTICE_ID = #{NOTICE_ID};
	</delete>
	
	<update id="PI0201G0U0" parameterType="Map">
		UPDATE BMS_NOTICE_MST SET VHC_RCPT_IDS = #{VHC_RCPT_IDS}, STTN_RCPT_IDS = #{STTN_RCPT_IDS}, TITLE = #{TITLE}, SEND_DIV = #{SEND_DIV}, 
		SEND_STS = #{SEND_STS}, REG_DTM = STR_TO_DATE(#{REG_DTM}, '%Y%m%d%H%i'), RSV_DTM = STR_TO_DATE(#{RSV_DTM}, '%Y%m%d%H%i'), SEND_DTM = STR_TO_DATE(#{SEND_DTM}, '%Y%m%d%H%i'), UPD_DTM = #{UPD_DTM}, CONTENTS = #{CONTENTS}, UPD_ID = #{UPD_ID}
		WHERE NOTICE_ID = #{NOTICE_ID}
	</update>
	
</mapper>