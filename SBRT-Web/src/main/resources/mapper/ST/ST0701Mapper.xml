<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

  <mapper namespace="kr.tracom.brt.domain.ST0701.ST0701Mapper">
  
  <select id="ST0701G0R0" resultType="Map">
		SELECT  
			CPLNT_DIV
			,CPLNT_TYPE
			,CPLNT_CNT
			,DATE_FORMAT(APPL_DTM, '%Y-%m-%d') APPL_DTM
			,JUDG_TYPE
			,JUDG_CNT
			,DATE_FORMAT(UPD_DTM, '%Y-%m-%d') UPD_DTM
		FROM 
			BRT_CPLNT_STAT
		<where>
			<if test="CONTENT != NULL and CONTENT != ''">
				CPLNT_DIV = #{CONTENT}
			</if>
			<if test="TYPE == 'ALL' and CONTENT != ''">
				CPLNT_DIV LIKE CONCAT('%',#{CONTENT},'%')
			</if>
		</where> 
		GROUP BY
			CPLNT_DIV
		ORDER BY 
			CPLNT_DIV
	</select>
  
  <select id="ST0701SHI0" resultType="Map">
  		SELECT
  			CPLNT_DIV
  		FROM
  			BRT_CPLNT_STAT
  		ORDER BY
  			CPLNT_DIV
  </select>
  
  <select id="ST0701SHI1" resultType="Map">
  		SELECT
  			CPLNT_TYPE
  		FROM
  			BRT_CPLNT_STAT
  		WHERE
  			CPLNT_DIV = #{CPLNT_DIV}
  		GROUP BY
  			CPLNT_TYPE
  		ORDER BY
  			CPLNT_TYPE
  </select>
  
  <select id="ST0701G1R0" resultType="Map">
		SELECT
			CPLNT_DIV
			,CPLNT_TYPE
			,SUM(CPLNT_CNT) AS CPLNT_CNT
			,DATE_FORMAT(APPL_DTM, '%Y-%m-%d') APPL_DTM
			,JUDG_TYPE
			,SUM(JUDG_CNT) AS JUDG_CNT
			,DATE_FORMAT(UPD_DTM, '%Y-%m-%d') UPD_DTM
		FROM
			BRT_CPLNT_STAT
		WHERE
			CPLNT_DIV = #{CPLNT_DIV}
			AND CPLNT_TYPE IN
			<foreach collection="CPLNT_TYPE" item="item" index="index"  open="(" close=")" separator=",">
				#{item}
			</foreach>
			<if test="F_DATE != null and F_DATE != '' and L_DATE != null and L_DATE != '' ">
				AND DATE_FORMAT(APPL_DTM, '%Y%m%d') BETWEEN #{F_DATE} AND #{L_DATE}
			</if>
		GROUP BY
			APPL_DTM, CPLNT_DIV, CPLNT_TYPE
		ORDER BY
			CPLNT_TYPE, APPL_DTM
  </select>	
	
	<select id="ST0701G2R0" resultType="Map">
		SELECT
			CPLNT_DIV
			,CPLNT_TYPE
			,SUM(CPLNT_CNT) AS CPLNT_CNT
			,DATE_FORMAT(APPL_DTM, '%Y-%m-%d') APPL_DTM
			,JUDG_TYPE
			,SUM(JUDG_CNT) AS JUDG_CNT
			,DATE_FORMAT(UPD_DTM, '%Y-%m-%d') UPD_DTM
		FROM
			BRT_CPLNT_STAT
		WHERE
			CPLNT_DIV = #{CPLNT_DIV}
			AND CPLNT_TYPE IN
			<foreach collection="CPLNT_TYPE" item="item" index="index"  open="(" close=")" separator=",">
				#{item}
			</foreach>
			<if test="F_DATE != null and F_DATE != '' and L_DATE != null and L_DATE != '' ">
				AND DATE_FORMAT(APPL_DTM, '%Y%m%d') BETWEEN #{F_DATE} AND #{L_DATE}
			</if>
		GROUP BY
			APPL_DTM, CPLNT_DIV, CPLNT_TYPE
		ORDER BY
			CPLNT_TYPE, APPL_DTM
  </select>
  
 </mapper>