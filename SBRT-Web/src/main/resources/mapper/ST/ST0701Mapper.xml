<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

  <mapper namespace="kr.tracom.brt.domain.ST0701.ST0701Mapper">
  
  <select id="ST0701G0R0" resultType="Map">
		SELECT  CPLNT_DIV
		FROM 
			BRT_CPLNT_STAT
		ORDER BY CPLNT_DIV
	</select>
  
  
  <select id="ST0701G1R0" resultType="Map">
  		SELECT
		<if test="SELECT_DIV == 'DAY'">
			DATE_FORMAT(DATE(A.APPL_DTM), '%Y-%m-%d') APPL_DTM
			,SUM(A.CPLNT_CNT) AS CPLNT_SUM
			,A.CPLNT_DIV
			,A.CPLNT_CNT
			,A.CPLNT_TYPE
		</if>
		<if test="SELECT_DIV == 'MONTH'">
			MONTH(A.APPL_DTM) AS APPL_DTM
			,SUM(A.CPLNT_CNT) AS CPLNT_SUM
			,A.CPLNT_DIV
			,A.CPLNT_CNT
			,A.CPLNT_TYPE
		</if>
		FROM
			BRT_CPLNT_STAT A
		WHERE
			<!-- A.CPLNT_DIV IN
		<foreach collection="CPLNT_DIV" item="item" index="index"  open="(" close=")" separator=",">
			#{item}
		</foreach> -->
			<if test="F_DATE != null and F_DATE != '' and L_DATE != null and L_DATE != '' ">
			 DATE_FORMAT(A.APPL_DTM, '%Y%m%d') BETWEEN #{F_DATE} AND #{L_DATE}
			</if>
		<if test="SELECT_DIV == 'DAY'">
		GROUP BY
			APPL_DTM, A.CPLNT_TYPE
		ORDER BY
			A.CPLNT_TYPE, APPL_DTM
		</if>
		<if test="SELECT_DIV == 'MONTH'">
		GROUP BY 
			A.CPLNT_TYPE
		ORDER BY
			A.CPLNT_TYPE, A.APPL_DTM 
		</if>
  </select>
  
   <!-- <select id="ST0701G1R1" resultType="Map">
 		SELECT 
			DATE_FORMAT(DATE(A.OPER_DT), '%Y-%m-%d') OPER_DT
			,AVG(A.AVRG_SPD) AS AVRG_SPD
			,A.ROUT_ID
			,A.REP_ROUT_ID
			,B.ROUT_NM
		FROM
			BRT_ROUT_AVER_OPER_SP_STAT A
			LEFT JOIN BMS_ROUT_MST B
			ON A.ROUT_ID = B.ROUT_ID
		WHERE
			A.ROUT_ID IN
		<foreach collection="ROUT_ID" item="item" index="index"  open="(" close=")" separator=",">
			#{item}
		</foreach>
			<if test="F_DATE != null and F_DATE != '' and L_DATE != null and L_DATE != '' ">
				AND DATE_FORMAT(A.OPER_DT, '%Y%m%d') BETWEEN #{F_DATE} AND #{L_DATE}
			</if>
			<if test="TYPE == 'OPER_SN'">
				GROUP BY
					A.ROUT_ID, A.OPER_SN
			</if>
			<if test="TYPE == 'ALLOC_NO'">
				GROUP BY
					A.ROUT_ID, A.ALLOC_NO
			</if>
			<if test="TYPE == 'REP_ROUT_ID'">
				GROUP BY
					A.REP_ROUT_ID
			</if>
		GROUP BY
			OPER_DT, A.ROUT_ID
		ORDER BY
			A.ROUT_ID, OPER_DT
  </select>
  
  <select id="ST0701G1R2" resultType="Map">
  		SELECT 
			MONTH(A.OPER_DT) AS OPER_DT
			,AVG(A.AVRG_SPD) AS AVRG_SPD
			,A.ROUT_ID
			,A.REP_ROUT_ID
			,B.ROUT_NM
		FROM 
			BRT_ROUT_AVER_OPER_SP_STAT A
			LEFT JOIN BMS_ROUT_MST B
			ON A.ROUT_ID = B.ROUT_ID
		WHERE
			A.ROUT_ID IN
		<foreach collection="ROUT_ID" item="item" index="index"  open="(" close=")" separator=",">
			#{item}
		</foreach>
			<if test="F_DATE != null and F_DATE != '' and L_DATE != null and L_DATE != '' ">
				AND DATE_FORMAT(A.OPER_DT, '%Y%m%d') BETWEEN #{F_DATE} AND #{L_DATE}
			</if>
			<if test="TYPE == 'OPER_SN'">
				GROUP BY
					A.ROUT_ID, A.OPER_SN
			</if>
			<if test="TYPE == 'ALLOC_NO'">
				GROUP BY
					A.ROUT_ID, A.ALLOC_NO
			</if>
			<if test="TYPE == 'REP_ROUT_ID'">
				GROUP BY
					A.REP_ROUT_ID
			</if>
		GROUP BY 
			A.REP_ROUT_ID
		ORDER BY
			A.OPER_DT, A.ROUT_ID
  </select>
  

  
   <select id="ST0701G1R0" resultType="Map">
  		SELECT
  			DATE_FORMAT(A.OPER_DT, '%Y-%m-%d') OPER_DT
			,A.REP_ROUT_ID
			,A.ROUT_ID
			,CONCAT(A.STAT_H, 'ì‹œ') AS STAT_H
			,AVG(AVRG_SPD) AS AVRG_SPD
			,MAX(MAX_SPD) AS MAX_SPD
			,MIN(MIN_SPD) AS MIN_SPD
			,B.ROUT_NM
		FROM
			BRT_ROUT_AVER_OPER_SP_STAT A
			LEFT JOIN BMS_ROUT_MST B
			ON A.ROUT_ID = B.ROUT_ID
		WHERE
			A.ROUT_ID IN
		<foreach collection="ROUT_ID" item="item" index="index"  open="(" close=")" separator=",">
			#{item}
		</foreach>
			<if test="(F_DATE != null and F_DATE != '') and (L_DATE == null or L_DATE == '')">
				<![CDATA[AND A.OPER_DT >= #{F_DATE}]]>
			</if>
			<if test="(F_DATE == null or F_DATE == '') and L_DATE != null and L_DATE != '' ">
				<![CDATA[AND A.OPER_DT <= #{L_DATE}]]>
			</if>
			<if test="F_DATE != null and F_DATE != '' and L_DATE != null and L_DATE != '' ">
				AND DATE_FORMAT(A.OPER_DT, '%Y%m%d') BETWEEN #{F_DATE} AND #{L_DATE}
			</if>
			<if test="TYPE == 'ROUT_ID'">
				GROUP BY
					A.ROUT_ID
			</if>
			<if test="TYPE == 'OPER_SN'">
				GROUP BY
					A.ROUT_ID, A.OPER_SN
			</if>
			<if test="TYPE == 'ALLOC_NO'">
				GROUP BY
					A.ROUT_ID, A.ALLOC_NO
			</if>
			<if test="TYPE == 'REP_ROUT_ID'">
				GROUP BY
					A.REP_ROUT_ID
			</if>
		ORDER BY
			OPER_DT, A.ROUT_ID, A.STAT_H
  </select> -->
  
	


</mapper>