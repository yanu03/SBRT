<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.tracom.cm.domain.Main.MainMapper">

<select id="bmsMainG0" resultType="Map">
	SELECT
		VHC_NO
		,BUS_STS
		,PRV_PLCE_NM
		,DATE_FORMAT(UPD_DTM, '%Y-%m-%d %H:%i') UPD_DTM
		,VHC_ID
		,GPS_X
		,GPS_Y
	FROM
		BRT_CUR_OPER_INFO
	<!--  WHERE
		DATE_FORMAT(UPD_DTM, '%Y-%m-%d') = CURDATE() -->
	ORDER BY
		UPD_DTM
	LIMIT
		20
</select>

<select id="bmsMainG1" resultType="Map">
	SELECT
		PROV_NM
		,NEWS_TITLE
		,DATE_FORMAT(UPD_DTM, '%Y-%m-%d %H:%i') UPD_DTM 
	FROM
		BMS_NEWS_INFO
	<!--  WHERE
		DATE_FORMAT(UPD_DTM, '%Y-%m-%d') = CURDATE() -->
	ORDER BY
		UPD_DTM
	LIMIT
		20
</select>

<select id="bmsMainF0" resultType="Map">
	SELECT
		SKY_COND
		,TEMPC
		,HUMI
	FROM
		BMS_WEAT_INFO
	ORDER BY
		UPD_DTM DESC
	LIMIT
		1
</select>

<select id="bmsMainF1" resultType="Map">
	SELECT
		DUSTC
		,OZONEC
		,NDC
		,CMC
		,SDC
	FROM
		BMS_ATMO_INFO
	ORDER BY
		UPD_DTM DESC
	LIMIT
		1
</select>

<select id="brtMainG1" resultType="Map">
	SELECT
		VHC_NO
		,DSPTCH_CONTS
		,DATE_FORMAT(SEND_DATE, '%Y-%m-%d %H:%i') SEND_DATE 
	FROM
		BRT_DSPTCH_LOG
	<!--  WHERE
		DATE_FORMAT(SEND_DATE, '%Y-%m-%d') = CURDATE() -->
	ORDER BY
		SEND_DATE
	LIMIT
		20
</select>

<select id="brtMainF0" resultType="Map">
	SELECT
		COUNT(*) INCDNT_CNT
	FROM
		BRT_INCDNT_HIS
	WHERE
		DATE_FORMAT(UPD_DTM, '%Y-%m-%d') = CURDATE()
</select>

<select id="brtMainF1" resultType="Map">
	SELECT
		COUNT(*) INCDNT_RES_CNT
	FROM
		BRT_INCDNT_RES_INFO
	WHERE
		DATE_FORMAT(UPD_DTM, '%Y-%m-%d') = CURDATE()
</select>

<select id="brtMainF2" resultType="Map">
	SELECT
		COUNT(*) SPEEDING_CNT
	FROM
		BRT_OPER_VIOLT_HIS
	WHERE
		DATE_FORMAT(UPD_DTM, '%Y-%m-%d') = CURDATE()
	AND
		VIOLT_TYPE = "VL003"
</select>
	
<select id="brtMainF3" resultType="Map">
	SELECT
		COUNT(*) NOSTOP_CNT
	FROM
		BRT_OPER_VIOLT_HIS
	WHERE
		DATE_FORMAT(UPD_DTM, '%Y-%m-%d') = CURDATE()
	AND
		VIOLT_TYPE = "VL004"
</select>	
</mapper>