var report_version="5.0.95";var exe_print_version="1.0.0.1";var mCR_reportVersion="5.0.95";var mCR_exe_print_version="1.0.0.1";mCR_reportVersion="5.0.95";var mCR_UserAgt=navigator.userAgent.toLowerCase();try{window.top.mCR_UserAgt=mCR_UserAgt;}catch(e){if(typeof window.console!="undefined"){window.console.log("userAgt : "+mCR_UserAgt);}}mCR_isMajor=parseInt(navigator.appVersion);mCR_isMinor=parseFloat(navigator.appVersion);mCR_isMoz=((mCR_UserAgt.indexOf("mozilla")!=-1)&&(mCR_UserAgt.indexOf("spoofer")==-1)&&(mCR_UserAgt.indexOf("compatible")==-1)&&(mCR_UserAgt.indexOf("opera")==-1)&&(mCR_UserAgt.indexOf("webtv")==-1)&&(mCR_UserAgt.indexOf("hotjava")==-1));mCR_isMoz2=(mCR_isMoz&&(mCR_isMajor==2));mCR_isMoz3=(mCR_isMoz&&(mCR_isMajor==3));mCR_isMoz4=(mCR_isMoz&&(mCR_isMajor==4));mCR_isGecko=(mCR_UserAgt.indexOf("gecko")!=-1);mCR_isFirefox=(mCR_UserAgt.indexOf("firefox")!=-1);mCR_isNav2=mCR_isMoz2;mCR_isNav3=mCR_isMoz3;mCR_isNav4=mCR_isMoz4;mCR_isNav4up=(mCR_isNav4||((mCR_isMajor>=4)&&(mCR_UserAgt.indexOf("netscape")!=-1)));mCR_isNav=(mCR_isNav2||mCR_isNav3||mCR_isNav4);mCR_isMozilla=(mCR_isMoz&&mCR_isGecko);mCR_isMozilla1=(mCR_isMoz&&mCR_isGecko&&(mCR_UserAgt.indexOf("rv:1")!=-1));mCR_isIE=((mCR_UserAgt.indexOf("msie")!=-1)&&(mCR_UserAgt.indexOf("opera")==-1));mCR_isIEVersion=0;mCR_isIE6=(mCR_isIE&&(mCR_isMajor==4)&&(mCR_UserAgt.indexOf("msie 6.")!=-1));if(mCR_isIE6){mCR_isIEVersion=6;}mCR_isIE7=(mCR_isIE&&(mCR_isMajor==4)&&(mCR_UserAgt.indexOf("msie 7.")!=-1));if(mCR_isIE7){mCR_isIE6=false;mCR_isIEVersion=7;}mCR_isIE8=(mCR_isIE&&(mCR_isMajor==4)&&(mCR_UserAgt.indexOf("msie 8.")!=-1));if(mCR_isIE8){mCR_isIE6=false;mCR_isIE7=false;mCR_isIEVersion=8;}mCR_isIE9=(mCR_isIE&&(mCR_isMajor==5)&&(mCR_UserAgt.indexOf("msie 9.")!=-1));if(mCR_isIE9){mCR_isIE6=false;mCR_isIE7=false;mCR_isIE8=false;mCR_isIEVersion=9;}mCR_isIE10=(mCR_isIE&&(mCR_isMajor==5)&&(mCR_UserAgt.indexOf("msie 10.")!=-1));if(mCR_isIE10){mCR_isIE6=false;mCR_isIE7=false;mCR_isIE8=false;mCR_isIE9=false;mCR_isIEVersion=10;}mCR_isIE11=(mCR_isGecko&&!mCR_isFirefox&&(mCR_isMajor==5)&&(mCR_UserAgt.indexOf("rv:11.")!=-1));if(mCR_isIE11){mCR_isIE6=false;mCR_isIE7=false;mCR_isIE8=false;mCR_isIE9=false;mCR_isIE10=false;mCR_isIE=true;mCR_isIEVersion=11;}mCR_isWindow=(mCR_UserAgt.indexOf("windows")!=-1);mCR_isChrome=!mCR_isIE&&(mCR_UserAgt.indexOf("chrome")!=-1)?true:false;mCR_isChrome77Up=false;if(mCR_isChrome){var tempVer=mCR_UserAgt.match(/chrome\/([0-9]+)\./g);if(null!=tempVer){if(Number(tempVer[0].substring(7))>76){mCR_isChrome77Up=true;}}}mCR_isChrome58=false;if(mCR_isChrome){var tempVer=mCR_UserAgt.match(/chrome\/([0-9]+)\./g);if(null!=tempVer){if(Number(tempVer[0].substring(7))>57){mCR_isChrome58=true;}}}mCR_isEdge=mCR_isChrome&&(mCR_UserAgt.indexOf("edge")!=-1);mCR_isOpera=mCR_isChrome&&(mCR_UserAgt.indexOf("opr/")!=-1);mCR_isWhale=mCR_isChrome&&(mCR_UserAgt.indexOf("whale/")!=-1);mCR_isSafari=(mCR_UserAgt.indexOf("safari")!=-1&&!mCR_isChrome);mCR_isWindowSafari=(mCR_isSafari&&mCR_UserAgt.indexOf("windows")!=-1);mCR_isChromeOS=mCR_isChrome&&(mCR_UserAgt.indexOf("csos")!=-1);mCR_isChromeFrame=!mCR_isIE&&mCR_isChrome;mCR_isWebkit=mCR_isSafari||mCR_isChrome;mCR_isMozBrowser=mCR_isFirefox||mCR_isOpera;mCR_isIpad=((mCR_isSafari||mCR_isMoz||(mCR_UserAgt.indexOf("applewebkit")!=-1))&&(mCR_UserAgt.indexOf("ipad")!=-1));mCR_isIphone=((mCR_isSafari||mCR_isMoz||(mCR_UserAgt.indexOf("applewebkit")!=-1))&&(mCR_UserAgt.indexOf("iphone")!=-1));mCR_isApple=(mCR_isIpad||mCR_isIphone);mCR_isAndroid=(mCR_UserAgt.indexOf("android")!=-1);mCR_isOpera_mini=(mCR_UserAgt.indexOf("opera mini")!=-1);mCR_isAndroidMobile=(mCR_isAndroid&&mCR_UserAgt.indexOf("mobile")!=-1);mCR_isAndroidTablet=(mCR_isAndroid&&!mCR_isAndroidMobile);mCR_isAndroidMobile44=(mCR_isAndroidMobile&&mCR_UserAgt.indexOf("android 4.")!=-1);mCR_isSamsungBrowser=(mCR_isAndroid&&(mCR_UserAgt.indexOf("samsungbrowser")!=-1));mCR_isMobile=(mCR_isIphone||mCR_isAndroidMobile);mCR_isTablet=(mCR_isIpad||mCR_isAndroidTablet);mCR_isSmartphone=false;mCR_isSmartphone=(mCR_isIphone||mCR_isOpera_mini||mCR_isIpad||mCR_isAndroid);mCR_isSVG=true;if(typeof window.SVGAElement=="undefined"){mCR_isSVG=false;if(!mCR_isIE6&&!mCR_isIE7&&!mCR_isIE8){mCR_isIE7=true;}mCR_isIE=true;mCR_isIE9=false;mCR_isIE10=false;mCR_isIE11=false;mCR_isIEVersion=7;}else{if(mCR_isIE7||mCR_isIE8){mCR_isSVG=false;}}mCR_isDaumApp=(mCR_isSmartphone&&(mCR_UserAgt.indexOf("daum")!=-1));mCR_isNaverApp=(mCR_isSmartphone&&(mCR_UserAgt.indexOf("naver")!=-1));mCR_isIosChrome=(mCR_isApple&&(mCR_UserAgt.indexOf("crios")!=-1));mCR_isIosKakaoApp=(mCR_isApple&&(mCR_UserAgt.indexOf("kakao")!=-1));var mCR_getAcrobatInfo=function(){var f=function(g){try{return new ActiveXObject(g);}catch(h){}};var b=function(g){for(key in navigator.plugins){var h=navigator.plugins[key];if(h.name==g){return h;}}};var c=function(){return this.plugin=this.plugin||function(){if(mCR_isIE||mCR_isIE11){return f("AcroPDF.PDF")||f("PDF.PdfCtrl");}else{return b("Chromium PDF Viewer")||b("Chrome PDF Viewer")||b("Microsoft Edge PDF Viewer")||b("Adobe Acrobat")||b("WebKit built-in PDF");}}();};var d=function(){return !!c();};var a=function(){try{var i=c();if(mCR_isIE||mCR_isIE11){var g=i.GetVersions().split(",");var h=g[0].split("=");return parseFloat(h[1]);}if(i.version){return parseInt(i.version);}return i.name;}catch(j){return null;}};return{acrobat:d()?true:false,acrobatVersion:a()};};mCR_objPDFInfo=mCR_getAcrobatInfo();mCR_isWin78_reader9=(((mCR_UserAgt.indexOf("windows nt 6.1")!=-1)||(mCR_UserAgt.indexOf("windows nt 6.2")!=-1)||(mCR_UserAgt.indexOf("windows nt 10.")!=-1))&&(null!=mCR_objPDFInfo.acrobatVersion)&&(mCR_objPDFInfo.acrobatVersion<10));mCR_isReader8=(null!=mCR_objPDFInfo.acrobatVersion)&&(mCR_objPDFInfo.acrobatVersion<9);mCR_isWinxpReader10=((mCR_isIE6||mCR_isIE7||mCR_isIE8)&&(null!=mCR_objPDFInfo.acrobatVersion)&&(mCR_objPDFInfo.acrobatVersion<11&&mCR_objPDFInfo.acrobatVersion>9));if(mCR_isEdge){mCR_objPDFInfo.acrobat=true;mCR_objPDFInfo.acrobatVersion="Edge PDF Viewer";}else{if(mCR_isFirefox){mCR_objPDFInfo.acrobat=true;mCR_objPDFInfo.acrobatVersion="Firefox PDF Viewer";}else{if(mCR_isSafari&&!mCR_isWindowSafari){mCR_objPDFInfo.acrobat=true;mCR_objPDFInfo.acrobatVersion="Safari PDF Viewer";}}}mCR_isIndexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;mCR_isIDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction;mCR_isIDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange;if(!Object.create){Object.create=function(c,a){if(typeof c!=="object"&&typeof c!=="function"){throw new TypeError("Object prototype may only be an Object: "+c);}else{if(c===null){throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");}}if(typeof a!="undefined"){throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");}function b(){}b.prototype=c;return new b();};}var m_reportHashMap=function(){};function mCR_StrTrim(a){return a.replace(/^\s+|\s+$/gm,"");}function mCR_onBeforeSend(a){if(typeof window.onBeforeSend!="undefined"){return onBeforeSend(a);}return a;}function mCR_onAfterSend(a){if(typeof window.onAfterSend!="undefined"){return onAfterSend(a);}return a;}function mCR_objectCall(b){if(b.charAt(0)=="("){b=b.substring(1,b.length-1);b=b.replace(/\'/g,'"');}var a=jQuery.parseJSON(b);return a;}function mCR_exeUpdateVersionCheck(c,b){var a=c.split(".");var d=b.split(".");if(a[0]>d[0]){return true;}else{if(a[0]==d[0]){if(a[1]>d[1]){return true;}else{if(a[1]==d[1]){if(a[2]>d[2]){return true;}else{return false;}}else{return false;}}}else{return false;}}}function mCR_makePrintFrame(k,c){var j=document.styleSheets;var d="";if(typeof j!="undefined"){var b=j.length;for(var f=0;f<b;f++){var a=j[f];if(null!=a){if(null!=a.href&&-1!=a.href.indexOf("font.css")){d=a.href;}}}}var g=new Array();g.push('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">');g.push("<html>");g.push("<head>");g.push('<meta http-equiv="Content-Type" content="text/html; charset=utf-8">');g.push("<title>report</title>");if(""!=d){g.push("<link rel='stylesheet' type='text/css' href='"+d+"'>");}g.push("<style media='print' type='text/css'>");g.push(" #header, #leftside, #rightside, #footer {");g.push("	display:none;");g.push("}");g.push("    @page {");if(!mCR_isIE){g.push("size:");g.push(Math.floor(k*25.4/96)+"mm ");g.push(Math.floor(c*25.4/96)+"mm;");}g.push("       margin: 0mm 0mm 0mm 0mm;");g.push("    }");g.push("  body, #content, .container .row {");g.push(" margin : 0;");g.push(" width:100%;");g.push(" }");g.push("</style>");g.push("<style type='text/css'>");g.push(".page-break{");if(mCR_isIE){g.push("border:1px solid transparent;");g.push("overflow:visible;");}else{if(mCR_isSafari&&!mCR_isWindowSafari){g.push("border:0px solid red;");g.push("overflow:hidden;");g.push("zoom:0.87;");g.push("width:"+k+"px;");g.push("height:"+c+"px;");}else{g.push("border:0px solid red;");g.push("overflow:hidden;");g.push("width:"+Math.floor(k)+"px;");g.push("height:"+Math.floor(c)+"px;");}}g.push(" }");g.push("</style>");g.push(" <script type='text/javascript'>");g.push(" function callPrint(){");g.push("	   document.execCommand('print', false, null);");g.push(" }");g.push("<\/script>");g.push("</head>");g.push("<body id='body1'>");var l=mCR_getFontCSSNameList();for(var h=0;h<l.length;h++){g.push("<div style='position:absolute;left:0px;top:0px;height:1px;width:1px;visibility:hidden;font-family:"+l[h]+"'>1</div>");}g.push("</body>");g.push("</html>");return g.join("");}function mCR_getFontCSSNameList(){var l=new Array();try{if(null!=document.styleSheets){for(var f=0;f<document.styleSheets.length;f++){var h=document.styleSheets[f];if(null!=h.href){if(-1!=h.href.indexOf("font")){if(null!=h.cssRules){for(var c=0;c<h.cssRules.length;c++){var a="";if(mCR_isFirefox){var k=/font\-family\:.+\;/g;var d=k.exec(h.cssRules[c].style.cssText);if(null!=d){var b=d[0];k=/font\-family(\s|)\:(\s|)\"/g;a=b.replace(k,"").replace(/\"\;/g,"");}}else{a=h.cssRules[c].style.fontFamily;}if(""!=a){l.push(a);}}}}}}}}catch(g){}return l;}function HttpClient(){try{var b=new XMLHttpRequest();if(null!=b){this.m_objHttpRequest=b;}}catch(a){try{var b=new ActiveXObject("Msxml2.XMLHTTP");if(null!=b){this.m_objHttpRequest=b;}}catch(a){try{var b=new ActiveXObject("Microsoft.XMLHTTP");if(null!=b){this.m_objHttpRequest=b;}}catch(a){throw new Error("HttpRequest not supported");}}}}HttpClient.prototype.send=function(f,a,b,d){if(b){this.m_objHttpRequest.onreadystatechange=d;}else{this.m_objHttpRequest.onreadystatechange=null;}try{this.m_objHttpRequest.open("POST",f,b);this.m_objHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");this.m_objHttpRequest.send(a);}catch(c){if(window.console){window.console.log(c);}}if(!b){if(4==this.m_objHttpRequest.readyState){if(200==this.m_objHttpRequest.status){return this.m_objHttpRequest.responseText;}else{throw new Error(this.m_objHttpRequest.status);}}return this._handleSyncHttpResponse();}};function createOOFReport(b,c,d){if(null==d){mCR_ReportEventHandler(20);}var a=new ReportView(b,null,null,c,d);return a;}function createJSPReport(c,d,b,f){if(null==f){mCR_ReportEventHandler(20);}var a=new ReportView(c,d,b,null,f);return a;}function createReport(b,f,c){if(null==c){mCR_ReportEventHandler(20);}var a=new ReportView(b,null,null,null,c);try{a.objReport=mCR_objectCall(mCR_StrTrim(f));}catch(d){mCR_ReportEventHandler(9);a.objReport=null;}return a;}function ReportView(c,a,d,b,f){this.strServerPath=c;this.strUserJspPath=a;this.strPostData=d;this.objTargetDOM=f;this.strOOF=b;this.objReport=null;this.elmProgess=null;this.elmHeaderBlind=null;this.isUpperMenu=true;this.objHeader=new mCR_ReportHeader(this);this.objBody=new mCR_ReportBody(this);this.objFileDownFrame=new mCR_ReportFileDownFrame(this);this.objThumbnailFrame=new mCR_ReportThumbnailFrame(this);this.objTOCFrame=new mCR_ReportTOCFrame(this);this.objTextBuilder=new mCR_TextBuilder();this.objSpeechBubbleFrame=new mCR_ReportSpeechBubbleFrame(this,mCR_isIE);this.objSearchWordFrame=null;this.objPrintMainOptionFrame=null;this.isPrintMainOptionFrame=false;this.objPrintSubOptionFrame=null;this.isPrintSubOptionFrame=false;this.isUsePrintSubOptionFrame=true;this.objDownloadMainOptionFrame=null;this.isDownloadMainOptionFrame=false;this.objDownloadSubOptionFrame=null;this.isDownloadSubOptionFrame=false;this.isUseDownloadSubOptionFrame=true;this.isTxtSaveExportOption=false;this.objSaveOptionVisible={isXls:true,isXlsx:true,isPdf:true,isHwp:true,isDoc:true,isDocx:true,isPpt:true,isPptx:false,isHtml:false,isCell:true,isJpg:false,isTxt:false,isTif:false,isMultitif:false,isExcelData:false,isBrl:false,isShow:true};this.objSaveMenuOrder=["xls","xlsx","pdf","hwp","doc","docx","ppt","pptx","show","html","cell","jpg","txt","tif","multitif","exceldata","brl"];this.objRatioComboInfo=[{name:"75%",text:"75%",value:"0.75",visible:true},{name:"100%",text:"100%",value:"1",visible:true},{name:"150%",text:"150%",value:"1.5",visible:true},{name:"200%",text:"200%",value:"2",visible:true},{name:"PageWidth",text:"pageWidth",value:"pageWidth",visible:true},{name:"WholePage",text:"wholePage",value:"pageHeight",visible:true}];this.objCustomSaveButtonInfo={isButtonHwp:false,isButtonXls:false,isButtonPdf:false,isButtonDoc:false};this.objPrintOptionInfo=[{name:"pdf_print",text:"pdf",value:"pdf",visible:true},{name:"html_print",text:"html",value:"html",visible:true},{name:"exe_print",text:"exe",value:"exe",visible:false}];this.objAdobeMessage={isMessage:false,strMessage:""};this.objDirectPrintInfo={isUse:false,printType:0};this.objStyleInfo={isCustomDesign:false,strHeaderHeight:"50px",strHeaderIconSize:"34px",strHeadStyle:null,strBodyStyle:null,strSaveButtonStyle:null,strPrintButtonStyle:null,strHWPButtonStyle:null,strEXCELButtonStyle:null,strPDFButtonStyle:null,strDOCButtonStyle:null,strTOCButtonStyle:null,strMoveToMemoPageButtonStyle:null,strMemoButtonStyle:null,strToggleMemoOpacityButtonStyle:null,strMemoOptionButtonStyle:null,strReturnFromMemoPageButtonStyle:null,strThumbnailButtonStyle:null,strMoveToSearchPageButtonStyle:null,strFirstButtonStyle:null,strPrevButtonStyle:null,strCountBoxStyle:null,strCurrentCountBoxStyle:null,strTotalCountBoxStyle:null,strNextButtonStyle:null,strLastButtonStyle:null,strZoomInStyle:null,strInfoStyle:null,strCloseButtonStyle:null};this.nOpendMenuType=null;this.isBodyOverflowAuto=false;this.arrTOCData=null;this.objClipSaveExportDownloadData=null;this.nFileDonwloadType=0;this.isProgressToPageMove=false;this.isReportStart=true;this.isReportMakingFinish=false;this.isPageInfoGetAlready=false;this.isSetPrintFrameFirst=false;this.objReportInfo={strEngineVersion:null,strViewerVersion:window.mCR_reportVersion,strReportKey:null,isStatus:false,isEndReport:false,nCode:0};this.objOption={nLanguage:0,isDebug:false,isAccessibility:false,nViewType:2};this.isClientPaintViewAccessibility=false;this.strPrintSubOptionFrameDetailPdf=null;this.strPrintSubOptionFrameDetailHTML=null;this.arrDocPageSizeInfoList=[];this.arrDocPageCheckList=[];this.isScrollView=false;this.arrDocPageDivList=[];this.objPrintRangeOption={type:0,pageFrom:1,pageTo:1};this.strFileName="";this.objPageInfo={nPageCount:0,nSelectPageIndex:0,nPageCountTime:700,nPageWidth:0,nPageHeight:0,strReportName:"report",nExportType:0,strZoomRatio:"1"};this.objSideMenuInfo={isThumbnail:false,isThumbnailCheck:false,isThumbnailCustom:false,isTOCCustom:false,isTOC:false,isThumbnailUse:false,isTocUse:false};this.strDefaultSaveOption="";this.objSaveExportOptionInfo={xls:{exportMethod:1,mergeCell:true,mergeEmptyCell:false,splitCellAtPageSize:true,rightToLeft:false,widthRate:100,heightRate:100,coordinateErrorLimit:10,processGerenalFormat:1,printingMagnification:100,fitToPageWhenPrinting:false,removeHyperlink:false,repeatPageSectionWhenAllSectionInOneSheet:false,dpi:150},xlsx:{exportMethod:1,mergeCell:true,mergeEmptyCell:false,splitCellAtPageSize:true,rightToLeft:false,widthRate:100,heightRate:100,coordinateErrorLimit:10,processGerenalFormat:1,printingMagnification:100,fitToPageWhenPrinting:false,removeHyperlink:false,repeatPageSectionWhenAllSectionInOneSheet:false,userPassword:"",dpi:150,is2Dot5VersionConverted:false},pdf:{userpw:"",textToImage:false,importOriginImage:false,removeHyperlink:false,useCodeX:true},hwp:{fixSize:true,allowOverlay:true,setPageBottomMarginToZero:true,outputLikeWord:false,tableSplitMethod:2,defaultCharGap:-8,charRatio:100,putCheckboxIntoCell:true,splitTextByLine:true,mergeTable:false,lineSpaceRate:100,positionRelTo:1,hwpExportMethod:1,splitPageOnListTableOnly:true,pageBottomMarginApplicationRate:100,insertPageNumber:false,mergeAllTablesOnListTableOnly:false,insertLabelWithTextOnListTableOnly:false,isTransparentMode:false},doc:{splitTextLine:true,processAsUnicode:true,processEqualAlign:4,defaultCharSpace:-0.5,tableWrapperBottomGap:0,insertTableWrapper:true,mergeTable:false,fitShapeToText:false,TableRowHeightSort:1},docx:{splitTextLine:true,processAsUnicode:true,processEqualAlign:4,defaultCharSpace:-0.5,tableWrapperBottomGap:0,insertTableWrapper:true,mergeTable:false,lineSpaceRate:100,easyEditable:false,userPassword:""},ppt:{mergeTable:false,ignoreLineSpace:true,removeHyperlink:false},pptx:{mergeTable:false,removeHyperlink:false,splitTextByLine:false,defaultCharGap:0,lineSpaceRate:0,putCheckboxIntoCell:false,userPassword:""},show:{mergeTable:false,removeHyperlink:false,splitTextByLine:false,defaultCharGap:0,lineSpaceRate:0,putCheckboxIntoCell:false,userPassword:""},html:{isSplite:true,dpiValue:96},cell:{exportMethod:1,mergeCell:true,mergeEmptyCell:false,splitCellAtPageSize:true,rightToLeft:false,widthRate:100,heightRate:100,coordinateErrorLimit:10,processGerenalFormat:1,printingMagnification:100,fitToPageWhenPrinting:false,removeHyperlink:false,repeatPageSectionWhenAllSectionInOneSheet:false,userPassword:"",dpi:150},jpg:{rotate90:false,dpiX:96,dpiY:96,quality:100},txt:{splitPage:0},tif:{rotate90:false,dpiX:96,dpiY:96,blackWhite:true},multitif:{rotate90:false,dpiX:96,dpiY:96,blackWhite:true},exceldata:{outputPageSectionMethod:0},brl:{splitPage:0}};this.isErrorSaveAlert=false;this.strErrorSaveString="";this.isErrorSaveButtonRemove=true;this.isErrorSaveBrowser=mCR_isDaumApp||mCR_isNaverApp||mCR_isIosChrome||mCR_isIosKakaoApp;this.strDownloadFormMethod="post";this.objDocPageController=new docPageController();this.objDocPageControllerDummy=new docPageController();this.isDummyFinished=false;this.isSearchWord=false;this.viewData=null;this.objClipDocument=null;this.isUseMemo=false;this.isRemoveTotalCountSlash=false;this.objPrintHTMLManualFrame=null;this.arrThumbnailImageList=[];this.arrCustomButtonInfoList=new Array();this.objLanguageMap=null;this.isBodyEventLock=false;this.arrWebLinkList=null;this.isPrintDirect=false;this.isPrintDirectPDF=false;this.isPrintDirectHTML=false;this.isPrintDirectEXE=false;this.isPageChanged=false;this.nWaitTime=1;this.nEndReportDocument=0;this.elmProgressNumberLabel=null;this.fnEndPageViewFunction=null;this.isUsePrintButtonWithoutAcrobat=true;this.isCrossDomainPDFPrint=false;this.editableControlMap=new m_reportHashMap();this.objReportInfoFrame=null;this.isPopUpSaveDownload=null;this.fnEndReportFunction=null;this.fnCloseReportFunction=null;this.fnEndPDFPrintFunction=null;this.fnEndHTMLPrintFunction=null;this.fnStartPrintButton=null;this.fnStartSaveButton=null;this.fnStartSaveFunction=null;this.fnEndSaveFunction=null;this.objExePrintEvent={ok:null,cancel:null};this.objExePrintStatus={url:"http://127.0.0.1:",port:[22000,33000,11000],httpPort:[22000,33000,11000],httpsPort:[22443,33443,11443],intervalKey:null,disConnectCount:0,isSet:false,portNumber:null};this.objExePrintOption={isPrintPopup:true,printName:"",tray:"",startNumber:1,endNumber:-1,copies:1,option:""};this.exe_print_version="1.0.1";this.isExeVersionChecked=false;this.objProperties=function(){};}ReportView.prototype.view=function(){if(null!=this.objTargetDOM){this.debugMeg("<<<<<<<<<<<< 리포트 디버깅 로그를 시작합니다 >>>>>>>>>>>>>>>");this.debugMeg("userAgent Check >> "+mCR_UserAgt);this.debugMeg("PDF check >> "+mCR_objPDFInfo.acrobatVersion);if(mCR_isSmartphone){this.setDefaultRatio("PageWidth");}this.objLanguageMap=mCR_ReportLanguage(this.objOption.nLanguage);if(null!=this.objReport){this.createReportInfo();this.createReportView();}else{if(null!=this.strUserJspPath){this.sendUserJspData();}else{if(null!=this.strOOF){this.sendOOFData();}}}}else{alert("report log :: 타겟이 되는 html Tag가 존재 하지 않습니다.");}};ReportView.prototype.createReportInfo=function(){this.objReportInfo.strEngineVersion=this.objReport.version.build;this.objReportInfo.isStatus=this.objReport.status;if(null!=this.objReport.uid){this.objReportInfo.strReportKey=this.objReport.uid;}else{this.objReportInfo.strReportKey=this.objReport.reportkey;}this.objReportInfo.nCode=this.objReport.event;m_reportHashMap[this.objReportInfo.strReportKey]=this;this.debugMeg("리포트 서버 버전 >>> "+this.objReportInfo.strEngineVersion);this.debugMeg("리포트 웹뷰어 버전 >>> "+this.objReportInfo.strViewerVersion);this.debugMeg("리포트 키 >>> "+this.objReportInfo.strReportKey);};ReportView.prototype.createReportView=function(){this.objTargetDOM.innerHTML="";this.createProgress();this.objHeader.createHeader();this.objHeader.createButtons();this.objBody.createBody();this.objFileDownFrame.createFrame();this.isDocView=(this.objOption.nViewType!=0);this.createDeleteImg();if(this.objReportInfo.isStatus){this.debugMeg("리포트 실행  정상");this.sendPageCheck();}else{this.removeProgress();this.debugMeg("리포트 실행 실패");var a=null;if(this.objReportInfo.nCode<1000){a="IE00"+this.objReportInfo.nCode;}else{a="LE"+this.objReportInfo.nCode;}this.objBody.setReportErrorPage(a);this.objHeader.callStopPageProgress();this.objHeader.setDisableButtons(true);}};ReportView.prototype.reportPageCheck=function(a){if(a.status){if(a.is_s){this.debugMeg("리포트 생성중 (양호)");}else{this.debugMeg("리포트 생성중 (경고) 서버에서 생성중인 리포트를 세션에서 찾지 못했습니다. 파일 탐색으로 변경되었습니다.");this.debugMeg("계속해서 똑같은 결과가 내려온다면 이중화된 서버 가능성이 있습니다.");this.debugMeg("리포트를 생성한 서버와 확인작업을 위해 통신으로 접속한 서버가 다를 수 있습니다.");this.debugMeg("서버관리자에게 문의 하여 하나의 세션이 생성됐을 때 그 서버만 바라보도록 하거나 리포트 설정 폴더를 물리적으로 같은 폴더로 사용하도록 변경이 필요합니다.");}if(a.count>0){this.nWaitTime=1;}if(a.wait!=null){if(a.wait>-1){if(this.elmProgressNumberLabel!=null){this.elmProgressNumberLabel.style.fontSize="18px";this.elmProgressNumberLabel.innerText="대기자 : "+(a.wait+1)+" 명";}}else{if(this.elmProgressNumberLabel!=null){this.elmProgressNumberLabel.innerText="";}}}if(a.endReport){this.debugMeg("서버에서 리포트 생성은 완료..! ");this.nEndReportDocument=1;if(a.count>0){this.sendCreatePageInfo(this.objPageInfo.nSelectPageIndex);}else{this.debugMeg("report log :: 보고서 양식이 잘못되었습니다.(페이지가 없습니다.)");mCR_ReportEventHandler(30);this.objBody.setReportErrorPage();this.objHeader.setDisableButtons(true);}if(this.isSetPrintFrameFirst){this.isPageInfoGetAlready=true;}this.isReportMakingFinish=true;if(!this.objSideMenuInfo.isThumbnailUse){}else{if(this.objOption.nViewType!=0){if(this.isReportMakingFinish){this.createThumbnailFrame(a.count);this.isReportMakingFinish=false;}}else{if(this.isReportMakingFinish&&this.objSideMenuInfo.isThumbnail&&!this.objSideMenuInfo.isThumbnailCustom){this.createThumbnailFrame(this.objPageInfo.nPageCount);this.isReportMakingFinish=false;}}}if(this.objOption.nViewType!=0&&this.isSearchWord){this.objSearchWordFrame=new mCR_ReportSearchWordFrame(this);this.objSearchWordFrame.createSearchWordFrame();}if(!this.objSideMenuInfo.isTocUse){}else{this.getTOCInfo();}if(this.objClipDocument!=null){if(this.objClipDocument.documentMemo.length!=0){this.objSpeechBubbleFrame.arrSpeechBubbleArray=this.objClipDocument.documentMemo;}else{this.objSpeechBubbleFrame.createSpeechBubbleArray(a.count);}}if(mCR_isIE8||mCR_isIE7){this.objHeader.ChangeStylelowIEHeadCenter();}if((this.objOption.nViewType==1||this.objOption.nViewType==2)&&!this.isScrollView&&this.isUseMemo){this.objHeader.createMemoHeader();this.objHeader.createMoveMemoPageButton();}this.objReportInfo.isEndReport=true;mCR_ReportEventHandler(200);this.objHeader.setDisableButtonsExceptMove(false);this.isReportStart=false;this.removeProgress();this.objHeader.callStopPageProgress();}else{if(this.objPageInfo.nPageCount==0&&a.count!=0){this.isFirstPage=true;this.sendCreatePageInfo(0);}var b=this;window.setTimeout(function(){b.sendPageCheck();b=null;},this.objPageInfo.nPageCountTime*this.nWaitTime);}if(this.objOption.nViewType!=0&&a.count!=0){this.sendRequestPageSizeInfo(this.objPageInfo.nPageCount,a.count);}this.objPageInfo.nPageCount=a.count;if(this.objOption.nViewType!=0&&this.isScrollView){this.createPageDivs();if(a.endReport){this.arrDocPageDivList[a.count-1].style.marginBottom="0px";}}if(a.endReport&&this.isSearchWord){this.sendCreatePageOnly();}this.writeInPageInfo();if(a.endReport&&this.fnEndReportFunction!=null){this.fnEndReportFunction();}}else{if(a.event==14){this.debugMeg("report log :: REPORT 사용 권한이 없습니다 (라이센스)");mCR_ReportEventHandler(14);}else{mCR_ReportEventHandler(30);this.objBody.setReportErrorPage();this.objHeader.setDisableButtons(true);this.debugMeg("report log :: 리포트 생성중 오류 발생(engine) >>> 서버로그 확인 필요!");if(a.event==60){mCR_ReportEventHandler(60);this.objBody.setReportErrorPage();this.objHeader.setDisableButtons(true);this.debugMeg("report log :: 리포트서버와의 세션 종료!");}}this.isReportStart=false;this.removeProgress();this.objHeader.callStopPageProgress();}};ReportView.prototype.createPageDivs=function(){var c=this.objPageInfo.nPageCount;var a=this.arrDocPageDivList.length;for(var b=a;b<c;b++){this.arrDocPageDivList.push(this.objBody.makePageDiv(b));this.arrDocPageCheckList.push(false);}};ReportView.prototype.sendRequestPageSizeInfo=function(d,a){var f=d;if(this.arrDocPageSizeInfoList.length==0){f=1;}else{f++;}if(f>a){}else{this.debugMeg((f)+" ~ "+(a)+" 페이지 사이즈 정보를 서버에 요청합니다.....");var c="";var b="";c={reportkey:this.objReportInfo.strReportKey,startIndex:f,endIndex:a};b="ClipType=PageSizeInfo&ClipData="+JSON.stringify(c);this.debugMeg("전송할 데이터 >>>>>"+b);this.sendData(b);}};ReportView.prototype.sendData=function(d){d=mCR_onBeforeSend(d);var a=this;var f=this.strServerPath;var c=-1!=f.indexOf("?")?"GET":"POST";var b=d.indexOf("ClipData=")+9;d=d.substring(0,b)+encodeURIComponent(d.substring(b));$.ajax({type:c,url:f,data:d,success:function(g){g=mCR_onAfterSend(g);if(null!=g){a.receiveData(g);}},error:function(g){if(typeof g!="string"){mCR_ReportEventHandler(40);a.removeProgress();if(!a.isPrintDirect){a.objHeader.callStopPageProgress();a.objBody.setReportErrorPage();a.objHeader.setDisableButtons(true);}}else{a.debugMeg(g);}}});};ReportView.prototype.receiveData=function(c){try{var b=jQuery.parseJSON(c);if(null!=b){switch(b.id){case 1:this.objReport=b.resValue;if(b.resValue.wait!=null){if(b.resValue.wait>=2){this.nWaitTime=b.resValue.wait;}}this.createReportInfo();if(!this.isPrintDirect){this.createReportView();}else{this.createPrintDirect();}break;case 2:if(!this.isPrintDirect){this.reportPageCheck(b.resValue);}else{this.reportPageCheckPrintDirect(b.resValue);}break;case 3:this.makePage(b.resValue);break;case 4:this.receiveFileDownCheck(b.resValue);break;case 5:this.receivePDFPrintCheck(b.resValue);break;case 6:this.receiveHTMLPrintCheck(b.resValue);break;case 7:this.receiveSaveCheck(b.resValue);break;case 8:this.receiveThumbnailCheck(b.resValue);break;case 9:this.receiveTOCCheck(b.resValue);break;case 10:this.makeDocumentPage(b.resValue);break;case 11:if(this.isScrollView){this.makeDocumentPageViewScrollType(b.resValue);}else{this.makeDocumentPageView(b.resValue);}break;case 12:this.printDOCHTML(b.resValue);break;case 13:this.makeDocumentThumbnail(b.resValue);break;case 14:this.makeDocumentPageOnly(b.resValue);break;case 15:this.checkPageSizeInfo(b.resValue);break;case 16:this.editableDocChange(b.resValue);break;default:break;}}}catch(a){this.debugMeg("리포트 서버 응답 오류 >>> 서버 응답 데이터 없거나  데이터가 잘못되었습니다.");this.debugMeg("리포트 서버 응답 >>> "+c);}};ReportView.prototype.makeDocumentPage=function(d){if(d.status){if(d.event==404){this.debugMeg("리포트 서버 세션에서 리포트를 찾을 수 없습니다.");this.debugMeg("리포트가 삭제되었거나 이중화 서버일 가능성이 있습니다.");}else{if(d.event==200){this.debugMeg("makeDocumentPage ....");var f=Base64.decode(d.viewData);if(f!=null){f=f.replace(/\+/gi," ");this.viewData=JSON.parse(f);var b=new documentReader();this.objClipDocument=b.documentReaderFromJSON(this.viewData,this.strServerPath,this.objReportInfo.strReportKey);if(this.objClipDocument.documentMemo.length!=0){this.objSpeechBubbleFrame.arrSpeechBubbleArray=this.objClipDocument.documentMemo;}else{this.objSpeechBubbleFrame.createSpeechBubbleArray(this.objPageInfo.nPageCount);}var a=this;this.objPageInfo.strReportName=this.objClipDocument.title;this.writeInCurrentPageInfo();this.paintDocumentPage();if(!this.objSideMenuInfo.isThumbnailUse){}else{if(!this.objSideMenuInfo.isThumbnailCheck){this.objSideMenuInfo.isThumbnail=d.thumbnail;this.objSideMenuInfo.isThumbnailCheck=true;}}if(!this.isReportStart){if(this.isProgressToPageMove){this.removeProgress();}}else{this.removeProgress();this.objHeader.setDisableButtonsExceptMove(true);}if(!this.objSideMenuInfo.isThumbnailUse){}else{if(this.isReportMakingFinish&&this.objSideMenuInfo.isThumbnail&&!this.objSideMenuInfo.isThumbnailCustom){this.createThumbnailFrame(this.objPageInfo.nPageCount);this.isReportMakingFinish=false;}}if(this.isPageInfoGetAlready){this.setPrintFrame();this.isPageInfoGetAlready=false;}}}else{if(d.event==18){var c=this;window.setTimeout(function(){c.sendCreatePageInfo(c.objPageInfo.nSelectPageIndex);},300);return;}}}}else{this.debugMeg("makeDocumentPage call back 실패....");}};ReportView.prototype.paintDocumentPage=function(){this.isPageChanged=true;if(this.objOption.nViewType==1){this.paintSVG();}else{this.objPageInfo.nExportType=4;}this.resizeBody(this.objPageInfo.strZoomRatio);};ReportView.prototype.editableDocChange=function(i){if(i.status){if(i.event==404){this.debugMeg("리포트 서버 세션에서 리포트를 찾을 수 없습니다.");this.debugMeg("리포트가 삭제되었거나 이중화 서버일 가능성이 있습니다.");}else{if(i.event==200){this.debugMeg("editableDocChange ....");var d=Base64.decode(i.viewData);if(d!=null){d=d.replace(/\+/gi," ");var b=JSON.parse(d);var h=b.pageNumber;var j=this.editableControlMap[h+"_"+b.controlIndex];if(typeof(b.data[0])=="boolean"){j.checkValue=b.data[0];}else{var a=new docTextInfo();var f=new documentReader();f.textInfoReaderFromJSON(a,b.data);j.setTextInfo(a);}var c=this.objDocPageController.getPage(h);var g=this.objDocPageController.getStyle(h);if(this.isScrollView&&this.objOption.nViewType!=0){this.paintDocumentPageViewScrollType(h,c,g);}else{this.paintDocumentPage();}}}else{if(i.event==18){}}}}else{this.debugMeg("editableDocChange call back 실패....");}};ReportView.prototype.makeDocumentPageView=function(l){if(l.status){if(l.event==404){this.debugMeg("리포트 서버 세션에서 리포트를 찾을 수 없습니다.");this.debugMeg("리포트가 삭제되었거나 이중화 서버일 가능성이 있습니다.");}else{if(l.event==200){this.debugMeg("makeDocumentPageView ....");var b=Base64.decode(l.viewData);if(b!=null){b=b.replace(/\+/gi," ");this.viewData=JSON.parse(b);var f=new documentReader();var k=null;if(this.viewData.document!=null){this.objClipDocument=f.documentReaderFromJSON(this.viewData.document,this.strServerPath,this.objReportInfo.strReportKey);k=this.objClipDocument.styleManager;if(this.objClipDocument.documentMemo.length!=0){this.objSpeechBubbleFrame.arrSpeechBubbleArray=this.objClipDocument.documentMemo;}else{this.objSpeechBubbleFrame.createSpeechBubbleArray(this.objPageInfo.nPageCount);}}else{k=f.styleManagerReaderFromJSON(this.viewData.style);}var a=this.viewData.pageNumList.length;for(var c=0;c<a;c++){if(!this.objDocPageController.getIsPage(this.viewData.pageNumList[c])){var h=f.readDocumentPage(this.viewData.pageList[c]);this.objDocPageController.addPage(this.viewData.pageNumList[c],h,k);}else{this.objDocPageController.deletePage(this.viewData.pageNumList[c]);var h=f.readDocumentPage(this.viewData.pageList[c]);this.objDocPageController.addPage(this.viewData.pageNumList[c],h,k);}}if(this.objClipDocument.documentPageList.length>0){this.objClipDocument.documentPageList.pop();}this.objClipDocument.documentPageList.push(this.objDocPageController.getPage(this.objPageInfo.nSelectPageIndex));this.objClipDocument.styleManager=k;var g=this;this.objPageInfo.strReportName=this.objClipDocument.title;this.isPageChanged=true;var d=this.objClipDocument.documentPageList[0];this.objPageInfo.nPageWidth=k.pageList[0].width*0.378;this.objPageInfo.nPageHeight=k.pageList[0].height*0.378;this.objBody.nDefaultHeight=this.objPageInfo.nPageHeight;this.objBody.nDefaultWidth=this.objPageInfo.nPageWidth;if(this.objOption.nViewType==1){this.paintSVG();}else{this.objPageInfo.nExportType=4;}this.writeInCurrentPageInfo();this.resizeBody(this.objPageInfo.strZoomRatio);if(!this.isReportStart){if(this.isProgressToPageMove){this.removeProgress();}}else{this.removeProgress();this.objHeader.setDisableButtonsExceptMove(true);}if(!this.objSideMenuInfo.isThumbnailUse){}else{if(this.isReportMakingFinish&&!this.objSideMenuInfo.isThumbnailCustom){this.createThumbnailFrame(this.objPageInfo.nPageCount);this.isReportMakingFinish=false;}}if(this.isPageInfoGetAlready){this.setPrintFrame();this.isPageInfoGetAlready=false;}if(this.fnEndPageViewFunction!=null){this.fnEndPageViewFunction();}}}else{if(l.event==18){var j=this;window.setTimeout(function(){j.sendCreatePageInfo(j.objPageInfo.nSelectPageIndex);},300);return;}}}}else{this.debugMeg("makeDocumentPage call back 실패....");}};ReportView.prototype.makeDocumentPageViewScrollType=function(n){if(n.status){if(n.event==404){this.debugMeg("리포트 서버 세션에서 리포트를 찾을 수 없습니다.");this.debugMeg("리포트가 삭제되었거나 이중화 서버일 가능성이 있습니다.");}else{if(n.event==200){this.debugMeg("makeDocumentPageView ....");var b=Base64.decode(n.viewData);if(b!=null){b=b.replace(/\+/gi," ");this.viewData=JSON.parse(b);var f=new documentReader();var l=null;if(this.viewData.document!=null){this.objClipDocument=f.documentReaderFromJSON(this.viewData.document,this.strServerPath,this.objReportInfo.strReportKey);l=this.objClipDocument.styleManager;if(this.objClipDocument.documentMemo.length!=0){this.objSpeechBubbleFrame.arrSpeechBubbleArray=this.objClipDocument.documentMemo;}else{this.objSpeechBubbleFrame.createSpeechBubbleArray(this.objPageInfo.nPageCount);}}else{l=f.styleManagerReaderFromJSON(this.viewData.style);}this.objPageInfo.strReportName=this.objClipDocument.title;var a=this.viewData.pageNumList.length;for(var c=0;c<a;c++){if(!this.objDocPageController.getIsPage(this.viewData.pageNumList[c])){var m=this.viewData.pageNumList[c];this.arrDocPageCheckList[m]=true;var h=f.readDocumentPage(this.viewData.pageList[c]);var k=this.objDocPageController.addPage(this.viewData.pageNumList[c],h,l);if(k!=null){this.arrDocPageCheckList[k]=false;if(this.arrDocPageDivList[k].firstChild!=null){var d=this.arrDocPageDivList[k].childNodes.length;for(var g=0;g<d;g++){this.arrDocPageDivList[k].removeChild(this.arrDocPageDivList[k].firstChild);}}}this.paintDocumentPageViewScrollType(m,h,l);}else{var m=this.viewData.pageNumList[c];this.arrDocPageCheckList[m]=true;this.objDocPageController.deletePage(this.viewData.pageNumList[c]);var h=f.readDocumentPage(this.viewData.pageList[c]);var k=this.objDocPageController.addPage(this.viewData.pageNumList[c],h,l);if(k!=null){this.arrDocPageCheckList[k]=false;if(this.arrDocPageDivList[k].firstChild!=null){var d=this.arrDocPageDivList[k].childNodes.length;for(var g=0;g<d;g++){this.arrDocPageDivList[k].removeChild(this.arrDocPageDivList[k].firstChild);}}}this.paintDocumentPageViewScrollType(m,h,l);}}if(!this.isReportStart){if(this.isProgressToPageMove){this.removeProgress();}}else{this.removeProgress();this.objHeader.setDisableButtonsExceptMove(true);}if(!this.objSideMenuInfo.isThumbnailUse){}else{if(this.isReportMakingFinish&&!this.objSideMenuInfo.isThumbnailCustom){this.createThumbnailFrame(this.objPageInfo.nPageCount);this.isReportMakingFinish=false;}}if(this.isPageInfoGetAlready){this.setPrintFrame();this.isPageInfoGetAlready=false;}}}else{if(n.event==18){var j=this;window.setTimeout(function(){j.sendCreatePageInfo(j.objPageInfo.nSelectPageIndex);},300);return;}}}}else{this.debugMeg("makeDocumentPage call back 실패....");}};ReportView.prototype.paintDocumentPageViewScrollType=function(n,k,m){var j=this;if(this.objClipDocument.documentPageList.length>0){this.objClipDocument.documentPageList.pop();}this.objClipDocument.documentPageList.push(k);this.objClipDocument.styleManager=m;var d=document.createElement("div");d.style.cssText="position:absolute;left:0px;top:0px;width:100%;overflow:visible";var g=this.objClipDocument.documentPageList[0];var b=this.objClipDocument.getPageInStyle(g);this.objBody.nDefaultWidth=b.width*0.378;this.objBody.nDefaultHeight=b.height*0.378;this.objPageInfo.nPageWidth=b.width*0.378;this.objPageInfo.nPageHeight=b.height*0.378;var i=this.objPageInfo.strZoomRatio;var o=null;if(i=="pageHeight"){o=this.objBody.elmBody.offsetHeight/this.objBody.nDefaultHeight;}else{if(i=="pageWidth"){o=this.objBody.elmBody.offsetWidth/this.objBody.nDefaultWidth;}else{o=parseFloat(i);}}this.arrDocPageDivList[n].style.height=b.height*o*0.378+"px";if(this.arrDocPageDivList[n].children.length!=0){var f=this.arrDocPageDivList[n].children.length;for(var h=0;h<f;h++){this.arrDocPageDivList[n].removeChild(this.arrDocPageDivList[n].firstChild);}}this.arrDocPageDivList[n].appendChild(d);if(this.objOption.nViewType==1){this.objPageInfo.nExportType=0;var p=new mCR_exportSVG(this.objClipDocument,false);p.setAccessibility(this.isClientPaintViewAccessibility);var c=p.exportPage(0,null,d);this.arrWebLinkList=p.callGetWebLinkList();d.appendChild(c);if(o!=1){c.setAttribute("width",this.objBody.nDefaultWidth*o);c.setAttribute("height",this.objBody.nDefaultHeight*o);c.lastChild.setAttribute("transform","scale("+o+") translate(0,0)");}this.makePackage(o,this.arrDocPageDivList[n],n);}else{if(this.objOption.nViewType==2){this.objPageInfo.nExportType=4;var a=null;if(mCR_isSmartphone){a=new mCR_exportCanvas(this.objClipDocument,o*2,function(){j.arrWebLinkList=a.callGetWebLinkList();j.objPageInfo.nPageWidth=g.getWidth()*0.378;j.objPageInfo.nPageHeight=g.getHeight()*0.378;j.makePackage(o,j.arrDocPageDivList[n],n);});}else{a=new mCR_exportCanvas(this.objClipDocument,o,function(){j.arrWebLinkList=a.callGetWebLinkList();j.objPageInfo.nPageWidth=g.getWidth()*0.378;j.objPageInfo.nPageHeight=g.getHeight()*0.378;j.makePackage(o,j.arrDocPageDivList[n],n);});}a.setAccessibility(this.isClientPaintViewAccessibility);var l=a.exportPage(0,d);d.appendChild(l);if(mCR_isSmartphone){this.arrDocPageDivList[n].firstChild.firstChild.style.zoom=0.5;}}else{this.debugMeg("잘못된 nViewType입니다.....");}}};ReportView.prototype.makeDocumentThumbnail=function(p){if(p.status){if(p.event==404){this.debugMeg("리포트 서버 세션에서 리포트를 찾을 수 없습니다.");this.debugMeg("리포트가 삭제되었거나 이중화 서버일 가능성이 있습니다.");}else{if(p.event==200){this.debugMeg("makeDocumentThumbnail ....");var j=Base64.decode(p.viewData);if(j!=null){j=j.replace(/\+/gi," ");var d=JSON.parse(j);var l=new documentReader();var g=l.documentReaderFromJSON(d.document,this.strServerPath,this.objReportInfo.strReportKey);var f=d.pageNumList.length;for(var k=0;k<f;k++){var m=l.readDocumentPage(d.pageList[k]);g.documentPageList.push(m);this.debugMeg("makeDocumentThumbnail Page ...."+d.pageNumList[k]);var c=this.objClipDocument.getPageInStyle(m);var h=c.width*0.378;var b=c.height*0.378;var o=null;if(h>b){o=(this.objThumbnailFrame.elmThumbnailImageList[d.pageNumList[k]].clientWidth)/h;}else{o=(this.objThumbnailFrame.elmThumbnailImageList[d.pageNumList[k]].clientHeight-4)/b;}var a=new mCR_exportCanvas(g,o);var n=a.exportPage(0,this.objThumbnailFrame.elmThumbnailImageList[d.pageNumList[k]]);this.objThumbnailFrame.elmThumbnailImageList[d.pageNumList[k]].appendChild(n);}}}else{if(p.event==18){}}}}else{this.debugMeg("makeDocumentPage call back 실패....");}};ReportView.prototype.makeDocumentPageHavedPage=function(){if(this.objClipDocument.documentPageList.length>0){this.objClipDocument.documentPageList.pop();}this.objClipDocument.documentPageList.push(this.objDocPageController.getPage(this.objPageInfo.nSelectPageIndex));this.objClipDocument.styleManager=this.objDocPageController.getStyle(this.objPageInfo.nSelectPageIndex);var a=this;this.objPageInfo.strReportName=this.objClipDocument.title;this.isPageChanged=true;if(this.objOption.nViewType==1){this.paintSVG();}else{this.objPageInfo.nExportType=4;}this.writeInCurrentPageInfo();this.resizeBody(this.objPageInfo.strZoomRatio);if(!this.isReportStart){if(this.isProgressToPageMove){this.removeProgress();}}else{this.removeProgress();this.objHeader.setDisableButtonsExceptMove(true);}};ReportView.prototype.checkPageSizeInfo=function(a){if(a.status){if(a.event==200){this.debugMeg("checkPageSizeInfo ....");var d=a.viewData;var c=d.length;if(c!=0){for(var b=0;b<c;b++){this.arrDocPageSizeInfoList.push(d[b]);}}if(this.objReportInfo.isEndReport){if(this.objSideMenuInfo.isThumbnailUse){this.setThumbnailPageSizeAll();}if(this.isScrollView){this.setPageSizeAll();this.objBody.showInScreen();}}}}else{this.debugMeg("checkPageSizeInfo call back 실패....");}};ReportView.prototype.setThumbnailPageSizeAll=function(){var b=this.objPageInfo.nPageCount;for(var a=0;a<b;a++){if(this.arrDocPageSizeInfoList[a][0]>this.arrDocPageSizeInfoList[a][1]){this.objThumbnailFrame.elmThumbnailImageList[a].style.height=this.objThumbnailFrame.elmThumbnailImageList[a].style.width.replace("px","")*this.arrDocPageSizeInfoList[a][1]/this.arrDocPageSizeInfoList[a][0]+"px";}}this.debugMeg("setPageSizeAll 완료....");};ReportView.prototype.setPageSizeAll=function(){var d=this.objPageInfo.strZoomRatio;var c=null;if(d=="pageHeight"){c=this.objBody.elmBody.offsetHeight/this.objBody.nDefaultHeight;}else{if(d=="pageWidth"){c=this.objBody.elmBody.offsetWidth/this.objBody.nDefaultWidth;}else{c=parseFloat(d);}}var b=this.objPageInfo.nPageCount;for(var a=0;a<b;a++){if(!this.arrDocPageCheckList[a]){this.arrDocPageDivList[a].style.height=this.arrDocPageSizeInfoList[a][1]*c*0.378+"px";}}this.debugMeg("setPageSizeAll 완료....");};ReportView.prototype.setPageSizeCheckFalse=function(){var d=this.objPageInfo.nPageCount;for(var c=0;c<d;c++){if(this.arrDocPageDivList[c].firstChild!=null){var a=this.arrDocPageDivList[c].childNodes.length;for(var b=0;b<a;b++){this.arrDocPageDivList[c].removeChild(this.arrDocPageDivList[c].firstChild);}}this.arrDocPageCheckList[c]=false;}this.debugMeg("setPageSizeCheckFalse 완료....");};ReportView.prototype.makeDocumentPageOnly=function(m){if(m.status){if(m.event==404){this.debugMeg("리포트 서버 세션에서 리포트를 찾을 수 없습니다.");this.debugMeg("리포트가 삭제되었거나 이중화 서버일 가능성이 있습니다.");}else{if(m.event==200){this.debugMeg("makeDocumentPageOnly ....");var d=Base64.decode(m.viewData);var c=null;if(d!=null){d=d.replace(/\+/gi," ");var a=JSON.parse(d);var g=new documentReader();c=g.documentReaderFromJSON(a.document,this.strServerPath,this.objReportInfo.strReportKey);var k=c.styleManager;var b=a.pageNumList.length;for(var f=0;f<b;f++){var l=a.pageNumList[f];var h=g.readDocumentPage(a.pageList[f]);this.objDocPageControllerDummy.addPageDummy(a.pageNumList[f],h,k);if(this.objPageInfo.nSelectPageIndex==l){c.documentPageList.push(h);}}}this.objDocPageController=null;this.objDocPageController=this.objDocPageControllerDummy;this.objDocPageControllerDummy=null;this.objClipDocument=c;this.isDummyFinished=true;this.objHeader.createMoveSearchPageButton();}else{if(m.event==18){var j=this;window.setTimeout(function(){j.sendCreatePageOnly();},300);return;}}}}else{this.debugMeg("makeDocumentPageOnly call back 실패....");}};ReportView.prototype.paintSVG=function(){var a=this;this.objBody.elmBody.innerHTML="";var f=document.createElement("div");f.style.cssText="position:absolute;left:0px;top:0px;width:100%;overflow:visible";this.objPageInfo.nExportType=0;var d=new mCR_exportSVG(this.objClipDocument,false);d.setAccessibility(this.isClientPaintViewAccessibility);var b=d.exportPage(0,null,f);this.arrWebLinkList=d.callGetWebLinkList();this.objBody.elmBody.appendChild(f);f.appendChild(b);var c=this.objClipDocument.documentPageList[0];this.objPageInfo.nPageWidth=c.getWidth()*0.378;this.objPageInfo.nPageHeight=c.getHeight()*0.378;this.objBody.nDefaultHeight=this.objPageInfo.nPageHeight;this.objBody.nDefaultWidth=this.objPageInfo.nPageWidth;this.isPageChanged=false;this.makePackage(parseFloat(this.objPageInfo.strZoomRatio),this.objBody.elmBody,a.objPageInfo.nSelectPageIndex);};ReportView.prototype.paintCanvas=function(g){var h=this;var l=document.createElement("div");l.style.cssText="position:absolute;left:0px;top:0px;width:100%;overflow:visible";var f=this.objClipDocument.documentPageList[0];var a=this.objClipDocument.getPageInStyle(f);this.objBody.nDefaultWidth=a.width*0.378;this.objBody.nDefaultHeight=a.height*0.378;var j=null;if(g=="pageHeight"){j=this.objBody.elmBody.offsetHeight/this.objBody.nDefaultHeight;}else{if(g=="pageWidth"){j=this.objBody.elmBody.offsetWidth/this.objBody.nDefaultWidth;}else{j=parseFloat(g);}}if(this.isPageChanged){this.isPageChanged=false;this.objBody.elmBody.innerHTML="";this.objBody.elmBody.appendChild(l);var b=null;if(mCR_isSmartphone){b=new mCR_exportCanvas(h.objClipDocument,j*2,function(){h.arrWebLinkList=b.callGetWebLinkList();h.objPageInfo.nPageWidth=f.getWidth()*0.378;h.objPageInfo.nPageHeight=f.getHeight()*0.378;h.makePackage(j,h.objBody.elmBody,h.objPageInfo.nSelectPageIndex);});}else{b=new mCR_exportCanvas(h.objClipDocument,j,function(){h.arrWebLinkList=b.callGetWebLinkList();h.objPageInfo.nPageWidth=f.getWidth()*0.378;h.objPageInfo.nPageHeight=f.getHeight()*0.378;h.makePackage(j,h.objBody.elmBody,h.objPageInfo.nSelectPageIndex);});}b.setAccessibility(this.isClientPaintViewAccessibility);var i=b.exportPage(0,l);l.appendChild(i);if(mCR_isSmartphone){this.objBody.elmBody.firstChild.firstChild.style.zoom=0.5;}}else{this.objBody.elmBody.removeChild(this.objBody.elmBody.firstChild);this.objBody.elmBody.appendChild(l);var b=null;if(mCR_isSmartphone){b=new mCR_exportCanvas(h.objClipDocument,j*2);}else{b=new mCR_exportCanvas(h.objClipDocument,j);}var i=b.exportPage(0,l);l.appendChild(i);if(mCR_isIphone||mCR_isFirefox){this.objBody.elmBody.firstChild.style.transform="scale("+j+")";this.objBody.elmBody.firstChild.style.transformOrigin="0 0 0";this.objBody.elmBody.firstChild.style.position="absolute";this.objBody.elmBody.firstChild.style.top="0px;";if(mCR_isFirefox){var c=this.objBody.elmBody.clientWidth;var k=this.objBody.elmBody.firstChild.clientWidth*j;var d=0;if(c-k>0){d=(c-k)/2;}this.objBody.elmBody.firstChild.style.left=d+"px";}else{this.objBody.elmBody.firstChild.style.left="0px";}}else{this.objBody.elmBody.firstChild.style.zoom=j;}this.objBody.elmBody.insertBefore(l,this.objBody.elmBody.firstChild);if(mCR_isSmartphone){this.objBody.elmBody.firstChild.firstChild.style.zoom=0.5;}}};ReportView.prototype.sendCreatePageInfo=function(a){this.debugMeg((a+1)+"페이지를 서버에 요청합니다.....");var c="";var b="";if(this.objOption.nViewType==0){c={reportkey:this.objReportInfo.strReportKey,pageNum:a,html5:mCR_isSVG,accessibility:this.objOption.isAccessibility,RSname:encodeURIComponent(Base64.encode(this.strServerPath))};b="ClipType=makePage&ClipData="+JSON.stringify(c);}else{var d=false;if(this.objClipDocument==null){d=true;}if(this.nEndReportDocument==1){d=true;this.nEndReportDocument=2;}else{if(this.nEndReportDocument==0){d=true;}}if(this.objDocPageController.getIsPage(a)&&(!d||this.isDummyFinished)){this.makeDocumentPageHavedPage();return;}else{b='ClipType=DocumentPageView&ClipData={"reportkey":"'+this.objReportInfo.strReportKey+'","pageMethod":'+a+',"isMakeDocument":'+d+"}";}}this.debugMeg("전송할 데이터 >>>>>"+b);this.sendData(b);};ReportView.prototype.sendCreatePageOnly=function(){this.debugMeg("전체페이지를 호출합니다.....");var b="";var a="";if(this.objOption.nViewType==0){}else{this.debugMeg("전체페이지를 호출합니다.....");a='ClipType=DocumentPageOnly&ClipData={"reportkey":"'+this.objReportInfo.strReportKey+'","pageMethod":"TotalPage","isMakeDocument":true}';}this.debugMeg("전송할 데이터 >>>>>"+a);this.sendData(a);};ReportView.prototype.sendCreatePageScrollType=function(a){this.debugMeg((a+1)+"페이지를 서버에 요청합니다.....");var c="";var b="";if(this.arrDocPageCheckList[a]){this.debugMeg((a+1)+"이미 페이지가 존재합니다.....");}else{if(this.objDocPageController.getIsPage(a)){this.debugMeg((a+1)+"이미 페이지가 존재합니다.....");this.paintDocumentPageViewScrollType(a,this.objDocPageController.getPage(a),this.objDocPageController.getStyle(a));this.arrDocPageCheckList[a]=true;}else{var d=false;if(this.objClipDocument==null){d=true;}b='ClipType=DocumentPageView&ClipData={"reportkey":"'+this.objReportInfo.strReportKey+'","pageMethod":'+a+',"isMakeDocument":'+d+"}";this.debugMeg("전송할 데이터 >>>>>"+b);this.arrDocPageCheckList[a]=true;this.sendData(b);}}};ReportView.prototype.manageDocPage=function(){this.objDocPageController;};ReportView.prototype.changeTunmbnailStyle=function(){if(this.objSideMenuInfo.isThumbnailUse&&!this.objSideMenuInfo.isThumbnailCustom){if(this.isDocView){this.objThumbnailFrame.changeTunmbnailStyle(this.objPageInfo.nSelectPageIndex);}else{if(this.objSideMenuInfo.isThumbnail){this.objThumbnailFrame.changeTunmbnailStyle(this.objPageInfo.nSelectPageIndex);}}}};ReportView.prototype.nextPage=function(){this.debugMeg("리포트의 마지막인지 체크....");if(this.objPageInfo.nPageCount-1>this.objPageInfo.nSelectPageIndex){if(this.isDocView&&this.isScrollView){this.objBody.elmBody.scrollTop=this.arrDocPageDivList[++this.objPageInfo.nSelectPageIndex].offsetTop;}else{if(this.isProgressToPageMove){this.createProgress();}this.sendCreatePageInfo(++this.objPageInfo.nSelectPageIndex);}this.changeTunmbnailStyle();}};ReportView.prototype.lastPage=function(){this.debugMeg("리포트의 마지막인지 체크....");if(this.objPageInfo.nPageCount-1>this.objPageInfo.nSelectPageIndex){if(this.isDocView&&this.isScrollView){this.objPageInfo.nSelectPageIndex=this.objPageInfo.nPageCount-1;this.objBody.elmBody.scrollTop=this.arrDocPageDivList[this.objPageInfo.nSelectPageIndex].offsetTop;}else{if(this.isProgressToPageMove){this.createProgress();}this.objPageInfo.nSelectPageIndex=this.objPageInfo.nPageCount-1;this.sendCreatePageInfo(this.objPageInfo.nSelectPageIndex);}this.changeTunmbnailStyle();}};ReportView.prototype.prevPage=function(){this.debugMeg("리포트의 처음인지 체크....");if(0<this.objPageInfo.nSelectPageIndex){if(this.isDocView&&this.isScrollView){this.objBody.elmBody.scrollTop=this.arrDocPageDivList[--this.objPageInfo.nSelectPageIndex].offsetTop;}else{if(this.isProgressToPageMove){this.createProgress();}this.sendCreatePageInfo(--this.objPageInfo.nSelectPageIndex);}this.changeTunmbnailStyle();}};ReportView.prototype.firstPage=function(){this.debugMeg("리포트의 처음인지 체크....");if(0<this.objPageInfo.nSelectPageIndex){if(this.isDocView&&this.isScrollView){this.objPageInfo.nSelectPageIndex=0;this.objBody.elmBody.scrollTop=this.arrDocPageDivList[this.objPageInfo.nSelectPageIndex].offsetTop;}else{if(this.isProgressToPageMove){this.createProgress();}this.objPageInfo.nSelectPageIndex=0;this.sendCreatePageInfo(this.objPageInfo.nSelectPageIndex);}this.changeTunmbnailStyle();}};ReportView.prototype.selectPage=function(a){this.debugMeg("이동 가능한 페이지인지 체크....");if(0<a&&this.objPageInfo.nPageCount+1>a&&!isNaN(parseInt(a))){if(this.objPageInfo.nSelectPageIndex==parseInt(a)-1){this.writeInCurrentPageInfo();this.debugMeg("같은 페이지 입니다.");}else{if(this.isDocView&&this.isScrollView){this.objPageInfo.nSelectPageIndex=parseInt(a)-1;this.objBody.elmBody.scrollTop=this.arrDocPageDivList[this.objPageInfo.nSelectPageIndex].offsetTop;}else{if(this.isProgressToPageMove){this.createProgress();}this.objPageInfo.nSelectPageIndex=parseInt(a)-1;this.sendCreatePageInfo(this.objPageInfo.nSelectPageIndex);}this.changeTunmbnailStyle();}}else{this.writeInCurrentPageInfo();this.debugMeg("페이지 이동 정보 오류....");}};ReportView.prototype.createBlind=function(){var a=this;var b=document.createElement("div");b.className="header_blind";b.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;z-index:40;opacity: 0.1;filter:alpha(opacity=50);background-color:white;";a.objHeader.setDisableButtons(true);if(mCR_isSmartphone){b.ontouchend=function(c){a.closeOptions();};}else{b.onclick=function(c){a.closeOptions();};}this.objTargetDOM.appendChild(b);this.elmHeaderBlind=b;};ReportView.prototype.closeOptions=function(){this.objHeader.setDisableButtons(false);if(this.nOpendMenuType!=null){switch(this.nOpendMenuType){case 1:this.closePrintMainOptionFrame();break;case 2:this.closeDownloadMainOptionFrame();break;case 3:this.closeThumbnailFrame();break;case 4:this.closeTOCFrame();break;case 5:this.closeReportInfo();break;case 6:this.closeSearchWordFrame();break;case 7:this.closeErrorAlertUI();break;}}};ReportView.prototype.resizeOptions=function(a){if(this.nOpendMenuType!=null){switch(this.nOpendMenuType){case 1:this.resizePrintOptionFrame(a);break;case 2:this.resizeDownloadOptionFrame(a);break;}}};ReportView.prototype.resizePrintOptionFrame=function(a){if(this.isPrintMainOptionFrame!=null){this.objPrintMainOptionFrame.resizeDiv(a);}if(this.isPrintSubOptionFrame!=null){this.objPrintSubOptionFrame.resizeDiv(a);}};ReportView.prototype.resizeDownloadOptionFrame=function(a){if(this.isDownloadMainOptionFrame!=null){this.objDownloadMainOptionFrame.resizeDiv(a);}if(this.isDownloadSubOptionFrame!=null){this.objDownloadSubOptionFrame.resizeDiv(a);}};ReportView.prototype.removeBlind=function(){if(this.elmHeaderBlind!=null){this.objTargetDOM.removeChild(this.elmHeaderBlind);this.elmHeaderBlind=null;}};ReportView.prototype.createProgress=function(){var c=document.createElement("div");c.className="report_progress";c.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;background-repeat:no-repeat;z-index:500;-webkit-touch-callout: none; -webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;";var a=document.createElement("div");a.style.cssText="position:absolute;left:50%;top:49%;transform: translateX(-50%);opacity:1;";c.appendChild(a);var d=document.createElement("label");d.style.cssText="color: #000000;font-size:18px;opacity:1;font-family: '맑은 고딕', 'Malgun Gothic';font-weight: bold;";a.appendChild(d);this.elmProgressNumberLabel=d;if(this.nWaitTime>1){var b=document.createElement("div");b.className="report_progress_msg";b.innerHTML=this.objLanguageMap.waitMsg;c.appendChild(b);}this.objTargetDOM.appendChild(c);this.elmProgess=c;};ReportView.prototype.removeProgress=function(){if(this.elmProgess!=null){this.objTargetDOM.removeChild(this.elmProgess);this.elmProgess=null;this.elmProgressNumberLabel=null;}};ReportView.prototype.sendOOFData=function(){if(null!=this.strOOF){this.debugMeg("리포트의 OOF >>> "+this.strOOF);var a='ClipType=newReport&ClipData={"oof":"'+Base64.encode(this.strOOF)+'"}';a=mCR_onBeforeSend(a);if(null!=a){this.sendData(a);}}else{this.debugMeg("리포트의 OOF 문서가 없습니다.");}};ReportView.prototype.sendUserJspData=function(){var c=this.strUserJspPath;var b=this.strPostData;var a=this;$.ajax({type:"POST",url:c,data:b,success:function(d){try{a.objReport=mCR_objectCall(mCR_StrTrim(d));a.createReportInfo();a.createReportView();}catch(f){mCR_ReportEventHandler(9);a.objBody.setReportErrorPage();a.objHeader.setDisableButtons(true);a.objReport=null;}},error:function(d){objReport.debugMeg(d);}});};ReportView.prototype.sendPageCheck=function(){this.debugMeg("서버에 리포트가 얼만큼 생성중인지 체크....");var b="t"+new Date().getMilliseconds();var a='ClipType=pageCheck&ClipData={"reportkey":"'+this.objReportInfo.strReportKey+'","s_time":"'+b+'"}';this.debugMeg("전송할 데이터 >>>>>"+a);this.sendData(a);};ReportView.prototype.sendDocumentPage=function(){this.debugMeg("리포트의 화면 페이지 정보 Doc json 데이터....");var a='ClipType=makeDocumentPage&ClipData={"reportkey":"'+this.objReportInfo.strReportKey+'","pageMethod":0,"compress":false}';this.debugMeg("전송할 데이터 >>>>>"+a);this.sendData(a);};ReportView.prototype.receiveThumbnailCheck=function(a){this.debugMeg("썸네일 이미지를 내려받는 중 입니다.");if(a.status){if(!this.objSideMenuInfo.isThumbnailCustom){this.objThumbnailFrame.elmThumbnailImageList[a.pageNum].firstChild.src="data:image/png;base64,"+a.viewData;this.arrThumbnailImageList[a.pageNum]="data:image/png;base64,"+a.viewData;}else{this.arrThumbnailImageList[a.pageNum]="data:image/png;base64,"+a.viewData;}}else{this.debugMeg((a.pageNum+1)+"번째 썸네일 이미지를 내려받는 중 오류가 발생하였습니다.");if(a.event==404){this.debugMeg("서버에 썸네일 이미지가 없습니다.");}else{if(a.event==500){this.debugMeg("썸네일 파일 로드중 오류 발생했습니다.");}}}};ReportView.prototype.receiveTOCCheck=function(a){this.debugMeg("TOC 정보를 내려받는 중 입니다.");if(a.status){this.arrTOCData=a.viewData;this.checkingTOCInfo();}else{if(a.event==404){this.debugMeg("TOC 정보가 없습니다.");}else{if(a.event==500){this.debugMeg("TOC정보 로드중 오류 발생했습니다.");}}}};ReportView.prototype.checkingTOCInfo=function(){this.debugMeg("TOC 정보를 확인하는 중입니다.");var a=this.arrTOCData.length;if(a<=0){this.objSideMenuInfo.isTOC=false;}else{this.objSideMenuInfo.isTOC=true;}if(this.objSideMenuInfo.isTOC){if(!this.objSideMenuInfo.isTOCCustom){this.objTOCFrame.createTOCFrame();this.objHeader.createTOCButton();this.makingTOCView();}}};ReportView.prototype.makingTOCView=function(){this.debugMeg("TOC 뷰를 만드는 중 입니다.");this.objTOCFrame.makingTOCView(this.arrTOCData);};ReportView.prototype.makePage=function(c){if(c.status){if(c.event==18){var a=this;window.setTimeout(function(){a.sendCreatePageInfo(a.objPageInfo.nSelectPageIndex);},300);return;}this.debugMeg("서버에서 정상적으로 화면을 출력하였습니다.");this.objPageInfo.nPageWidth=c.pageWidth;this.objPageInfo.nPageHeight=c.pageHeight;this.objPageInfo.strReportName=c.reportName;this.objPageInfo.nExportType=c.exportType;switch(c.exportType){case 0:this.objBody.insertHTML(Base64.decode(c.viewData),c.exportType);break;case 1:this.objBody.insertHTML(Base64.decode(c.viewData),c.exportType);break;case 2:var g=Base64.decode(c.viewData).split("{clipreport_separator}");var i=g[0];var h=document.getElementsByTagName("head")[0];var b=h.lastChild;if(b.tagName!="STYLE"||b.getAttribute("id")!="report_css"){var f=document.createElement("style");f.setAttribute("type","text/css");f.setAttribute("id","report_css");h.appendChild(f);b=f;}if(b.styleSheet){b.styleSheet.cssText=i;}else{var d=document.createTextNode(i);b.appendChild(d);}this.objBody.insertHTML(g[1],c.exportType);break;default:break;}if(!this.objSideMenuInfo.isThumbnailUse){}else{if(!this.objSideMenuInfo.isThumbnailCheck){this.objSideMenuInfo.isThumbnail=c.thumbnail;this.objSideMenuInfo.isThumbnailCheck=true;}}this.writeInCurrentPageInfo();this.resizeBody(this.objPageInfo.strZoomRatio);if(!this.isReportStart){if(this.isProgressToPageMove){this.removeProgress();}}else{this.removeProgress();this.objHeader.setDisableButtonsExceptMove(true);}if(!this.objSideMenuInfo.isThumbnailUse){}else{if(this.isReportMakingFinish&&this.objSideMenuInfo.isThumbnail&&!this.objSideMenuInfo.isThumbnailCustom){this.createThumbnailFrame(this.objPageInfo.nPageCount);this.isReportMakingFinish=false;}}if(this.fnEndPageViewFunction!=null){this.fnEndPageViewFunction();}}else{this.debugMeg("서버에서 화면을 출력하는 중 오류가 발생하였습니다.");if(this.isProgressToPageMove&&!this.isReportStart){this.removeProgress();this.objHeader.callStopPageProgress();}}};ReportView.prototype.resizeBody=function(a){if(a!=null){if(!this.isScrollView||this.objOption.nViewType==0){this.objBody.resize(a,this.objPageInfo.nExportType);this.objBody.elmBody.scrollTop=0;}else{this.setPageSizeCheckFalse();var b=this.objPageInfo.nSelectPageIndex;this.setPageSizeAll();this.objBody.elmBody.scrollTop=this.arrDocPageDivList[b].offsetTop;this.objBody.showInScreen();}}else{this.debugMeg("화면크기 변환하는 중 오류가 발생하였습니다.");}};ReportView.prototype.createDeleteImg=function(){if(null!=this.objTargetDOM){var a=document.createElement("img");a.style.display="none";this.objTargetDOM.appendChild(a);this.elmDeleteImg=a;}else{this.debugMeg("리포트 삭제 모듈 생성에 실패하였습니다.(리포트가 그려질 테그가 존재하지 않습니다)");}};ReportView.prototype.debugMeg=function(a){if(this.objOption.isDebug){window.console.log("report log :: "+a);}};function mCR_ReportEventHandler(a){if(null!=typeof window.ReportEventHandler!="undefined"){ReportEventHandler(a);}else{if(typeof window.console!="undefined"){window.console.log("Report Code : "+a);}}}ReportView.prototype.makePackage=function(o,j,f){var k=this;var f=f;var p=document.createElement("div");p.style.cssText="position: relative; background-color: transparent; display: inline-block;";p.style.width=this.objBody.nDefaultWidth+"px";p.style.height=this.objBody.nDefaultHeight+"px";if(mCR_isIphone||mCR_isFirefox){p.style.transform="scale("+o+")";p.style.transformOrigin="0 0 0";p.style.position="absolute";p.style.top="0px;";if(mCR_isFirefox){var s=j.clientWidth;var m=this.objBody.nDefaultWidth*o;var l=0;if(s-m>0){l=(s-m)/2;}p.style.left=l+"px";}else{p.style.left="0px";}}else{p.style.zoom=o;}var r=document.createElement("div");r.style.cssText="position: absolute; left:0px; right:0px; top:0px; bottom:0px;";p.appendChild(r);var g=this.arrWebLinkList;var n=g.length;for(var c=0;c<n;c++){var b=g[c];var w=null;var i=b.info.type;if(i==0){w=document.createElement("a");w.style.cssText="position:absolute;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;filter:alpha(opacity=0); opacity:0;background-color:white;cursor:pointer;";w.tabIndex=-1;var u=decodeURIComponent(b.info.linkUrl);if(u==null||u=="null"||u==undefined){u="";}w.name=u;var d=b.info.webLinkType;if(d==null||d=="null"||d==undefined){d="";}w.target=d;if(d=="self"||d=="blank"){w.onclick=function(){k.webLinkControl(this.name,this.target);};}else{if(d=="window"){var v=b.info.windowWidth;var q=b.info.windowHeight;w.rel=v;w.rev=q;w.onclick=function(){k.webLinkControl(this.name,this.target,this.rel,this.rev);};}else{var t=b.info.frameName;w.rel=t;w.onclick=function(){k.webLinkControl(this.name,this.target,this.rel);};}}w.style.zIndex="1";}else{if(i==1){this.editableControlMap[f+"_"+b.info.editableIndex]=b.info.objControl;w=document.createElement("TEXTAREA");w.className="mRe_focus";w.setAttribute("type","text");w.setAttribute("controlIndex",b.info.editableIndex);w.setAttribute("pageIndex",f);w.style.cssText="position:absolute;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;margin-top: 0 !important;margin-bottom: 0 !important;filter:alpha(opacity=0); opacity:0;resize: none;"+b.info.fontStyle;w.tabIndex=-1;w.value=b.info.editText;w.onchange=function(){k.editableDocControl(this);};w.onkeydown=function(){k.editableKeyEvent(this,event);};w.style.zIndex="1";}else{if(i==4){this.editableControlMap[f+"_"+b.info.editableIndex]=b.info.objControl;w=document.createElement("input");w.setAttribute("type","checkbox");w.setAttribute("controlIndex",b.info.editableIndex);w.setAttribute("pageIndex",f);w.style.cssText="position:absolute;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;filter:alpha(opacity=0); opacity:0;";w.tabIndex=-1;w.checked=b.info.isChecked;w.onclick=function(){k.editableDocControl(this);};w.style.zIndex="1";}else{if(i==2){w=document.createElement("a");w.style.cssText="position:absolute;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;filter:alpha(opacity=0); opacity:0;background-color:white;cursor:pointer;";w.tabIndex=-1;var u=b.info.linkUrl;if(u==null||u=="null"||u==undefined){u="";}w.name=u;w.onclick=function(){k.updataDrilingSubSection(this.name,f);};w.style.zIndex="1";}else{if(i==10){w=document.createElement("a");var h=b.info.ctrlName;w.innerHTML=h;w.tabIndex=-1;w.style.cssText="position:absolute;border:0.75pt solid gray !important; padding: 0px 0px 0px 0px !important;color:gray;font-size:9pt;text-align:left;";w.style.zIndex="1";}else{if(i==20){w=document.createElement("span");w.style.cssText="position:absolute;border:0 !important; padding: 0px 0px 0px 0px !important;color:gray;font-size:9pt;text-align:left;";w.tabIndex="0";w.setAttribute("role","text");var a=b.info.msg.replace(/\'/g,"작은따옴표");a=a.replace(/\"/g,"큰따옴표");a=a.replace(/\<\/?(b|B|i|I|u|U|s|S|c|C|o|O|r|R|p|P|d|D|br|BR|Font|size|SIZE|FONT)\>/g,"");w.setAttribute("aria-label",a);}else{if(i==400){continue;}}}}}}}w.style.width=b.rect.getWidth()/100+"cm";w.style.height=b.rect.getHeight()/100+"cm";w.style.top=b.rect.getTop()/100+"cm";w.style.left=b.rect.getLeft()/100+"cm";r.appendChild(w);}j.appendChild(p);this.createSpeechBubbleDiv(j);};ReportView.prototype.webLinkControl=function(){if(arguments.length>1){var h=arguments[0];var g=arguments[1];var c=document.createElement("form");document.body.appendChild(c);var k=null;var f=h.split("?");switch(f.length){case 2:k=f[1];var l=k.split("&");for(var d=0;d<l.length;d++){var j=l[d].split("=");var b=document.createElement("input");b.type="hidden";b.name=j[0];b.value=j[1];c.appendChild(b);}h=f[0];c.method="post";c.action=h;break;case 1:h=f[0];c.method="post";c.action=h;break;default:break;}if("self"==g){c.target="_self";}else{if("blank"==g){c.target="_blank";}else{if("window"==g){var a="report_SubWindow"+new Date().getMilliseconds();window.open("",a,"height="+arguments[3]+",width="+arguments[2]);c.target=a;}else{c.target=arguments[2];}}}c.submit();document.body.removeChild(c);}};ReportView.prototype.writeInPageInfo=function(){this.writeInCurrentPageInfo();this.writeInTotalPageInfo();};ReportView.prototype.writeInCurrentPageInfo=function(){this.objHeader.elmCurrentPageInput.value=this.objPageInfo.nSelectPageIndex+1;};ReportView.prototype.writeInTotalPageInfo=function(){if(this.isRemoveTotalCountSlash){this.objHeader.elmTotalPageInput.value=this.objPageInfo.nPageCount;}else{this.objHeader.elmTotalPageInput.value="/"+this.objPageInfo.nPageCount;}};ReportView.prototype.createPrintMainOptionFrame=function(){if(!(this.isPrintMainOptionFrame||this.isDownloadMainOptionFrame)){this.createBlind();this.objPrintMainOptionFrame=new mCR_ReportPrintMainOptionFrame(this);this.objPrintMainOptionFrame.createPrintMainOptionFrame();this.nOpendMenuType=1;this.isPrintMainOptionFrame=true;this.createPrintSubOptionFrame();}};ReportView.prototype.createPrintSubOptionFrame=function(){if(!(this.isPrintSubOptionFrame||this.isDownloadSubOptionFrame)){this.objPrintSubOptionFrame=new mCR_ReportPrintSubOptionFrame(this,this.strPrintSubOptionFrameDetailPdf,this.strPrintSubOptionFrameDetailHTML);this.objPrintSubOptionFrame.createPrintSubOptionFrame();if(!this.isUsePrintSubOptionFrame){this.objPrintSubOptionFrame.elmPrintSubOptionFrame.firstChild.style.display="none";}this.isPrintSubOptionFrame=true;}};ReportView.prototype.closePrintMainOptionFrame=function(){if(this.isPrintMainOptionFrame){this.objTargetDOM.removeChild(this.objPrintMainOptionFrame.elmPrintMainOptionFrame);this.objPrintMainOptionFrame=null;this.isPrintMainOptionFrame=false;this.closePrintSubOptionFrame();this.objHeader.setDisableButtons(false);this.nOpendMenuType=null;this.removeBlind();if(this.objHeader!=null){if(this.objHeader.elmPrintButton!=null){this.objHeader.elmPrintButton.elmButton.focus();}}}};ReportView.prototype.closePrintSubOptionFrame=function(){if(this.isPrintSubOptionFrame){this.objTargetDOM.removeChild(this.objPrintSubOptionFrame.elmPrintSubOptionFrame);this.objPrintSubOptionFrame=null;this.isPrintSubOptionFrame=false;}};ReportView.prototype.createDownloadMainOptionFrame=function(){if(!(this.isPrintMainOptionFrame||this.isDownloadMainOptionFrame)){this.createBlind();this.objDownloadMainOptionFrame=new mCR_ReportDownloadMainOptionFrame(this);this.objDownloadMainOptionFrame.createDownloadMainOptionFrame();this.nOpendMenuType=2;this.isDownloadMainOptionFrame=true;this.createDownloadSubOptionFrame();}};ReportView.prototype.callDirectPrint=function(){if(this.objDirectPrintInfo.printType==0){this.debugMeg("pdf direct 인쇄");if(this.objPrintRangeOption.type==0){this.runPDFPrint(1,this.objPageInfo.nPageCount,false);}else{if(this.objPrintRangeOption.type==2){if(this.objPrintRangeOption.pageFrom=="last"){this.objPrintRangeOption.pageFrom=this.objPageInfo.nPageCount;}if(this.objPrintRangeOption.pageTo=="last"){this.objPrintRangeOption.pageTo=this.objPageInfo.nPageCount;}this.runPDFPrint(this.objPrintRangeOption.pageFrom,this.objPrintRangeOption.pageTo,false);}}}else{if(this.objDirectPrintInfo.printType==1){this.debugMeg("html direct 인쇄");if(this.objPrintRangeOption.type==0){this.runHTML5Print(1,this.objPageInfo.nPageCount);}else{if(this.objPrintRangeOption.type==2){if(this.objPrintRangeOption.pageFrom=="last"){this.objPrintRangeOption.pageFrom=this.objPageInfo.nPageCount;}if(this.objPrintRangeOption.pageTo=="last"){this.objPrintRangeOption.pageTo=this.objPageInfo.nPageCount;}this.runHTML5Print(this.objPrintRangeOption.pageFrom,this.objPrintRangeOption.pageTo);}}}else{if(this.objDirectPrintInfo.printType==2){this.debugMeg("exe direct 인쇄");this.mCR_printEXEView();}else{this.debugMeg("callDirectPrint 타입 오류입니다.");}}}};ReportView.prototype.createDownloadSubOptionFrame=function(){if(!(this.isPrintSubOptionFrame||this.isDownloadSubOptionFrame)){this.objDownloadSubOptionFrame=new mCR_ReportDownloadSubOptionFrame(this);this.objDownloadSubOptionFrame.createDownloadSubOptionFrame();if(!this.isUseDownloadSubOptionFrame){this.objDownloadSubOptionFrame.elmDownloadSubOptionFrame.firstChild.style.display="none";}this.isDownloadSubOptionFrame=true;}};ReportView.prototype.closeDownloadMainOptionFrame=function(){if(this.isDownloadMainOptionFrame){this.objTargetDOM.removeChild(this.objDownloadMainOptionFrame.elmDownloadMainOptionFrame);this.objDownloadMainOptionFrame=null;this.isDownloadMainOptionFrame=false;this.closeDownloadSubOptionFrame();this.objHeader.setDisableButtons(false);this.nOpendMenuType=null;this.removeBlind();if(this.objHeader!=null){if(this.objHeader.elmSaveButton!=null){this.objHeader.elmSaveButton.elmButton.focus();}}}};ReportView.prototype.closeDownloadSubOptionFrame=function(){if(this.isDownloadSubOptionFrame){this.objTargetDOM.removeChild(this.objDownloadSubOptionFrame.elmDownloadSubOptionFrame);this.objDownloadSubOptionFrame=null;this.isDownloadSubOptionFrame=false;}};ReportView.prototype.togglePrintSubOptionFrame=function(){if(this.isPrintSubOptionFrame){if(this.objPrintSubOptionFrame.elmPrintSubOptionFrame.style.display=="block"){this.objPrintSubOptionFrame.elmPrintSubOptionFrame.style.display="none";}else{this.objPrintSubOptionFrame.elmPrintSubOptionFrame.style.display="block";}}};ReportView.prototype.sendFileDownCheck=function(){this.debugMeg("서버에 export가 얼만큼 생성중인지 체크....");var b="t"+new Date().getMilliseconds();var a='ClipType=fileDownloadCheck&ClipData={"reportkey":"'+this.objReportInfo.strReportKey+'","s_time":"'+b+'"}';this.debugMeg("전송할 데이터 >>>>>"+a);this.sendData(a);};ReportView.prototype.receiveFileDownCheck=function(b){var a=this;if(b.status){if(404==b.event){this.debugMeg("리포트 서버 세션에서 리포트를 찾을 수 없습니다.");this.debugMeg("리포트가 삭제되었거나 이중화 서버일 가능성이 있습니다.");}if(this.nFileDonwloadType==5){this.debugMeg("PDF 프린트 시작....");var c={reportkey:this.objReportInfo.strReportKey};this.objFileDownFrame.submit("PDFPrintDownload",JSON.stringify(c));if(this.fnEndPDFPrintFunction!=null){this.fnEndPDFPrintFunction();}}else{if(this.nFileDonwloadType==6){this.debugMeg("HTML 프린트 시작....");var c={reportkey:this.objReportInfo.strReportKey};this.objFileDownFrame.submit("HTMLPrintDownload",JSON.stringify(c));if(this.fnEndHTMLPrintFunction!=null){this.fnEndHTMLPrintFunction();}}else{if(this.nFileDonwloadType==7){this.debugMeg("다운로드 시작....");this.objFileDownFrame.submit("saveExportDownload",JSON.stringify(this.objClipSaveExportDownloadData));if(this.fnEndSaveFunction!=null){this.fnEndSaveFunction();}}}}this.debugMeg("프로그래스 종료....");if(!this.isPrintDirect){if(b.wait!=null){if(a.elmProgressNumberLabel!=null){a.elmProgressNumberLabel.innerText=b.progress+"%";window.setTimeout(function(){a.removeProgress();},400);}}else{this.removeProgress();}}}else{if(b.wait!=null){if(b.wait>0){if(a.elmProgressNumberLabel!=null){a.elmProgressNumberLabel.style.fontSize="18px";a.elmProgressNumberLabel.innerText="대기자 : "+(b.wait)+" 명";}}else{if(a.elmProgressNumberLabel!=null){a.elmProgressNumberLabel.parentNode.style.top="47.5%";a.elmProgressNumberLabel.style.fontSize="40px";a.elmProgressNumberLabel.innerText=b.progress+"%";}}}window.setTimeout(function(){a.sendFileDownCheck();},1000);}};ReportView.prototype.receiveSaveCheck=function(b){if(b.status){if(404==b.event){this.debugMeg("리포트 서버 세션에서 리포트를 찾을 수 없습니다.");this.debugMeg("리포트가 삭제되었거나 이중화 서버일 가능성이 있습니다.");}this.debugMeg("callback 저장....");var a=this;window.setTimeout(function(){a.sendFileDownCheck();},1000);}else{this.debugMeg("저장 call back 실패....");}};ReportView.prototype.receivePDFPrintCheck=function(b){if(b.status){if(404==b.event){this.debugMeg("리포트 서버 세션에서 리포트를 찾을 수 없습니다.");this.debugMeg("리포트가 삭제되었거나 이중화 서버일 가능성이 있습니다.");}this.debugMeg("PDFPrint callback 저장....");var a=this;window.setTimeout(function(){a.sendFileDownCheck();},1000);}else{this.debugMeg("PDF 프린트 call back 실패....");}};ReportView.prototype.receiveHTMLPrintCheck=function(b){if(b.status){if(404==b.event){this.debugMeg("리포트 서버 세션에서 리포트를 찾을 수 없습니다.");this.debugMeg("리포트가 삭제되었거나 이중화 서버일 가능성이 있습니다.");}this.debugMeg("HTMLPrint callback 저장....");var a=this;window.setTimeout(function(){a.sendFileDownCheck();},1000);}else{this.debugMeg("HTML 프린트 call back 실패....");}};ReportView.prototype.runPDFPrint=function(d,f,a){if(!this.isPrintDirect){this.createProgress();}var c={reportkey:this.objReportInfo.strReportKey,startNum:d,endNum:f,isTextImage:a,drawDashedLineDirectly:(mCR_isChrome||mCR_isOpera)};this.nFileDonwloadType=5;var b="ClipType=PDFPrint&ClipData="+JSON.stringify(c);this.sendData(b);};ReportView.prototype.runHTML5Print=function(h,i){if(!this.isPrintDirect){this.createProgress();}if(!(this.objOption.nViewType==0)&&!mCR_isFirefox){if(document.getElementsByName("docprint"+this.objReportInfo.strReportKey).length==0){var g=document.createElement("iframe");this.objTargetDOM.appendChild(g);g.style.position="absolute";g.style.width="1px";g.style.height="1px";g.style.visibility="hidden";g.name="docprint"+this.objReportInfo.strReportKey;g.title="Doc HTML Print Frame";var f=this.objPageInfo.nPageWidth<this.objPageInfo.nPageHeight?this.objPageInfo.nPageWidth:this.objPageInfo.nPageHeight;var a=this.objPageInfo.nPageWidth>this.objPageInfo.nPageHeight?this.objPageInfo.nPageWidth:this.objPageInfo.nPageHeight;g.contentWindow.document.write(mCR_makePrintFrame(f,a));}else{document.getElementsByName("docprint"+this.objReportInfo.strReportKey)[0].contentWindow.document.body.innerHTML="";}var d="PartOfPage;"+h+"-"+i;var c={reportkey:this.objReportInfo.strReportKey,pageMethod:d,isMakeDocument:true};var b="ClipType=DocumentPagePrint&ClipData="+JSON.stringify(c);this.sendData(b);}else{var c={reportkey:this.objReportInfo.strReportKey,startNum:h,endNum:i,pageWidth:this.objPageInfo.nPageWidth,pageHeight:this.objPageInfo.nPageHeight,isIE:mCR_isIE,isFirefox:mCR_isFirefox,isSafari:mCR_isSafari};this.nFileDonwloadType=6;var b="ClipType=HTMLPrint&ClipData="+JSON.stringify(c);this.sendData(b);}};ReportView.prototype.saveExportByType=function(b,c,d,j,h){if(this.fnStartSaveFunction!=null){var i=this.fnStartSaveFunction();if(i!=true){this.objHeader.setDisableButtons(false);return;}}if((this.isErrorSaveBrowser)&&this.isErrorSaveAlert){if(this.strErrorSaveString!=""){alert(this.strErrorSaveString);}else{alert(this.objLanguageMap.save_error);}return;}this.createProgress();var g=this.objReportInfo.strReportKey;var a={reportkey:g,startNum:c,endNum:d,fileName:Base64.encode(j),isIE:mCR_isIE,isEdge:mCR_isEdge,exportType:b,option:h,isSmartphone:mCR_isSmartphone};this.objClipSaveExportDownloadData=a;this.nFileDonwloadType=7;var f="ClipType=saveExport&ClipData="+JSON.stringify(a);this.sendData(f);};ReportView.prototype.getThumbnailImage=function(a){var c={reportkey:this.objReportInfo.strReportKey,pageNum:a};var b="ClipType=thumbnailPage&ClipData="+JSON.stringify(c);this.sendData(b);};ReportView.prototype.getTOCInfo=function(){var b={reportkey:this.objReportInfo.strReportKey};var a="ClipType=TOCReport&ClipData="+JSON.stringify(b);this.sendData(a);};ReportView.prototype.createThumbnailCanvas=function(c){var b={reportkey:this.objReportInfo.strReportKey,pageMethod:c,isMakeDocument:true};var a="ClipType=DocumentPageThumbnail&ClipData="+JSON.stringify(b);this.sendData(a);};ReportView.prototype.createThumbnailImageList=function(){for(var a=0;a<this.objPageInfo.nPageCount;a++){this.objThumbnailFrame.createThumbnailImage(a,this.isDocView);}};ReportView.prototype.createThumbnailAll=function(b){for(var a=0;a<b;a++){this.objThumbnailFrame.createThumbnailImage(a,this.isDocView);}this.changeTunmbnailStyle();};ReportView.prototype.closeTOCFrame=function(){this.nOpendMenuType=null;this.objTOCFrame.closeTOCFrame();this.removeBlind();};ReportView.prototype.closeThumbnailFrame=function(){this.nOpendMenuType=null;this.objThumbnailFrame.closeThumbnailFrame();this.removeBlind();};ReportView.prototype.openTOCFrame=function(){this.createBlind();this.objTOCFrame.openTOCFrame();this.nOpendMenuType=4;};ReportView.prototype.openThumbnailFrame=function(){this.createBlind();this.objThumbnailFrame.openThumbnailFrame();this.nOpendMenuType=3;};ReportView.prototype.openSearchWordFrame=function(){this.createBlind();this.objSearchWordFrame.openSearchWordFrame();this.nOpendMenuType=6;};ReportView.prototype.closeSearchWordFrame=function(){this.nOpendMenuType=null;this.objSearchWordFrame.closeSearchWordFrame();this.removeBlind();};ReportView.prototype.moveThumbnailImage=function(a){this.objThumbnailFrame.moveThumbnailImage(a);};ReportView.prototype.createThumbnailFrame=function(a){this.objThumbnailFrame.createThumbnailFrame();this.objHeader.createThumbnailButton();this.createThumbnailAll(a);};ReportView.prototype.editableControl=function(k){var h=k.getAttribute("type");var i=k.value;var c=k.getAttribute("controlindex");if("text"!=h){i=k.checked+"";if(k.tagName=="SPAN"){var j=k.getAttribute("checkValue");if(j=="true"){i="false";}else{i="true";}}}i=encodeURIComponent(Base64.encode(i));var b=this.objReportInfo.strReportKey;var g=this.objPageInfo.nSelectPageIndex;var d=this.objPageInfo.nExportType;var a={reportkey:b,pageNum:g,exportType:d,RSname:encodeURIComponent(Base64.encode(this.strServerPath)),controlType:h,controlIndex:c,controlValue:i};var f="ClipType=editableUpdate&ClipData="+JSON.stringify(a);this.debugMeg("전송할 데이터 >>>>>"+f);this.sendData(f);k.style.zIndex="0";};ReportView.prototype.editableDocControl=function(k){var h=k.getAttribute("type");var i=k.value;var c=k.getAttribute("controlindex");var g=Number(k.getAttribute("pageIndex"));if("text"!=h){i=k.checked+"";if(k.tagName=="SPAN"){var j=k.getAttribute("checkValue");if(j=="true"){i="false";}else{i="true";}}}i=encodeURIComponent(Base64.encode(i));var b=this.objReportInfo.strReportKey;var d=this.objPageInfo.nExportType;var a={reportkey:b,pageNum:g,exportType:d,RSname:encodeURIComponent(Base64.encode(this.strServerPath)),controlType:h,controlIndex:c,controlValue:i};var f="ClipType=editableDocUpdate&ClipData="+JSON.stringify(a);this.debugMeg("전송할 데이터 >>>>>"+f);this.sendData(f);k.style.zIndex="0";};ReportView.prototype.editableKeyEvent=function(a,c){if(c.keyCode==13){if(c.ctrlKey){var d=a.value;if(typeof a.selectionStart=="number"&&typeof a.selectionEnd=="number"){var f=a.selectionStart;a.value=d.slice(0,f)+"\n"+d.slice(a.selectionEnd);a.selectionStart=a.selectionEnd=f+1;}else{if(document.selection&&document.selection.createRange){a.focus();var b=document.selection.createRange();b.text="\r\n";b.collapse(false);b.select();}}return;}a.blur();if(c.preventDefault){c.preventDefault();}c.returnValue=false;}};ReportView.prototype.drilingControl=function(g){var d=this.objReportInfo.strReportKey;var a=this.objPageInfo.nSelectPageIndex;var f=this.objPageInfo.nExportType;var c={reportkey:d,pageNum:a,drilingName:encodeURIComponent(g),exportType:f,RSname:encodeURIComponent(Base64.encode(this.strServerPath))};var b="ClipType=drilingUpdate&ClipData="+JSON.stringify(c);this.debugMeg("전송할 데이터 >>>>>"+b);this.sendData(b);};ReportView.prototype.printPDFDirect=function(){this.isPrintDirect=true;this.isPrintDirectPDF=true;this.printDirect();};ReportView.prototype.printHTMLDirect=function(){this.isPrintDirect=true;this.isPrintDirectHTML=true;this.objOption.nViewType=0;this.printDirect();};ReportView.prototype.printEXEDirect=function(){this.isPrintDirect=true;this.isPrintDirectEXE=true;this.printDirect();};ReportView.prototype.printDirect=function(){this.debugMeg("<<<<<<<<<<<< 리포트 디버깅 로그를 시작합니다 >>>>>>>>>>>>>>>");this.debugMeg("userAgent Check >> "+mCR_UserAgt);this.debugMeg("PDF check >> "+mCR_objPDFInfo.acrobatVersion);this.objLanguageMap=mCR_ReportLanguage(this.objOption.nLanguage);if(null!=this.objReport){this.createReportInfo();this.createPrintDirect();}else{if(null!=this.strUserJspPath){this.sendUserJspDataPrintDirect();}else{if(null!=this.strOOF){this.sendOOFData();}}}};ReportView.prototype.sendUserJspDataPrintDirect=function(){var c=this.strUserJspPath;var b=this.strPostData;var a=this;$.ajax({type:"POST",url:c,data:b,success:function(d){try{a.objReport=mCR_objectCall(mCR_StrTrim(d));a.createReportInfo();a.createPrintDirect();}catch(f){mCR_ReportEventHandler(9);objReport.debugMeg(f);}},error:function(d){objReport.debugMeg(d);}});};ReportView.prototype.createPrintDirect=function(){this.objTargetDOM.style.cssText+="position:absolute !important;width:1px !important;height:1px !important;visibility:hidden !important;opacity:0 !important;filter:alpha(opacity=0) !important;";this.objFileDownFrame.createFrame();if(this.objReportInfo.isStatus){this.debugMeg("리포트 실행  정상");this.sendPageCheck();}else{this.debugMeg("리포트 실행 실패");var a=null;if(this.objReportInfo.nCode<1000){a="IE00"+this.objReportInfo.nCode;}else{a="LE"+this.objReportInfo.nCode;}}};ReportView.prototype.reportPageCheckPrintDirect=function(a){if(a.status){if(a.is_s){this.debugMeg("리포트 생성중 (양호)");}else{this.debugMeg("리포트 생성중 (경고) 서버에서 생성중인 리포트를 세션에서 찾지 못했습니다. 파일 탐색으로 변경되었습니다.");this.debugMeg("계속해서 똑같은 결과가 내려온다면 이중화된 서버 가능성이 있습니다.");this.debugMeg("리포트를 생성한 서버와 확인작업을 위해 통신으로 접속한 서버가 다를 수 있습니다.");this.debugMeg("서버관리자에게 문의 하여 하나의 세션이 생성됐을 때 그 서버만 바라보도록 하거나 리포트 설정 폴더를 물리적으로 같은 폴더로 사용하도록 변경이 필요합니다.");}if(a.endReport){this.debugMeg("서버에서 리포트 생성은 완료..! ");this.isReportMakingFinish=true;this.objPageInfo.nPageCount=a.count;if(this.isPrintDirectPDF==true){this.debugMeg("pdf direct 인쇄");if(this.objPrintRangeOption.type==0){this.runPDFPrint(1,this.objPageInfo.nPageCount,false);}else{if(this.objPrintRangeOption.type==2){if(this.objPrintRangeOption.pageFrom=="last"){this.objPrintRangeOption.pageFrom=this.objPageInfo.nPageCount;}if(this.objPrintRangeOption.pageTo=="last"){this.objPrintRangeOption.pageTo=this.objPageInfo.nPageCount;}this.runPDFPrint(this.objPrintRangeOption.pageFrom,this.objPrintRangeOption.pageTo,false);}}}else{if(this.isPrintDirectHTML==true){this.debugMeg("html direct 인쇄");if(this.objPrintRangeOption.type==0){this.runHTML5Print(1,this.objPageInfo.nPageCount);}else{if(this.objPrintRangeOption.type==2){if(this.objPrintRangeOption.pageFrom=="last"){this.objPrintRangeOption.pageFrom=this.objPageInfo.nPageCount;}if(this.objPrintRangeOption.pageTo=="last"){this.objPrintRangeOption.pageTo=this.objPageInfo.nPageCount;}this.runHTML5Print(this.objPrintRangeOption.pageFrom,this.objPrintRangeOption.pageTo);}}}else{if(this.isPrintDirectEXE==true){this.debugMeg("exe direct 인쇄");this.mCR_printEXEView();}}}}else{var b=this;window.setTimeout(function(){b.sendPageCheck();b=null;},this.objPageInfo.nPageCountTime*this.nWaitTime);}this.objPageInfo.nPageCount=a.count;}else{mCR_ReportEventHandler(30);this.debugMeg("report log :: 리포트 생성중 오류 발생(engine) >>> 서버로그 확인 필요!");if(a.event==60){mCR_ReportEventHandler(60);this.debugMeg("report log :: 리포트서버와의 세션 종료!");}}};ReportView.prototype.setPrintFrame=function(){if(!(this.objOption.nViewType==0)&&!mCR_isFirefox){if(document.getElementsByName("docprint"+this.objReportInfo.strReportKey).length==0){var c=document.createElement("iframe");c.style.position="absolute";c.style.width="1px";c.style.height="1px";c.style.visibility="hidden";c.name="docprint"+this.objReportInfo.strReportKey;c.title="Doc HTML Print Frame";var b=this.objPageInfo.nPageWidth<this.objPageInfo.nPageHeight?this.objPageInfo.nPageWidth:this.objPageInfo.nPageHeight;var a=this.objPageInfo.nPageWidth>this.objPageInfo.nPageHeight?this.objPageInfo.nPageWidth:this.objPageInfo.nPageHeight;if(b==0||a==0){return;}else{this.objTargetDOM.appendChild(c);c.contentWindow.document.write(mCR_makePrintFrame(b,a));}}}};ReportView.prototype.printDOCHTML=function(p){if(p.status){this.objHeader.setDisableButtons(true);if(p.event==404){this.debugMeg("리포트 서버 세션에서 리포트를 찾을 수 없습니다.");this.debugMeg("리포트가 삭제되었거나 이중화 서버일 가능성이 있습니다.");this.objBody.setReportErrorPage(102);this.removeProgress();}else{if(p.event==200){try{this.debugMeg("printDOCHTML ....");var t=document.getElementsByName("docprint"+this.objReportInfo.strReportKey)[0];var s=Base64.decode(p.viewData);var m=this;if(s!=null){s=s.replace(/\+/gi," ");var n=JSON.parse(s);var a=new documentReader();var h=null;if(n.document!=null){h=a.documentReaderFromJSON(n.document,this.strServerPath,this.objReportInfo.strReportKey);}var d=0;var l=0;var f=n.pageNumList.length;for(var g=0;g<f;g++){if(h.documentPageList.length>0){h.documentPageList.pop();}var c=a.readDocumentPage(n.pageList[g]);h.documentPageList.push(c);var b=document.createElement("div");b.className="page-break";if(t.contentWindow.document.body==null){var j=document.createElement("body");t.contentWindow.document.documentElement.appendChild(j);}t.contentWindow.document.body.appendChild(b);d++;var k=new mCR_exportSVG(h,true);var q=k.exportPage(0,function(){if(!(mCR_isIE||mCR_isEdge||mCR_isSafari)){l++;if(d<=l){if(m.fnEndHTMLPrintFunction!=null){m.fnEndHTMLPrintFunction();}t.contentWindow.callPrint();m.removeProgress();m.objHeader.setDisableButtons(false);}}},b);var r=k.objPageStyle.width*0.378;var i=k.objPageStyle.height*0.378;if(r>i){q.setAttribute("width",i);q.setAttribute("height",r);q.lastChild.setAttribute("transform","scale(1) rotate(270,0,0) translate("+r*-1+",0)");}else{q.setAttribute("width",r);q.setAttribute("height",i);}b.appendChild(q);}if(mCR_isIE||mCR_isEdge||mCR_isSafari){if(m.fnEndHTMLPrintFunction!=null){m.fnEndHTMLPrintFunction();}t.contentWindow.callPrint();this.removeProgress();this.objHeader.setDisableButtons(false);}}}catch(o){this.objBody.setReportErrorPage(102);this.removeProgress();}}else{if(p.event==18){this.debugMeg("printDOCHTML 다시 호출....");}}}}else{this.debugMeg("printDOCHTML call back 실패....");this.objBody.setReportErrorPage(102);this.objHeader.setDisableButtons(true);this.removeProgress();}};ReportView.prototype.printDOCPDF=function(o){if(o.status){this.objHeader.setDisableButtons(true);if(o.event==404){this.debugMeg("리포트 서버 세션에서 리포트를 찾을 수 없습니다.");this.debugMeg("리포트가 삭제되었거나 이중화 서버일 가능성이 있습니다.");this.objBody.setReportErrorPage(102);this.removeProgress();}else{if(o.event==200){try{this.debugMeg("printDOCPDF ....");var n=document.getElementsByName("docprint"+this.objReportInfo.strReportKey)[0];var c=Base64.decode(o.viewData);var l=this;if(c!=null){c=c.replace(/\+/gi," ");var a=JSON.parse(c);var f=new documentReader();var b=null;if(a.document!=null){b=f.documentReaderFromJSON(a.document,this.strServerPath,this.objReportInfo.strReportKey);}var d=0;var k=0;this.elmPDF=null;var i=a.pageNumList.length;for(var h=0;h<i;h++){if(b.documentPageList.length>0){b.documentPageList.pop();}var m=f.readDocumentPage(a.pageList[h]);b.documentPageList.push(m);d++;var g=new mCR_exportPDF(b,true);this.elmPDF=g.exportPage(0,this.elmPDF);}this.removeProgress();this.objHeader.setDisableButtons(false);this.elmPDF.autoPrint();if(mCR_isIE||mCR_isEdge){window.navigator.msSaveOrOpenBlob(this.elmPDF.output("blob"),"report.pdf");}else{this.elmPDF.output("dataurlnewwindow");}}}catch(j){this.objBody.setReportErrorPage(102);this.removeProgress();}}else{if(o.event==18){this.debugMeg("printDOCHTML 다시 호출....");}}}}else{this.debugMeg("printDOCHTML call back 실패....");this.objBody.setReportErrorPage(102);this.objHeader.setDisableButtons(true);this.removeProgress();}};ReportView.prototype.openPrintHTMLManualFrame=function(){this.objPrintHTMLManualFrame=new mCR_ReportPrintHTMLManualFrame(this);this.objPrintHTMLManualFrame.createPrintHTMLManualFrame();};ReportView.prototype.closePrintHTMLManualFrame=function(){this.objTargetDOM.removeChild(this.objPrintHTMLManualFrame.elmPrintHTMLManualFrame);this.objPrintHTMLManualFrame=null;};ReportView.prototype.memoPage=function(){this.toggleMemoHeader();this.objSpeechBubbleFrame.memoPage(this.objPageInfo.nSelectPageIndex);};ReportView.prototype.makeMemo=function(){this.objSpeechBubbleFrame.makeMemo();};ReportView.prototype.toggleMemoOption=function(){this.objSpeechBubbleFrame.toggleSpeechBubbleFrame();};ReportView.prototype.returnFromMemoPage=function(){this.objSpeechBubbleFrame.closeSpeechBubbleFrame();this.toggleMemoHeader();this.objSpeechBubbleFrame.returnFromMemoPage();};ReportView.prototype.toggleMemoHeader=function(){this.objHeader.changeMemoHeader();};ReportView.prototype.createSpeechBubbleDiv=function(a){var b=this.objSpeechBubbleFrame.createSpeechBubbleDiv(a);this.objSpeechBubbleFrame.setSpeechBubbleDiv(b);this.objSpeechBubbleFrame.makeAllPageMemo(this.objPageInfo.nSelectPageIndex,b);};ReportView.prototype.toggleOpacityEditingSpace=function(a){if(a==undefined){if(this.objBody.elmBody.lastChild.style.opacity=="1"||this.objBody.elmBody.lastChild.style.opacity==""){this.objBody.elmBody.lastChild.style.opacity="0.1";}else{this.objBody.elmBody.lastChild.style.opacity="1";}}else{if(!a){this.objBody.elmBody.lastChild.style.opacity="1";}else{this.objBody.elmBody.lastChild.style.opacity="0.1";}}};ReportView.prototype.updataDrilingSubSection=function(d,m){var c=this.objDocPageController.getPage(m);if(c!=null){var b=1;var l=this.objDocPageController.getStyle(m);var a=d;var i=c.subSectionList.length;var h=0;for(var g=0;g<i;g++){var n=c.subSectionList[g];if(n.isDrilling){if(n.drillingName==a){n.area.offsetRect(0,h);if(n.isDrillingView){n.isDrillingView=false;b=-1;}else{n.isDrillingView=true;}h+=n.area.getHeight()*b;for(var f=0;f<g;f++){var o=c.subSectionList[f];if(n.area.top<o.area.top){o.area.offsetRect(0,n.area.getHeight()*b);}}}else{n.area.offsetRect(0,h);}}else{n.area.offsetRect(0,h);}}l.height=l.height+h;if(this.isScrollView&&this.objOption.nViewType!=0){this.paintDocumentPageViewScrollType(m,c,l);}else{this.paintDocumentPage();}}else{alert("page 정보가 objDocPageController에 없습니다.");}};ReportView.prototype.updateMemo=function(){var c=this.objReportInfo.strReportKey;var b={reportkey:c,value:Base64.encode(JSON.stringify(this.objSpeechBubbleFrame.arrSpeechBubbleArray))};this.objClipSaveExportDownloadData=b;var a="ClipType=memoUpdate&ClipData="+JSON.stringify(b);this.sendData(a);};ReportView.prototype.ClipReportExePrintCheck=function(a){var g=this;g.objExePrintStatus.disConnectCount=0;if(mCR_isChrome58||"http:"==location.protocol.toLocaleLowerCase()){this.objExePrintStatus.url="http://127.0.0.1:";this.objExePrintStatus.port=g.objExePrintStatus.httpPort;}else{this.objExePrintStatus.url="https://127.0.0.1:";this.objExePrintStatus.port=g.objExePrintStatus.httpsPort;}if(window.XDomainRequest){var j=new XDomainRequest();if(j){try{j.onload=function(){var k=(new Function("return "+j.responseText))();a(k.version);};j.onerror=function(){g.objExePrintStatus.disConnectCount++;if(g.objExePrintStatus.disConnectCount==3){a("1.0.0");}};j.open("GET",g.objExePrintStatus.url+g.objExePrintStatus.port[0]+"/version");j.send();}catch(b){if(window.console){window.console.log(b);}}}var i=new XDomainRequest();if(i){try{i.onload=function(){var k=(new Function("return "+i.responseText))();a(k.version);};i.onerror=function(){g.objExePrintStatus.disConnectCount++;if(g.objExePrintStatus.disConnectCount==3){a("1.0.0");}};i.open("GET",g.objExePrintStatus.url+g.objExePrintStatus.port[1]+"/version");i.send();}catch(b){if(window.console){window.console.log(b);}}}var h=new XDomainRequest();if(h){try{h.onload=function(){var k=(new Function("return "+h.responseText))();a(k.version);};h.onerror=function(){g.objExePrintStatus.disConnectCount++;if(g.objExePrintStatus.disConnectCount==3){a("1.0.0");}};h.open("GET",g.objExePrintStatus.url+g.objExePrintStatus.port[2]+"/version");h.send();}catch(b){if(window.console){window.console.log(b);}}}}else{var f=new HttpClient();f.send(g.objExePrintStatus.url+g.objExePrintStatus.port[0]+"/version","",true,function(){if(4==this.readyState){if(200==this.status){var k=(new Function("return "+this.responseText))();a(k.version);}else{g.objExePrintStatus.disConnectCount++;if(g.objExePrintStatus.disConnectCount==3){a("1.0.0");}}}});var d=new HttpClient();d.send(g.objExePrintStatus.url+g.objExePrintStatus.port[1]+"/version","",true,function(){if(4==this.readyState){if(200==this.status){var k=(new Function("return "+this.responseText))();a(k.version);}else{g.objExePrintStatus.disConnectCount++;if(g.objExePrintStatus.disConnectCount==3){a("1.0.0");}}}});var c=new HttpClient();c.send(g.objExePrintStatus.url+g.objExePrintStatus.port[2]+"/version","",true,function(){if(4==this.readyState){if(200==this.status){var k=(new Function("return "+this.responseText))();a(k.version);}else{g.objExePrintStatus.disConnectCount++;if(g.objExePrintStatus.disConnectCount==3){a("1.0.0");}}}});}};ReportView.prototype.mCR_printEXEView=function(){this.debugMeg("report log ::  EXE Print 인쇄를 시작합니다. >>>>>>>>>>>>>>>");this.createProgress();try{var c=null;if(this.strServerPath.substring(0,2)=="./"){c=location.href.slice(0,location.href.lastIndexOf("/")+1)+this.strServerPath.replace("report_server","Clip").substring(2);}else{if(this.strServerPath.substring(0,3)=="../"){var f=this.strServerPath.split("../").length-1;var n=location.href.slice(0,location.href.lastIndexOf("/"));for(var s=0;s<f;s++){n=n.slice(0,n.lastIndexOf("/"));}var o=this.strServerPath.replace("report_server","Clip");c=n+"/"+o.substring(o.lastIndexOf("../")+3);}else{if(this.strServerPath.substring(0,1)=="/"){c=location.origin+this.strServerPath.replace("report_server","Clip");}else{if(this.strServerPath.indexOf(location.origin)!=-1){c=this.strServerPath.replace("report_server","Clip");}else{alert("exe 프린트 경로 오류입니다.");return;}}}}if(mCR_isChrome58||"http:"==location.protocol.toLocaleLowerCase()){this.objExePrintStatus.url="http://127.0.0.1:";this.objExePrintStatus.port=this.objExePrintStatus.httpPort;}else{this.objExePrintStatus.url="https://127.0.0.1:";this.objExePrintStatus.port=this.objExePrintStatus.httpsPort;}var j="";if(-1!=this.strServerPath.indexOf("?")){j=location.host+this.strServerPath.replace("report_server","Clip")+"&";}else{j=this.strServerPath.replace("report_server","Clip")+"?";}this.debugMeg("report log :: EXE Print 인쇄하기 위하여 통신 준비중....");j+="ClipID=S01";this.debugMeg("report log :: 서버 통신 주소  >>> "+j);var m=new HttpClient();var t="";var a=true;if(typeof getExePrintUseCookie!="undefined"){a=getExePrintUseCookie();}if(a){j=mCR_onBeforeSend(j);t=m.send(j,"",false,null);t=mCR_StrTrim(mCR_onAfterSend(t));}this.debugMeg("report log :: 리포트 생성 통신 완료..!");this.debugMeg("report log :: 쿠키정보 체크 >>> "+t);var r=this;if(typeof this.exe_print_version!="undefined"){this.debugMeg("report log :: exe Print version >>> "+this.exe_print_version);}else{this.debugMeg("report log :: exe Print version >>> 확인불가");this.exe_print_version="1.0.1";}var p=this.objPageInfo.nSelectPageIndex+1;var l={cookie:encodeURIComponent(t),serverPath:encodeURIComponent(c),ClipID:"P01",uid:r.objReportInfo.strReportKey,version:r.exe_print_version,currentPage:p,totalPageCount:r.objPageInfo.nPageCount,printSet:r.objExePrintOption};var h="option="+JSON.stringify(l);this.debugMeg("report log :: 프린트 설정 정보 >>> "+h);this.objExePrintStatus.disConnectCount=0;this.objExePrintStatus.intervalKey=window.setInterval(function(){if(3==r.objExePrintStatus.disConnectCount){window.clearInterval(r.objExePrintStatus.intervalKey);if(!r.isPrintDirect){r.removeProgress();}mCR_ReportEventHandler(103);}},1500);if(window.XDomainRequest){var x=new XDomainRequest();if(x){try{x.onload=function(){r.startEXEPrintResponse(x.responseText);};x.onerror=function(){r.objExePrintStatus.disConnectCount++;};x.open("GET",this.objExePrintStatus.url+this.objExePrintStatus.port[0]+"?"+h);x.send();}catch(g){mRe_ReportWebLog(g.stack);}}var w=new XDomainRequest();if(w){try{w.onload=function(){r.startEXEPrintResponse(w.responseText);};w.onerror=function(){r.objExePrintStatus.disConnectCount++;};w.open("GET",this.objExePrintStatus.url+this.objExePrintStatus.port[1]+"?"+h);w.send();}catch(g){mRe_ReportWebLog(g.stack);}}var v=new XDomainRequest();if(v){try{v.onload=function(){r.startEXEPrintResponse(v.responseText);};v.onerror=function(){r.objExePrintStatus.disConnectCount++;};v.open("GET",this.objExePrintStatus.url+this.objExePrintStatus.port[2]+"?"+h);v.send();}catch(g){mRe_ReportWebLog(g.stack);}}}else{var q="POST";if(typeof getExePrintAjaxType!="undefined"){q=getExePrintAjaxType();}for(var d=0;d<this.objExePrintStatus.port.length;d++){var b=this.objExePrintStatus.port[d];var k=this.objExePrintStatus.url+b;$.ajax({type:q,url:k,crossDomain:true,data:h,success:function(i){r.startEXEPrintResponse(i);},error:function(i){r.objExePrintStatus.disConnectCount++;}});}}}catch(u){if(!this.isPrintDirect){this.removeProgress();}mCR_ReportEventHandler(104);}};ReportView.prototype.startEXEPrintResponse=function(a){try{this.debugMeg("report log :: 서비스 응답 >>>"+a);this.closePrintMainOptionFrame();var c=null;if(typeof a==="string"){c=mCR_objectCall(mCR_StrTrim(a));}else{c=a;}var b=this;window.clearInterval(this.objExePrintStatus.intervalKey);if(c.result){window.setTimeout(function(){b.exePrintStatusCheck(c.port);},1500);}else{var f=c.serviceCode;this.debugMeg("report log :: exe print service에 문제가 발생하였습니다. 코드번호  >> "+f);if(!this.isPrintDirect){this.removeProgress();}mCR_ReportEventHandler(105);}}catch(d){this.objExePrintStatus.disConnectCount++;this.debugMeg("report log :: 다른 로컬서버가 존재하는것 같습니다.");this.debugMeg("report log :: startEXEPrintResponse function error >> "+d);mCR_ReportEventHandler(104);}};ReportView.prototype.exePrintStatusCheck=function(g){this.objExePrintStatus.portNumber=g;var b=this;var f={ClipID:"P02",uid:b.objReportInfo.strReportKey};var h="option="+JSON.stringify(f);this.debugMeg("report log :: 인쇄가 종료될 때 까지 서비스에 인쇄상태를 요청합니다. >>>"+h);if(window.XDomainRequest){var c=new XDomainRequest();if(c){c.onload=function(){b.exePrintStatusResult(c.responseText);};c.onerror=function(){mCR_ReportEventHandler(105);if(!b.isPrintDirect){b.removeProgress();}};c.open("GET",this.objExePrintStatus.url+g+"?"+h);c.send();}}else{var a=this.objExePrintStatus.url+g;var d="POST";if(typeof getExePrintAjaxType!="undefined"){d=getExePrintAjaxType();}$.ajax({type:d,url:a,crossDomain:true,data:h,success:function(i){b.exePrintStatusResult(i);},error:function(i){mCR_ReportEventHandler(105);if(!b.isPrintDirect){b.removeProgress();}}});}};ReportView.prototype.exePrintStatusResult=function(a){try{var c=null;if(typeof a==="string"){c=mCR_objectCall(mCR_StrTrim(a));}else{c=a;}this.debugMeg("report log :: 서비스 응답 >>>"+c);var b=this;if(c.endPrint){if(!this.isPrintDirect){this.removeProgress();}if(c.okButton){this.debugMeg("report log :: 인쇄에 대한 이벤트가 종료 되었습니다. ");if(this.objExePrintEvent.ok!=null){this.objExePrintEvent.ok(c.errorCode);}mCR_ReportEventHandler(106);}else{if(c.cancelButton){this.debugMeg("report log :: 인쇄에 대한 이벤트가 취소 되었습니다. ");if(this.objExePrintEvent.cancel!=null){this.objExePrintEvent.cancel(c.errorCode);}mCR_ReportEventHandler(107);}}}else{if(false==c.endPrint){this.debugMeg("report log :: 인쇄가 아직 진행중 입니다....");window.setTimeout(function(){b.exePrintStatusCheck(b.objExePrintStatus.portNumber);},1500);}}}catch(d){this.debugMeg("report log :: exePrintStatusResult function error >> "+d);mCR_ReportEventHandler(105);if(!this.isPrintDirect){this.removeProgress();}}};ReportView.prototype.getProperty=function(a){return this.objProperties[a];};ReportView.prototype.setProperty=function(a,b){this.objProperties[a]=b;};ReportView.prototype.searchWord=function(a){this.objDocPageController.searchWord(a,this.objClipDocument);};ReportView.prototype.getSearchWordArrayCount=function(){return this.objDocPageController.getSearchWordArrayCount();};ReportView.prototype.getSearchWordInfo=function(a){return this.objDocPageController.getSearchWordInfo(a);};ReportView.prototype.getSelectedPageSearchWordInfo=function(a){return this.objDocPageController.getSelectedPageSearchWordInfo(a);};ReportView.prototype.errorAlertUI=function(m,n,g,b){var h=this;this.createBlind();this.nOpendMenuType=7;var a=document.createElement("div");a.className="error_background";var f=this.objTargetDOM.offsetWidth;var d=this.objTargetDOM.offsetHeight;var l=document.createElement("div");l.className="error_layout";var k=document.createElement("div");k.className="error_font error_layout_head";k.innerHTML=m;var o=document.createElement("div");o.className="error_font error_layout_body";o.innerHTML=n;var i=document.createElement("div");i.className="error_font error_layout_bottom";var j=document.createElement("button");j.onclick=function(){h.closeOptions();if(b!=null){b();}};j.className="error_ok_button";j.innerHTML="확인";i.appendChild(j);if(g){var c=document.createElement("button");c.onclick=function(){h.closeOptions();};c.className="error_cancel_button";c.innerHTML="취소";i.appendChild(c);}l.appendChild(k);l.appendChild(o);l.appendChild(i);a.appendChild(l);this.objReportInfoFrame=a;this.objTargetDOM.appendChild(a);l.style.left=((f/2)-(l.offsetWidth/2))+"px";l.style.top=((d/2)-(l.offsetHeight/2))+"px";j.focus();};ReportView.prototype.closeErrorAlertUI=function(){this.nOpendMenuType=null;this.objReportInfoFrame.parentElement.removeChild(this.objReportInfoFrame);this.objReportInfoFrame=null;this.removeBlind();if(this.objHeader!=null){if(this.objHeader.elmInfoButton!=null){this.objHeader.elmInfoButton.elmButton.focus();}}};ReportView.prototype.reportInfo=function(){var h=this;this.createBlind();this.nOpendMenuType=5;var j=document.createElement("div");j.className="report_popup_view";this.objTargetDOM.appendChild(j);var i=document.createElement("div");i.className="report_view_box report_info_view_position";j.appendChild(i);var b=document.createElement("span");b.className="report_view_box";b.style.cssText="position:absolute;left:20px;top:13px;border:0;z-index:310";b.textContent=this.objLanguageMap.report_info;b.setAttribute("role","text");b.setAttribute("aria-label",this.objLanguageMap.report_info);b.tabIndex=1;i.appendChild(b);var c=document.createElement("div");c.style.cssText="position:absolute;left:15px;right:15px;top:20px;bottom:40px;border:1px solid darkgray;";i.appendChild(c);var f=document.createElement("div");f.className="report_view_cliplogo";f.style.cssText="position:absolute;left:8px;top:12px;height:30%;width:45%;background-color: white;border-style:double;";f.tabIndex=2;f.title=this.objLanguageMap.clipReportImage;f.setAttribute("role","text");f.setAttribute("aria-label",this.objLanguageMap.clipReportImage);c.appendChild(f);var g=document.createElement("div");g.style.cssText="position:absolute;right:8px;top:18px;height:25%;width:45%;";g.innerText=this.objLanguageMap.version+" : "+this.objLanguageMap.clipReport+" v5.0("+this.objReportInfo.strEngineVersion+")\n"+this.objLanguageMap.webversion+" : "+this.objReportInfo.strViewerVersion;g.tabIndex=3;g.setAttribute("role","text");g.setAttribute("aria-label",this.objLanguageMap.version+" : "+this.objLanguageMap.clipReport+" v5.0("+this.objReportInfo.strEngineVersion+")\n"+this.objLanguageMap.webversion+" : "+this.objReportInfo.strViewerVersion);c.appendChild(g);var a=document.createElement("div");a.style.cssText="position:absolute;left:8px; right:8px;top:43%;height:50%;";a.innerText="Copyright (C) 2011 CLIPSOFT Co., Ltd. All Rights Reserved.\nhttp://www.clipsoft.co.kr\n\n"+this.objLanguageMap.report_info_text;a.tabIndex=4;a.setAttribute("role","text");a.setAttribute("aria-label","Copyright (C) 2011 CLIPSOFT Co., Ltd. All Rights Reserved.\nhttp://www.clipsoft.co.kr\n\n"+this.objLanguageMap.report_info_text);c.appendChild(a);var d=document.createElement("button");d.title=this.objLanguageMap.ok;d.className="report_view_button";d.textContent=this.objLanguageMap.ok;d.tabIndex=5;d.onclick=function(){h.closeOptions();};d.style.cssText="bottom:5px;right:15px;height:30px;width:75px;";i.appendChild(d);this.objReportInfoFrame=j;b.focus();};ReportView.prototype.closeReportInfo=function(){this.nOpendMenuType=null;this.objReportInfoFrame.parentElement.removeChild(this.objReportInfoFrame);this.objReportInfoFrame=null;this.removeBlind();if(this.objHeader!=null){if(this.objHeader.elmInfoButton!=null){this.objHeader.elmInfoButton.elmButton.focus();}}};var mCR_strWhiteImg="/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAIBAQIBAQICAgICAgICAwUDAwMDAwYEBAMFBwYHBwcGBwcICQsJCAgKCAcHCg0KCgsMDAwMBwkODw0MDgsMDAz/2wBDAQICAgMDAwYDAwYMCAcIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCAABAAEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9/KKKKAP/2Q==";ReportView.prototype.setDebug=function(a){if(typeof window.console!="undefined"){if(a){this.objOption.isDebug=a;}else{this.objOption.isDebug=false;}}};ReportView.prototype.setPageCountTime=function(a){this.objPageInfo.nPageCountTime=a;};ReportView.prototype.setLanguage=function(a){switch(a){case"en":this.objOption.nLanguage=1;break;case"jp":this.objOption.nLanguage=2;break;case"cn":this.objOption.nLanguage=3;break;default:break;}};ReportView.prototype.setEndReportEvent=function(a){this.fnEndReportFunction=a;};ReportView.prototype.setEndPDFPrintEvent=function(a){this.fnEndPDFPrintFunction=a;};ReportView.prototype.setPrintFrameFirst=function(a){this.isSetPrintFrameFirst=a;};ReportView.prototype.setEndHTMLPrintEvent=function(a){this.fnEndHTMLPrintFunction=a;};ReportView.prototype.setEndSaveFunctionEvent=function(a){this.fnEndSaveFunction=a;};ReportView.prototype.setIsUsePrintButtonWithoutAcrobat=function(a){this.isUsePrintButtonWithoutAcrobat=a;};ReportView.prototype.setCloseReportEvent=function(a){this.fnCloseReportFunction=a;};ReportView.prototype.setStartPrintButtonEvent=function(a){this.fnStartPrintButton=a;};ReportView.prototype.setStartSaveButtonEvent=function(a){this.fnStartSaveButton=a;};ReportView.prototype.setStartSaveFunctionEvent=function(a){this.fnStartSaveFunction=a;};ReportView.prototype.setAccessibility=function(a){this.objOption.isAccessibility=a;};ReportView.prototype.setBodyOverflowAuto=function(a){this.isBodyOverflowAuto=a;};ReportView.prototype.setRemoveTotalCountSlash=function(a){this.isRemoveTotalCountSlash=a;};ReportView.prototype.setClientPaintViewAccessibility=function(a){this.isClientPaintViewAccessibility=a;};ReportView.prototype.setZoomEventLock=function(a){this.isBodyEventLock=a;};ReportView.prototype.callDeleteToReport=function(){this.debugMeg("deleteToReport 함수 사용");this.debugMeg("서버에 만들어진 리포트 파일을 삭제합니다.");var d=null;if(this.fnCloseReportFunction!=null){var d=this.fnCloseReportFunction;}var b='ClipType=deleteReport&ClipData={"reportkey":"'+this.objReportInfo.strReportKey+'"}';b=mCR_onAfterSend(b);var c=this.strServerPath;var a=this;$.ajax({type:"POST",url:c,data:b,success:function(f){a.debugMeg("삭제 URL >>> "+c+b);if(d!=null){d();}},error:function(f){a.debugMeg("삭제 URL >>> "+f);if(d!=null){d();}}});};ReportView.prototype.callCloseView=function(){this.callDeleteToReport();this.objTargetDOM.innerHTML="";m_reportHashMap[this.objReport.reportkey]=null;};ReportView.prototype.setProgressToPageMove=function(a){this.isProgressToPageMove=a;};ReportView.prototype.callResize=function(){if(this.objPageInfo.strZoomRatio!=null){this.resizeBody(this.objPageInfo.strZoomRatio);}};ReportView.prototype.setDefaultRatio=function(b){this.debugMeg("페이지 크기 설정");var a=null;if(b=="PageWidth"){a="pageWidth";}else{if(b=="WholePage"){a="pageHeight";}else{a=((b.replace("%","")/100)).toString();}}this.objPageInfo.strZoomRatio=a;};ReportView.prototype.setCustomButtonInfo=function(b,d,c,a){this.debugMeg("버튼 정보 추가");this.arrCustomButtonInfoList.push({className:b,functionInfo:d,nonDisplay:c,title:a});};ReportView.prototype.setDefaultSaveDOCOption=function(h,c,d,b,i,j,f,g,a){this.debugMeg("DOC 저장 옵션 설정");this.objSaveExportOptionInfo.doc={splitTextLine:h,processAsUnicode:c,processEqualAlign:d,defaultCharSpace:b,tableWrapperBottomGap:i,insertTableWrapper:j,mergeTable:f,fitShapeToText:g,TableRowHeightSort:a};};ReportView.prototype.setDefaultSaveDOCXOption=function(h,b,c,a,i,j,f,d,g,k){this.debugMeg("DOCX 저장 옵션 설정");this.objSaveExportOptionInfo.docx={splitTextLine:h,processAsUnicode:b,processEqualAlign:c,defaultCharSpace:a,tableWrapperBottomGap:i,insertTableWrapper:j,mergeTable:f,lineSpaceRate:d,easyEditable:g,userPassword:k};};ReportView.prototype.setDefaultSaveExcelOption=function(j,n,a,f,l,d,b,m,h,o,k,i,g,c){this.debugMeg("EXCEl 저장 옵션 설정");this.objSaveExportOptionInfo.xls={exportMethod:j,mergeCell:n,mergeEmptyCell:a,splitCellAtPageSize:f,rightToLeft:l,widthRate:d,heightRate:b,coordinateErrorLimit:m,processGerenalFormat:h,printingMagnification:o,fitToPageWhenPrinting:k,removeHyperlink:i,repeatPageSectionWhenAllSectionInOneSheet:g,dpi:c};};ReportView.prototype.setDefaultSaveExcelxOption=function(k,o,a,f,m,d,b,n,h,q,l,j,g,p,c,i){this.debugMeg("EXCElX 저장 옵션 설정");this.objSaveExportOptionInfo.xlsx={exportMethod:k,mergeCell:o,mergeEmptyCell:a,splitCellAtPageSize:f,rightToLeft:m,widthRate:d,heightRate:b,coordinateErrorLimit:n,processGerenalFormat:h,printingMagnification:q,fitToPageWhenPrinting:l,removeHyperlink:j,repeatPageSectionWhenAllSectionInOneSheet:g,userPassword:p,dpi:c,is2Dot5VersionConverted:i};};ReportView.prototype.setDefaultSaveHanCellOption=function(j,n,a,f,l,d,b,m,h,p,k,i,g,o,c){this.debugMeg("HanCell 저장 옵션 설정");this.objSaveExportOptionInfo.cell={exportMethod:j,mergeCell:n,mergeEmptyCell:a,splitCellAtPageSize:f,rightToLeft:l,widthRate:d,heightRate:b,coordinateErrorLimit:m,processGerenalFormat:h,printingMagnification:p,fitToPageWhenPrinting:k,removeHyperlink:i,repeatPageSectionWhenAllSectionInOneSheet:g,userPassword:o,dpi:c};};ReportView.prototype.setDefaultSaveHTML5Option=function(b,a){this.debugMeg(" html5 저장 옵션 설정");this.objSaveExportOptionInfo.html={isSplite:b,dpiValue:a};};ReportView.prototype.setDefaultSaveHWPOption=function(b,h,l,m,q,d,r,c,t,j,i,a,g,f,k,o,p,n,s){this.debugMeg("HWP 저장 옵션 설정");this.objSaveExportOptionInfo.hwp={fixSize:b,allowOverlay:h,setPageBottomMarginToZero:l,outputLikeWord:m,tableSplitMethod:q,defaultCharGap:d,charRatio:r,putCheckboxIntoCell:c,splitTextByLine:t,mergeTable:j,lineSpaceRate:i,positionRelTo:a,hwpExportMethod:g,splitPageOnListTableOnly:f,pageBottomMarginApplicationRate:k,insertPageNumber:o,mergeAllTablesOnListTableOnly:p,insertLabelWithTextOnListTableOnly:n,isTransparentMode:s};};ReportView.prototype.setDefaultSaveJPGOption=function(b,a,d,c){this.debugMeg("JPG 저장 옵션 설정");this.objSaveExportOptionInfo.jpg={rotate90:b,dpiX:a,dpiY:d,quality:c};};ReportView.prototype.setDefaultSavePDFOption=function(f,a,b,d,c){this.debugMeg("PDF 저장 옵션 설정");this.objSaveExportOptionInfo.pdf={userpw:f,textToImage:a,importOriginImage:b,removeHyperlink:d,useCodeX:c};};ReportView.prototype.setDefaultSavePPTOption=function(b,a,c){this.debugMeg("PPT 저장 옵션 설정");this.objSaveExportOptionInfo.ppt={mergeTable:b,ignoreLineSpace:a,removeHyperlink:c};};ReportView.prototype.setDefaultSavePPTXOption=function(d,h,f,a,c,g,b){this.debugMeg("PPTX 저장 옵션 설정");this.objSaveExportOptionInfo.pptx={mergeTable:d,removeHyperlink:h,splitTextByLine:f,removeHyperlink:h,defaultCharGap:a,lineSpaceRate:c,putCheckboxIntoCell:g,userPassword:b};};ReportView.prototype.setDefaultSaveHanShowOption=function(d,h,f,a,c,g,b){this.debugMeg("한쇼 저장 옵션 설정");this.objSaveExportOptionInfo.show={mergeTable:d,removeHyperlink:h,splitTextByLine:f,removeHyperlink:h,defaultCharGap:a,lineSpaceRate:c,putCheckboxIntoCell:g,userPassword:b};};ReportView.prototype.setDefaultSaveTIFOption=function(b,a,d,c){this.debugMeg("TIF 저장 옵션 설정");this.objSaveExportOptionInfo.tif={rotate90:b,dpiX:a,dpiY:d,blackWhite:c};};ReportView.prototype.setDefaultSaveMultiTIFOption=function(b,a,d,c){this.debugMeg("Multi TIF 저장 옵션 설정");this.objSaveExportOptionInfo.multitif={rotate90:b,dpiX:a,dpiY:d,blackWhite:c};};ReportView.prototype.setDefaultSaveExcelDataOption=function(a){this.debugMeg("ExcelData 저장 옵션 설정");this.objSaveExportOptionInfo.exceldata={outputPageSectionMethod:a};};ReportView.prototype.setVisibleMenu=function(a){this.debugMeg("상단 메뉴바 사용 옵션 설정");this.isUpperMenu=a;};ReportView.prototype.setSaveOptionVisible=function(b,a){b=b.toLowerCase();if("xls"==b){this.objSaveOptionVisible.isXls=a;}else{if("xlsx"==b){this.objSaveOptionVisible.isXlsx=a;}else{if("pdf"==b){this.objSaveOptionVisible.isPdf=a;}else{if("hwp"==b){this.objSaveOptionVisible.isHwp=a;}else{if("doc"==b){this.objSaveOptionVisible.isDoc=a;}else{if("docx"==b){this.objSaveOptionVisible.isDocx=a;}else{if("ppt"==b){this.objSaveOptionVisible.isPpt=a;}else{if("pptx"==b){this.objSaveOptionVisible.isPptx=a;}else{if("html"==b){this.objSaveOptionVisible.isHtml=a;}else{if("cell"==b){this.objSaveOptionVisible.isCell=a;}else{if("jpg"==b){this.objSaveOptionVisible.isJpg=a;}else{if("txt"==b){this.objSaveOptionVisible.isTxt=a;}else{if("tif"==b){this.objSaveOptionVisible.isTif=a;}else{if("multitif"==b){this.objSaveOptionVisible.isMultitif=a;}else{if("exceldata"==b){this.objSaveOptionVisible.isExcelData=a;}else{if("brl"==b){this.objSaveOptionVisible.isBrl=a;}else{if("show"==b){this.objSaveOptionVisible.isShow=a;}}}}}}}}}}}}}}}}}};ReportView.prototype.setReportSaveMenuOrder=function(a){this.objSaveMenuOrder=a;};ReportView.prototype.setDefaultSelectSaveOption=function(a){this.strDefaultSaveOption=a;};ReportView.prototype.setRatioComboNameVisible=function(c,a){var d=this.objRatioComboInfo.length;for(var b=0;b<d;b++){if(this.objRatioComboInfo[b].name==c){this.objRatioComboInfo[b].visible=a;}}};ReportView.prototype.setRatioComboNameChange=function(d,c){var b=this.objRatioComboInfo.length;for(var a=0;a<b;a++){if(this.objRatioComboInfo[a].text==d){this.objRatioComboInfo[a].text=c;}}};ReportView.prototype.setRatioComboLastTwoWordsNameChange=function(d,b){var c=this.objRatioComboInfo.length;for(var a=0;a<c;a++){if(this.objRatioComboInfo[a].value=="pageWidth"){this.objRatioComboInfo[a].text=d;}else{if(this.objRatioComboInfo[a].value=="pageHeight"){this.objRatioComboInfo[a].text=b;}}}};ReportView.prototype.setRatioComboAllChange=function(a){this.objRatioComboInfo=a;};ReportView.prototype.setPrintSelectNames=function(d,a){var b=this.objPrintOptionInfo.length;for(var c=0;c<b;c++){if(this.objPrintOptionInfo[c].value==d){this.objPrintOptionInfo[c].text=a;}}};ReportView.prototype.setIsPrintUse=function(c,b,a){this.objPrintOptionInfo=null;this.objPrintOptionInfo=new Array();if(c=="pdf"){this.objPrintOptionInfo.push({name:"pdf_print",text:"pdf",value:"pdf",visible:true});}else{if(c=="html"){this.objPrintOptionInfo.push({name:"html_print",text:"html",value:"html",visible:true});}else{if(c=="exe"){this.objPrintOptionInfo.push({name:"exe_print",text:"exe",value:"exe",visible:true});}}}if(b=="pdf"){this.objPrintOptionInfo.push({name:"pdf_print",text:"pdf",value:"pdf",visible:true});}else{if(b=="html"){this.objPrintOptionInfo.push({name:"html_print",text:"html",value:"html",visible:true});}else{if(b=="exe"){this.objPrintOptionInfo.push({name:"exe_print",text:"exe",value:"exe",visible:true});}}}if(a=="pdf"){this.objPrintOptionInfo.push({name:"pdf_print",text:"pdf",value:"pdf",visible:true});}else{if(a=="html"){this.objPrintOptionInfo.push({name:"html_print",text:"html",value:"html",visible:true});}else{if(a=="exe"){this.objPrintOptionInfo.push({name:"exe_print",text:"exe",value:"exe",visible:true});}}}};ReportView.prototype.setPrintRangeOption=function(a,c,b){this.objPrintRangeOption.type=a;if(a==2){if(c=="last"){this.objPrintRangeOption.pageFrom="last";}else{if(c>=1){this.objPrintRangeOption.pageFrom=c;}else{this.objPrintRangeOption.pageFrom=1;}}if(b=="last"){this.objPrintRangeOption.pageTo="last";}else{if(b>=c){this.objPrintRangeOption.pageTo=b;}else{this.objPrintRangeOption.pageTo=1;}}}};ReportView.prototype.callGetTOCData=function(){this.debugMeg("TOC 정보를 가져오는 중 입니다.");return this.arrTOCData;};ReportView.prototype.setTOCCustom=function(a){this.debugMeg("TOC 커스텀 사용 여부 설정중입니다.");this.objSideMenuInfo.isTOCCustom=a;};ReportView.prototype.setThumbnailCustom=function(a){this.debugMeg("썸네일 커스텀 사용 여부 설정중입니다.");this.objSideMenuInfo.isThumbnailCustom=a;};ReportView.prototype.setThumbnailUse=function(a){this.debugMeg("썸네일 사용 여부 설정중입니다.");this.objSideMenuInfo.isThumbnailUse=a;};ReportView.prototype.setTocUse=function(a){this.debugMeg("toc 사용 여부 설정중입니다.");this.objSideMenuInfo.isTocUse=a;};ReportView.prototype.callThumbnailData=function(){this.debugMeg("썸네일 정보를 서버로부터 불러오는 중 입니다.");for(var a=0;a<this.objPageInfo.nPageCount;a++){this.getThumbnailImage(a);}};ReportView.prototype.callGetThumbnailData=function(){return this.arrThumbnailImageList;};ReportView.prototype.callChangeRatioCombo=function(b){var a=null;if(b=="PageWidth"){a="pageWidth";}else{if(b=="WholePage"){a="pageHeight";}else{a=((b.replace("%",""))/100).toString();}}this.objPageInfo.strZoomRatio=a;this.objHeader.elmZoomSelect.value=this.objPageInfo.strZoomRatio;this.objHeader.changeRatioComobo();};ReportView.prototype.setUsePrintSubOptionFrame=function(a){this.isUsePrintSubOptionFrame=a;};ReportView.prototype.setPrintSubOptionFrameDetailString=function(b,a){this.strPrintSubOptionFrameDetailPdf=b;this.strPrintSubOptionFrameDetailHTML=a;};ReportView.prototype.setAdobeInfoMessage=function(a){if(a!=null&&a!=""){this.objAdobeMessage.isMessage=true;this.objAdobeMessage.strMessage=a;}};ReportView.prototype.setUseDownloadSubOptionFrame=function(a){this.isUseDownloadSubOptionFrame=a;};ReportView.prototype.setIsErrorSaveAlert=function(a){this.isErrorSaveAlert=a;};ReportView.prototype.setStrErrorSaveString=function(a){this.strErrorSaveString=a;};ReportView.prototype.setIsErrorSaveButtonRemove=function(a){this.isErrorSaveButtonRemove=a;};ReportView.prototype.setIsErrorSaveBrowser=function(a){this.isErrorSaveBrowser=a;};ReportView.prototype.setStrDownloadFormMethod=function(a){this.strDownloadFormMethod=a;};ReportView.prototype.setSaveFileName=function(a){this.strFileName=a;};ReportView.prototype.setReportDirectPrintButton=function(a,b){this.objDirectPrintInfo.isUse=a;this.objDirectPrintInfo.printType=b;};ReportView.prototype.callSaveFileDownLoad=function(i,a,h,b,g){if(this.objReportInfo.isEndReport){var f=new Object();f.name=i;if(h==1){f.pageType=1;f.startNum=1;f.endNum=this.objPageInfo.nPageCount;}else{if(h==2){f.pageType=2;f.startNum=this.objPageInfo.nSelectPageIndex+1;f.endNum=this.objPageInfo.nSelectPageIndex+1;}else{f.pageType=3;var d=1;var c=this.objPageInfo.nPageCount;if(arguments.length==5){if(g<b){if(g>0){d=g;}if(b<=c){c=b;}}else{if(b>0){d=b;}if(g<=c){c=g;}}}f.startNum=d;f.endNum=c;}}switch(a){case 1:f.exportType=1;f.option=this.objSaveExportOptionInfo.xls;break;case 2:f.exportType=2;f.option=this.objSaveExportOptionInfo.xlsx;break;case 3:f.exportType=3;f.option=this.objSaveExportOptionInfo.pdf;break;case 4:f.exportType=4;f.option=this.objSaveExportOptionInfo.hwp;break;case 5:f.exportType=5;f.option=this.objSaveExportOptionInfo.doc;break;case 6:f.exportType=6;f.option=this.objSaveExportOptionInfo.docx;break;case 7:f.exportType=7;f.option=this.objSaveExportOptionInfo.ppt;break;case 8:f.exportType=8;f.option=this.objSaveExportOptionInfo.html;break;case 9:f.exportType=9;f.option=this.objSaveExportOptionInfo.cell;break;case 10:f.exportType=10;f.option=this.objSaveExportOptionInfo.jpg;break;case 11:f.exportType=11;f.option=this.objSaveExportOptionInfo.txt;break;case 12:f.exportType=12;f.option=this.objSaveExportOptionInfo.tif;break;case 13:f.exportType=13;f.option=this.objSaveExportOptionInfo.multitif;break;case 14:f.exportType=14;f.option=this.objSaveExportOptionInfo.exceldata;break;case 15:f.exportType=15;f.option=this.objSaveExportOptionInfo.pptx;break;case 16:f.exportType=16;f.option=this.objSaveExportOptionInfo.brl;break;case 17:f.exportType=17;f.option=this.objSaveExportOptionInfo.show;break;default:break;}this.saveExportByType(f.exportType,f.startNum,f.endNum,f.name,f.option);}else{}};ReportView.prototype.setCustomSaveButton=function(b,a,d,c){this.objCustomSaveButtonInfo.isButtonHwp=b;this.objCustomSaveButtonInfo.isButtonXls=a;this.objCustomSaveButtonInfo.isButtonPdf=d;this.objCustomSaveButtonInfo.isButtonDoc=c;};ReportView.prototype.setDoubleClickEvent=function(a){this.objBody.objDblclickOp.isEvent=a;};ReportView.prototype.callGetReportKey=function(){return this.objReportInfo.strReportKey;};ReportView.prototype.callGetTotalPageCount=function(){return this.objPageInfo.nPageCount;};ReportView.prototype.callGetSlectedPageNumber=function(){return this.objPageInfo.nSelectPageIndex+1;};ReportView.prototype.callCreateUserProgress=function(){var a=document.createElement("div");a.className="user_progress";a.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;background-repeat:no-repeat;z-index:500;-webkit-touch-callout: none; -webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;";this.objTargetDOM.appendChild(a);this.elmProgess=a;};ReportView.prototype.callRemoveUserProgress=function(){if(null!=this.elmProgess){this.objTargetDOM.removeChild(this.elmProgess);this.elmProgess=null;}};ReportView.prototype.callErrorAlertUI=function(b,a,c,d){this.errorAlertUI(b,a,c,d);};ReportView.prototype.setStyle=function(b,a){switch(b){case"menu":this.objStyleInfo.strHeadStyle=a;break;case"main":this.objStyleInfo.strBodyStyle=a;break;case"save_button":this.objStyleInfo.strSaveButtonStyle=a;break;case"print_button":this.objStyleInfo.strPrintButtonStyle=a;break;case"hwp_button":this.objStyleInfo.strHWPButtonStyle=a;break;case"excel_button":this.objStyleInfo.strEXCELButtonStyle=a;break;case"pdf_button":this.objStyleInfo.strPDFButtonStyle=a;break;case"doc_button":this.objStyleInfo.strDOCButtonStyle=a;break;case"firstPage_button":this.objStyleInfo.strFirstButtonStyle=a;break;case"prev_button":this.objStyleInfo.strPrevButtonStyle=a;break;case"count_box":this.objStyleInfo.strCountBoxStyle=a;break;case"currentCount_box":this.objStyleInfo.strCurrentCountBoxStyle=a;break;case"totalCount_box":this.objStyleInfo.strTotalCountBoxStyle=a;break;case"next_button":this.objStyleInfo.strNextButtonStyle=a;break;case"lastPage_button":this.objStyleInfo.strLastButtonStyle=a;break;case"toc_button":this.objStyleInfo.strTOCButtonStyle=a;break;case"thumbnail_button":this.objStyleInfo.strThumbnailButtonStyle=a;break;case"zoomIn":this.objStyleInfo.strZoomInStyle=a;break;case"info_button":this.objStyleInfo.strInfoStyle=a;break;case"close_button":this.objStyleInfo.strCloseButtonStyle=a;break;default:break;}};ReportView.prototype.setCustomDesign=function(a){this.objStyleInfo.isCustomDesign=a;};ReportView.prototype.setHeaderHeight=function(a){this.objStyleInfo.strHeaderHeight=a;};ReportView.prototype.setHeaderButtonSize=function(a){this.objStyleInfo.strHeaderIconSize=a;};ReportView.prototype.setIsPopUpSaveDownload=function(a){this.isPopUpSaveDownload=a;};ReportView.prototype.setMobileMoveButtonTime=function(a){this.objBody.nMobileMoveButtonTime=a;};ReportView.prototype.setViewType=function(a){this.objOption.nViewType=a;};ReportView.prototype.setUseMemo=function(a){this.isUseMemo=a;};ReportView.prototype.setSearchWord=function(a){this.isSearchWord=a;};ReportView.prototype.setScrollView=function(a){this.isScrollView=a;};ReportView.prototype.setEndPageViewFunction=function(a){this.fnEndPageViewFunction=a;};ReportView.prototype.callGetVersionInfo=function(){this.debugMeg("클립리포트 v5.0   엔진 버전 : "+this.objReportInfo.strEngineVersion+" 뷰어 버전 : "+this.objReportInfo.strViewerVersion);alert("클립리포트 v5.0   엔진 버전 : "+this.objReportInfo.strEngineVersion+" 뷰어 버전 : "+this.objReportInfo.strViewerVersion);};ReportView.prototype.callGetReportKey=function(){this.debugMeg("클립리포트 v5.0 리포트키 : "+this.objReportInfo.strReportKey);return this.objReportInfo.strReportKey;};ReportView.prototype.callReportInfo=function(){this.reportInfo();};ReportView.prototype.setCrossDomainPDFPrint=function(a){this.isCrossDomainPDFPrint=a;};ReportView.prototype.callPDFPrint=function(){this.runPDFPrint(1,this.objPageInfo.nPageCount,false);};ReportView.prototype.callHTML5Print=function(){this.runHTML5Print(1,this.objPageInfo.nPageCount);};ReportView.prototype.setExePrintVersionInfo=function(a){this.exe_print_version=a;};ReportView.prototype.setExePrintFinishEvent=function(a){this.objExePrintEvent.ok=a;};ReportView.prototype.setExePrintCancelEvent=function(a){this.objExePrintEvent.cancel=a;};ReportView.prototype.setEXEPrintDownloadLink=function(a){this.strExeLink=a;};ReportView.prototype.exePrint=function(d,f,c,g,a,h,b){this.objExePrintStatus.isSet=true;this.objExePrintOption.isPrintPopup=d;this.objExePrintOption.printName=f;this.objExePrintOption.tray=c;this.objExePrintOption.startNumber=g;this.objExePrintOption.endNumber=a;this.objExePrintOption.copies=h;this.objExePrintOption.option=b;this.mCR_printEXEView();};ReportView.prototype.exeDirectPrint=function(){var d,f,c,g,a,h,b;if(arguments.length==7){d=arguments[0];f=arguments[1];c=arguments[2];g=arguments[3];a=arguments[4];h=arguments[5];b=arguments[6];}else{d=false;f=arguments[0];c=arguments[1];g=arguments[2];a=arguments[3];h=arguments[4];b=arguments[5];}this.objExePrintStatus.isSet=true;this.objExePrintOption.isPrintPopup=d;this.objExePrintOption.printName=f;this.objExePrintOption.tray=c;this.objExePrintOption.startNumber=g;this.objExePrintOption.endNumber=a;this.objExePrintOption.copies=h;this.objExePrintOption.option=b;this.printEXEDirect();};function docPageController(){this.arrPageNumberList=new Array();this.arrPageList=new Array();this.arrStyleList=new Array();this.arrSearchWordInfo=new Array();}docPageController.prototype.getPage=function(a){var c=this.arrPageNumberList.length;for(var b=0;b<c;b++){if(this.arrPageNumberList[b]==a){return this.arrPageList[b];}}return null;};docPageController.prototype.getStyle=function(a){var c=this.arrPageNumberList.length;for(var b=0;b<c;b++){if(this.arrPageNumberList[b]==a){return this.arrStyleList[b];}}return null;};docPageController.prototype.getLength=function(){var a=this.arrPageNumberList.length;return a;};docPageController.prototype.getIsPage=function(a){var c=this.arrPageNumberList.length;for(var b=0;b<c;b++){if(this.arrPageNumberList[b]==a){return true;}}return false;};docPageController.prototype.deletePage=function(a){var c=this.arrPageNumberList.length;for(var b=0;b<c;b++){if(this.arrPageNumberList[b]==a){this.arrPageNumberList.splice(b,1);this.arrPageList.splice(b,1);this.arrStyleList.splice(b,1);}}};docPageController.prototype.addPage=function(c,b,a){if(this.getIsPage(c)){}else{this.arrPageNumberList.push(c);this.arrPageList.push(b);this.arrStyleList.push(a);}return this.cleanPage(c);};docPageController.prototype.addPageDummy=function(c,b,a){if(this.getIsPage(c)){}else{this.arrPageNumberList.push(c);this.arrPageList.push(b);this.arrStyleList.push(a);}};docPageController.prototype.cleanPage=function(d){var c=this.arrPageNumberList.length;var a=null;if(c>6){for(var b=0;b<c;b++){if(this.arrPageNumberList[b]<d-3||this.arrPageNumberList[b]>d+3){a=this.arrPageNumberList[b];this.arrPageNumberList.splice(b,1)[0]=null;this.arrPageList.splice(b,1)[0]=null;this.arrStyleList.splice(b,1)[0]=null;break;}}}return a;};docPageController.prototype.clear=function(){this.arrPageNumberList.splice(0,this.arrPageNumberList.length);this.arrPageList.splice(0,this.arrPageList.length);this.arrStyleList.splice(0,this.arrStyleList.length);};docPageController.prototype.searchWordArrayClear=function(){this.arrSearchWordInfo.splice(0,this.arrSearchWordInfo.length);};docPageController.prototype.getSearchWordArrayCount=function(){return this.arrSearchWordInfo.length;};docPageController.prototype.getSearchWordInfo=function(a){return this.arrSearchWordInfo[a];};docPageController.prototype.getSelectedPageSearchWordInfo=function(b){var c=this.arrSearchWordInfo.length;var d=new Array();for(var a=0;a<c;a++){if(this.arrSearchWordInfo[a].pageNum==b){d.push(this.arrSearchWordInfo[a]);}}return d;};docPageController.prototype.searchWord=function(A,B){var x=0;this.searchWordArrayClear();var d=A.length;var C=this.arrPageList.length;for(var m=0;m<C;m++){var f=this.arrPageList[m].subSectionList.length;for(var b=0;b<f;b++){var o=this.arrPageList[m].subSectionList[b].controlPageList.length;for(var y=0;y<o;y++){var L=this.arrPageList[m].subSectionList[b].controlPageList.length;if(L>0){var w=this.arrPageList[m].subSectionList[b].controlPageList[y];if(w.type==0||w.type==40||w.type==41||w.type==42||w.type==45||w.type==46||w.type==47){if(w.type>0){var I=B.documentStorage[w.primaryName];if(null!=I){if(!I.visible&&w.type!=41&&w.type!=42){continue;}}}var n=w.textInfo.originalTextInfo.text;var g=n.length;var u=parseInt(g/d);var M=0;for(var K=0;K<u;K++){var D=n.toLowerCase().indexOf(A.toLowerCase(),M);if(D!=-1){var J=0;var z=0;if(D-16<0){J=0;}else{J=D-16;var q=n.indexOf(" ",D-16);if(q<D){J=q+1;}}if(D+d+10>g){z=g;}else{z=D+d+11;}var l={text:n.substring(J,D)+"<span style='color:Tomato;'>"+n.substring(D,D+d)+"</span>"+n.substring(D+d,z),pageNum:m+1,top:w.rect.top+w.subSection.area.top,left:w.rect.left+w.subSection.area.left,right:w.subSection.area.left+w.rect.right,bottom:w.subSection.area.top+w.rect.bottom,type:"label",number:x++,outterlineStyleKey:w.outterlineStyleKey,pageStyleKey:this.arrPageList[m].pageStyleKey};this.arrSearchWordInfo.push(l);if(g-D-d>d){M=D+d;}else{break;}}else{break;}}}else{if(w.type==3){var s=w.table.length;for(var k=0;k<s;k++){var p=w.table[k];var E=p.cellList.length;for(var F=0;F<E;F++){if(p.cellList[F].detailTextInfo!=null){var n=p.cellList[F].detailTextInfo.originalTextInfo.text;var g=n.length;var u=parseInt(g/d);var M=0;for(var K=0;K<u;K++){var D=n.toLowerCase().indexOf(A.toLowerCase(),M);if(D!=-1){var i=0;var h=0;var a=0;var c=0;var N=p.cellList[F].colSpan;var t=p.cellList[F].rowSpan;for(var r=0;r<k;r++){i=i+w.rowColArranger.rowHeightList[r];}for(var r=0;r<t;r++){c=c+w.rowColArranger.rowHeightList[k+r];}for(var G=0;G<F;G++){h=h+w.rowColArranger.columnWidthList[G];}for(var G=0;G<N;G++){a=a+w.rowColArranger.columnWidthList[F+G];}var J=0;var z=0;if(D-16<0){J=0;}else{J=D-16;var q=n.indexOf(" ",D-16);if(q<D){J=q+1;}}if(D+d+10>g){z=g;}else{z=D+d+11;}var l={text:n.substring(J,D)+"<span style='color:Tomato;'>"+n.substring(D,D+d)+"</span>"+n.substring(D+d,z),pageNum:m+1,top:w.rect.top+w.subSection.area.top+i,left:w.rect.left+w.subSection.area.left+h,right:w.subSection.area.left+w.rect.left+h+a,bottom:w.subSection.area.top+w.rect.top+i+c,type:"table",number:x++,outterlineStyleKey:w.outterlineStyleKey,pageStyleKey:this.arrPageList[m].pageStyleKey};this.arrSearchWordInfo.push(l);if(g-D-d>d){M=D+d;}else{break;}}else{break;}}}}}}else{if(w.type==10){var H=0;var v=0;var s=w.matrixHeader.rowList.length;for(var j=0;j<s;j++){v=v+w.matrixHeader.rowHeightList[j];}for(var k=0;k<s;k++){var p=w.matrixHeader.rowList[k];var E=p.cellList.length;if(k==0){for(var j=0;j<E;j++){H=H+w.matrixHeader.columnWidthList[j];}}for(var F=0;F<E;F++){if(p.cellList[F].detailTextInfo!=null){var n=p.cellList[F].detailTextInfo.originalTextInfo.text;var g=n.length;var u=parseInt(g/d);var M=0;for(var K=0;K<u;K++){var D=n.toLowerCase().indexOf(A.toLowerCase(),M);if(D!=-1){var i=0;var h=0;var a=0;var c=0;var N=p.cellList[F].colSpan;var t=p.cellList[F].rowSpan;for(var r=0;r<k;r++){i=i+w.matrixHeader.rowHeightList[r];}for(var r=0;r<t;r++){c=c+w.matrixHeader.rowHeightList[k+r];}for(var G=0;G<F;G++){h=h+w.matrixHeader.columnWidthList[G];}for(var G=0;G<N;G++){a=a+w.matrixHeader.columnWidthList[F+G];}var J=0;var z=0;if(D-16<0){J=0;}else{J=D-16;var q=n.indexOf(" ",D-16);if(q<D){J=q+1;}}if(D+d+10>g){z=g;}else{z=D+d+11;}var l={text:n.substring(J,D)+"<span style='color:Tomato;'>"+n.substring(D,D+d)+"</span>"+n.substring(D+d,z),pageNum:m+1,top:w.rect.top+w.subSection.area.top+i,left:w.rect.left+w.subSection.area.left+h,right:w.subSection.area.left+w.rect.left+h+a,bottom:w.subSection.area.top+w.rect.top+i+c,type:"crossTab",number:x++,outterlineStyleKey:w.outterlineStyleKey,pageStyleKey:this.arrPageList[m].pageStyleKey};this.arrSearchWordInfo.push(l);if(g-D-d>d){M=D+d;}else{break;}}else{break;}}}}}s=w.matrixColumn.rowList.length;for(var k=0;k<s;k++){var p=w.matrixColumn.rowList[k];var E=p.cellList.length;for(var F=0;F<E;F++){if(p.cellList[F].detailTextInfo!=null){var n=p.cellList[F].detailTextInfo.originalTextInfo.text;var g=n.length;var u=parseInt(g/d);var M=0;for(var K=0;K<u;K++){var D=n.toLowerCase().indexOf(A.toLowerCase(),M);if(D!=-1){var i=0;var h=0;var a=0;var c=0;var N=p.cellList[F].colSpan;var t=p.cellList[F].rowSpan;for(var r=0;r<k;r++){i=i+w.matrixColumn.rowHeightList[r];}for(var r=0;r<t;r++){c=c+w.matrixColumn.rowHeightList[k+r];}for(var G=0;G<F;G++){h=h+w.matrixColumn.columnWidthList[G];}for(var G=0;G<N;G++){a=a+w.matrixColumn.columnWidthList[F+G];}var J=0;var z=0;if(D-16<0){J=0;}else{J=D-16;var q=n.indexOf(" ",D-16);if(q<D){J=q+1;}}if(D+d+10>g){z=g;}else{z=D+d+11;}var l={text:n.substring(J,D)+"<span style='color:Tomato;'>"+n.substring(D,D+d)+"</span>"+n.substring(D+d,z),pageNum:m+1,top:w.rect.top+w.subSection.area.top+i,left:H+w.rect.left+w.subSection.area.left+h,right:H+w.subSection.area.left+w.rect.left+h+a,bottom:w.subSection.area.top+w.rect.top+i+c,type:"crossTab",number:x++,outterlineStyleKey:w.outterlineStyleKey,pageStyleKey:this.arrPageList[m].pageStyleKey};this.arrSearchWordInfo.push(l);if(g-D-d>d){M=D+d;}else{break;}}else{break;}}}}}s=w.matrixRow.rowList.length;for(var k=0;k<s;k++){var p=w.matrixRow.rowList[k];var E=p.cellList.length;for(var F=0;F<E;F++){if(p.cellList[F].detailTextInfo!=null){var n=p.cellList[F].detailTextInfo.originalTextInfo.text;var g=n.length;var u=parseInt(g/d);var M=0;for(var K=0;K<u;K++){var D=n.toLowerCase().indexOf(A.toLowerCase(),M);if(D!=-1){var i=0;var h=0;var a=0;var c=0;var N=p.cellList[F].colSpan;var t=p.cellList[F].rowSpan;for(var r=0;r<k;r++){i=i+w.matrixRow.rowHeightList[r];}for(var r=0;r<t;r++){c=c+w.matrixRow.rowHeightList[k+r];}for(var G=0;G<F;G++){h=h+w.matrixRow.columnWidthList[G];}for(var G=0;G<N;G++){a=a+w.matrixRow.columnWidthList[F+G];}var J=0;var z=0;if(D-16<0){J=0;}else{J=D-16;var q=n.indexOf(" ",D-16);if(q<D){J=q+1;}}if(D+d+10>g){z=g;}else{z=D+d+11;}var l={text:n.substring(J,D)+"<span style='color:Tomato;'>"+n.substring(D,D+d)+"</span>"+n.substring(D+d,z),pageNum:m+1,top:v+w.rect.top+w.subSection.area.top+i,left:w.rect.left+w.subSection.area.left+h,right:w.subSection.area.left+w.rect.left+h+a,bottom:v+w.subSection.area.top+w.rect.top+i+c,type:"crossTab",number:x++,outterlineStyleKey:w.outterlineStyleKey,pageStyleKey:this.arrPageList[m].pageStyleKey};this.arrSearchWordInfo.push(l);if(g-D-d>d){M=D+d;}else{break;}}else{break;}}}}}s=w.matrixSummarized.rowList.length;for(var k=0;k<s;k++){var p=w.matrixSummarized.rowList[k];var E=p.cellList.length;for(var F=0;F<E;F++){if(p.cellList[F].detailTextInfo!=null){var n=p.cellList[F].detailTextInfo.originalTextInfo.text;var g=n.length;var u=parseInt(g/d);var M=0;for(var K=0;K<u;K++){var D=n.toLowerCase().indexOf(A.toLowerCase(),M);if(D!=-1){var i=0;var h=0;var a=0;var c=0;var N=p.cellList[F].colSpan;var t=p.cellList[F].rowSpan;for(var r=0;r<k;r++){i=i+w.matrixSummarized.rowHeightList[r];}for(var r=0;r<t;r++){c=c+w.matrixSummarized.rowHeightList[k+r];}for(var G=0;G<F;G++){h=h+w.matrixSummarized.columnWidthList[G];}for(var G=0;G<N;G++){a=a+w.matrixSummarized.columnWidthList[F+G];}var J=0;var z=0;if(D-16<0){J=0;}else{J=D-16;var q=n.indexOf(" ",D-16);if(q<D){J=q+1;}}if(D+d+10>g){z=g;}else{z=D+d+11;}var l={text:n.substring(J,D)+"<span style='color:Tomato;'>"+n.substring(D,D+d)+"</span>"+n.substring(D+d,z),pageNum:m+1,top:v+w.rect.top+w.subSection.area.top+i,left:H+w.rect.left+w.subSection.area.left+h,right:H+w.subSection.area.left+w.rect.left+h+a,bottom:v+w.subSection.area.top+w.rect.top+i+c,type:"crossTab",number:x++,outterlineStyleKey:w.outterlineStyleKey,pageStyleKey:this.arrPageList[m].pageStyleKey};this.arrSearchWordInfo.push(l);if(g-D-d>d){M=D+d;}else{break;}}else{break;}}}}}}}}}}}}};window.mCR_objLanguageMap={lic_error:["리포트 서버 라이센스에 문제가 있습니다.","Report a problem with the server license.","レポートサーバーのライセンスに問題があります。","报告服务器许可证出现问题。"],report_error:["잘못된 결과입니다.","Invalid results","結果が正しくありません。","结果错误。"],report_error2:["보고서 양식이 잘못되었습니다.(페이지가 없습니다.)","Report form is incorrect. (There is no page.)","レポートフォームが間違っています。（ページがありません。）","报告的形式不正确。 （没有页。）"],install_error:["리포트 서버 설치에 문제가 있습니다.","There is a problem with the report server installation.","レポートサーバーのインストールに問題があります。","报告服务器的安装出现问题。"],sesstion_error:["리포트파일이 삭제되어 찾을 수 없습니다.","This session has been terminated.","セッションが終了しました。","会话结束。"],link_error:["리포트 서버와의 연결에 실패하였습니다.","It failed to connect to the report server.","これは、レポートサーバーへの接続に失敗しました。","它无法连接到报表服务器。"],img_alt:["리포트 본문 입니다.","The body of the report.","レポートの本文です。","报告正文。"],save:["저장","Save","保存","保存"],ignore:["무시","Ignore","無視","忽略"],cancel:["취소","Cancel","キャンセル","取消"],reset:["초기화","Reset","リセット","重置"],pdf_save:["PDF 저장","PDF file","PDF形式で保存","保存成PDF文件"],excel_save:["엑셀 저장","Excel file","エクセル形式で保存","保存成表格文件"],hwp_save:["한글 저장","HWP file","ハングル形式で保存","保存成hwp文件"],rtf_save:["RTF 저장","RTF file","RTF形式で保存","保存成RTF文件"],ppt_save:["PPT 저장","PPT file","PPT形式で保存","保存成PPT文件"],html_save:["HTML 저장","HTML file","HTML形式で保存","保存成HTML文件"],hancell_save:["한셀 저장","Hancell file","ハンセル形式で保存","保存成Hancell文件"],hanshow_save:["한쇼 저장","Hanshow file","Hanshow file","保存成Hanshow文件"],html5_save:["HTML5 저장","HTML5 file","HTML5形式で保存","保存成HTML 5文件"],doc_save:["DOC 저장","DOC file","DOC形式で保存","保存成DOC文件"],jpg_save:["JPG 저장","JPG file","JPG形式で保存","保存成JPG文件"],txt_save:["TXT 저장","TXT file","TXT形式で保存","保存成TXT文件"],tif_save:["TIF 저장","TIF file","TIF形式で保存","保存成TIF文件"],brl_save:["BRL 저장","BRL file","BRL形式で保存","保存成BRL文件"],multitif_save:["MultiTIF 저장","MultiTIF file","MultiTIF形式で保存","保存成MultiTIF文件"],exceldata_save:["엑셀(data only) 저장","Excel(data only) file","Excel(data only)形式で保存","保存成Excel(data only)文件"],print:["인쇄","Print","印刷","打印"],doodle:["형광펜","highlighter","蛍光ペン","荧光笔"],first_page:["첫 페이지","First Page","先頭ページ","首页"],prv_page:["이전 페이지","Previous Page","前のページ","上一页"],page:["페이지","Page","ページ","页数"],total_page:["전체 페이지","All Page","全てのページ","全部页"],next_page:["다음 페이지","Next Page","次のページ","下一页"],last_page:["마지막 페이지","Last Page","最後のページ","末页"],zoomIn:["화면 비율 선택","Zoom","画面の比率を選択","选择画面分配率"],report_info:["등록 정보","Information","登録情報","注册信息"],close:["닫기","Close","閉じる","关闭"],clipReport:["클립리포트","Clipreport","Clipreport","Clipreport"],version:["버전","Version","バージョン","版本"],webversion:["뷰어","Viewer","Viewer","Viewer"],build:["빌드","Build","ビルド","新建"],report_info_text:["경고:이 컴퓨터 프로그램은 저작권법과 국제 협약의 보호를 받습니다.\n이 프로그램의 전부 혹은 일부를 무단으로 복제, 배포하는 행위는 민사\n및 형사법에 의해 엄격히 규제되어 있으며 기소의 사유가 됩니다.","This program is ClipReport4.0 viewer that\nwas develop and deploy by the Clipsoft","警告:このコンピュータープログラムは、著作権法と国際条約による保護を受けています。\nこのプログラムの全部若しくは一部を無断で複製、配布する行為は、民事\n及び刑事法により厳しく規制されており起訴事由となります。","警告：本计算机程序受著作权法和国际协议的保护。\n任意复制、发放本程序的全部或部分的行为严格受到民事\n和刑事法的管制，构成起诉的事由。"],ok:["확인","Ok","確認","确定"],fileType:["파일형식","File Type","ファイル形式","文件形式"],printType:["인쇄방식","Type","印刷方法","打印方式"],propertys:["옵션수정","Settings","オプションの修正","修改选项"],fileName:["파일명","Location","ファイル名","文件名"],save_range:["저장범위","Range","保存範囲","保存范围"],from:["부터"," from"," から","从"],to:["까지"," to"," まで","至"],currentPage:["현재 페이지","Current Page","現在のページ","当前页"],page_designation:["페이지 지정","Page","ページ指定","保存页"],NofC:["매수","Number of Copies","部数","张"],print_info:["인쇄정보","Information","印刷情報","打印信息"],print_info2:["인쇄 안내","Information","印刷案内","打印说明"],print_range:["인쇄범위","Range","印刷範囲","打印范围"],printName_validation:["파일이름이 올바르지 않습니다.","File name is incorrect.","ファイル名が正しくありません。","文件名不正确。"],printNum_validation:["저장범위의 지정 값이 올바르지 않습니다.","The specified value of the storage range is incorrect.","保存範囲に指定した値が正しくありません。","保存范围的指定值不正确。"],sheet_type:["시트구분","Sheet Type","シートの区分け","表格区分"],sheet_type1:["페이지 마다","Pages","ページ毎に","每页"],sheet_type2:["하나의 시트","One Sheet","一つのシート","一个表格"],sheet_type3:["하나의 시트(페이지 영역 무시)","One Sheet(igore a page layout)","一つのシート(ページ領域を無視)","一个表格(忽略页面布局)"],sheet_type4:["리포트 마다(페이지 영역 무시)","One Sheet for each report(ignore a page layout)","レポート毎に","每份报告"],sheet_type5:["리포트 마다","One Sheet for each report","各レポートの一枚","一张纸上为每个报表"],merge_cell:["셀 합치기","Merge Cells","セルの結合","合并单元格"],merge_EmptyCell:["공백 셀일 경우 합치기","Merge blank cells","空白セルの場合結合","合并空白单元格"],cell_Separated:["페이지 크기로 셀 분리","Split row at the end of each page","ページのサイズに合わせてセルを分離","按照页面大小拆分单元格"],rightToLeft:["열이 오른쪽에서 왼쪽으로 진행","Display a sheet in a RTL(Right-to-left) layout","列番号を右から左へ表示","纵列自由向左进行"],fitToPageWhenPrinting:["출력시 페이지 맞춤","Fit page at the time of output","出力時のページ合わせる","在输出时适合页面"],cellSizeRatio:["셀 크기 비율","The ratio of a cell's size","セルサイズの比率","单元格大小比例"],cellWidth:["가로 비율","Column","横比","横向比例"],cellHeight:["세로 비율","Row","縦比","纵向比例"],rangeError:["좌표 오차 범위","Error Range","座標誤差の範囲","坐标误差范围"],displayFormat:["일반 표시형식 처리","Format Cells","一般表示形式で処理","常规显示形式处理"],text:["텍스트","Text","テキスト","文本"],normal:["일반","General","一般","一般"],fix:["Fix","Fix","Fix","Fix"],minimum:["Minimum","Minimum","Minimum","Minimum"],removeHyperlink:["하이퍼링크 제거","removeHyperlink","ハイパーリンクの削除","刪除超鏈接"],hwpDownlodaInfo:["본 제품은 한글과컴퓨터의 한글 문서 파일(.hwp) 공개 문서를 참고하여 개발하였습니다.","This product was developed by referring to the Korean language document file (.hwp) public document of the computer.","This product was developed by referring to the Korean language document file (.hwp) public document of the computer.","This product was developed by referring to the Korean language document file (.hwp) public document of the computer."],allowedToPrint:["HTML 인쇄 사용 가능합니다.","HTML Printing can be used.","HTML Printing can be used.","HTML Printing can be used."],notAllowedToPrint:["HTML 인쇄 사용 불가능합니다.","HTML Printing is not available.","HTML Printing is not available.","HTML Printing is not available."],programsAllowedToPrint:["IE9 이상, mac safari, chrome, edge, opera, firefox 지원","IE9 or higher, mac safari, chrome, edge, opera, firefox support","IE9 or higher, mac safari, chrome, edge, opera, firefox support","IE9 or higher, mac safari, chrome, edge, opera, firefox support"],repeatPageSectionWhenAllSectionInOneSheet:["페이지 머리글/바닥글 반복","Repeat page the header/the footer","Repeat page the header/the footer","Repeat page the header/the footer"],outputPageSectionMethod:["페이지 머리글/바닥글","page the header/the footer","page the header/the footer","page the header/the footer"],none:["저장안함","None","None","None"],atOnce:["한번만","AtOnce","AtOnce","AtOnce"],repeatAtEachPage:["페이지 마다","RepeatAtEachPage","RepeatAtEachPage","RepeatAtEachPage"],useCodeX:["검증용 바코드 사용(CodeX)","Using Barcode For Verification (CodeX)","Using Barcode For Verification (CodeX)","Using Barcode For Verification (CodeX)"],save_error:["아이폰, 아이패드의 크롬브라우저와 카카오앱, 네이버앱, 다음앱에서 저장기능을 사용할 수 없습니다.","You cannot use the save function in the Chrome browser and Kakao App of iPhone and iPad, Naver App, and Daum App.","You cannot use the save function in the Chrome browser and Kakao App of iPhone and iPad, Naver App, and Daum App.","You cannot use the save function in the Chrome browser and Kakao App of iPhone and iPad, Naver App, and Daum App."],printRate:["인쇄 확대/축소 비율","Zoom Rate","印刷拡大/縮小比率","打印放大/缩小比例"],widthError:["가로 비율의 설정값이 올바르지 않습니다.","Setting value of the Column is not correct.","横比の設定値が正しくありません。","横向比例的设定值不正确。"],heightError:["세로 비율의 설정값이 올바르지 않습니다.","Setting value of the Row is not correct.","縦比の設定値が正しくありません。","纵向比例的设定值不正确。"],widthErrorValue:["가로 비율의 설정값은 (50 ~ 200) 가능합니다.","Setting value of the Column, ( 50-200 ) is possible.","設定可能な横比の値は(50 ~ 200)です。","横向比例的设定值可在(50~200)范围内。"],heightErrorValue:["세로 비율의 설정값은 (50 ~ 200) 가능합니다.","Setting value of the Row, ( 50-200 ) is possible.","設定可能な縦比の値は(50 ~ 200)です。","纵向比例的设定值可在(50~200)范围内。"],coordinateError:["좌표 오차 범위의 설정값이 올바르지 않습니다.","Setting value of the error range of coordinates is incorrect.","座標誤差範囲の設定値が正しくありません。","坐标误差范围的设定值不正确。"],printError:["인쇄 확대/축소 비율의 설정값이 올바르지 않습니다.","Setting of print enlargement / reduction ratio is not correct.","印刷拡大/縮小比率の設定値が正しくありません。","打印放大/缩小比例的设定值不正确。"],printErrorValue:["인쇄 확대/축소 비율의 설정값은 (10 ~ 400) 가능합니다.","Setting of print enlargement / reduction ratio , ( 10-400 ) is possible.","設定可能な印刷拡大/縮小比率の値は(10 ~ 400)です。","打印放大/缩小比例可在(10~400)范围内。"],hwpExportMethod:["저장 방식","Storage method","保存方式","保存方法"],splitPageOnListTableOnly:["페이지 나눔","Page split","ページ分割","页面师"],listTableOnly:["표만 나열하기","ListTableOnly","切符だけリストする","要只列出票"],fixSize:["크기 고정","Locks controls","サイズを固定","固定尺寸"],allowOverlay:["겹침 허용","Overlay","重ね合わせを許可","允许重叠"],setPageBottomMarginToZero:["페이지 바닥 여백을 0으로 설정","Set the bottom margin of the page to 0","ページ下部の余白を「０」に設定","页脚空白设为0"],pageBottomMarginApplicationRate:["페이지 바닥 여백 적용비율","Application rate of margin","余白の適用率","保证金的应用率"],outputLikeWord:["글자처럼 출력","In Line with Text","文字のように出力","打印文字"],tableSplit:["쪽 영역에서 표 나눔","Split Table","改ページ領域でテーブルを分割","页域内拆分表"],Split:["나눔","Split Table","分割","拆分"],cellSplit:["셀 단위로 나눔","Split Table by row","セル単位に分割","以单元格单位拆分"],noneSplit:["나누지 않음","Do not split","分割しない","不拆分"],defaultCharGap:["기본 자간","Default a character spacing","基本カーニング","基本字间距"],charRatio:["장평","Character Ratio","字送り","字符比率"],lineSpaceRate:["줄간격 비율","Ratio of line spacing","行間隔の比率","行距的比率"],putCheckboxIntoCell:["셀 안에 체크박스 이미지로 넣기","Place a checkbox in a cell","セル内にチェックボックスを挿入","在单元格中添加复选框"],splitTextByLine:["문자열을 여러줄로 나눠서 표현","Split a multi-line text into lines.","テキストをライン別に分けて表示","分行显示文本"],defaultCharGapError:["기본 자간의 설정값이 올바르지 않습니다.","Setting value of the Default a character spacing is not correct.","設定した基本カーニング値が正しくありません。","基本字间距的设定值不正确。"],defaultCharGapValueError:["기본 자간의 설정값은 (-50 ~ 50) 가능합니다.","Setting value of the Default a character spacing, ( -50 ~ 50 ) is possible.","設定可能な基本カーニング値は(-50 ~ 50)です。","基本字间距的设定值可在(-50 ~ 50)范围内。"],defaultCharGapValue2Error:["기본 자간의 설정값은 (-3.0 ~ 3.0) 가능합니다.","Setting value of the Default a character spacing, ( -3.0 ~ 3.0 ) is possible.","設定可能な基本カーニング値は(-3.0 ~ 3.0)です。","基本字间距的设定值可在(-3.0 ~ 3.0)范围内。"],charRatioError:["장평의 설정값이 올바르지 않습니다.","Setting value of the Character Ratio is not correct.","設定した字送り値が正しくありません。","字符比率的设定值不正确。"],charRatioValueError:["장평의 설정값은 (50 ~ 200) 가능합니다.","Setting value of the Character ratio , ( 50-200 ) is possible.","設定可能な字送り値は(50 ~ 200)です。","字符比率的设定值可在(50 ~ 200)范围内。"],bottomMarginError:["여백 적용비율의 설정값이 올바르지 않습니다.","The setting value of the margin application rate is incorrect.","余白の適用率の設定値が正しくありません。","保证金的应用率的设定值是不正确的。"],bottomMarginValueError:["여백 적용비율의 설정값은 (1 ~ 100) 가능합니다.","The setting value of the margin application rate can be (1 to 100).","余白の適用率の設定値は、（1〜100）が可能です。","余量的施用率的设定值，就可以（1至100）。"],splitTextLine:["문자열을 여러 줄로 나누어 표현","Split a multi-line text into lines","文字列を複数行に分けて表示","分多行显示字符串"],processAsUnicode:["유니코드로 문자열을 처리","A text is encoded in Unicode format","文字列をユニコードとして処理","用字符编码处理字符串"],processEqualAlign:["균등분할 정렬 처리","Convert an equal alignment into","均等割付の整列指定","均等拆分排列"],soLeft:["왼쪽 정렬","Left","左揃え","靠左排列"],soCenter:["가운데 정렬","Center","中央揃え","居中排列"],soRight:["오른쪽 정렬","Right","右揃え","靠右排列"],soBoth:["양쪽 정렬","Both","両端揃え","两边对齐"],insertTableWrapper:["표를 감싸는 객체 삽입","Whether or not to insert an object that wraps around the table","テーブルを包み込むオブジェクトを挿入するかどうか","是否要插入的对象环绕表"],tableWrapperBottomGap:["표를 감싸는 객체의 아래쪽 여백","The bottom margin of an object(a control) including a table","テーブルを囲っているオブジェクト下部の余白","表格周围个体的底部空白"],tableWrapperBottomGapError:["표의 아래쪽 여백 설정값이 올바르지 않습니다.","Setting value of the margin below is not correct.","テーブル下部の余白の設定値が正しくありません。","表格底部空白的设定值不正确。"],tableWrapperBottomGapValueError:["표의 아래쪽 여백 설정값은 (0 ~ 500) 가능합니다.","Setting value of the margin below , (0 ~ 500) is possible.","テーブル下部の余白の設定値は(0 ~ 500)です。","表格底部空白的设定值可在(0~500)范围内。"],pageSplite:["페이지를 분할하여 저장","Save by dividing the page","ページを区切って保存","保存拆分页"],pageSpliteCount:["분할 수","Count","分割数","拆分数"],password:["문서암호","Password","文書パスワード","文件密码"],textToImage:["문자를 이미지로 표현","Text To Image","文字を画像として表示","图像显示文本"],importOriginImage:["원본 이미지 사용","Use Original Image","原画像を使用","使用原图"],pageSpliteCountError:["분할 수의 설정값이 올바르지 않습니다.","Setting value of the Count is not correct.","分割数の設定値が正しくありません。","拆分数的设定值不正确。"],html5page:["페이지 라인 표시","Show page breaks","ページ枠を表示","显示分页符号"],dpi:["이미지 해상도","DPI","DPI","DPI"],dpiError:["DPI의 설정값이 올바르지 않습니다.","Setting value of the DPI is not correct.","DPIの設定値が正しくありません。","DPI的设定值不正确。"],mergeTable:["이웃한 표 병합","Whether to merge the adjacent table","隣接したテーブルをマージするかどうか","是否合并相邻表"],ignoreLineSpace:["행간 무시","Line spacing ignored","行間無視","行间距忽略"],positionRelTo:["좌표 기준","Coordinate criteria","座標基準","协调标准"],paper:["종이","paper","紙","纸"],paragraph:["문단","paragraph","段落","段落"],fitShapeToText:["도형을 텍스트 크기에 맟춤","fitShapeToText","図形をテキストのサイズにカスタマイズされた","对文本的大小形状定制"],TableRowHeightSort:["표의 행의 높이 설정","TableRowHeightSort","表の行の高さを設定","设置在表中的行的高度"],rotate90:["90도 회전","Rotate 90 degrees","Rotate 90 degrees","Rotate 90 degrees"],dpiX:["DPIX","DPIX","DPIX","DPIX"],dpiY:["DPIY","DPIY","DPIY","DPIY"],quality:["품질(1~100)","Quality(1~100)","Quality(1~100)","Quality(1~100)"],qualityError:["품질의 설정값이 올바르지 않습니다.","Setting value of the Default a character spacing is not correct.","設定した基本カーニング値が正しくありません。","基本字间距的设定值不正确。"],qualityErrorValue:["품질의 설정값은 (1 ~ 100) 가능합니다.","Setting value of the Character ratio , ( 1 ~ 100 ) is possible.","設定可能な字送り値は(1 ~ 100)です。","字符比率的设定值可在(1 ~ 100)范围内。"],grayScale:["흑백설정 여부","GrayScale","GrayScale","GrayScale"],toc:["목차","toc","toc","toc"],thumbnail:["썸네일","thumbnail","thumbnail","thumbnail"],moveToMemoPage:["메모페이지로 이동","Move to Memo Page","Move to Memo Page","Move to Memo Page"],Memo:["메모생성","Create Memo","Create Memo","Create Memo"],toggleMemoOpacity:["메모 투명도 조절","Toggle Memo Opacity","Toggle Memo Opacity","Toggle Memo Opacity"],memoOption:["메모 상세 설정","Memo Option","Memo Option","Memo Option"],returnFromMemoPage:["메모 페이지로부터 돌아가기 ","Return From Memo Page","Return From Memo Page","Return From Memo Page"],insertPageNumber:["페이지 넘버 삽입","Insert Page Number","Insert Page Number","Insert Page Number"],mergeAllTablesOnListTableOnly:["모든 테이블 병합하기","Merge All Tables On List Table Only","Merge All Tables On List Table Only","Merge All Tables On List Table Only"],insertLabelWithTextOnListTableOnly:["글상자를 텍스트로 삽입","Insert Label With Text On List Table Only","Insert Label With Text On List Table Only","Insert Label With Text On List Table Only"],isTransparentMode:["표의 모든 배경 투명으로 표시","All backgrounds of the table are transparent","All backgrounds of the table are transparent","All backgrounds of the table are transparent"],moveToSearchPage:["검색페이지로 이동","Move to Search Page","Move to Search Page","Move to Search Page"],searchContent:["검색내용","Search Content","Search Content","Search Content"],search:["검색","Search","Search","Search"],orderOfListAndListBySearched:["목록순서 및 검색된목록","Order of List and List by Searched","Order of List and List by Searched","Order of List and List by Searched"],moveUpOfList:["목록에서 위로 이동","Move Up of List","Move Up of List","Move Up of List"],moveDownOfList:["목록에서 아래로 이동","Move Down of List","Move Down of List","Move Down of List"],toggleListSize:["목록 크기 조절","Toggle List Size","Toggle List Size","Toggle List Size"],languageInfo:["kr","en","jp","cn"],adobe9Info:["현재 Adobe Reader 9 버전이 설치되어 있습니다.","Version of Adode Reader 9 is installed currently .","現在、Adobe Reader 9がインストールされています。","当前已安装了Adobe Reader 9版本。"],adobe9Info2:["정상적인 인쇄를 사용하기 위해서는 Adode Reader 10 버전 이상을 설치하여야 합니다.","To use the normal printing , you need to install the version Adode Reader 10 and later.","正常に印刷するためには、Adode Reader 10以上をインストールする必要があります。","正常打印必须安装Adobe Reader 10以上的版本。"],adobe9Info3:["현재 사용 중이신 브라우져의 창을 종료 한 후 아래의 사이트를 통하여 설치 하시기 바랍니다.","After the completion of the browser window now gotten use it , please install via the following site .","現在ご利用中のブラウザを閉じた後、下記のサイトからインストールして下さい。","请关闭正在使用的浏览器窗口，通过下方网站安装。"],adobe9Info4:["설치 없이 인쇄를 원하신다면 저장 버튼을 이용하여 파일을 저장 후 인쇄 하실 수 있습니다.","After you save the file by using the Save button if you want to print without installing , you can print .","インストールせずに印刷したい場合は、[保存]をクリックしファイルを保存してから印刷して下さい。","若想不安装，直接打印，可以使用保存按钮保存文件后再打印。"],adobe9Info5:["현재 브라우져에서 Adobe Reader 찾을 수 없습니다.","We were not able to find Adode Reader in the browser now .","現在のブラウザで、Adobe Readerは見つかりません。","用当前的浏览器找不到Adobe Reader。"],adobePrintStatus:["인쇄 가능합니다.","Printable.","印刷可能です。","可打印的。"],adobeInstallStatus:["PDF 설치 여부","Whether to install PDF","PDFインスト ルするかどうか","是否安 PDF"],adobeInstallStatusOk:["확인","Ok","Ok","Ok"],adobeInstallStatusFail:["미설치","Not installed","未設置","未安"],adobeVersionStatus:["PDF 버전 정보","PDF version information","PDFバ ジョン情報","PDF版本信息"],adobeVersionFailMsg:["확인이 불가능합니다.","I can't confirm.","確認できません。","我无法  。"],exeInfo1:["인쇄에 필요한 프로그램을 찾을 수 없습니다.","I could not find the program you need to print.","印刷に必要なプログラムを見つけることができませんでした。","我找不到你需要打印的程序。"],exeInfo2:["아래에 링크를 통하여 프로그램을 설치하시기 바랍니다.","Please install the program via the link below.","下にリンクを介してプログラムをインストールしてください。","请通过以下链接安装该程序。"],exeInfo3:["설치가 완료되면 다시 인쇄 하실 수 있습니다.","When the installation is complete, you can re-print.","インストールが完了すると、再印刷することができます。","当安装完成后，可以重新打印。"],exeInfo4:["현재 사용중이신 인쇄 프로그램은 업데이트가 필요합니다.","Print program of your current use, the update is required.","現在ご使用の印刷プログラムは、更新が必要になります。","当前的使用的打印程序，则需要进行更新。"],printLimit1:["현재 리포트에 대한 인쇄 페이지 수가 많습니다.","Print number of pages of the current report is large.","現在のレポートの印刷ページ数が多すぎます。","当前报告打印页数多。"],printLimit2:["페이지가 많을 경우 속도 저하의 문제가 될 수 있으므로 PDF 저장 인쇄를 권장하고 있습니다.","If the page is large , because there is that the speed reduction of the problems , PDF save , I recommends printing .","ページが多い場合、速度が低下することがあるためPDF形式で保存、印刷することをお勧めします。","页数过多可能减低速度，建议保存成为PDF文件后打印。"],printSet1:["처음 인쇄를 시작하셨다면 브라우져의 설정이 필요합니다.","If this is the first time you start printing you will need to set the browser .","初めて印刷する場合は、ブラウザの設定が必要です。","首次打印时需要设定浏览器。"],printSet2:["브라우저의 메뉴에 파일 -> 페이지설정 사용하여 여백을 모두 0, 머리글, 바닥글 사용 안 함으로 설정하시고 저장하시면 됩니다.","File to the browser menu - > 0 the margin of using the settings of the page , the header , it is the footer disabled to save .","ブラウザメニューのファイル -> ページ設定で余白を全て「0」にし, 「ヘッダーとフッターを使用しない」に設定してから保存して下さい。","在浏览器菜单中选择文件->页面设定，将空白全部设为0，不使用页眉和页脚，保存即可。"],printSet3:["다음 인쇄 사용시 이 팝업을 원하지 않을 경우 표시 안함","It does not want to appear in the case you do not want pop-up at the next printing use","次回印刷する際、このポップアップ画面の表示を望まない場合は表示しない。","若下次打印时不希望看到此弹出窗口，将不显示。"],pdfPrintLimit1:["현재 사용 중이신 브라우져는 팝업창의 인쇄화면을 제공하고 있습니다.","Currently gotten your browser offers a print screen of the pop-up.","現在ご使用いただいてブラウザはポップアップの印刷画面を提供しています。","目前得到您的浏览器提供的弹出打印屏幕。"],pdfPrintLimit2:["아래의 확인 버튼을 누르시면 팝업 인쇄창을 확인 하실 수 있습니다.","When you press the [OK] button below, you will be able to confirm the pop-up print window.","下の[OK]ボタンを押すと、ポップアップ印刷ウィンドウを確認することができます。","当您按下下面的[确定]按钮，你将能够确认弹出打印窗口。"],pdfPrintLimit3:["현재 사용 중이신 Edge Browser는 팝업창의 인쇄화면을 제공하고 있습니다. 만약 Adobe Reader가 없다면 PDF 파일로 다운로드 됩니다.","Currently gotten your browser offers a print screen of the pop-up. If there is no Adobe Reader, it will be downloaded as a PDF file.","現在ご使用いただいてブラウザはポップアップの印刷画面を提供しています。もしAdobe Readerがない場合は、PDFファイルとしてダウンロードされます。","目前得到您的浏览器提供的弹出打印屏幕。如果没有Adobe Reader的，它会下载一个PDF文件。"],pdfPrintLimit4:["아래의 확인 버튼을 누르시면 확인 하실 수 있습니다.","You can check by pressing the [OK] button below.","下の[OK]ボタンを押すと確認することができます。","您可以检查按下面的[确定]按钮。"],waitMsg:["지금은 사용자가 많아 잠시 지연되고 있습니다.","There are so many users now that it is delaying for a while.","There are so many users now that it is delaying for a while.","There are so many users now that it is delaying for a while."],exeInfo0:["exe인쇄 가능합니다.","exe printable.","exe printable.","exe printable."],exeInfo5:["exe인쇄 설치 확인 중 입니다.","Checking exe print installation.","Checking exe print installation.","Checking exe print installation."],clipReportImage:["클립 리포트 이미지","Clip Report Image","Clip Report Image","Clip Report Image"],easyEditable:["간편 편집용","For easy editing","For easy editing","For easy editing"],memoInfo:["메모","Memo","Memo","Memo"],memoText:["텍스트","Text","Text","Text"],memoPo:["위치 및 크기","Position and size","Position and size","Position and size"],memoPoX:["x좌표","x coordinate","x coordinate","x coordinate"],memoPoY:["y좌표","y coordinate","y coordinate","y coordinate"],memoPoWidth:["넓이","width","width","width"],memoPoHeight:["높이","height","height","height"],memoFont:["서식","Format","Format","Format"],memoFontSize:["글자 크기(pt)","Font Size(pt)","Font Size(pt)","Font Size(pt)"],memoFontColor:["글자 색","Font Color","Font Color","Font Color"],memoFontReSize:["글자 줄이기","Reduce characters","Reduce characters","Reduce characters"],memoFontBGColor:["배경 색","Background Color","Background Color","Background Color"],memoReplacement:["정렬","Replacement","Replacement","Replacement"],memoBlowingDirection:["말풍선방향","Blowing Direction","Blowing Direction","Blowing Direction"]};function mCR_ReportLanguage(c){var a=new Object();for(var b in window.mCR_objLanguageMap){a[b]=window.mCR_objLanguageMap[b][c];}return a;}var JSON;if(!JSON){JSON=new Object();}(function(){function d(f){return f<10?"0"+f:f;}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(f){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+d(this.getUTCMonth()+1)+"-"+d(this.getUTCDate())+"T"+d(this.getUTCHours())+":"+d(this.getUTCMinutes())+":"+d(this.getUTCSeconds())+"Z":null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(f){return this.valueOf();};}var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i,b,k={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;function a(f){h.lastIndex=0;return h.test(f)?'"'+f.replace(h,function(l){var m=k[l];return typeof m==="string"?m:"\\u"+("0000"+l.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+f+'"';}function g(r,o){var m,l,s,f,p=i,n,q=o[r];if(q&&typeof q==="object"&&typeof q.toJSON==="function"){q=q.toJSON(r);}if(typeof j==="function"){q=j.call(o,r,q);}switch(typeof q){case"string":return a(q);case"number":return isFinite(q)?String(q):"null";case"boolean":case"null":return String(q);case"object":if(!q){return"null";}i+=b;n=[];if(Object.prototype.toString.apply(q)==="[object Array]"){f=q.length;for(m=0;m<f;m+=1){n[m]=g(m,q)||"null";}s=n.length===0?"[]":i?"[\n"+i+n.join(",\n"+i)+"\n"+p+"]":"["+n.join(",")+"]";i=p;return s;}if(j&&typeof j==="object"){f=j.length;for(m=0;m<f;m+=1){if(typeof j[m]==="string"){l=j[m];s=g(l,q);if(s){n.push(a(l)+(i?": ":":")+s);}}}}else{for(l in q){if(Object.prototype.hasOwnProperty.call(q,l)){s=g(l,q);if(s){n.push(a(l)+(i?": ":":")+s);}}}}s=n.length===0?"{}":i?"{\n"+i+n.join(",\n"+i)+"\n"+p+"}":"{"+n.join(",")+"}";i=p;return s;}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(n,l,m){var f;i="";b="";if(typeof m==="number"){for(f=0;f<m;f+=1){b+=" ";}}else{if(typeof m==="string"){b=m;}}j=l;if(l&&typeof l!=="function"&&(typeof l!=="object"||typeof l.length!=="number")){throw new Error("JSON.stringify");}return g("",{"":n});};}if(typeof JSON.parse!=="function"){JSON.parse=function(n,f){var m;function l(r,q){var p,o,s=r[q];if(s&&typeof s==="object"){for(p in s){if(Object.prototype.hasOwnProperty.call(s,p)){o=l(s,p);if(o!==undefined){s[p]=o;}else{delete s[p];}}}}return f.call(r,q,s);}n=String(n);c.lastIndex=0;if(c.test(n)){n=n.replace(c,function(o){return"\\u"+("0000"+o.charCodeAt(0).toString(16)).slice(-4);});}if(/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=(new Function("return ("+n+")"))();return typeof f==="function"?l({"":m},""):m;}throw new SyntaxError("JSON.parse");};}}());var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){var a="";var l,j,g,k,h,f,d;var b=0;c=Base64._utf8_encode(c);while(b<c.length){l=c.charCodeAt(b++);j=c.charCodeAt(b++);g=c.charCodeAt(b++);k=l>>2;h=((l&3)<<4)|(j>>4);f=((j&15)<<2)|(g>>6);d=g&63;if(isNaN(j)){f=d=64;}else{if(isNaN(g)){d=64;}}a=a+this._keyStr.charAt(k)+this._keyStr.charAt(h)+this._keyStr.charAt(f)+this._keyStr.charAt(d);}return a;},decode:function(c){var a="";var l,j,g;var k,h,f,d;var b=0;c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(b<c.length){k=this._keyStr.indexOf(c.charAt(b++));h=this._keyStr.indexOf(c.charAt(b++));f=this._keyStr.indexOf(c.charAt(b++));d=this._keyStr.indexOf(c.charAt(b++));l=(k<<2)|(h>>4);j=((h&15)<<4)|(f>>2);g=((f&3)<<6)|d;a=a+String.fromCharCode(l);if(f!=64){a=a+String.fromCharCode(j);}if(d!=64){a=a+String.fromCharCode(g);}}a=Base64._utf8_decode(a);return a;},_utf8_encode:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var f=0;f<b.length;f++){var d=b.charCodeAt(f);if(d<128){a+=String.fromCharCode(d);}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128);}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128);}}}return a;},_utf8_decode:function(a){var b="";var d=0;var f=c1=c2=0;while(d<a.length){f=a.charCodeAt(d);if(f<128){b+=String.fromCharCode(f);d++;}else{if((f>191)&&(f<224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((f&31)<<6)|(c2&63));d+=2;}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((f&15)<<12)|((c2&63)<<6)|(c3&63));d+=3;}}}return b;}};function mCR_ReportBody(a){this.objReport=a;this.nDefaultWidth=793;this.nDefaultHeight=1122;this.nScale=1;this.elmBody=null;this.mobileButtonTimer=null;this.elmMobilePrevButton=null;this.elmMobileNextButton=null;this.nMobileMoveButtonTime=3000;this.nStartX=0;this.nStartY=0;this.nTouchX=0;this.nTouchY=0;this.prevOverflowX="auto";this.prevOverflowY="auto";this.doubleClickTimer=null;this.objMobileButton={isVisible:false,isEvent:true};this.objDblclickOp={isEvent:false,nX:0,nX:0,nCount:0};this.objGesture={nScale:1,nLine:0,isStart:false,nFirstScale:1};}mCR_ReportBody.prototype.createBody=function(){var b=this;var c=document.createElement("div");c.id="report_body";c.className="report_body_div";if(!this.objReport.isUpperMenu){c.className=c.className+" clip_report_menu_up";}if(this.objReport.objStyleInfo.strBodyStyle!=null&&this.objReport.isUpperMenu){c.style.cssText=this.objReport.objStyleInfo.strBodyStyle;}if(this.objReport.objStyleInfo.strHeaderHeight!=null&&this.objReport.isUpperMenu){c.style.top=this.objReport.objStyleInfo.strHeaderHeight;}if(this.objReport.isScrollView&&this.objReport.objOption.nViewType!=0){c.style.backgroundColor="silver";}c.addEventListener("scroll",function(){b.showInScreen();});this.objReport.objTargetDOM.appendChild(c);this.elmBody=c;if(mCR_isSmartphone){this.createMobilePrevButton();this.createMobileNextButton();this.changeMobileButtonSize();}if(mCR_isIE8||mCR_isIE7){this.objDblclickOp.isEvent=false;}var a=this.objReport;if(a.isBodyOverflowAuto){this.elmBody.style.overflow="auto";}else{if(a.objPageInfo.strZoomRatio=="pageHeight"){this.elmBody.style.overflowY="hidden";this.elmBody.style.overflowX="hidden";}else{if(a.objPageInfo.strZoomRatio=="pageWidth"){this.elmBody.style.overflowY="auto";if(mCR_isSmartphone){this.elmBody.style.overflowX="auto";}else{this.elmBody.style.overflowX="hidden";}}else{this.elmBody.style.overflowY="auto";this.elmBody.style.overflowX="auto";}}}this.createBodyEvent();};mCR_ReportBody.prototype.insertHTML=function(a,b){if(null!=this.elmBody){this.elmBody.innerHTML=a;switch(b){case 0:this.nDefaultHeight=this.elmBody.firstChild.firstChild.getAttribute("height");this.nDefaultWidth=this.elmBody.firstChild.firstChild.getAttribute("width");break;case 1:this.nDefaultHeight=this.elmBody.firstChild.offsetHeight;this.nDefaultWidth=this.elmBody.firstChild.offsetWidth;break;case 2:this.nDefaultHeight=this.elmBody.firstChild.offsetHeight;this.nDefaultWidth=this.elmBody.firstChild.offsetWidth;break;}}};mCR_ReportBody.prototype.resize=function(h,i){if(this.elmBody!=null){if(h!=null){var g=null;if(h=="pageHeight"){g=this.elmBody.offsetHeight/this.nDefaultHeight;}else{if(h=="pageWidth"){g=this.elmBody.offsetWidth/this.nDefaultWidth;}else{g=parseFloat(h);}}this.nScale=g;if(i==0){var d=this.elmBody.firstChild.firstChild;var b=this.elmBody.lastChild;d.setAttribute("width",this.nDefaultWidth*g);d.setAttribute("height",this.nDefaultHeight*g);d.lastChild.setAttribute("transform","scale("+g+") translate(0,0)");if(mCR_isIphone||mCR_isFirefox){b.style.transform="scale("+g+")";b.style.transformOrigin="0 0 0";b.style.position="absolute";b.style.top="0px;";if(mCR_isFirefox){var a=this.elmBody.clientWidth;var f=this.nDefaultWidth*g;var c=0;if(a-f>0){c=(a-f)/2;}b.style.left=c+"px";}else{b.style.left="0px";}}else{b.style.zoom=g;}}else{if(i==1){this.elmBody.firstChild.style.zoom=g;var b=this.elmBody.lastChild;if(mCR_isIphone||mCR_isFirefox){b.style.transform="scale("+g+")";b.style.transformOrigin="0 0 0";b.style.position="absolute";b.style.top="0px;";if(mCR_isFirefox){var a=this.elmBody.clientWidth;var f=this.nDefaultWidth*g;var c=0;if(a-f>0){c=(a-f)/2;}b.style.left=c+"px";}else{b.style.left="0px";}}else{b.style.zoom=g;}}else{if(i==2){this.elmBody.firstChild.style.zoom=g;var b=this.elmBody.lastChild;if(mCR_isIphone||mCR_isFirefox){b.style.transform="scale("+g+")";b.style.transformOrigin="0 0 0";b.style.position="absolute";b.style.top="0px;";if(mCR_isFirefox){var a=this.elmBody.clientWidth;var f=this.nDefaultWidth*g;var c=0;if(a-f>0){c=(a-f)/2;}b.style.left=c+"px";}else{b.style.left="0px";}}else{b.style.zoom=g;}}else{if(i==4){this.objReport.paintCanvas(h);}}}}if(!this.objGesture.isStart){}else{this.elmBody.scrollTo(this.nStartX*this.objGesture.nScale-this.nTouchX,this.nStartY*this.objGesture.nScale-this.nTouchY);}}}};mCR_ReportBody.prototype.createBodyEvent=function(){var b=this.objReport;var a=this;if(mCR_isSmartphone){this.elmBody.ontouchstart=function(c){if(a.objMobileButton.isEvent){a.viewMobileButton();}if(!b.isBodyEventLock){if(c.touches.length==1){if(a.objDblclickOp.isEvent){var f=c.touches[0].clientX;var d=c.touches[0].clientY;if(((a.objDblclickOp.nX+30)<f||(a.objDblclickOp.nX-30)>f)||((a.objDblclickOp.nY+30)<d||(a.objDblclickOp.nY-30)>d)){a.objDblclickOp.nCount=0;a.objDblclickOp.nX=f;a.objDblclickOp.nY=d;}else{if(a.objDblclickOp.nX==0&&a.objDblclickOp.nY==0){a.objDblclickOp.nX=f;a.objDblclickOp.nY=d;}}}}else{if(c.touches.length==2&&c.cancelable){c.preventDefault();a.prevOverflowX=a.elmBody.style.overflowX;a.prevOverflowY=a.elmBody.style.overflowY;a.elmBody.style.overflowY="hidden";a.elmBody.style.overflowX="hidden";a.objGesture.isStart=true;a.objGesture.nScale=a.nScale;a.objGesture.nFirstScale=a.objGesture.nScale;var f=Math.abs(c.touches[0].clientX-c.touches[1].clientX);var d=Math.abs(c.touches[0].clientY-c.touches[1].clientY);a.objGesture.nLine=Math.sqrt((f*f)+(d*d));if(a.elmBody.firstChild.firstChild.offsetLeft==undefined){a.nTouchX=(c.touches[0].clientX+c.touches[1].clientX)/2;}else{a.nTouchX=(c.touches[0].clientX+c.touches[1].clientX)/2-a.elmBody.firstChild.firstChild.offsetLeft;}a.nStartX=(a.elmBody.scrollLeft+a.nTouchX)/a.objGesture.nScale;a.nTouchY=(c.touches[0].clientY-a.elmBody.offsetTop+c.touches[1].clientY-a.elmBody.offsetTop)/2;a.nStartY=(a.elmBody.scrollTop+a.nTouchY)/a.objGesture.nScale;}}}};this.elmBody.ontouchmove=function(c){if(!b.isBodyEventLock){if(c.touches.length==2&&c.cancelable){c.preventDefault();var m=Math.abs(c.touches[0].clientX-c.touches[1].clientX);var l=Math.abs(c.touches[0].clientY-c.touches[1].clientY);var i=Math.sqrt((m*m)+(l*l));var g=a.objGesture;var h=null;if(i>g.nLine){h=g.nScale+0.02;}else{h=g.nScale-0.02;}var d=a.elmBody.clientWidth;var n=d/Number(a.nDefaultWidth);if(n>0.75){n=0.75;}if(h>2){h=2;return;}else{if(h<n){if(mCR_isAndroidMobile44&&n<0.5){n=0.55;}h=n;}}var k=a.objGesture.nScale;if(k!=h){a.objGesture.nScale=h;if(b.objPageInfo.nExportType==4){var j=a.nScale;var f=h/j;a.elmBody.firstChild.firstChild.style.zoom=f/2;a.elmBody.lastChild.style.zoom=h;a.elmBody.scrollTop=a.nStartY*a.objGesture.nScale-a.nTouchY;a.elmBody.scrollLeft=a.nStartX*a.objGesture.nScale-a.nTouchX;}else{a.resize(h,b.objPageInfo.nExportType);}}}}};this.elmBody.ontouchend=function(d){if(!b.isBodyEventLock){if(a.objDblclickOp.isEvent){var i=d.changedTouches[0].clientX;var h=d.changedTouches[0].clientY;if(((a.objDblclickOp.nX+30)>i&&(a.objDblclickOp.nX-30)<i)&&((a.objDblclickOp.nY+30)>h&&(a.objDblclickOp.nY-30)<h)){a.objDblclickOp.nCount++;a.checkDoublclickTimer();}if(a.objDblclickOp.nCount==2){var f=this.offsetWidth/2;var c=this;while(null!=c){i-=c.offsetLeft;c=c.offsetParent;}if(i>f){b.nextPage();}else{b.prevPage();}a.objDblclickOp.nCount=0;a.objDblclickOp.nX=0;a.objDblclickOp.nY=0;}}else{var g=a.objGesture;if(g.isStart){if(g.nFirstScale!=g.nScale){a.resize(g.nScale,b.objPageInfo.nExportType);}a.elmBody.style.overflowY=a.prevOverflowX;a.elmBody.style.overflowX=a.prevOverflowY;}g.isStart=false;}}};window.addEventListener("resize",function(){a.changeMobileButtonSize();a.changeFrameSize();},false);}else{this.elmBody.ondblclick=function(d){if(a.objDblclickOp.isEvent){var f=this.offsetWidth/2;var g=d.clientX;var c=this;while(null!=c){g-=c.offsetLeft;c=c.offsetParent;}if(g>f){b.nextPage();}else{b.prevPage();}}};window.addEventListener("resize",function(){a.changeFrameSize();},false);}};mCR_ReportBody.prototype.createMobilePrevButton=function(){var a=this.objReport;var c=this;var b=document.createElement("button");b.id="reportMobilePrevButton";b.className="report_mobile_button report_mobile_prev_button";b.title=a.objLanguageMap.prv_page;b.onclick=function(){a.prevPage();c.viewMobileButton();};this.elmMobilePrevButton=b;a.objTargetDOM.appendChild(b);};mCR_ReportBody.prototype.createMobileNextButton=function(){var a=this.objReport;var c=this;var b=document.createElement("button");b.id="reportMobileNextButton";b.className="report_mobile_button report_mobile_next_button";b.title=a.objLanguageMap.next_page;b.onclick=function(){a.nextPage();c.viewMobileButton();};this.elmMobileNextButton=b;a.objTargetDOM.appendChild(b);};mCR_ReportBody.prototype.setDisabled=function(a){this.objDblclickOp.isEvent=!a;};mCR_ReportBody.prototype.showMobileButton=function(){var a=this.objReport;if(a.objPageInfo.nSelectPageIndex!=0){this.elmMobilePrevButton.style.display="block";}else{this.elmMobilePrevButton.style.display="none";}if(a.objPageInfo.nSelectPageIndex+1!=a.objPageInfo.nPageCount){this.elmMobileNextButton.style.display="block";}else{this.elmMobileNextButton.style.display="none";}};mCR_ReportBody.prototype.changeMobileButtonSize=function(){if(this.elmBody.offsetWidth>this.elmBody.offsetHeight){this.elmMobilePrevButton.style.width="40px";this.elmMobilePrevButton.style.height="40px";this.elmMobileNextButton.style.width="40px";this.elmMobileNextButton.style.height="40px";}else{this.elmMobilePrevButton.style.width="60px";this.elmMobilePrevButton.style.height="60px";this.elmMobileNextButton.style.width="60px";this.elmMobileNextButton.style.height="60px";}};mCR_ReportBody.prototype.changeFrameSize=function(){var a=false;if((this.elmBody.offsetWidth/this.elmBody.offsetHeight)>1.4){var a=true;}this.objReport.resizeOptions(a);};mCR_ReportBody.prototype.blindMobileButton=function(){this.elmMobilePrevButton.style.display="none";this.elmMobileNextButton.style.display="none";};mCR_ReportBody.prototype.viewMobileButton=function(){var a=this;this.showMobileButton();clearTimeout(this.mobileButtonTimer);this.mobileButtonTimer=setTimeout(function(){a.blindMobileButton();},a.nMobileMoveButtonTime);};mCR_ReportBody.prototype.checkDoublclickTimer=function(){var a=this;clearTimeout(this.doubleClickTimer);this.doubleClickTimer=setTimeout(function(){a.objDblclickOp.nCount=0;},500);};mCR_ReportBody.prototype.setReportErrorPage=function(b){if(this.elmBody!=null){var a="";if(b!=null||b!=undefined){a="(errorCode : "+b+")";}this.elmBody.innerHTML="<br>"+this.objReport.objLanguageMap.report_error+a;}};mCR_ReportBody.prototype.makePageDiv=function(a){var b=document.createElement("div");b.id="report_page_div";b.className="report_page_div";b.alt=a+1;this.elmBody.appendChild(b);return b;};mCR_ReportBody.prototype.showInScreen=function(){if(this.objReport.isDocView&&this.objReport.isScrollView){var j=this.elmBody.scrollTop;var k=this.elmBody.clientHeight;var a=j+k;var f=this.objReport.arrDocPageDivList.length;var d=j+k/2;for(var c=0;c<f;c++){var b=this.objReport.arrDocPageDivList[c];var h=b.offsetTop;var g=b.offsetTop+b.offsetHeight;if(h>=j||g>=j){if(h<=a||g<=a){if(!this.objReport.arrDocPageCheckList[c]){this.objReport.sendCreatePageScrollType(c);}if(d>=h&&d<=g){this.objReport.objPageInfo.nSelectPageIndex=c;this.objReport.writeInCurrentPageInfo();}}else{break;}}}}};function mCR_ReportHeader(a){this.objReport=a;this.nCustomButtonCount=0;this.arrCustomButton=null;this.elmHead=null;this.elmMemoHead=null;this.isMemoPage=false;this.nHeadCenterSize=0;this.elmHeadCenter=null;this.elmSaveButton=null;this.elmPrintButton=null;this.elmFirstButton=null;this.elmPrevButton=null;this.elmNextButton=null;this.elmLastButton=null;this.elmInfoButton=null;this.elmZoomSelect=null;this.elmHWPButton=null;this.elmEXCELButton=null;this.elmPDFButton=null;this.elmDOCButton=null;this.elmCloseButton=null;this.elmPageInfo=null;this.elmReportPageProgressDiv=null;this.elmMoveToMemoPageButton=null;this.elmMoveToSearchPageButton=null;this.objButtonInfo={nLeftPosition:0,nRightPosition:0,nButtonSize:0,nTopBottomSize:0};this.elmThumbnailButton=null;this.elmTOCButton=null;this.elmCurrentPageInput=null;this.elmTotalPageInput=null;this.nCustomButton=null;}mCR_ReportHeader.prototype.createHeader=function(b){var c=document.createElement("div");c.id="report_head";c.className="report_head_div";if(!this.objReport.isUpperMenu){c.className=c.className+" clip_report_diplay_none";}if(this.objReport.objStyleInfo.strHeadStyle!=null){c.style.cssText=this.objReport.objStyleInfo.strHeadStyle;}if(this.objReport.objStyleInfo.strHeaderHeight!=null){c.style.height=this.objReport.objStyleInfo.strHeaderHeight;}this.objReport.objTargetDOM.appendChild(c);this.arrCustomButton=new Array();var a=document.createElement("div");a.id="report_head_center";a.className="report_head_center_div";c.appendChild(a);this.elmHeadCenter=a;this.elmHead=c;};mCR_ReportHeader.prototype.changeMemoHeader=function(){if(this.isMemoPage){this.isMemoPage=false;this.setDisableButtons(false);this.elmMemoHead.style.display="none";}else{this.isMemoPage=true;this.elmMemoHead.style.display="block";this.setDisableButtons(true);}};mCR_ReportHeader.prototype.createMemoHeader=function(){var a=this.objReport;var d=document.createElement("div");d.id="report_memo_head";d.className="report_memo_head_div";if(!this.objReport.isUpperMenu){d.className=d.className+" clip_report_diplay_none";}if(this.objReport.objStyleInfo.strHeadStyle!=null){d.style.cssText=this.objReport.objStyleInfo.strHeadStyle;}if(this.objReport.objStyleInfo.strHeaderHeight!=null){d.style.height=this.objReport.objStyleInfo.strHeaderHeight;}this.elmMemoHead=d;this.objReport.objTargetDOM.appendChild(d);var c=document.createElement("div");c.id="report_head_center";c.className="report_head_center_div";d.appendChild(c);var b=document.createElement("button");b.id="report_menu_memo_button";b.className="report_menu_button report_menu_memo_button";b.title=this.objReport.objLanguageMap.Memo;b.tabIndex=1;b.onclick=function(){a.makeMemo();};if(this.objReport.objStyleInfo.strSaveButtonStyle!=null){b.style.cssText=b.style.cssText+this.objReport.objStyleInfo.strMemoButtonStyle;}c.appendChild(b);var b=document.createElement("button");b.id="report_menu_memo_opacity_button";b.className="report_menu_button report_menu_memo_opacity_button";b.title=this.objReport.objLanguageMap.toggleMemoOpacity;b.tabIndex=2;b.onclick=function(){a.toggleOpacityEditingSpace();};if(this.objReport.objStyleInfo.strSaveButtonStyle!=null){b.style.cssText=b.style.cssText+this.objReport.objStyleInfo.strToggleMemoOpacityButtonStyle;}c.appendChild(b);var b=document.createElement("button");b.id="report_menu_memo_option_button";b.className="report_menu_button report_menu_memo_option_button";b.title=this.objReport.objLanguageMap.memoOption;b.tabIndex=3;b.onclick=function(){a.toggleMemoOption();};if(this.objReport.objStyleInfo.strSaveButtonStyle!=null){b.style.cssText=b.style.cssText+this.objReport.objStyleInfo.strMemoOptionButtonStyle;}c.appendChild(b);var b=document.createElement("button");b.id="report_menu_return_memo_page_button";b.className="report_menu_button report_menu_return_memo_page_button";b.title=this.objReport.objLanguageMap.returnFromMemoPage;b.tabIndex=4;b.onclick=function(){a.returnFromMemoPage();};if(this.objReport.objStyleInfo.strSaveButtonStyle!=null){b.style.cssText=b.style.cssText+this.objReport.objStyleInfo.strReturnFromMemoPageButtonStyle;}c.appendChild(b);};mCR_ReportHeader.prototype.createButtons=function(){if(!this.objReport.objStyleInfo.isCustomDesign){this.objButtonInfo.nButtonSize=parseInt(this.objReport.objStyleInfo.strHeaderIconSize.replace("px",""));this.objButtonInfo.nTopBottomSize=(parseInt(this.objReport.objStyleInfo.strHeaderHeight.replace("px",""))-this.objButtonInfo.nButtonSize)/2;}this.createSaveButton();this.createPrintButton();this.createInfoButton();this.createZoomSelect();this.createLastButton();this.createNextButton();this.createPageInfoDiv();this.createPrevButton();this.createFirstButton();if(this.objReport.objCustomSaveButtonInfo.isButtonHwp){this.createHWPButton();}if(this.objReport.objCustomSaveButtonInfo.isButtonXls){this.createEXCELButton();}if(this.objReport.objCustomSaveButtonInfo.isButtonPdf){this.createPDFButton();}if(this.objReport.objCustomSaveButtonInfo.isButtonDoc){this.createDOCButton();}this.setCustomButton();this.createCloseButton();};mCR_ReportHeader.prototype.createSaveButton=function(){this.elmSaveButton=new mCR_ReportHeaderButton(this);var b=this.objReport;var c=this;var a=null;if(mCR_isIE7||mCR_isIE8){a="report_menu_save_button_lowie";}else{a="report_menu_save_button";}this.elmSaveButton.createButton(a,function(){c.setDisableButtons(true);if(b.fnStartSaveButton!=null){var d=b.fnStartSaveButton();if(d!=true){c.setDisableButtons(false);return;}}b.createDownloadMainOptionFrame();},false,b.objLanguageMap.save,!this.objReport.objStyleInfo.isCustomDesign,false,1,this.objReport.objStyleInfo.strSaveButtonStyle,true);};mCR_ReportHeader.prototype.createPrintButton=function(){if(mCR_isSmartphone){this.elmHeadCenter.style.width=this.elmHeadCenter.offsetWidth-40+"px";}else{this.elmPrintButton=new mCR_ReportHeaderButton(this);var c=this;var a=null;if(mCR_isIE7||mCR_isIE8){a="report_menu_print_button_lowie";}else{a="report_menu_print_button";}var b=this.objReport;if(b.objDirectPrintInfo.isUse){this.elmPrintButton.createButton(a,function(){c.setDisableButtons(true);if(b.fnStartPrintButton!=null){var f=b.fnStartPrintButton();if(f!=true){c.setDisableButtons(false);return;}}if(b.objDirectPrintInfo.printType==0){var d=mCR_objPDFInfo;var g=null;if(mCR_isFirefox||mCR_isEdge||mCR_isSafari){b.callDirectPrint();}else{if(d.acrobat){if(d.acrobatVersion==9){if(b.objAdobeMessage.isMessage){g=b.objAdobeMessage.strMessage;b.errorAlertUI("안내",g,true,function(){b.callDirectPrint();});}else{g=b.objLanguageMap.adobe9Info+b.objLanguageMap.adobe9Info2+" "+b.objLanguageMap.adobe9Info3+"\n <a href='https://get.adobe.com/reader/?loc=kr' target='_blank'>https://get.adobe.com/reader/?loc=kr</a> \n"+b.objLanguageMap.adobe9Info4;b.errorAlertUI("안내",g,true,function(){b.callDirectPrint();});}}else{b.callDirectPrint();}}else{if(b.objAdobeMessage.isMessage){g=b.objAdobeMessage.strMessage;b.errorAlertUI("안내",g,true,function(){b.callDirectPrint();});}else{g=b.objLanguageMap.adobe9Info5+" "+b.objLanguageMap.adobe9Info2+" "+b.objLanguageMap.adobe9Info3+"\n <a href='https://get.adobe.com/reader/?loc=kr' target='_blank'>https://get.adobe.com/reader/?loc=kr</a> \n"+b.objLanguageMap.adobe9Info4;b.errorAlertUI("안내",g,true,function(){b.callDirectPrint();});}}}}else{b.callDirectPrint();}c.setDisableButtons(false);},mCR_isSmartphone,b.objLanguageMap.print,!this.objReport.objStyleInfo.isCustomDesign,false,2,this.objReport.objStyleInfo.strPrintButtonStyle,true);}else{this.elmPrintButton.createButton(a,function(){c.setDisableButtons(true);if(b.fnStartPrintButton!=null){var d=b.fnStartPrintButton();if(d!=true){c.setDisableButtons(false);return;}}b.createPrintMainOptionFrame();},mCR_isSmartphone,b.objLanguageMap.print,!this.objReport.objStyleInfo.isCustomDesign,false,2,this.objReport.objStyleInfo.strPrintButtonStyle,true);}}};mCR_ReportHeader.prototype.createFirstButton=function(){this.elmFirstButton=new mCR_ReportHeaderButton(this);var b=this.objReport;var a=null;if(mCR_isIE7||mCR_isIE8){a="report_menu_first_button_lowie";}else{a="report_menu_first_button";}this.elmFirstButton.createButton(a,function(){b.firstPage();},false,b.objLanguageMap.first_page,!this.objReport.objStyleInfo.isCustomDesign,false,20,this.objReport.objStyleInfo.strFirstButtonStyle,false);};mCR_ReportHeader.prototype.createPrevButton=function(){this.elmPrevButton=new mCR_ReportHeaderButton(this);var b=this.objReport;var a=null;if(mCR_isIE7||mCR_isIE8){a="report_menu_prev_button_lowie";}else{a="report_menu_prev_button";}this.elmPrevButton.createButton(a,function(){b.prevPage();},false,b.objLanguageMap.prv_page,!this.objReport.objStyleInfo.isCustomDesign,false,21,this.objReport.objStyleInfo.strPrevButtonStyle,false);};mCR_ReportHeader.prototype.createNextButton=function(){this.elmNextButton=new mCR_ReportHeaderButton(this);var b=this.objReport;var a=null;if(mCR_isIE7||mCR_isIE8){a="report_menu_next_button_lowie";}else{a="report_menu_next_button";}this.elmNextButton.createButton(a,function(){b.nextPage();},false,b.objLanguageMap.next_page,!this.objReport.objStyleInfo.isCustomDesign,false,24,this.objReport.objStyleInfo.strNextButtonStyle,false);};mCR_ReportHeader.prototype.createLastButton=function(){this.elmLastButton=new mCR_ReportHeaderButton(this);var b=this.objReport;var a=null;if(mCR_isIE7||mCR_isIE8){a="report_menu_last_button_lowie";}else{a="report_menu_last_button";}this.elmLastButton.createButton(a,function(){b.lastPage();},false,b.objLanguageMap.last_page,!this.objReport.objStyleInfo.isCustomDesign,false,25,this.objReport.objStyleInfo.strLastButtonStyle,false);};mCR_ReportHeader.prototype.createHWPButton=function(){if(mCR_isSmartphone){}else{this.elmHWPButton=new mCR_ReportHeaderButton(this);var c=this.objReport;var a=null;if(mCR_isIE7||mCR_isIE8){a="report_menu_hwp_download_button_lowie";}else{a="report_menu_hwp_download_button";}var b="";if(c.strFileName!=""){b=c.strFileName;}else{b="report";}this.elmHWPButton.createButton(a,function(){c.saveExportByType(4,1,c.objPageInfo.nPageCount,b,c.objSaveExportOptionInfo.hwp);},mCR_isSmartphone,c.objLanguageMap.hwp_save,!this.objReport.objStyleInfo.isCustomDesign,true,3,this.objReport.objStyleInfo.strHWPButtonStyle,true);}};mCR_ReportHeader.prototype.createEXCELButton=function(){if(mCR_isSmartphone){}else{this.elmEXCELButton=new mCR_ReportHeaderButton(this);var c=this.objReport;var a=null;if(mCR_isIE7||mCR_isIE8){a="report_menu_excel_download_button_lowie";}else{a="report_menu_excel_download_button";}var b="";if(c.strFileName!=""){b=c.strFileName;}else{b="report";}this.elmEXCELButton.createButton(a,function(){c.saveExportByType(1,1,c.objPageInfo.nPageCount,b,c.objSaveExportOptionInfo.xls);},mCR_isSmartphone,c.objLanguageMap.excel_save,!this.objReport.objStyleInfo.isCustomDesign,true,4,this.objReport.objStyleInfo.strEXCELButtonStyle,true);}};mCR_ReportHeader.prototype.createPDFButton=function(){if(mCR_isSmartphone){}else{this.elmPDFButton=new mCR_ReportHeaderButton(this);var c=this.objReport;var a=null;if(mCR_isIE7||mCR_isIE8){a="report_menu_pdf_download_button_lowie";}else{a="report_menu_pdf_download_button";}var b="";if(c.strFileName!=""){b=c.strFileName;}else{b="report";}this.elmPDFButton.createButton(a,function(){c.saveExportByType(3,1,c.objPageInfo.nPageCount,b,c.objSaveExportOptionInfo.pdf);},mCR_isSmartphone,c.objLanguageMap.pdf_save,!this.objReport.objStyleInfo.isCustomDesign,true,5,this.objReport.objStyleInfo.strPDFButtonStyle,true);}};mCR_ReportHeader.prototype.createDOCButton=function(){if(mCR_isSmartphone){}else{this.elmDOCButton=new mCR_ReportHeaderButton(this);var c=this.objReport;var a=null;if(mCR_isIE7||mCR_isIE8){a="report_menu_doc_download_button_lowie";}else{a="report_menu_doc_download_button";}var b="";if(c.strFileName!=""){b=c.strFileName;}else{b="report";}this.elmDOCButton.createButton(a,function(){c.saveExportByType(5,1,c.objPageInfo.nPageCount,b,c.objSaveExportOptionInfo.doc);},mCR_isSmartphone,c.objLanguageMap.doc_save,!this.objReport.objStyleInfo.isCustomDesign,true,6,this.objReport.objStyleInfo.strDOCButtonStyle,true);}};mCR_ReportHeader.prototype.createInfoButton=function(){this.elmInfoButton=new mCR_ReportHeaderButton(this);var b=this.objReport;var a=null;a="report_menu_info_button";this.elmInfoButton.createButton(a,function(){b.reportInfo();},false,b.objLanguageMap.report_info,!this.objReport.objStyleInfo.isCustomDesign,false,27,this.objReport.objStyleInfo.strInfoStyle,false);this.objButtonInfo.nRightPosition+=2;};mCR_ReportHeader.prototype.createCloseButton=function(){var c=this;var a=this.objReport;var b=document.createElement("button");b.id="report_menu_close_button";b.tabIndex=27;if(mCR_isIE7||mCR_isIE8){b.className="report_menu_close_button report_menu_close_button_lowie";}else{b.className="report_menu_close_button";}b.title=a.objLanguageMap.close;if(!this.objReport.objStyleInfo.isCustomDesign){b.style.width=this.objButtonInfo.nButtonSize+"px";b.style.height=this.objButtonInfo.nButtonSize+"px";b.style.top=this.objButtonInfo.nTopBottomSize+"px";b.style.bottom=this.objButtonInfo.nTopBottomSize+"px";}if(this.objReport.objStyleInfo.strCloseButtonStyle!=null){b.style.cssText=b.style.cssText+this.objReport.objStyleInfo.strCloseButtonStyle;}b.onclick=function(){a.callCloseView();};this.elmHead.appendChild(b);this.elmCloseButton=b;};mCR_ReportHeader.prototype.setCustomButton=function(){var c=this.objReport.arrCustomButtonInfoList;var b=c.length;this.nCustomButton=b;if(b>0){for(var a=0;a<b;a++){this.arrCustomButton[a]=new mCR_ReportHeaderButton(this);this.arrCustomButton[a].createButton(c[a].className,c[a].functionInfo,c[a].nonDisplay,c[a].title,!this.objReport.objStyleInfo.isCustomDesign,true,7+a,null,true);}}};mCR_ReportHeader.prototype.createPageInfoDiv=function(){var g=this.objReport;var h=document.createElement("div");h.id="report_page_info";h.className="report_menu_div report_page_info_div";this.elmPageInfo=h;if(!this.objReport.objStyleInfo.isCustomDesign){h.style.width=((this.objButtonInfo.nButtonSize+2)*4)+"px";h.style.height=(this.objButtonInfo.nButtonSize-4)+"px";h.style.top=(this.objButtonInfo.nTopBottomSize+2)+"px";h.style.bottom=(this.objButtonInfo.nTopBottomSize+2)+"px";this.nHeadCenterSize+=((this.objButtonInfo.nButtonSize+2)*4);h.style.right=this.objButtonInfo.nRightPosition+"px";this.objButtonInfo.nRightPosition+=((this.objButtonInfo.nButtonSize+2)*4);this.elmHeadCenter.style.width=this.nHeadCenterSize+"px";}if(this.objReport.objStyleInfo.strCountBoxStyle!=null){h.style.cssText=h.style.cssText+this.objReport.objStyleInfo.strCountBoxStyle;}var f=document.createElement("input");f.type="text";f.className="report_current_page_info_input";f.tabIndex=22;f.title=g.objLanguageMap.currentPage;var b=this.objReport;f.onkeypress=function(){enterEvent(event,b,this);};f.onblur=function(){b.selectPage(this.value);};this.elmCurrentPageInput=f;var a=document.createElement("input");a.type="text";a.className="report_total_page_info_input";a.tabIndex=23;a.readOnly=true;a.title=g.objLanguageMap.total_page;this.elmTotalPageInput=a;h.appendChild(f);h.appendChild(a);if(!this.objReport.objStyleInfo.isCustomDesign){this.elmHeadCenter.appendChild(h);}else{this.elmHead.appendChild(h);}if(this.objReport.objStyleInfo.strCurrentCountBoxStyle!=null){f.style.cssText=f.style.cssText+this.objReport.objStyleInfo.strCurrentCountBoxStyle;}if(this.objReport.objStyleInfo.strTotalCountBoxStyle!=null){a.style.cssText=a.style.cssText+this.objReport.objStyleInfo.strTotalCountBoxStyle;}var d=document.createElement("div");d.id="report_page_progress_div";d.className="report_page_progress_div";if(!this.objReport.objStyleInfo.isCustomDesign){var c=((this.objButtonInfo.nButtonSize-4)/2);d.style.width=c+"px";d.style.height=c+"px";d.style.top=c/2+"px";d.style.bottom=c/2+"px";}this.elmReportPageProgressDiv=d;h.appendChild(d);};function enterEvent(c,a,b){if(c.keyCode==13){a.selectPage(b.value);if(c.preventDefault){c.preventDefault();}c.returnValue=false;}}mCR_ReportHeader.prototype.createZoomSelect=function(){var d=this.objReport;var f=this;var a=document.createElement("SELECT");a.tabIndex=26;a.title=d.objLanguageMap.zoomIn;this.elmZoomSelect=a;if(mCR_isSmartphone){this.elmZoomSelect.style.display="none";}a.className="report_zoom_select";var b=d.objRatioComboInfo;var g=b.length;for(var c=0;c<g;c++){if(b[c].visible){this.createZoomSelectOption(a,b[c].text,b[c].value,b[c].name);}}a.value=d.objPageInfo.strZoomRatio;a.onchange=function(){f.changeRatioComobo();};if(!this.objReport.objStyleInfo.isCustomDesign&&!mCR_isSmartphone){a.style.width=(this.objButtonInfo.nButtonSize*3)+"px";a.style.height=(this.objButtonInfo.nButtonSize-4)+"px";a.style.top=(this.objButtonInfo.nTopBottomSize+2)+"px";a.style.bottom=(this.objButtonInfo.nTopBottomSize+2)+"px";this.nHeadCenterSize+=(this.objButtonInfo.nButtonSize*3);a.style.right=this.objButtonInfo.nRightPosition+"px";this.objButtonInfo.nRightPosition+=(this.objButtonInfo.nButtonSize*3);this.elmHeadCenter.style.width=this.nHeadCenterSize+"px";}if(this.objReport.objStyleInfo.strZoomInStyle!=null){a.style.cssText=a.style.cssText+this.objReport.objStyleInfo.strZoomInStyle;}if(!this.objReport.objStyleInfo.isCustomDesign){this.elmHeadCenter.appendChild(a);}else{this.elmHead.appendChild(a);}};mCR_ReportHeader.prototype.changeRatioComobo=function(){this.objReport.objPageInfo.strZoomRatio=this.elmZoomSelect[this.elmZoomSelect.selectedIndex].value;if(this.objReport.objPageInfo.strZoomRatio=="pageHeight"){if(this.objReport.isScrollView){this.objReport.objBody.elmBody.style.overflowY="auto";this.objReport.objBody.elmBody.style.overflowX="hidden";}else{this.objReport.objBody.elmBody.style.overflowY="hidden";this.objReport.objBody.elmBody.style.overflowX="hidden";}}else{if(this.objReport.objPageInfo.strZoomRatio=="pageWidth"){this.objReport.objBody.elmBody.style.overflowY="auto";this.objReport.objBody.elmBody.style.overflowX="hidden";}else{this.objReport.objBody.elmBody.style.overflowY="auto";this.objReport.objBody.elmBody.style.overflowX="auto";}}this.objReport.resizeBody(this.objReport.objPageInfo.strZoomRatio);if(!this.objReport.isScrollView){this.objReport.objBody.elmBody.scrollTop=0;}};mCR_ReportHeader.prototype.createZoomSelectOption=function(b,a,d,c){var f=document.createElement("OPTION");f.text=a;f.className="report_zoom_select_option";f.value=d;f.name=c;b.add(f);};mCR_ReportHeader.prototype.createThumbnailButton=function(){this.elmThumbnailButton=new mCR_ReportHeaderButton(this);var a=this.objReport;var b=null;if(mCR_isIE7||mCR_isIE8){b="report_menu_thumbnail_button_lowie";}else{b="report_menu_thumbnail_button";}this.elmThumbnailButton.createButton(b,function(){a.openThumbnailFrame();a.moveThumbnailImage(a.objPageInfo.nSelectPageIndex);},false,a.objLanguageMap.thumbnail,!this.objReport.objStyleInfo.isCustomDesign,true,this.nCustomButton+7+1,this.objReport.objStyleInfo.strThumbnailButtonStyle,true);};mCR_ReportHeader.prototype.createTOCButton=function(){this.elmTOCButton=new mCR_ReportHeaderButton(this);var a=this.objReport;var b=null;if(mCR_isIE7||mCR_isIE8){b="report_menu_toc_button_lowie";}else{b="report_menu_toc_button";}this.elmTOCButton.createButton(b,function(){a.openTOCFrame();},false,a.objLanguageMap.toc,!this.objReport.objStyleInfo.isCustomDesign,true,this.nCustomButton+7+2,this.objReport.objStyleInfo.strTOCButtonStyle,true);};mCR_ReportHeader.prototype.createMoveMemoPageButton=function(){this.elmMoveToMemoPageButton=new mCR_ReportHeaderButton(this);var a=this.objReport;var b="report_menu_move_memo_page_button";this.elmMoveToMemoPageButton.createButton(b,function(){a.memoPage();},false,a.objLanguageMap.moveToMemoPage,!this.objReport.objStyleInfo.isCustomDesign,true,this.nCustomButton+7+3,this.objReport.objStyleInfo.strMoveToMemoPageButtonStyle,true);};mCR_ReportHeader.prototype.createMoveSearchPageButton=function(){this.elmMoveToSearchPageButton=new mCR_ReportHeaderButton(this);var a=this.objReport;var b="report_searchword_search_button";this.elmMoveToSearchPageButton.createButton(b,function(){a.openSearchWordFrame();},false,a.objLanguageMap.moveToSearchPage,!this.objReport.objStyleInfo.isCustomDesign,true,this.nCustomButton+7+4,this.objReport.objStyleInfo.strMoveToSearchPageButtonStyle,true);};mCR_ReportHeader.prototype.ChangeStylelowIEHeadCenter=function(){if(this.elmHeadCenter!=null){this.elmHeadCenter.style.marginLeft=this.elmHeadCenter.clientWidth/2*-1;}};mCR_ReportHeader.prototype.setDisableButtons=function(c){if(this.elmHead!=null){if(this.elmSaveButton!=null){this.elmSaveButton.elmButton.disabled=c;}if(this.elmPrintButton!=null){this.elmPrintButton.elmButton.disabled=c;}if(this.elmFirstButton!=null){this.elmFirstButton.elmButton.disabled=c;}if(this.elmPrevButton!=null){this.elmPrevButton.elmButton.disabled=c;}if(this.elmNextButton!=null){this.elmNextButton.elmButton.disabled=c;}if(this.elmLastButton!=null){this.elmLastButton.elmButton.disabled=c;}if(this.elmInfoButton!=null){this.elmInfoButton.elmButton.disabled=c;}if(this.elmHWPButton!=null){this.elmHWPButton.elmButton.disabled=c;}if(this.elmEXCELButton!=null){this.elmEXCELButton.elmButton.disabled=c;}if(this.elmPDFButton!=null){this.elmPDFButton.elmButton.disabled=c;}if(this.elmDOCButton!=null){this.elmDOCButton.elmButton.disabled=c;}if(this.elmZoomSelect!=null){this.elmZoomSelect.disabled=c;}if(this.elmThumbnailButton!=null){this.elmThumbnailButton.elmButton.disabled=c;}if(this.elmTOCButton!=null){this.elmTOCButton.elmButton.disabled=c;}if(this.elmCurrentPageInput!=null){this.elmCurrentPageInput.disabled=c;}if(this.elmTotalPageInput!=null){this.elmTotalPageInput.disabled=c;}if(this.elmMoveToMemoPageButton!=null){this.elmMoveToMemoPageButton.elmButton.disabled=c;}if(this.arrCustomButton.length>0){var b=this.arrCustomButton;for(var a=0;a<b;a++){this.arrCustomButton[a].elmButton.disabled=c;}}}};mCR_ReportHeader.prototype.setDisableButtonsExceptMove=function(c){if(this.elmHead!=null){if(this.elmSaveButton!=null){this.elmSaveButton.elmButton.disabled=c;}if(this.elmPrintButton!=null){this.elmPrintButton.elmButton.disabled=c;}if(this.elmInfoButton!=null){this.elmInfoButton.elmButton.disabled=c;}if(this.elmHWPButton!=null){this.elmHWPButton.elmButton.disabled=c;}if(this.elmEXCELButton!=null){this.elmEXCELButton.elmButton.disabled=c;}if(this.elmPDFButton!=null){this.elmPDFButton.elmButton.disabled=c;}if(this.elmDOCButton!=null){this.elmDOCButton.elmButton.disabled=c;}if(this.elmThumbnailButton!=null){this.elmThumbnailButton.elmButton.disabled=c;}if(this.elmTOCButton!=null){this.elmTOCButton.elmButton.disabled=c;}if(this.arrCustomButton.length>0){var b=this.arrCustomButton;for(var a=0;a<b;a++){this.arrCustomButton[a].elmButton.disabled=c;}}}};mCR_ReportHeader.prototype.callStopPageProgress=function(){if(this.elmReportPageProgressDiv!=null){this.elmReportPageProgressDiv.style.display="none";}};function mCR_ReportHeaderButton(a){this.objHead=a;this.elmButton=null;this.objCss={strClass:"",strStyle:""};}mCR_ReportHeaderButton.prototype.createButton=function(b,o,f,k,i,d,j,n,l){var m=document.createElement("button");this.elmButton=m;m.id=b;m.className="report_menu_button "+b;m.title=k;m.tabIndex=j;if(f){m.style.display="none";}if(!this.objHead.objReport.objStyleInfo.isCustomDesign){if(d){if(this.objHead.nCustomButtonCount!=0){}else{var h=document.createElement("div");if(mCR_isIE7||mCR_isIE8){h.className="report_menu_button report_menu_header_wall_left_div report_menu_header_wall_left_div_lowie";}else{h.className="report_menu_button report_menu_header_wall_left_div ";}var g=document.createElement("div");if(mCR_isIE7||mCR_isIE8){g.className="report_menu_button report_menu_header_wall_right_div report_menu_header_wall_right_div_lowie";}else{g.className="report_menu_button report_menu_header_wall_right_div ";}var a=this.objHead.objButtonInfo.nButtonSize;var c=this.objHead.objButtonInfo.nTopBottomSize;h.style.width=a+"px";h.style.height=a+"px";h.style.top=c+"px";h.style.bottom=c+"px";g.style.width=a+"px";g.style.height=a+"px";g.style.top=c+"px";g.style.bottom=c+"px";this.objHead.nHeadCenterSize+=(a);h.style.left=this.objHead.objButtonInfo.nLeftPosition+"px";this.objHead.objButtonInfo.nLeftPosition+=(a);this.objHead.elmHeadCenter.style.width=this.objHead.nHeadCenterSize+"px";this.objHead.nHeadCenterSize+=(a);g.style.right=this.objHead.objButtonInfo.nRightPosition+"px";this.objHead.objButtonInfo.nRightPosition+=(a);this.objHead.elmHeadCenter.style.width=this.objHead.nHeadCenterSize+"px";this.objHead.elmHeadCenter.appendChild(h);this.objHead.elmHeadCenter.appendChild(g);}this.objHead.nCustomButtonCount++;}var a=this.objHead.objButtonInfo.nButtonSize;m.style.width=a+"px";m.style.height=a+"px";var c=this.objHead.objButtonInfo.nTopBottomSize;m.style.top=c+"px";m.style.bottom=c+"px";if(!f){if(l){this.objHead.nHeadCenterSize+=(a+2);m.style.left=this.objHead.objButtonInfo.nLeftPosition+"px";this.objHead.objButtonInfo.nLeftPosition+=(a+2);}else{this.objHead.nHeadCenterSize+=(a);m.style.right=this.objHead.objButtonInfo.nRightPosition+"px";this.objHead.objButtonInfo.nRightPosition+=(a);}this.objHead.elmHeadCenter.style.width=this.objHead.nHeadCenterSize+"px";}}if(n!=null){m.style.cssText=m.style.cssText+n;}m.onclick=o;if(i){this.objHead.elmHeadCenter.appendChild(m);}else{this.objHead.elmHead.appendChild(m);}};function mCR_ReportFileDownFrame(a){this.objReport=a;this.elmFileDownFrame=null;this.elmPDFPrintFrame=null;this.elmForm=null;this.elmClipTypeInput=null;this.elmClipDataInput=null;this.objPopupPrint={isPopup:true,nWidth:750,nHeight:600};}mCR_ReportFileDownFrame.prototype.createFrame=function(){var b=this.objReport.objReportInfo.strReportKey;var a=this.objReport.strServerPath;this.elmFileDownFrame=document.createElement("iframe");this.elmFileDownFrame.style.position="absolute";this.elmFileDownFrame.style.width="1px";this.elmFileDownFrame.style.height="1px";this.elmFileDownFrame.style.visibility="hidden";this.elmFileDownFrame.name="fileDown"+b;this.elmFileDownFrame.title="File DownLoad Frame";this.elmForm=document.createElement("form");this.elmForm.style.display="none";this.elmForm.encoding="application/x-www-form-urlencoded";this.elmForm.method=this.objReport.strDownloadFormMethod;this.elmForm.action=a;this.elmForm.target="fileDown"+b;this.elmClipTypeInput=document.createElement("input");this.elmClipTypeInput.name="ClipType";this.elmClipDataInput=document.createElement("input");this.elmClipDataInput.name="ClipData";this.elmForm.appendChild(this.elmClipTypeInput);this.elmForm.appendChild(this.elmClipDataInput);this.objReport.objTargetDOM.appendChild(this.elmFileDownFrame);this.objReport.objTargetDOM.appendChild(this.elmForm);if(this.objReport.isCrossDomainPDFPrint){this.elmPDFPrintFrame=document.createElement("iframe");this.elmPDFPrintFrame.style.position="absolute";this.elmPDFPrintFrame.style.width="1px";this.elmPDFPrintFrame.style.height="1px";this.elmPDFPrintFrame.style.visibility="hidden";this.elmPDFPrintFrame.name="PDFPrint"+b;this.elmPDFPrintFrame.title="PDF Print DownLoad Frame";this.objReport.objTargetDOM.appendChild(this.elmPDFPrintFrame);this.elmClipTypeInput.value="PDFPrintFrame";this.elmClipDataInput.value="";this.elmForm.target="PDFPrint"+b;this.elmForm.submit();this.elmForm.target="fileDown"+b;}};mCR_ReportFileDownFrame.prototype.submit=function(f,g){var d=this.objReport.objReportInfo.strReportKey;this.elmClipTypeInput.value=f;this.elmClipDataInput.value=g;if(mCR_isSmartphone&&mCR_isSafari){this.elmForm.target="_blank";}else{if("PDFPrintDownload"==f){if(mCR_isEdge||(!mCR_isWindow&&mCR_isSafari)||mCR_isChrome77Up||mCR_isWhale){if(this.objReport.isCrossDomainPDFPrint){var a=this.objReport.strServerPath;var c={ClipType:f,ClipData:g,url:a};this.elmPDFPrintFrame.contentWindow.postMessage(c,"*");return;}else{var b=this.elmFileDownFrame;this.elmFileDownFrame.onload=function(){b.contentWindow.window.print(true);};}}else{this.elmFileDownFrame.onload=null;if(mCR_isFirefox){if(this.objPopupPrint.isPopup){window.open("","report_SubWindow","height="+this.objPopupPrint.nHeight+",width="+this.objPopupPrint.nWidth);this.elmForm.target="report_SubWindow";}else{this.elmForm.target="_blank";}}}}else{this.elmFileDownFrame.onload=null;}}if(this.objReport.isPopUpSaveDownload&&(f=="saveExportDownload")){this.elmForm.target="_blank";}else{if(!(this.objReport.isPopUpSaveDownload==null)&&(f=="saveExportDownload")){this.elmForm.target="fileDown"+d;}}this.elmForm.submit();};function mCR_ReportDownloadMainOptionFrame(a){this.objReport=a;this.objCss={strClass:"",strStyle:""};this.strDownloadType="xls";this.firstPage=0;this.lastPage=0;this.customFirstPageInput=null;this.customLastPageInput=null;this.elmFileNameInput=null;this.elmDownloadMainOptionFrame=null;this.elmDownloadMainOptionSelect=null;this.elmDownloadMainOptionSelectCoverDiv=null;this.elmDownloadRangeDiv=null;this.elmDownloadFileNameDiv=null;}mCR_ReportDownloadMainOptionFrame.prototype.createDownloadMainOptionFrame=function(){var o=this.objReport;var s=this;var a=this.objReport.objSaveExportOptionInfo;var f=this.objReport.strDefaultSaveOption;this.firstPage=1;this.lastPage=o.objPageInfo.nPageCount;var b=document.createElement("div");this.elmDownloadMainOptionFrame=b;b.id="report_download_main_option_frame";if((o.objBody.elmBody.offsetWidth/o.objBody.elmBody.offsetHeight)>1.4){b.className="report_download_main_option_frame_div "+this.objCss.strClass;}else{b.className="report_download_main_option_frame_div report_download_main_option_frame_div_vertical "+this.objCss.strClass;}if(this.objReport.objStyleInfo.strHeaderHeight!=null){b.style.top=this.objReport.objStyleInfo.strHeaderHeight;}this.objReport.objTargetDOM.appendChild(b);var c=document.createElement("div");c.className="report_download_main_option_frame_cover_div";b.appendChild(c);var d=document.createElement("div");d.className="report_download_main_option_select_div";c.appendChild(d);var p=document.createElement("div");p.className="report_download_main_option_method_title_div";d.appendChild(p);var t=document.createElement("SPAN");t.style.top="50%";t.style.transform="translateY(-50%)";t.style.fontWeight="bold";t.style.fontSize="13px";t.style.left="3%";t.style.position="absolute";var q=document.createTextNode(o.objLanguageMap.fileType);t.appendChild(q);p.appendChild(t);var v=o.objSaveOptionVisible;var m=document.createElement("div");m.className="report_download_main_option_select_cover_div";d.appendChild(m);this.elmDownloadMainOptionSelectCoverDiv=m;var u=document.createElement("label");u.className="report_download_main_option_select_label";u.setAttribute("for","select_label");m.appendChild(u);var h=document.createElement("SELECT");h.title=o.objLanguageMap.fileType;h.className="report_download_main_option_select";h.tabIndex=1;h.id="select_label";var k=o.objSaveMenuOrder;var g=k.length;if(f!=""){for(var r=0;r<g;r++){if(k[r]==f){k.splice(r,1);k.unshift(f);break;}}}for(var r=0;r<g;r++){if(v.isXls&&k[r]=="xls"){this.createDownloadMainOption(h,o.objLanguageMap.excel_save+"(*.xls)","xls","xls_download");if(r==0){h.value="xls";}}else{if(v.isXlsx&&k[r]=="xlsx"){this.createDownloadMainOption(h,o.objLanguageMap.excel_save+"(*.xlsx)","xlsx","xlsx_download");if(r==0){h.value="xlsx";}}else{if(v.isPdf&&k[r]=="pdf"){this.createDownloadMainOption(h,o.objLanguageMap.pdf_save+"(*.pdf)","pdf","pdf_download");if(r==0){h.value="pdf";}}else{if(v.isHwp&&k[r]=="hwp"){this.createDownloadMainOption(h,o.objLanguageMap.hwp_save+"(*.hwp)","hwp","hwp_download");if(r==0){h.value="hwp";}}else{if(v.isDoc&&k[r]=="doc"){this.createDownloadMainOption(h,o.objLanguageMap.doc_save+"(*.doc)","doc","doc_download");if(r==0){h.value="doc";}}else{if(v.isDocx&&k[r]=="docx"){this.createDownloadMainOption(h,o.objLanguageMap.doc_save+"(*.docx)","docx","docx_download");if(r==0){h.value="docx";}}else{if(v.isPpt&&k[r]=="ppt"){this.createDownloadMainOption(h,o.objLanguageMap.ppt_save+"(*.ppt)","ppt","ppt_download");if(r==0){h.value="ppt";}}else{if(v.isPptx&&k[r]=="pptx"){this.createDownloadMainOption(h,o.objLanguageMap.ppt_save+"(*.pptx)","pptx","pptx_download");if(r==0){h.value="pptx";}}else{if(v.isShow&&k[r]=="show"){this.createDownloadMainOption(h,o.objLanguageMap.hanshow_save+"(*.show)","show","show_download");if(r==0){h.value="show";}}else{if(v.isCell&&k[r]=="cell"){this.createDownloadMainOption(h,o.objLanguageMap.hancell_save+"(*.cell)","cell","cell_download");if(r==0){h.value="cell";}}else{if(v.isHtml&&k[r]=="html"){this.createDownloadMainOption(h,o.objLanguageMap.html5_save+"(*.html)","html","html_download");if(r==0){h.value="html";}}else{if(v.isJpg&&k[r]=="jpg"){this.createDownloadMainOption(h,o.objLanguageMap.jpg_save+"(*.jpg)","jpg","jpg_download");if(r==0){h.value="jpg";}}else{if(v.isTxt&&k[r]=="txt"){this.createDownloadMainOption(h,o.objLanguageMap.txt_save+"(*.txt)","txt","txt_download");if(r==0){h.value="txt";}}else{if(v.isTif&&k[r]=="tif"){this.createDownloadMainOption(h,o.objLanguageMap.tif_save+"(*.tif)","tif","tif_download");if(r==0){h.value="tif";}}else{if(v.isMultitif&&k[r]=="multitif"){this.createDownloadMainOption(h,o.objLanguageMap.multitif_save+"(*.tif)","multitif","multitif_download");if(r==0){h.value="multitif";}}else{if(v.isExcelData&&k[r]=="exceldata"){this.createDownloadMainOption(h,o.objLanguageMap.exceldata_save+"(*.xls)","exceldata","exceldata_download");if(r==0){h.value="exceldata";}}else{if(v.isExcelData&&k[r]=="brl"){this.createDownloadMainOption(h,o.objLanguageMap.brl_save+"(*.brl)","brl","brl_download");if(r==0){h.value="brl";}}}}}}}}}}}}}}}}}}}s.strDownloadType=h.value;u.innerHTML=h[h.selectedIndex].text;var n=this.strDownloadType;h.onchange=function(){u.innerHTML=h[h.selectedIndex].text;s.strDownloadType=this.value;if(o.isUseDownloadSubOptionFrame){o.objDownloadSubOptionFrame.choiceOption();}};this.elmDownloadMainOptionSelect=h;m.appendChild(h);var l=document.createElement("button");l.id="download_main_option_download_button";l.innerHTML=o.objLanguageMap.save;l.className="download_main_option_download_button";l.title=o.objLanguageMap.save;l.tabIndex=4;l.onclick=function(){if(parseInt(s.customFirstPageInput.value)>parseInt(s.customLastPageInput.value)&&!s.customFirstPageInput.disabled){alert(o.objLanguageMap.printNum_validation);}else{if(s.strDownloadType=="xls"){o.saveExportByType(1,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.xls);}else{if(s.strDownloadType=="xlsx"){o.saveExportByType(2,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.xlsx);}else{if(s.strDownloadType=="pdf"){o.saveExportByType(3,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.pdf);}else{if(s.strDownloadType=="hwp"){o.saveExportByType(4,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.hwp);}else{if(s.strDownloadType=="doc"){o.saveExportByType(5,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.doc);}else{if(s.strDownloadType=="docx"){o.saveExportByType(6,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.docx);}else{if(s.strDownloadType=="ppt"){o.saveExportByType(7,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.ppt);}else{if(s.strDownloadType=="html"){o.saveExportByType(8,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.html);}else{if(s.strDownloadType=="cell"){o.saveExportByType(9,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.cell);}else{if(s.strDownloadType=="jpg"){o.saveExportByType(10,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.jpg);}else{if(s.strDownloadType=="txt"){o.saveExportByType(11,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.txt);}else{if(s.strDownloadType=="tif"){o.saveExportByType(12,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.tif);}else{if(s.strDownloadType=="multitif"){o.saveExportByType(13,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.multitif);}else{if(s.strDownloadType=="exceldata"){o.saveExportByType(14,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.exceldata);}else{if(s.strDownloadType=="pptx"){o.saveExportByType(15,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.pptx);}else{if(s.strDownloadType=="brl"){o.saveExportByType(16,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.brl);}else{if(s.strDownloadType=="show"){o.saveExportByType(17,s.firstPage,s.lastPage,s.elmFileNameInput.value,a.show);}else{}}}}}}}}}}}}}}}}}s.closeDownloadMainOptionFrame();}};b.appendChild(l);if((o.isErrorSaveBrowser)&&o.isErrorSaveButtonRemove){l.style.display="none";}var j=document.createElement("button");j.id="download_main_option_cancel_button";j.innerHTML=o.objLanguageMap.cancel;j.className="download_main_option_cancel_button";j.title=o.objLanguageMap.cancel;j.tabIndex=5;j.onclick=function(){s.closeDownloadMainOptionFrame();};b.appendChild(j);this.createDownloadFileNameDiv(c);this.createDownloadRangeOptionDiv(c);h.focus();};mCR_ReportDownloadMainOptionFrame.prototype.resizeDiv=function(a){if(a){this.elmDownloadMainOptionFrame.className="report_download_main_option_frame_div "+this.objCss.strClass;}else{this.elmDownloadMainOptionFrame.className="report_download_main_option_frame_div report_download_main_option_frame_div_vertical "+this.objCss.strClass;}};mCR_ReportDownloadMainOptionFrame.prototype.createDownloadMainOption=function(b,a,f,c){var d=document.createElement("OPTION");d.text=a;d.className="report_download_main_option";d.value=f;d.name=c;b.add(d);};mCR_ReportDownloadMainOptionFrame.prototype.createDownloadFileNameDiv=function(b){var g=document.createElement("div");g.className="report_download_main_option_file_name_div";this.elmDownloadFileNameDiv=g;b.appendChild(g);var h=document.createElement("div");h.className="report_download_main_option_file_name_title_div";g.appendChild(h);var a=document.createElement("SPAN");a.style.top="50%";a.style.transform="translateY(-50%)";a.style.fontWeight="bold";a.style.fontSize="13px";a.style.left="3%";a.style.position="absolute";var f=document.createTextNode(this.objReport.objLanguageMap.fileName);a.appendChild(f);h.appendChild(a);var d=document.createElement("input");d.type="text";d.className="report_download_main_option_file_name_input";d.tabIndex=2;d.title=this.objReport.objLanguageMap.fileName;var c="";if(this.objReport.strFileName!=""){c=this.objReport.strFileName;}else{if(this.objReport.objPageInfo.strReportName!=null&&this.objReport.objPageInfo.strReportName!=""){c=this.objReport.objPageInfo.strReportName;}else{c="report";}}d.value=c;this.elmFileNameInput=d;g.appendChild(d);};mCR_ReportDownloadMainOptionFrame.prototype.createDownloadRangeOptionDiv=function(c){var g=document.createElement("div");g.className="report_download_main_option_range_div";this.elmDownloadRangeDiv=g;c.appendChild(g);var f=document.createElement("div");f.className="report_download_main_option_range_title_div";g.appendChild(f);var b=document.createElement("SPAN");b.style.top="50%";b.style.transform="translateY(-50%)";b.style.fontWeight="bold";b.style.fontSize="13px";b.style.left="3%";b.style.position="absolute";var d=document.createTextNode(this.objReport.objLanguageMap.save_range);b.appendChild(d);f.appendChild(b);var a=document.createElement("div");a.style.position="absolute";a.style.top="18%";a.style.left="5%";a.style.width="90%";a.style.height="80%";g.appendChild(a);this.createDownloadRangeOptionDetail(a,this.objReport.objLanguageMap.total_page,"total_page","5%",true,false);this.createDownloadRangeOptionDetail(a,this.objReport.objLanguageMap.currentPage,"recent_page","25%",false,false);this.createDownloadRangeOptionDetail(a,this.objReport.objLanguageMap.page_designation,"custom_page","45%",false,true);};mCR_ReportDownloadMainOptionFrame.prototype.createDownloadRangeOptionDetail=function(o,n,b,h,c,g){var f=this;var j=this.objReport;var d=document.createElement("div");d.style.position="absolute";d.style.left="0px";d.style.width="100%";d.style.height="10%";d.style.textAlign="left";d.style.top=h;o.appendChild(d);var a=document.createElement("input");a.name="download_range_option";a.id=b;a.tabIndex=3;a.title=n;a.setAttribute("type","radio");a.checked=c;a.onclick=function(){f.checkDownloadOptionRadioButton(j,a);};d.appendChild(a);var l=document.createElement("label");l.innerText=n;l.title=n;l.setAttribute("for",b);d.appendChild(l);if(g){var m=document.createTextNode("\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0");d.appendChild(m);var i=document.createElement("input");i.type="text";i.value=1;i.disabled=true;i.style.width="15%";i.title=j.objLanguageMap.from;d.appendChild(i);i.onkeypress=function(){f.keyCheckEvent(event);};i.onchange=function(){f.comparePageEvent(j,f,this,true);};this.customFirstPageInput=i;var k=document.createElement("SPAN");var m=document.createTextNode(j.objLanguageMap.from);k.appendChild(m);d.appendChild(k);var i=document.createElement("input");i.type="text";i.value=j.objPageInfo.nPageCount;i.disabled=true;i.style.width="15%";i.title=j.objLanguageMap.to;d.appendChild(i);i.onkeypress=function(){f.keyCheckEvent(event);};i.onchange=function(){f.comparePageEvent(j,f,this,false);};this.customLastPageInput=i;var k=document.createElement("SPAN");var m=document.createTextNode(j.objLanguageMap.to);k.appendChild(m);d.appendChild(k);}};mCR_ReportDownloadMainOptionFrame.prototype.checkDownloadOptionRadioButton=function(a,b){if(b.id=="total_page"){if(b.checked){this.customFirstPageInput.disabled=true;this.customLastPageInput.disabled=true;this.firstPage=1;this.lastPage=a.objPageInfo.nPageCount;}}else{if(b.id=="recent_page"){if(b.checked){this.customFirstPageInput.disabled=true;this.customLastPageInput.disabled=true;this.firstPage=a.objPageInfo.nSelectPageIndex+1;this.lastPage=a.objPageInfo.nSelectPageIndex+1;}}else{if(b.checked){this.customFirstPageInput.disabled=false;this.customLastPageInput.disabled=false;this.firstPage=parseInt(this.customFirstPageInput.value);this.lastPage=parseInt(this.customLastPageInput.value);}}}};mCR_ReportDownloadMainOptionFrame.prototype.keyCheckEvent=function(b){var a=b.keyCode;if(!((a>=48&&a<=57))){if(b.preventDefault){b.preventDefault();}b.returnValue=false;}else{return;}};mCR_ReportDownloadMainOptionFrame.prototype.comparePageEvent=function(b,f,d,a){var c=parseInt(d.value);if(c>=1&&c<=b.objPageInfo.nPageCount){if(a){f.firstPage=c;}else{f.lastPage=c;}return;}else{if(a){d.value=1;}else{d.value=b.objPageInfo.nPageCount;}}};mCR_ReportDownloadMainOptionFrame.prototype.closeDownloadMainOptionFrame=function(){this.objReport.closeDownloadMainOptionFrame();};mCR_ReportDownloadMainOptionFrame.prototype.setSyle=function(a){this.objCss.strStyle=a;if(this.elmBody!=null){this.elmBody.style.cssText=a;}};mCR_ReportDownloadMainOptionFrame.prototype.setClass=function(a){this.objCss.strClass=a;if(this.elmBody!=null){this.elmBody.className="report_download_main_option_frame_div "+a;}};function mCR_ReportDownloadSubOptionFrame(a){this.objReport=a;this.objCss={strClass:"",strStyle:""};this.elmDownloadSubOptionFrame=null;this.elmDownloadSubOptionDetailDiv=null;this.elmSaveDetailError=null;this.elmOptionSaveButton=null;this.elmOptionChangeButton=null;this.elmOptionCancelButton=null;}mCR_ReportDownloadSubOptionFrame.prototype.createDownloadSubOptionFrame=function(){var a=this.objReport;var c=this;var b=document.createElement("div");b.id="report_download_sub_option_frame";if((a.objBody.elmBody.offsetWidth/a.objBody.elmBody.offsetHeight)>1.4){b.className="report_download_sub_option_frame_div "+this.objCss.strClass;}else{b.className="report_download_sub_option_frame_div report_download_sub_option_frame_div_vertical "+this.objCss.strClass;}if(this.objReport.objStyleInfo.strHeaderHeight!=null){b.style.top=this.objReport.objStyleInfo.strHeaderHeight;}this.elmDownloadSubOptionFrame=b;this.objReport.objTargetDOM.appendChild(b);this.choiceOption();};mCR_ReportDownloadSubOptionFrame.prototype.choiceOption=function(){var b=this.objReport.objDownloadMainOptionFrame.strDownloadType;var a=this.objReport.objSaveExportOptionInfo;if(this.elmDownloadSubOptionDetailDiv!=null){this.elmDownloadSubOptionFrame.removeChild(this.elmDownloadSubOptionDetailDiv);this.elmDownloadSubOptionDetailDiv=null;}if(b=="xls"){this.createExcelOptionDetail(a.xls);}else{if(b=="xlsx"){this.createCellOptionDetail(a.xlsx);}else{if(b=="pdf"){this.createPdfOptionDetail(a.pdf);}else{if(b=="hwp"){this.createHwpOptionDetail(a.hwp);}else{if(b=="doc"){this.createDocOptionDetail(a.doc);}else{if(b=="docx"){this.createDocxOptionDetail(a.docx);}else{if(b=="ppt"){this.createPptOptionDetail(a.ppt);}else{if(b=="pptx"){this.createPptxOptionDetail(a.pptx);}else{if(b=="html"){this.createHtmlOptionDetail(a.html);}else{if(b=="cell"){this.createCellOptionDetail(a.cell);}else{if(b=="jpg"){this.createJpgOptionDetail(a.jpg);}else{if(b=="txt"){}else{if(b=="tif"){this.createTifOptionDetail(a.tif);}else{if(b=="multitif"){this.createTifOptionDetail(a.multitif);}else{if(b=="exceldata"){this.createExceldataOptionDetail(a.exceldata);}else{if(b=="brl"){}else{if(b=="show"){this.createPptxOptionDetail(a.show);}else{}}}}}}}}}}}}}}}}}};mCR_ReportDownloadSubOptionFrame.prototype.createDetailErrorText=function(c){this.elmSaveDetailError=null;var b=document.createElement("div");b.className="download_sub_option_err_div";b.style.bottom="15%";b.style.top="80%";b.style.left="0px";b.style.right="0px";b.style.textAlign="center";b.style.position="absolute";c.appendChild(b);var a=document.createElement("SPAN");a.className="download_sub_option_err_span";a.style.color="red";a.style.fontSize="11px";b.appendChild(a);this.elmSaveDetailError=a;};mCR_ReportDownloadSubOptionFrame.prototype.changeDetailErrorText=function(a){this.elmSaveDetailError.innerText=a;};mCR_ReportDownloadSubOptionFrame.prototype.createDownloadSubOption=function(c,b,d){var a=document.createElement("OPTION");a.text=b;a.className="report_download_sub_option";a.value=d;c.add(a);};mCR_ReportDownloadSubOptionFrame.prototype.resizeDiv=function(a){if(a){this.elmDownloadSubOptionFrame.className="report_download_sub_option_frame_div "+this.objCss.strClass;}else{this.elmDownloadSubOptionFrame.className="report_download_sub_option_frame_div report_download_sub_option_frame_div_vertical "+this.objCss.strClass;}};mCR_ReportDownloadSubOptionFrame.prototype.displaySaveCancelButton=function(){this.elmOptionSaveButton.style.display="block";this.elmOptionCancelButton.style.display="block";this.elmOptionChangeButton.style.display="none";};mCR_ReportDownloadSubOptionFrame.prototype.displayChangeButton=function(){this.elmOptionSaveButton.style.display="none";this.elmOptionCancelButton.style.display="none";this.elmOptionChangeButton.style.display="block";};mCR_ReportDownloadSubOptionFrame.prototype.disableDownloadSubOptionFrame=function(){var d=this.elmDownloadSubOptionFrame.getElementsByTagName("input");var a=d.length;for(var c=0;c<a;c++){d[c].disabled=true;}var b=this.elmDownloadSubOptionFrame.getElementsByTagName("select");var a=b.length;for(var c=0;c<a;c++){b[c].disabled=true;}};mCR_ReportDownloadSubOptionFrame.prototype.ableDownloadSubOptionFrame=function(){var d=this.elmDownloadSubOptionFrame.getElementsByTagName("input");var a=d.length;for(var c=0;c<a;c++){d[c].disabled=false;}var b=this.elmDownloadSubOptionFrame.getElementsByTagName("select");var a=b.length;for(var c=0;c<a;c++){b[c].disabled=false;}};mCR_ReportDownloadSubOptionFrame.prototype.keyCheckEvent=function(b){var a=b.keyCode;if(!((a>=48&&a<=57||a==45||a==46))){if(b.preventDefault){b.preventDefault();}b.returnValue=false;}else{return;}};mCR_ReportDownloadSubOptionFrame.prototype.closeDownloadSubOptionFrame=function(){this.objReport.closeDownloadSubOptionFrame();};mCR_ReportDownloadSubOptionFrame.prototype.createCellOptionDetail=function(b){var F=b;var G=this;var p=this.objReport;var n=document.createElement("div");n.style.position="absolute";n.style.top="0px";n.style.left="0px";n.style.width="100%";n.style.height="100%";this.elmDownloadSubOptionFrame.appendChild(n);this.elmDownloadSubOptionDetailDiv=n;var u=document.createElement("div");u.className="report_download_sub_option_div";n.appendChild(u);var D=document.createElement("div");D.style.position="absolute";D.style.left="5%";D.style.width="95%";D.style.top="35px";D.style.height="35px";D.style.textAlign="left";u.appendChild(D);var w=document.createElement("SPAN");w.style.left="0px";var m=document.createTextNode(p.objLanguageMap.sheet_type+" : ");w.appendChild(m);D.appendChild(w);var B=document.createElement("SELECT");B.tabIndex=7;B.style.width="50%";B.style.height="60%";B.style.fontSize="12px";B.title=p.objLanguageMap.sheet_type;B.className="report_download_sub_option_select";this.createDownloadSubOption(B,p.objLanguageMap.sheet_type1,"1");this.createDownloadSubOption(B,p.objLanguageMap.sheet_type2,"2");this.createDownloadSubOption(B,p.objLanguageMap.sheet_type3,"3");this.createDownloadSubOption(B,p.objLanguageMap.sheet_type5,"5");this.createDownloadSubOption(B,p.objLanguageMap.sheet_type4,"4");D.appendChild(B);var D=document.createElement("div");D.style.position="absolute";D.style.left="7%";D.style.width="93%";D.style.top="65px";D.style.height="30px";D.style.textAlign="left";u.appendChild(D);var q=document.createElement("input");q.tabIndex=8;q.id="download_mergecell_option";q.setAttribute("type","checkbox");q.checked=true;D.appendChild(q);var o=document.createElement("label");o.innerText=p.objLanguageMap.merge_cell;o.setAttribute("for","download_mergecell_option");D.appendChild(o);var D=document.createElement("div");D.style.position="absolute";D.style.left="12%";D.style.width="93%";D.style.top="95px";D.style.height="30px";D.style.textAlign="left";u.appendChild(D);var c=document.createElement("input");c.tabIndex=9;c.id="download_mergeemptycell_option";c.setAttribute("type","checkbox");c.checked=true;D.appendChild(c);var o=document.createElement("label");o.innerText=p.objLanguageMap.merge_EmptyCell;o.setAttribute("for","download_mergeemptycell_option");D.appendChild(o);q.onclick=function(){if(this.checked==true){c.disabled=false;}else{c.checked=false;c.disabled=true;}};var D=document.createElement("div");D.style.position="absolute";D.style.left="7%";D.style.width="93%";D.style.top="125px";D.style.height="30px";D.style.textAlign="left";u.appendChild(D);var a=document.createElement("input");a.tabIndex=10;a.id="download_splitcellatpagesize_option";a.setAttribute("type","checkbox");a.checked=true;D.appendChild(a);var o=document.createElement("label");o.innerText=p.objLanguageMap.cell_Separated;o.setAttribute("for","download_splitcellatpagesize_option");D.appendChild(o);var D=document.createElement("div");D.style.position="absolute";D.style.left="7%";D.style.width="93%";D.style.top="155px";D.style.height="30px";D.style.textAlign="left";u.appendChild(D);var C=document.createElement("input");C.tabIndex=11;C.id="download_righttoleft_option";C.setAttribute("type","checkbox");C.checked=true;D.appendChild(C);var o=document.createElement("label");o.innerText=p.objLanguageMap.rightToLeft;o.setAttribute("for","download_righttoleft_option");D.appendChild(o);var D=document.createElement("div");D.style.position="absolute";D.style.left="7%";D.style.width="93%";D.style.top="185px";D.style.height="30px";D.style.textAlign="left";u.appendChild(D);var j=document.createElement("input");j.tabIndex=12;j.id="download_fittopagewhenprinting_option";j.setAttribute("type","checkbox");j.checked=true;D.appendChild(j);var o=document.createElement("label");o.innerText=p.objLanguageMap.fitToPageWhenPrinting;o.setAttribute("for","download_fittopagewhenprinting_option");D.appendChild(o);var D=document.createElement("div");D.style.position="absolute";D.style.left="7%";D.style.width="93%";D.style.top="215px";D.style.height="30px";D.style.textAlign="left";u.appendChild(D);var d=document.createElement("input");d.tabIndex=13;d.id="download_removehyperlink_option";d.setAttribute("type","checkbox");d.checked=true;D.appendChild(d);var o=document.createElement("label");o.innerText=p.objLanguageMap.removeHyperlink;o.setAttribute("for","download_removehyperlink_option");D.appendChild(o);var D=document.createElement("div");D.style.position="absolute";D.style.left="7%";D.style.width="93%";D.style.top="245px";D.style.height="30px";D.style.textAlign="left";u.appendChild(D);var k=document.createElement("input");k.tabIndex=14;k.id="download_repeatPageSectionWhenAllSectionInOneSheet_option";k.setAttribute("type","checkbox");k.checked=true;D.appendChild(k);var o=document.createElement("label");o.innerText=p.objLanguageMap.repeatPageSectionWhenAllSectionInOneSheet;o.setAttribute("for","download_repeatPageSectionWhenAllSectionInOneSheet_option");D.appendChild(o);var h=document.createElement("div");h.className="report_download_cell_size_ratio_div";u.appendChild(h);var E=document.createElement("SPAN");E.style.top="10%";E.style.left="5%";E.style.position="absolute";var v=document.createTextNode(p.objLanguageMap.cellSizeRatio);E.appendChild(v);h.appendChild(E);var y=document.createElement("div");y.style.position="absolute";y.style.top="5%";y.style.left="5%";y.style.width="90%";y.style.height="90%";h.appendChild(y);var g=document.createElement("div");g.style.position="absolute";g.style.top="40%";g.style.left="5%";g.style.width="95%";g.style.height="33%";g.style.textAlign="left";y.appendChild(g);var E=document.createElement("SPAN");var v=document.createTextNode(p.objLanguageMap.cellWidth+" : ");E.appendChild(v);g.appendChild(E);var A=document.createElement("input");A.tabIndex=15;A.type="text";A.style.fontSize="12px";A.style.width="30%";A.title=p.objLanguageMap.cellWidth;A.onkeypress=function(){G.keyCheckEvent(event);};g.appendChild(A);var E=document.createElement("SPAN");var v=document.createTextNode("%");E.appendChild(v);g.appendChild(E);var g=document.createElement("div");g.style.position="absolute";g.style.top="70%";g.style.left="5%";g.style.width="95%";g.style.height="33%";g.style.textAlign="left";y.appendChild(g);var E=document.createElement("SPAN");var v=document.createTextNode(p.objLanguageMap.cellHeight+" : ");E.appendChild(v);g.appendChild(E);var x=document.createElement("input");x.tabIndex=16;x.type="text";x.style.fontSize="12px";x.style.width="30%";x.title=p.objLanguageMap.cellHeight;x.onkeypress=function(){G.keyCheckEvent(event);};g.appendChild(x);var E=document.createElement("SPAN");var v=document.createTextNode("%");E.appendChild(v);g.appendChild(E);var D=document.createElement("div");D.style.position="absolute";D.style.left="5%";D.style.width="95%";D.style.top="400px";D.style.height="35px";D.style.textAlign="left";u.appendChild(D);var E=document.createElement("SPAN");var v=document.createTextNode(p.objLanguageMap.rangeError+" : ");E.appendChild(v);D.appendChild(E);var i=document.createElement("input");i.tabIndex=17;i.type="text";i.style.fontSize="12px";i.style.width="30%";i.title=p.objLanguageMap.rangeError;i.onkeypress=function(){G.keyCheckEvent(event);};D.appendChild(i);var D=document.createElement("div");D.style.position="absolute";D.style.left="5%";D.style.width="95%";D.style.top="435px";D.style.height="35px";D.style.textAlign="left";u.appendChild(D);var E=document.createElement("SPAN");var v=document.createTextNode(p.objLanguageMap.displayFormat+": ");E.appendChild(v);D.appendChild(E);var s=document.createElement("SELECT");s.tabIndex=18;s.style.height="60%";s.style.width="30%";s.style.fontSize="12px";s.title=p.objLanguageMap.displayFormat;s.className="report_download_sub_option_general_format_select";this.createDownloadSubOption(s,p.objLanguageMap.text,"1");this.createDownloadSubOption(s,p.objLanguageMap.normal,"2");D.appendChild(s);var D=document.createElement("div");D.style.position="absolute";D.style.left="5%";D.style.width="95%";D.style.top="470px";D.style.height="35px";D.style.textAlign="left";u.appendChild(D);var E=document.createElement("SPAN");var v=document.createTextNode(p.objLanguageMap.printRate+" : ");E.appendChild(v);D.appendChild(E);var t=document.createElement("input");t.tabIndex=19;t.type="text";t.style.fontSize="12px";t.style.width="30%";t.title=p.objLanguageMap.printRate;t.onkeypress=function(){G.keyCheckEvent(event);};D.appendChild(t);var D=document.createElement("div");D.style.position="absolute";D.style.left="5%";D.style.width="100%";D.style.top="505px";D.style.height="35px";D.style.textAlign="left";u.appendChild(D);var E=document.createElement("SPAN");var v=document.createTextNode(p.objLanguageMap.password+" : ");E.appendChild(v);D.appendChild(E);var H=document.createElement("input");H.tabIndex=20;H.type="password";H.style.fontSize="12px";H.style.width="30%";H.title=p.objLanguageMap.password;D.appendChild(H);var D=document.createElement("div");D.style.position="absolute";D.style.left="5%";D.style.width="95%";D.style.top="540px";D.style.height="35px";D.style.textAlign="left";u.appendChild(D);var E=document.createElement("SPAN");var v=document.createTextNode(p.objLanguageMap.dpi+"(1~600) : ");E.appendChild(v);D.appendChild(E);var z=document.createElement("input");z.tabIndex=20;z.type="text";z.style.fontSize="12px";z.style.width="30%";z.title=p.objLanguageMap.dpi;z.onkeypress=function(){G.keyCheckEvent(event);};D.appendChild(z);B.onchange=function(){if(this.value==3||this.value==4){k.disabled=false;}else{k.disabled=true;}};B.value=F.exportMethod.toString();q.checked=F.mergeCell;c.checked=F.mergeEmptyCell;a.checked=F.splitCellAtPageSize;C.checked=F.rightToLeft;j.checked=F.fitToPageWhenPrinting;d.checked=F.removeHyperlink;k.checked=F.repeatPageSectionWhenAllSectionInOneSheet;A.value=F.widthRate;x.value=F.heightRate;i.value=F.coordinateErrorLimit;s.value=F.processGerenalFormat.toString();t.value=F.printingMagnification;H.value=F.userPassword;z.value=F.dpi;this.createDetailErrorText(n);var r=document.createElement("button");r.tabIndex=6;r.id="download_sub_option_change_button";r.innerHTML=p.objLanguageMap.propertys;r.title=p.objLanguageMap.propertys;r.className="download_sub_option_change_button";r.onclick=function(){G.ableDownloadSubOptionFrame();if(q.checked){c.disabled=false;}else{c.disabled=true;}if(B.value==3||B.value==4){k.disabled=false;}else{k.disabled=true;}G.displaySaveCancelButton();};n.appendChild(r);this.elmOptionChangeButton=r;var f=document.createElement("button");f.tabIndex=20;f.id="download_sub_option_save_button";f.innerHTML=p.objLanguageMap.save;f.title=p.objLanguageMap.save;f.className="download_sub_option_save_button";f.onclick=function(){var I=parseInt(A.value);var L=parseInt(x.value);var K=parseInt(i.value);var M=parseInt(t.value);var J=parseInt(z.value);if(!(I>=50&&I<=200)){G.changeDetailErrorText(p.objLanguageMap.widthError+"\n"+p.objLanguageMap.widthErrorValue);return;}else{if(!(L>=50&&L<=200)){G.changeDetailErrorText(p.objLanguageMap.heightError+"\n"+p.objLanguageMap.heightErrorValue);return;}else{if(!(K>0)){G.changeDetailErrorText(p.objLanguageMap.coordinateError);return;}else{if(!(M>=10&&M<=400)){G.changeDetailErrorText(p.objLanguageMap.printError+"\n"+p.objLanguageMap.printErrorValue);return;}else{if(!(J>=1&&J<=600)){G.changeDetailErrorText(p.objLanguageMap.dpiError);return;}}}}}F.exportMethod=parseInt(B.value);F.mergeCell=q.checked;F.mergeEmptyCell=c.checked;F.splitCellAtPageSize=a.checked;F.rightToLeft=C.checked;F.fitToPageWhenPrinting=j.checked;F.removeHyperlink=d.checked;F.repeatPageSectionWhenAllSectionInOneSheet=k.checked;F.widthRate=I;F.heightRate=L;F.coordinateErrorLimit=K;F.processGerenalFormat=parseInt(s.value);F.printingMagnification=M;F.userPassword=H.value;F.dpi=J;G.changeDetailErrorText("");G.displayChangeButton();G.disableDownloadSubOptionFrame();};n.appendChild(f);this.elmOptionSaveButton=f;var l=document.createElement("button");l.tabIndex=21;l.id="download_sub_option_cancel_button";l.innerHTML=p.objLanguageMap.cancel;l.title=p.objLanguageMap.cancel;l.className="download_sub_option_cancel_button";l.onclick=function(){B.value=F.exportMethod.toString();q.checked=F.mergeCell;c.checked=F.mergeEmptyCell;a.checked=F.splitCellAtPageSize;C.checked=F.rightToLeft;j.checked=F.fitToPageWhenPrinting;d.checked=F.removeHyperlink;k.checked=F.repeatPageSectionWhenAllSectionInOneSheet;A.value=F.widthRate;x.value=F.heightRate;i.value=F.coordinateErrorLimit;s.value=F.processGerenalFormat.toString();t.value=F.printingMagnification;H.value=F.userPassword;G.changeDetailErrorText("");G.displayChangeButton();G.disableDownloadSubOptionFrame();};n.appendChild(l);this.elmOptionCancelButton=l;this.disableDownloadSubOptionFrame();this.displayChangeButton();};mCR_ReportDownloadSubOptionFrame.prototype.createExcelOptionDetail=function(b){var F=b;var G=this;var p=this.objReport;var n=document.createElement("div");n.style.position="absolute";n.style.top="0px";n.style.left="0px";n.style.width="100%";n.style.height="100%";this.elmDownloadSubOptionFrame.appendChild(n);this.elmDownloadSubOptionDetailDiv=n;var u=document.createElement("div");u.className="report_download_sub_option_div";n.appendChild(u);var D=document.createElement("div");D.style.position="absolute";D.style.left="5%";D.style.width="95%";D.style.top="35px";D.style.height="35px";D.style.textAlign="left";u.appendChild(D);var w=document.createElement("SPAN");w.style.left="0px";var m=document.createTextNode(p.objLanguageMap.sheet_type+" : ");w.appendChild(m);D.appendChild(w);var B=document.createElement("SELECT");B.tabIndex=7;B.style.width="50%";B.style.height="60%";B.style.fontSize="12px";B.title=p.objLanguageMap.sheet_type;B.className="report_download_sub_option_select";this.createDownloadSubOption(B,p.objLanguageMap.sheet_type1,"1");this.createDownloadSubOption(B,p.objLanguageMap.sheet_type2,"2");this.createDownloadSubOption(B,p.objLanguageMap.sheet_type3,"3");this.createDownloadSubOption(B,p.objLanguageMap.sheet_type5,"5");this.createDownloadSubOption(B,p.objLanguageMap.sheet_type4,"4");D.appendChild(B);var D=document.createElement("div");D.style.position="absolute";D.style.left="7%";D.style.width="93%";D.style.top="65px";D.style.height="30px";D.style.textAlign="left";u.appendChild(D);var q=document.createElement("input");q.tabIndex=8;q.id="download_mergecell_option";q.setAttribute("type","checkbox");q.checked=true;D.appendChild(q);var o=document.createElement("label");o.innerText=p.objLanguageMap.merge_cell;o.setAttribute("for","download_mergecell_option");D.appendChild(o);var D=document.createElement("div");D.style.position="absolute";D.style.left="12%";D.style.width="93%";D.style.top="95px";D.style.height="30px";D.style.textAlign="left";u.appendChild(D);var c=document.createElement("input");c.tabIndex=9;c.id="download_mergeemptycell_option";c.setAttribute("type","checkbox");c.checked=true;D.appendChild(c);var o=document.createElement("label");o.innerText=p.objLanguageMap.merge_EmptyCell;o.setAttribute("for","download_mergeemptycell_option");D.appendChild(o);q.onclick=function(){if(this.checked==true){c.disabled=false;}else{c.checked=false;c.disabled=true;}};var D=document.createElement("div");D.style.position="absolute";D.style.left="7%";D.style.width="93%";D.style.top="125px";D.style.height="30px";D.style.textAlign="left";u.appendChild(D);var a=document.createElement("input");a.tabIndex=10;a.id="download_splitcellatpagesize_option";a.setAttribute("type","checkbox");a.checked=true;D.appendChild(a);var o=document.createElement("label");o.innerText=p.objLanguageMap.cell_Separated;o.setAttribute("for","download_splitcellatpagesize_option");D.appendChild(o);var D=document.createElement("div");D.style.position="absolute";D.style.left="7%";D.style.width="93%";D.style.top="155px";D.style.height="30px";D.style.textAlign="left";u.appendChild(D);var C=document.createElement("input");C.tabIndex=11;C.id="download_righttoleft_option";C.setAttribute("type","checkbox");C.checked=true;D.appendChild(C);var o=document.createElement("label");o.innerText=p.objLanguageMap.rightToLeft;o.setAttribute("for","download_righttoleft_option");D.appendChild(o);var D=document.createElement("div");D.style.position="absolute";D.style.left="7%";D.style.width="93%";D.style.top="185px";D.style.height="30px";D.style.textAlign="left";u.appendChild(D);var j=document.createElement("input");j.tabIndex=12;j.id="download_fittopagewhenprinting_option";j.setAttribute("type","checkbox");j.checked=true;D.appendChild(j);var o=document.createElement("label");o.innerText=p.objLanguageMap.fitToPageWhenPrinting;o.setAttribute("for","download_fittopagewhenprinting_option");D.appendChild(o);var D=document.createElement("div");D.style.position="absolute";D.style.left="7%";D.style.width="93%";D.style.top="215px";D.style.height="30px";D.style.textAlign="left";u.appendChild(D);var d=document.createElement("input");d.tabIndex=13;d.id="download_removehyperlink_option";d.setAttribute("type","checkbox");d.checked=true;D.appendChild(d);var o=document.createElement("label");o.innerText=p.objLanguageMap.removeHyperlink;o.setAttribute("for","download_removehyperlink_option");D.appendChild(o);var D=document.createElement("div");D.style.position="absolute";D.style.left="7%";D.style.width="93%";D.style.top="245px";D.style.height="30px";D.style.textAlign="left";u.appendChild(D);var k=document.createElement("input");k.tabIndex=14;k.id="download_repeatPageSectionWhenAllSectionInOneSheet_option";k.setAttribute("type","checkbox");k.checked=true;D.appendChild(k);var o=document.createElement("label");o.innerText=p.objLanguageMap.repeatPageSectionWhenAllSectionInOneSheet;o.setAttribute("for","download_repeatPageSectionWhenAllSectionInOneSheet_option");D.appendChild(o);var h=document.createElement("div");h.className="report_download_cell_size_ratio_div";u.appendChild(h);var E=document.createElement("SPAN");E.style.top="10%";E.style.left="5%";E.style.position="absolute";var v=document.createTextNode(p.objLanguageMap.cellSizeRatio);E.appendChild(v);h.appendChild(E);var y=document.createElement("div");y.style.position="absolute";y.style.top="5%";y.style.left="5%";y.style.width="90%";y.style.height="90%";h.appendChild(y);var g=document.createElement("div");g.style.position="absolute";g.style.top="40%";g.style.left="5%";g.style.width="95%";g.style.height="33%";g.style.textAlign="left";y.appendChild(g);var E=document.createElement("SPAN");var v=document.createTextNode(p.objLanguageMap.cellWidth+" : ");E.appendChild(v);g.appendChild(E);var A=document.createElement("input");A.tabIndex=15;A.type="text";A.style.fontSize="12px";A.style.width="30%";A.title=p.objLanguageMap.cellWidth;A.onkeypress=function(){G.keyCheckEvent(event);};g.appendChild(A);var E=document.createElement("SPAN");var v=document.createTextNode("%");E.appendChild(v);g.appendChild(E);var g=document.createElement("div");g.style.position="absolute";g.style.top="70%";g.style.left="5%";g.style.width="95%";g.style.height="33%";g.style.textAlign="left";y.appendChild(g);var E=document.createElement("SPAN");var v=document.createTextNode(p.objLanguageMap.cellHeight+" : ");E.appendChild(v);g.appendChild(E);var x=document.createElement("input");x.tabIndex=16;x.type="text";x.style.fontSize="12px";x.style.width="30%";x.title=p.objLanguageMap.cellHeight;x.onkeypress=function(){G.keyCheckEvent(event);};g.appendChild(x);var E=document.createElement("SPAN");var v=document.createTextNode("%");E.appendChild(v);g.appendChild(E);var D=document.createElement("div");D.style.position="absolute";D.style.left="5%";D.style.width="95%";D.style.top="400px";D.style.height="35px";D.style.textAlign="left";u.appendChild(D);var E=document.createElement("SPAN");var v=document.createTextNode(p.objLanguageMap.rangeError+" : ");E.appendChild(v);D.appendChild(E);var i=document.createElement("input");i.tabIndex=17;i.type="text";i.style.fontSize="12px";i.style.width="30%";i.title=p.objLanguageMap.rangeError;i.onkeypress=function(){G.keyCheckEvent(event);};D.appendChild(i);var D=document.createElement("div");D.style.position="absolute";D.style.left="5%";D.style.width="95%";D.style.top="435px";D.style.height="35px";D.style.textAlign="left";u.appendChild(D);var E=document.createElement("SPAN");var v=document.createTextNode(p.objLanguageMap.displayFormat+": ");E.appendChild(v);D.appendChild(E);var s=document.createElement("SELECT");s.tabIndex=18;s.style.height="60%";s.style.width="30%";s.style.fontSize="12px";s.title=p.objLanguageMap.displayFormat;s.className="report_download_sub_option_general_format_select";this.createDownloadSubOption(s,p.objLanguageMap.text,"1");this.createDownloadSubOption(s,p.objLanguageMap.normal,"2");D.appendChild(s);var D=document.createElement("div");D.style.position="absolute";D.style.left="5%";D.style.width="95%";D.style.top="470px";D.style.height="35px";D.style.textAlign="left";u.appendChild(D);var E=document.createElement("SPAN");var v=document.createTextNode(p.objLanguageMap.printRate+" : ");E.appendChild(v);D.appendChild(E);var t=document.createElement("input");t.tabIndex=19;t.type="text";t.style.fontSize="12px";t.style.width="30%";t.title=p.objLanguageMap.printRate;t.onkeypress=function(){G.keyCheckEvent(event);};D.appendChild(t);var D=document.createElement("div");D.style.position="absolute";D.style.left="5%";D.style.width="95%";D.style.top="505px";D.style.height="35px";D.style.textAlign="left";u.appendChild(D);var E=document.createElement("SPAN");var v=document.createTextNode(p.objLanguageMap.dpi+"(1~600) : ");E.appendChild(v);D.appendChild(E);var z=document.createElement("input");z.tabIndex=20;z.type="text";z.style.fontSize="12px";z.style.width="30%";z.title=p.objLanguageMap.dpi;z.onkeypress=function(){G.keyCheckEvent(event);};D.appendChild(z);B.onchange=function(){if(this.value==3||this.value==4){k.disabled=false;}else{k.disabled=true;}};B.value=F.exportMethod.toString();q.checked=F.mergeCell;c.checked=F.mergeEmptyCell;a.checked=F.splitCellAtPageSize;C.checked=F.rightToLeft;j.checked=F.fitToPageWhenPrinting;d.checked=F.removeHyperlink;k.checked=F.repeatPageSectionWhenAllSectionInOneSheet;A.value=F.widthRate;x.value=F.heightRate;i.value=F.coordinateErrorLimit;s.value=F.processGerenalFormat.toString();t.value=F.printingMagnification;z.value=F.dpi;this.createDetailErrorText(n);var r=document.createElement("button");r.tabIndex=6;r.id="download_sub_option_change_button";r.innerHTML=p.objLanguageMap.propertys;r.title=p.objLanguageMap.propertys;r.className="download_sub_option_change_button";r.onclick=function(){G.ableDownloadSubOptionFrame();if(q.checked){c.disabled=false;}else{c.disabled=true;}if(B.value==3||B.value==4){k.disabled=false;}else{k.disabled=true;}G.displaySaveCancelButton();};n.appendChild(r);this.elmOptionChangeButton=r;var f=document.createElement("button");f.tabIndex=20;f.id="download_sub_option_save_button";f.innerHTML=p.objLanguageMap.save;f.title=p.objLanguageMap.save;f.className="download_sub_option_save_button";f.onclick=function(){var H=parseInt(A.value);var K=parseInt(x.value);var J=parseInt(i.value);var L=parseInt(t.value);var I=parseInt(z.value);if(!(H>=50&&H<=200)){G.changeDetailErrorText(p.objLanguageMap.widthError+"\n"+p.objLanguageMap.widthErrorValue);return;}else{if(!(K>=50&&K<=200)){G.changeDetailErrorText(p.objLanguageMap.heightError+"\n"+p.objLanguageMap.heightErrorValue);return;}else{if(!(J>0)){G.changeDetailErrorText(p.objLanguageMap.coordinateError);return;}else{if(!(L>=10&&L<=400)){G.changeDetailErrorText(p.objLanguageMap.printError+"\n"+p.objLanguageMap.printErrorValue);return;}else{if(!(I>=1&&I<=600)){G.changeDetailErrorText(p.objLanguageMap.dpiError);return;}}}}}F.exportMethod=parseInt(B.value);F.mergeCell=q.checked;F.mergeEmptyCell=c.checked;F.splitCellAtPageSize=a.checked;F.rightToLeft=C.checked;F.fitToPageWhenPrinting=j.checked;F.removeHyperlink=d.checked;F.repeatPageSectionWhenAllSectionInOneSheet=k.checked;F.widthRate=H;F.heightRate=K;F.coordinateErrorLimit=J;F.processGerenalFormat=parseInt(s.value);F.printingMagnification=L;F.dpi=I;G.changeDetailErrorText("");G.displayChangeButton();G.disableDownloadSubOptionFrame();};n.appendChild(f);this.elmOptionSaveButton=f;var l=document.createElement("button");l.tabIndex=21;l.id="download_sub_option_cancel_button";l.innerHTML=p.objLanguageMap.cancel;l.title=p.objLanguageMap.cancel;l.className="download_sub_option_cancel_button";l.onclick=function(){B.value=F.exportMethod.toString();q.checked=F.mergeCell;c.checked=F.mergeEmptyCell;a.checked=F.splitCellAtPageSize;C.checked=F.rightToLeft;j.checked=F.fitToPageWhenPrinting;d.checked=F.removeHyperlink;k.checked=F.repeatPageSectionWhenAllSectionInOneSheet;A.value=F.widthRate;x.value=F.heightRate;i.value=F.coordinateErrorLimit;s.value=F.processGerenalFormat.toString();t.value=F.printingMagnification;G.changeDetailErrorText("");G.displayChangeButton();G.disableDownloadSubOptionFrame();};n.appendChild(l);this.elmOptionCancelButton=l;this.disableDownloadSubOptionFrame();this.displayChangeButton();};mCR_ReportDownloadSubOptionFrame.prototype.createDocOptionDetail=function(a){var t=a;var u=this;var j=this.objReport;var g=document.createElement("div");g.style.position="absolute";g.style.top="0px";g.style.left="0px";g.style.width="100%";g.style.height="100%";this.elmDownloadSubOptionFrame.appendChild(g);this.elmDownloadSubOptionDetailDiv=g;var m=document.createElement("div");m.style.position="absolute";m.style.top="0px";m.style.left="5%";m.style.width="95%";m.style.height="80%";m.style.overflowX="hidden";m.style.overflowY="auto";g.appendChild(m);var q=document.createElement("div");q.style.position="absolute";q.style.left="0px";q.style.width="100%";q.style.top="35px";q.style.height="35px";q.style.textAlign="left";m.appendChild(q);var c=document.createElement("input");c.tabIndex=7;c.id="download_splittextline_option";c.setAttribute("type","checkbox");c.checked=true;q.appendChild(c);var i=document.createElement("label");i.innerText=j.objLanguageMap.splitTextByLine;i.setAttribute("for","download_splittextline_option");q.appendChild(i);var q=document.createElement("div");q.style.position="absolute";q.style.width="100%";q.style.left="0px";q.style.top="70px";q.style.height="35px";q.style.textAlign="left";m.appendChild(q);var r=document.createElement("SPAN");var o=document.createTextNode(j.objLanguageMap.defaultCharGap+" : ");r.appendChild(o);q.appendChild(r);var h=document.createElement("input");h.tabIndex=8;h.type="text";h.style.fontSize="12px";h.style.width="30%";h.title=j.objLanguageMap.defaultCharGap;h.onkeypress=function(){u.keyCheckEvent(event);};q.appendChild(h);var r=document.createElement("SPAN");var o=document.createTextNode(" pt");r.appendChild(o);q.appendChild(r);var q=document.createElement("div");q.style.position="absolute";q.style.width="100%";q.style.left="0px";q.style.top="105px";q.style.height="30px";q.style.textAlign="left";m.appendChild(q);var p=document.createElement("input");p.tabIndex=9;p.id="download_mergetable_option";p.setAttribute("type","checkbox");p.checked=true;q.appendChild(p);var i=document.createElement("label");i.innerText=j.objLanguageMap.mergeTable;i.setAttribute("for","download_mergetable_option");q.appendChild(i);var q=document.createElement("div");q.style.position="absolute";q.style.left="0px";q.style.width="100%";q.style.top="135px";q.style.height="30px";q.style.textAlign="left";m.appendChild(q);var l=document.createElement("input");l.tabIndex=10;l.id="download_fitshapetotext_option";l.setAttribute("type","checkbox");l.checked=true;q.appendChild(l);var i=document.createElement("label");i.innerText=j.objLanguageMap.fitShapeToText;i.setAttribute("for","download_fitshapetotext_option");q.appendChild(i);var q=document.createElement("div");q.style.position="absolute";q.style.left="0px";q.style.width="100%";q.style.top="165px";q.style.height="30px";q.style.textAlign="left";m.appendChild(q);var s=document.createElement("input");s.tabIndex=11;s.id="download_inserttablewrapper_option";s.setAttribute("type","checkbox");s.checked=true;q.appendChild(s);var i=document.createElement("label");i.innerText=j.objLanguageMap.insertTableWrapper;i.setAttribute("for","download_inserttablewrapper_option");q.appendChild(i);s.onclick=function(){if(this.checked==true){b.disabled=false;}else{b.value=0;b.disabled=true;}};var q=document.createElement("div");q.style.position="absolute";q.style.left="0px";q.style.width="100%";q.style.top="200px";q.style.height="35px";q.style.textAlign="left";m.appendChild(q);var r=document.createElement("SPAN");var o=document.createTextNode(j.objLanguageMap.tableWrapperBottomGap+" : ");r.appendChild(o);q.appendChild(r);var b=document.createElement("input");b.tabIndex=12;b.type="text";b.style.fontSize="12px";b.style.width="30%";b.title=j.objLanguageMap.tableWrapperBottomGap;b.onkeypress=function(){u.keyCheckEvent(event);};q.appendChild(b);var q=document.createElement("div");q.style.position="absolute";q.style.left="0px";q.style.width="100%";q.style.top="235px";q.style.height="35px";q.style.textAlign="left";m.appendChild(q);var r=document.createElement("SPAN");var o=document.createTextNode(j.objLanguageMap.TableRowHeightSort+": ");r.appendChild(o);q.appendChild(r);var n=document.createElement("SELECT");n.tabIndex=13;n.style.fontSize="12px";n.style.width="30%";n.style.height="60%";n.title=j.objLanguageMap.displayFormat;n.className="report_download_sub_option_table_row_height_sort_select";this.createDownloadSubOption(n,j.objLanguageMap.fix,"1");this.createDownloadSubOption(n,j.objLanguageMap.minimum,"2");q.appendChild(n);c.checked=t.splitTextLine;h.value=t.defaultCharSpace;p.checked=t.mergeTable;l.checked=t.fitShapeToText;s.checked=t.insertTableWrapper;b.value=t.tableWrapperBottomGap;n.value=t.TableRowHeightSort.toString();this.createDetailErrorText(g);var k=document.createElement("button");k.tabIndex=6;k.id="download_sub_option_change_button";k.innerHTML=j.objLanguageMap.propertys;k.title=j.objLanguageMap.propertys;k.className="download_sub_option_change_button";k.onclick=function(){u.ableDownloadSubOptionFrame();if(s.checked){b.disabled=false;}else{b.disabled=true;}u.displaySaveCancelButton();};g.appendChild(k);this.elmOptionChangeButton=k;var d=document.createElement("button");d.tabIndex=14;d.id="download_sub_option_save_button";d.innerHTML=j.objLanguageMap.save;d.title=j.objLanguageMap.save;d.className="download_sub_option_save_button";d.onclick=function(){var w=parseFloat(h.value);var v=parseInt(b.value);if(!(w>=-3&&w<=3)){u.changeDetailErrorText(j.objLanguageMap.defaultCharGapError+"\n"+j.objLanguageMap.defaultCharGapValue2Error);return;}else{if(!(v>=0&&v<=500)){u.changeDetailErrorText(j.objLanguageMap.tableWrapperBottomGapError+"\n"+j.objLanguageMap.tableWrapperBottomGapValueError);return;}}t.splitTextLine=c.checked;t.defaultCharSpace=parseFloat(h.value);t.mergeTable=p.checked;t.fitShapeToText=l.checked;t.insertTableWrapper=s.checked;t.tableWrapperBottomGap=parseInt(b.value);t.TableRowHeightSort=parseInt(n.value);u.changeDetailErrorText("");u.displayChangeButton();u.disableDownloadSubOptionFrame();};g.appendChild(d);this.elmOptionSaveButton=d;var f=document.createElement("button");f.tabIndex=15;f.id="download_sub_option_cancel_button";f.innerHTML=j.objLanguageMap.cancel;f.title=j.objLanguageMap.cancel;f.className="download_sub_option_cancel_button";f.onclick=function(){c.checked=t.splitTextLine;h.value=t.defaultCharSpace;p.checked=t.mergeTable;l.checked=t.fitShapeToText;s.checked=t.insertTableWrapper;b.value=t.tableWrapperBottomGap;n.value=t.TableRowHeightSort.toString();u.changeDetailErrorText("");u.displayChangeButton();u.disableDownloadSubOptionFrame();};g.appendChild(f);this.elmOptionCancelButton=f;this.disableDownloadSubOptionFrame();this.displayChangeButton();};mCR_ReportDownloadSubOptionFrame.prototype.createDocxOptionDetail=function(a){var t=a;var u=this;var j=this.objReport;var g=document.createElement("div");g.style.position="absolute";g.style.top="0px";g.style.left="0px";g.style.width="100%";g.style.height="100%";this.elmDownloadSubOptionFrame.appendChild(g);this.elmDownloadSubOptionDetailDiv=g;var n=document.createElement("div");n.style.position="absolute";n.style.top="0px";n.style.left="5%";n.style.width="95%";n.style.height="80%";n.style.overflowX="hidden";n.style.overflowY="auto";g.appendChild(n);var q=document.createElement("div");q.style.position="absolute";q.style.left="0px";q.style.width="100%";q.style.top="35px";q.style.height="35px";q.style.textAlign="left";n.appendChild(q);var c=document.createElement("input");c.tabIndex=7;c.id="download_splittextline_option";c.setAttribute("type","checkbox");c.checked=true;q.appendChild(c);var i=document.createElement("label");i.innerText=j.objLanguageMap.splitTextByLine;i.setAttribute("for","download_splittextline_option");q.appendChild(i);var q=document.createElement("div");q.style.position="absolute";q.style.width="100%";q.style.left="0px";q.style.top="70px";q.style.height="35px";q.style.textAlign="left";n.appendChild(q);var r=document.createElement("SPAN");var o=document.createTextNode(j.objLanguageMap.defaultCharGap+" : ");r.appendChild(o);q.appendChild(r);var h=document.createElement("input");h.tabIndex=8;h.type="text";h.style.fontSize="12px";h.style.width="30%";h.title=j.objLanguageMap.defaultCharGap;h.onkeypress=function(){u.keyCheckEvent(event);};q.appendChild(h);var r=document.createElement("SPAN");var o=document.createTextNode(" pt");r.appendChild(o);q.appendChild(r);var q=document.createElement("div");q.style.position="absolute";q.style.width="100%";q.style.left="0px";q.style.top="105px";q.style.height="30px";q.style.textAlign="left";n.appendChild(q);var p=document.createElement("input");p.tabIndex=9;p.id="download_mergetable_option";p.setAttribute("type","checkbox");p.checked=true;q.appendChild(p);var i=document.createElement("label");i.innerText=j.objLanguageMap.mergeTable;i.setAttribute("for","download_mergetable_option");q.appendChild(i);var q=document.createElement("div");q.style.position="absolute";q.style.left="0px";q.style.width="100%";q.style.top="135px";q.style.height="30px";q.style.textAlign="left";n.appendChild(q);var s=document.createElement("input");s.tabIndex=10;s.id="download_inserttablewrapper_option";s.setAttribute("type","checkbox");s.checked=true;q.appendChild(s);var i=document.createElement("label");i.innerText=j.objLanguageMap.insertTableWrapper;i.setAttribute("for","download_inserttablewrapper_option");q.appendChild(i);s.onclick=function(){if(this.checked==true){b.disabled=false;}else{b.value=0;b.disabled=true;}};var q=document.createElement("div");q.style.position="absolute";q.style.left="0px";q.style.width="100%";q.style.top="170px";q.style.height="35px";q.style.textAlign="left";n.appendChild(q);var r=document.createElement("SPAN");var o=document.createTextNode(j.objLanguageMap.tableWrapperBottomGap+" : ");r.appendChild(o);q.appendChild(r);var b=document.createElement("input");b.tabIndex=11;b.type="text";b.style.fontSize="12px";b.style.width="30%";b.title=j.objLanguageMap.tableWrapperBottomGap;b.onkeypress=function(){u.keyCheckEvent(event);};q.appendChild(b);var q=document.createElement("div");q.style.position="absolute";q.style.left="0px";q.style.width="100%";q.style.top="205px";q.style.height="35px";q.style.textAlign="left";n.appendChild(q);var r=document.createElement("SPAN");var o=document.createTextNode(j.objLanguageMap.lineSpaceRate+" : ");r.appendChild(o);q.appendChild(r);var l=document.createElement("input");l.tabIndex=12;l.type="text";l.style.fontSize="12px";l.style.width="30%";l.title=j.objLanguageMap.lineSpaceRate;l.onkeypress=function(){u.keyCheckEvent(event);};q.appendChild(l);var q=document.createElement("div");q.style.position="absolute";q.style.left="0px";q.style.width="100%";q.style.top="240px";q.style.height="35px";q.style.textAlign="left";n.appendChild(q);var m=document.createElement("input");m.tabIndex=10;m.id="download_easyeditable_option";m.setAttribute("type","checkbox");m.checked=true;q.appendChild(m);var i=document.createElement("label");i.innerText=j.objLanguageMap.easyEditable;i.setAttribute("for","download_easyeditable_option");q.appendChild(i);var q=document.createElement("div");q.style.position="absolute";q.style.left="0px";q.style.width="100%";q.style.top="275px";q.style.height="35px";q.style.textAlign="left";n.appendChild(q);var r=document.createElement("SPAN");var o=document.createTextNode(j.objLanguageMap.password+" : ");r.appendChild(o);q.appendChild(r);var v=document.createElement("input");v.tabIndex=20;v.type="password";v.style.fontSize="12px";v.style.width="30%";v.title=j.objLanguageMap.password;q.appendChild(v);c.checked=t.splitTextLine;h.value=t.defaultCharSpace;p.checked=t.mergeTable;s.checked=t.insertTableWrapper;b.value=t.tableWrapperBottomGap;l.value=t.lineSpaceRate.toString();m.checked=t.easyEditable;v.value=t.userPassword;this.createDetailErrorText(g);var k=document.createElement("button");k.tabIndex=6;k.id="download_sub_option_change_button";k.innerHTML=j.objLanguageMap.propertys;k.title=j.objLanguageMap.propertys;k.className="download_sub_option_change_button";k.onclick=function(){u.ableDownloadSubOptionFrame();if(s.checked){b.disabled=false;}else{b.disabled=true;}u.displaySaveCancelButton();};g.appendChild(k);this.elmOptionChangeButton=k;var d=document.createElement("button");d.tabIndex=14;d.id="download_sub_option_save_button";d.innerHTML=j.objLanguageMap.save;d.title=j.objLanguageMap.save;d.className="download_sub_option_save_button";d.onclick=function(){var x=parseFloat(h.value);var w=parseInt(b.value);if(!(x>=-3&&x<=3)){u.changeDetailErrorText(j.objLanguageMap.defaultCharGapError+"\n"+j.objLanguageMap.defaultCharGapValue2Error);return;}else{if(!(w>=0&&w<=500)){u.changeDetailErrorText(j.objLanguageMap.tableWrapperBottomGapError+"\n"+j.objLanguageMap.tableWrapperBottomGapValueError);return;}}t.splitTextLine=c.checked;t.defaultCharSpace=parseFloat(h.value);t.mergeTable=p.checked;t.insertTableWrapper=s.checked;t.tableWrapperBottomGap=parseInt(b.value);t.lineSpaceRate=parseInt(l.value);t.easyEditable=m.checked;t.userPassword=v.value;u.changeDetailErrorText("");u.displayChangeButton();u.disableDownloadSubOptionFrame();};g.appendChild(d);this.elmOptionSaveButton=d;var f=document.createElement("button");f.tabIndex=15;f.id="download_sub_option_cancel_button";f.innerHTML=j.objLanguageMap.cancel;f.title=j.objLanguageMap.cancel;f.className="download_sub_option_cancel_button";f.onclick=function(){c.checked=t.splitTextLine;h.value=t.defaultCharSpace;p.checked=t.mergeTable;s.checked=t.insertTableWrapper;b.value=t.tableWrapperBottomGap;l.value=t.lineSpaceRate;m.checked=t.easyEditable;v.value=t.userPassword;u.changeDetailErrorText("");u.displayChangeButton();u.disableDownloadSubOptionFrame();};g.appendChild(f);this.elmOptionCancelButton=f;this.disableDownloadSubOptionFrame();this.displayChangeButton();};mCR_ReportDownloadSubOptionFrame.prototype.createExceldataOptionDetail=function(h){var g=h;var b=this;var j=this.objReport;var m=document.createElement("div");m.style.position="absolute";m.style.top="0px";m.style.left="0px";m.style.width="100%";m.style.height="100%";this.elmDownloadSubOptionFrame.appendChild(m);this.elmDownloadSubOptionDetailDiv=m;var f=document.createElement("div");f.style.position="absolute";f.style.top="0px";f.style.left="5%";f.style.width="95%";f.style.height="80%";f.style.overflowX="hidden";f.style.overflowY="auto";m.appendChild(f);var c=document.createElement("div");c.style.position="absolute";c.style.left="0px";c.style.width="100%";c.style.top="35px";c.style.height="35px";c.style.textAlign="left";f.appendChild(c);var n=document.createElement("SPAN");n.style.left="0px";var a=document.createTextNode(j.objLanguageMap.outputPageSectionMethod+" : ");n.appendChild(a);c.appendChild(n);var k=document.createElement("SELECT");k.tabIndex=7;k.style.width="30%";k.style.fontSize="12px";k.style.height="60%";k.title=j.objLanguageMap.sheet_type;k.className="report_download_sub_option_select";this.createDownloadSubOption(k,j.objLanguageMap.none,"0");this.createDownloadSubOption(k,j.objLanguageMap.atOnce,"1");this.createDownloadSubOption(k,j.objLanguageMap.repeatAtEachPage,"2");c.appendChild(k);k.value=g.outputPageSectionMethod;this.createDetailErrorText(m);var d=document.createElement("button");d.tabIndex=6;d.id="download_sub_option_change_button";d.innerHTML=j.objLanguageMap.propertys;d.title=j.objLanguageMap.propertys;d.className="download_sub_option_change_button";d.onclick=function(){b.ableDownloadSubOptionFrame();b.displaySaveCancelButton();};m.appendChild(d);this.elmOptionChangeButton=d;var i=document.createElement("button");i.tabIndex=8;i.id="download_sub_option_save_button";i.innerHTML=j.objLanguageMap.save;i.title=j.objLanguageMap.save;i.className="download_sub_option_save_button";i.onclick=function(){g.outputPageSectionMethod=parseInt(k.value);b.displayChangeButton();b.disableDownloadSubOptionFrame();};m.appendChild(i);this.elmOptionSaveButton=i;var l=document.createElement("button");l.tabIndex=9;l.id="download_sub_option_cancel_button";l.innerHTML=j.objLanguageMap.cancel;l.title=j.objLanguageMap.cancel;l.className="download_sub_option_cancel_button";l.onclick=function(){k.value=g.outputPageSectionMethod;b.displayChangeButton();b.disableDownloadSubOptionFrame();};m.appendChild(l);this.elmOptionCancelButton=l;this.disableDownloadSubOptionFrame();this.displayChangeButton();};mCR_ReportDownloadSubOptionFrame.prototype.createHtmlOptionDetail=function(j){var h=j;var b=this;var l=this.objReport;var p=document.createElement("div");p.style.position="absolute";p.style.top="0px";p.style.left="0px";p.style.width="100%";p.style.height="100%";this.elmDownloadSubOptionFrame.appendChild(p);this.elmDownloadSubOptionDetailDiv=p;var g=document.createElement("div");g.style.position="absolute";g.style.top="0px";g.style.left="5%";g.style.width="95%";g.style.height="80%";g.style.overflowX="hidden";g.style.overflowY="auto";p.appendChild(g);var c=document.createElement("div");c.style.position="absolute";c.style.left="0px";c.style.width="100%";c.style.top="35px";c.style.height="35px";c.style.textAlign="left";g.appendChild(c);var a=document.createElement("input");a.tabIndex=7;a.id="download_issplite_option";a.setAttribute("type","checkbox");a.checked=true;c.appendChild(a);var d=document.createElement("label");d.innerText=l.objLanguageMap.html5page;d.setAttribute("for","download_issplite_option");c.appendChild(d);var c=document.createElement("div");c.style.position="absolute";c.style.left="0px";c.style.width="100%";c.style.top="70px";c.style.height="35px";c.style.textAlign="left";g.appendChild(c);var m=document.createElement("SPAN");var o=document.createTextNode(l.objLanguageMap.dpi+" : ");m.appendChild(o);c.appendChild(m);var i=document.createElement("input");i.tabIndex=8;i.type="text";i.style.fontSize="12px";i.style.width="30%";i.title=l.objLanguageMap.dpi;i.onkeypress=function(){b.keyCheckEvent(event);};c.appendChild(i);a.checked=h.isSplite;i.value=h.dpiValue;this.createDetailErrorText(p);var f=document.createElement("button");f.tabIndex=6;f.id="download_sub_option_change_button";f.innerHTML=l.objLanguageMap.propertys;f.title=l.objLanguageMap.propertys;f.className="download_sub_option_change_button";f.onclick=function(){b.ableDownloadSubOptionFrame();b.displaySaveCancelButton();};p.appendChild(f);this.elmOptionChangeButton=f;var k=document.createElement("button");k.tabIndex=9;k.id="download_sub_option_save_button";k.innerHTML=l.objLanguageMap.save;k.title=l.objLanguageMap.save;k.className="download_sub_option_save_button";k.onclick=function(){h.isSplite=a.checked;h.dpiValue=parseInt(i.value);b.changeDetailErrorText("");b.displayChangeButton();b.disableDownloadSubOptionFrame();};p.appendChild(k);this.elmOptionSaveButton=k;var n=document.createElement("button");n.tabIndex=10;n.id="download_sub_option_cancel_button";n.innerHTML=l.objLanguageMap.cancel;n.title=l.objLanguageMap.cancel;n.className="download_sub_option_cancel_button";n.onclick=function(){a.checked=h.isSplite;i.value=h.dpiValue;b.changeDetailErrorText("");b.displayChangeButton();b.disableDownloadSubOptionFrame();};p.appendChild(n);this.elmOptionCancelButton=n;this.disableDownloadSubOptionFrame();this.displayChangeButton();};mCR_ReportDownloadSubOptionFrame.prototype.createHwpOptionDetail=function(b){var H=b;var I=this;var v=this.objReport;var r=document.createElement("div");r.style.position="absolute";r.style.top="0px";r.style.left="0px";r.style.width="100%";r.style.height="100%";this.elmDownloadSubOptionFrame.appendChild(r);this.elmDownloadSubOptionDetailDiv=r;var y=document.createElement("div");y.style.position="absolute";y.style.top="0px";y.style.left="5%";y.style.width="95%";y.style.height="80%";y.style.overflowX="hidden";y.style.overflowY="auto";r.appendChild(y);var E=document.createElement("div");E.style.position="absolute";E.style.left="0px";E.style.width="100%";E.style.height="35px";E.style.top="35px";E.style.textAlign="left";y.appendChild(E);var B=document.createElement("SPAN");B.style.left="0px";var q=document.createTextNode(v.objLanguageMap.hwpExportMethod+" : ");B.appendChild(q);E.appendChild(B);var g=document.createElement("SELECT");g.tabIndex=7;g.style.width="30%";g.style.height="60%";g.style.fontSize="12px";g.title=v.objLanguageMap.hwpExportMethod;g.className="report_download_hwpexportmethod_option_select";this.createDownloadSubOption(g,v.objLanguageMap.normal,"1");this.createDownloadSubOption(g,v.objLanguageMap.listTableOnly,"2");E.appendChild(g);var E=document.createElement("div");E.style.position="absolute";E.style.width="98%";E.style.top="70px";E.style.height="30px";E.style.left="2%";E.style.textAlign="left";y.appendChild(E);var x=document.createElement("input");x.tabIndex=8;x.id="download_splitpageonlisttableonly_option";x.setAttribute("type","checkbox");x.checked=true;E.appendChild(x);var t=document.createElement("label");t.innerText=v.objLanguageMap.splitPageOnListTableOnly;t.setAttribute("for","download_splitpageonlisttableonly_option");E.appendChild(t);var E=document.createElement("div");E.style.position="absolute";E.style.width="98%";E.style.top="100px";E.style.height="30px";E.style.left="2%";E.style.textAlign="left";y.appendChild(E);var d=document.createElement("input");d.tabIndex=9;d.id="download_fixsize_option";d.setAttribute("type","checkbox");d.checked=true;E.appendChild(d);var t=document.createElement("label");t.innerText=v.objLanguageMap.fixSize;t.setAttribute("for","download_fixsize_option");E.appendChild(t);var E=document.createElement("div");E.style.position="absolute";E.style.width="98%";E.style.top="130px";E.style.height="35px";E.style.left="2%";E.style.textAlign="left";y.appendChild(E);var B=document.createElement("SPAN");B.style.left="0px";var q=document.createTextNode(v.objLanguageMap.positionRelTo+" : ");B.appendChild(q);E.appendChild(B);var f=document.createElement("SELECT");f.tabIndex=10;f.style.width="30%";f.style.height="60%";f.style.fontSize="12px";f.title=v.objLanguageMap.positionRelTo;f.className="report_download_positionrelto_option_select";this.createDownloadSubOption(f,v.objLanguageMap.paper,"1");this.createDownloadSubOption(f,v.objLanguageMap.paragraph,"2");E.appendChild(f);var E=document.createElement("div");E.style.position="absolute";E.style.width="93%";E.style.top="165px";E.style.height="30px";E.style.left="7%";E.style.textAlign="left";y.appendChild(E);var a=document.createElement("input");a.tabIndex=11;a.id="download_allowoverlay_option";a.setAttribute("type","checkbox");a.checked=true;E.appendChild(a);var t=document.createElement("label");t.innerText=v.objLanguageMap.allowOverlay;t.setAttribute("for","download_allowoverlay_option");E.appendChild(t);var E=document.createElement("div");E.style.position="absolute";E.style.width="98%";E.style.top="195px";E.style.height="30px";E.style.left="2%";E.style.textAlign="left";y.appendChild(E);var A=document.createElement("input");A.tabIndex=12;A.id="download_setpagebottommarginoozero_option";A.setAttribute("type","checkbox");A.checked=true;E.appendChild(A);var t=document.createElement("label");t.innerText=v.objLanguageMap.mergeTable;t.setAttribute("for","download_setpagebottommarginoozero_option");E.appendChild(t);var E=document.createElement("div");E.style.position="absolute";E.style.width="100%";E.style.top="225px";E.style.height="30px";E.style.left="2%";E.style.textAlign="left";y.appendChild(E);var p=document.createElement("input");p.tabIndex=13;p.id="download_setPagebottommargintozero_option";p.setAttribute("type","checkbox");p.checked=true;E.appendChild(p);var t=document.createElement("label");t.innerText=v.objLanguageMap.setPageBottomMarginToZero;t.setAttribute("for","download_setPagebottommargintozero_option");E.appendChild(t);var E=document.createElement("div");E.style.position="absolute";E.style.width="93%";E.style.top="255px";E.style.height="35px";E.style.left="7%";E.style.textAlign="left";y.appendChild(E);var G=document.createElement("SPAN");var z=document.createTextNode(v.objLanguageMap.pageBottomMarginApplicationRate+" : ");G.appendChild(z);E.appendChild(G);var s=document.createElement("input");s.tabIndex=14;s.type="text";s.style.fontSize="12px";s.style.width="15%";s.title=v.objLanguageMap.pageBottomMarginApplicationRate;s.onkeypress=function(){I.keyCheckEvent(event);};E.appendChild(s);var G=document.createElement("SPAN");var z=document.createTextNode(" %");G.appendChild(z);E.appendChild(G);var E=document.createElement("div");E.style.position="absolute";E.style.width="98%";E.style.top="290px";E.style.height="30px";E.style.left="2%";E.style.textAlign="left";y.appendChild(E);var D=document.createElement("input");D.tabIndex=15;D.id="download_outputlikeword_option";D.setAttribute("type","checkbox");D.checked=true;E.appendChild(D);var t=document.createElement("label");t.innerText=v.objLanguageMap.outputLikeWord;t.setAttribute("for","download_outputlikeword_option");E.appendChild(t);var E=document.createElement("div");E.style.position="absolute";E.style.width="93%";E.style.top="320px";E.style.height="35px";E.style.left="7%";E.style.textAlign="left";y.appendChild(E);var B=document.createElement("SPAN");B.style.left="0px";var q=document.createTextNode(v.objLanguageMap.tableSplit+" : ");B.appendChild(q);E.appendChild(B);var h=document.createElement("SELECT");h.tabIndex=16;h.style.width="30%";h.style.height="60%";h.style.fontSize="12px";h.title=v.objLanguageMap.tableSplit;h.className="report_download_positionrelto_option_select";this.createDownloadSubOption(h,v.objLanguageMap.Split,"1");this.createDownloadSubOption(h,v.objLanguageMap.cellSplit,"2");this.createDownloadSubOption(h,v.objLanguageMap.noneSplit,"3");E.appendChild(h);var E=document.createElement("div");E.style.position="absolute";E.style.left="0px";E.style.width="100%";E.style.top="355px";E.style.height="35px";E.style.textAlign="left";y.appendChild(E);var G=document.createElement("SPAN");var z=document.createTextNode(v.objLanguageMap.defaultCharGap+" : ");G.appendChild(z);E.appendChild(G);var j=document.createElement("input");j.tabIndex=17;j.type="text";j.style.fontSize="12px";j.style.width="20%";j.title=v.objLanguageMap.defaultCharGap;j.onkeypress=function(){I.keyCheckEvent(event);};E.appendChild(j);var G=document.createElement("SPAN");var z=document.createTextNode(" %");G.appendChild(z);E.appendChild(G);var E=document.createElement("div");E.style.position="absolute";E.style.left="0px";E.style.width="100%";E.style.top="390px";E.style.height="35px";E.style.textAlign="left";y.appendChild(E);var G=document.createElement("SPAN");var z=document.createTextNode(v.objLanguageMap.charRatio+" : ");G.appendChild(z);E.appendChild(G);var c=document.createElement("input");c.tabIndex=18;c.type="text";c.style.fontSize="12px";c.style.width="20%";c.title=v.objLanguageMap.charRatio;c.onkeypress=function(){I.keyCheckEvent(event);};E.appendChild(c);var G=document.createElement("SPAN");var z=document.createTextNode(" %");G.appendChild(z);E.appendChild(G);var E=document.createElement("div");E.style.position="absolute";E.style.left="0px";E.style.width="100%";E.style.top="425px";E.style.height="35px";E.style.textAlign="left";y.appendChild(E);var G=document.createElement("SPAN");var z=document.createTextNode(v.objLanguageMap.lineSpaceRate+" : ");G.appendChild(z);E.appendChild(G);var u=document.createElement("input");u.tabIndex=19;u.type="text";u.style.fontSize="12px";u.style.width="20%";u.title=v.objLanguageMap.lineSpaceRate;u.onkeypress=function(){I.keyCheckEvent(event);};E.appendChild(u);var G=document.createElement("SPAN");var z=document.createTextNode(" %");G.appendChild(z);E.appendChild(G);var E=document.createElement("div");E.style.position="absolute";E.style.left="0px";E.style.width="100%";E.style.top="460px";E.style.height="30px";E.style.textAlign="left";y.appendChild(E);var J=document.createElement("input");J.tabIndex=20;J.id="download_putcheckboxintocell_option";J.setAttribute("type","checkbox");J.checked=true;E.appendChild(J);var t=document.createElement("label");t.innerText=v.objLanguageMap.putCheckboxIntoCell;t.setAttribute("for","download_putcheckboxintocell_option");E.appendChild(t);var E=document.createElement("div");E.style.position="absolute";E.style.left="0px";E.style.width="100%";E.style.top="490px";E.style.height="30px";E.style.textAlign="left";y.appendChild(E);var i=document.createElement("input");i.tabIndex=21;i.id="download_splittextbyline_option";i.setAttribute("type","checkbox");i.checked=true;E.appendChild(i);var t=document.createElement("label");t.innerText=v.objLanguageMap.splitTextByLine;t.setAttribute("for","download_splittextbyline_option");E.appendChild(t);var E=document.createElement("div");E.style.position="absolute";E.style.left="0px";E.style.width="100%";E.style.top="520px";E.style.height="30px";E.style.textAlign="left";y.appendChild(E);var m=document.createElement("input");m.tabIndex=22;m.id="download_insertpagenumber_option";m.setAttribute("type","checkbox");m.checked=true;E.appendChild(m);var t=document.createElement("label");t.innerText=v.objLanguageMap.insertPageNumber;t.setAttribute("for","download_insertpagenumber_option");E.appendChild(t);var E=document.createElement("div");E.style.position="absolute";E.style.left="0px";E.style.width="100%";E.style.top="550px";E.style.height="30px";E.style.textAlign="left";y.appendChild(E);var F=document.createElement("input");F.tabIndex=23;F.id="download_mergealltablesonlisttableonly_option";F.setAttribute("type","checkbox");F.checked=true;E.appendChild(F);var t=document.createElement("label");t.innerText=v.objLanguageMap.mergeAllTablesOnListTableOnly;t.setAttribute("for","download_mergealltablesonlisttableonly_option");E.appendChild(t);var E=document.createElement("div");E.style.position="absolute";E.style.left="0px";E.style.width="100%";E.style.top="580px";E.style.height="30px";E.style.textAlign="left";y.appendChild(E);var C=document.createElement("input");C.tabIndex=24;C.id="download_insertlabelwithtextonlisttableonly_option";C.setAttribute("type","checkbox");C.checked=true;E.appendChild(C);var t=document.createElement("label");t.innerText=v.objLanguageMap.insertLabelWithTextOnListTableOnly;t.setAttribute("for","download_insertlabelwithtextonlisttableonly_option");E.appendChild(t);var E=document.createElement("div");E.style.position="absolute";E.style.left="0px";E.style.width="100%";E.style.top="610px";E.style.height="30px";E.style.textAlign="left";y.appendChild(E);var l=document.createElement("input");l.tabIndex=25;l.id="download_istransparentmode_option";l.setAttribute("type","checkbox");l.checked=true;E.appendChild(l);var t=document.createElement("label");t.innerText=v.objLanguageMap.isTransparentMode;t.setAttribute("for","download_istransparentmode_option");E.appendChild(t);var o=document.createElement("div");o.style.position="absolute";o.style.top="640px";o.style.left="0px";o.style.width="100%";o.style.height="30px";o.style.textAlign="center";y.appendChild(o);var G=document.createElement("SPAN");G.style.backgroundColor="#EBEBEB";var z=document.createTextNode(v.objLanguageMap.hwpDownlodaInfo);G.appendChild(z);o.appendChild(G);g.value=H.hwpExportMethod.toString();x.checked=H.splitPageOnListTableOnly;d.checked=H.fixSize;f.value=H.positionRelTo.toString();a.checked=H.allowOverlay;A.checked=H.mergeTable;p.checked=H.setPageBottomMarginToZero;s.value=H.pageBottomMarginApplicationRate;D.checked=H.outputLikeWord;h.value=H.tableSplitMethod.toString();j.value=H.defaultCharGap;c.value=H.charRatio;u.value=H.lineSpaceRate;J.checked=H.putCheckboxIntoCell;i.checked=H.splitTextByLine;m.checked=H.insertPageNumber;C.checked=H.insertLabelWithTextOnListTableOnly;F.checked=H.mergeAllTablesOnListTableOnly;l.checked=H.isTransparentMode;g.onchange=function(){if(this.value=="1"){x.disabled=true;d.disabled=false;f.disabled=false;if(f.value=="1"){a.disabled=true;}else{a.disabled=false;}A.disabled=false;p.disabled=false;if(p.checked){s.disabled=true;}else{s.disabled=false;}D.disabled=false;if(D.checked){h.disabled=false;}else{h.disabled=true;}C.disabled=true;F.disabled=true;}else{x.disabled=false;d.disabled=true;f.disabled=true;a.disabled=true;A.disabled=true;p.disabled=true;s.disabled=false;D.disabled=true;h.disabled=true;C.disabled=false;F.disabled=false;}};f.onchange=function(){if(this.value=="1"){a.disabled=true;}else{a.disabled=false;}};p.onclick=function(){if(this.checked){s.disabled=true;}else{s.disabled=false;}};D.onclick=function(){if(this.checked){h.disabled=false;}else{h.disabled=true;}};this.createDetailErrorText(r);var w=document.createElement("button");w.tabIndex=6;w.id="download_sub_option_change_button";w.innerHTML=v.objLanguageMap.propertys;w.title=v.objLanguageMap.propertys;w.className="download_sub_option_change_button";w.onclick=function(){I.ableDownloadSubOptionFrame();if(g.value=="1"){x.disabled=true;d.disabled=false;f.disabled=false;if(f.value=="1"){a.disabled=true;}else{a.disabled=false;}A.disabled=false;p.disabled=false;if(p.checked){s.disabled=true;}else{s.disabled=false;}D.disabled=false;if(D.checked){h.disabled=false;}else{h.disabled=true;}C.disabled=true;F.disabled=true;}else{x.disabled=false;d.disabled=true;f.disabled=true;a.disabled=true;A.disabled=true;p.disabled=true;s.disabled=false;D.disabled=true;h.disabled=true;C.disabled=false;F.disabled=false;}I.displaySaveCancelButton();};r.appendChild(w);this.elmOptionChangeButton=w;var k=document.createElement("button");k.tabIndex=22;k.id="download_sub_option_save_button";k.innerHTML=v.objLanguageMap.save;k.title=v.objLanguageMap.save;k.className="download_sub_option_save_button";k.onclick=function(){var K=parseInt(s.value);var L=parseInt(j.value);var N=parseInt(c.value);var M=parseInt(u.value);if(!(K>=1&&K<=100)){I.changeDetailErrorText(v.objLanguageMap.bottomMarginError+"\n"+v.objLanguageMap.bottomMarginValueError);return;}else{if(!(L>=-50&&L<=50)){I.changeDetailErrorText(v.objLanguageMap.defaultCharGapError+"\n"+v.objLanguageMap.defaultCharGapValueError);return;}else{if(!(N>=50&&N<=200)){I.changeDetailErrorText(v.objLanguageMap.charRatioError+"\n"+v.objLanguageMap.charRatioValueError);return;}}}if(M==""||isNaN(M)){u.value="0";}H.hwpExportMethod=parseInt(g.value);H.splitPageOnListTableOnly=x.checked;H.fixSize=d.checked;H.positionRelTo=parseInt(f.value);H.allowOverlay=a.checked;H.mergeTable=A.checked;H.setPageBottomMarginToZero=p.checked;H.pageBottomMarginApplicationRate=parseInt(s.value);H.outputLikeWord=D.checked;H.tableSplitMethod=parseInt(h.value);H.defaultCharGap=parseInt(j.value);H.charRatio=parseInt(c.value);H.lineSpaceRate=parseInt(u.value);H.putCheckboxIntoCell=J.checked;H.splitTextByLine=i.checked;H.insertPageNumber=m.checked;H.insertLabelWithTextOnListTableOnly=C.checked;H.mergeAllTablesOnListTableOnly=F.checked;H.isTransparentMode=l.checked;I.changeDetailErrorText("");I.displayChangeButton();I.disableDownloadSubOptionFrame();};r.appendChild(k);this.elmOptionSaveButton=k;var n=document.createElement("button");n.tabIndex=23;n.id="download_sub_option_cancel_button";n.innerHTML=v.objLanguageMap.cancel;n.title=v.objLanguageMap.cancel;n.className="download_sub_option_cancel_button";n.onclick=function(){g.value=H.hwpExportMethod.toString();x.checked=H.splitPageOnListTableOnly;d.checked=H.fixSize;f.value=H.positionRelTo.toString();a.checked=H.allowOverlay;A.checked=H.mergeTable;p.checked=H.setPageBottomMarginToZero;s.value=H.pageBottomMarginApplicationRate;D.checked=H.outputLikeWord;h.value=H.tableSplitMethod.toString();j.value=H.defaultCharGap;c.value=H.charRatio;u.value=H.lineSpaceRate;J.checked=H.putCheckboxIntoCell;i.checked=H.splitTextByLine;m.checked=H.insertPageNumber;C.checked=H.insertLabelWithTextOnListTableOnly;F.checked=H.mergeAllTablesOnListTableOnly;l.checked=H.isTransparentMode;I.changeDetailErrorText("");I.displayChangeButton();I.disableDownloadSubOptionFrame();};r.appendChild(n);this.elmOptionCancelButton=n;this.disableDownloadSubOptionFrame();this.displayChangeButton();};mCR_ReportDownloadSubOptionFrame.prototype.createJpgOptionDetail=function(j){var h=j;var a=this;var n=this.objReport;var r=document.createElement("div");r.style.position="absolute";r.style.top="0px";r.style.left="0px";r.style.width="100%";r.style.height="100%";this.elmDownloadSubOptionFrame.appendChild(r);this.elmDownloadSubOptionDetailDiv=r;var g=document.createElement("div");g.style.position="absolute";g.style.top="0px";g.style.left="5%";g.style.width="95%";g.style.height="80%";g.style.overflowX="hidden";g.style.overflowY="auto";r.appendChild(g);var c=document.createElement("div");c.style.position="absolute";c.style.left="0px";c.style.width="100%";c.style.top="35px";c.style.height="30px";c.style.textAlign="left";g.appendChild(c);var i=document.createElement("input");i.tabIndex=7;i.id="download_rotate_option";i.setAttribute("type","checkbox");i.checked=true;c.appendChild(i);var d=document.createElement("label");d.innerText=n.objLanguageMap.rotate90;d.setAttribute("for","download_rotate_option");c.appendChild(d);var c=document.createElement("div");c.style.position="absolute";c.style.left="0px";c.style.width="100%";c.style.top="65px";c.style.height="35px";c.style.textAlign="left";g.appendChild(c);var o=document.createElement("SPAN");var q=document.createTextNode(n.objLanguageMap.dpiX+" : ");o.appendChild(q);c.appendChild(o);var m=document.createElement("input");m.tabIndex=8;m.type="text";m.style.fontSize="12px";m.style.width="30%";m.title=n.objLanguageMap.dpiX;m.onkeypress=function(){a.keyCheckEvent(event);};c.appendChild(m);var c=document.createElement("div");c.style.position="absolute";c.style.left="0px";c.style.width="100%";c.style.top="100px";c.style.height="35px";c.style.textAlign="left";g.appendChild(c);var o=document.createElement("SPAN");var q=document.createTextNode(n.objLanguageMap.dpiY+" : ");o.appendChild(q);c.appendChild(o);var b=document.createElement("input");b.tabIndex=9;b.type="text";b.style.fontSize="12px";b.style.width="30%";b.title=n.objLanguageMap.dpiY;b.onkeypress=function(){a.keyCheckEvent(event);};c.appendChild(b);var c=document.createElement("div");c.style.position="absolute";c.style.left="0px";c.style.width="100%";c.style.top="135px";c.style.height="35px";c.style.textAlign="left";g.appendChild(c);var o=document.createElement("SPAN");var q=document.createTextNode(n.objLanguageMap.quality+" : ");o.appendChild(q);c.appendChild(o);var l=document.createElement("input");l.tabIndex=10;l.type="text";l.style.fontSize="12px";l.style.width="30%";l.title=n.objLanguageMap.quality;l.onkeypress=function(){a.keyCheckEvent(event);};c.appendChild(l);i.checked=h.rotate90;m.value=h.dpiX;b.value=h.dpiY;l.value=h.quality;this.createDetailErrorText(r);var f=document.createElement("button");f.tabIndex=6;f.id="download_sub_option_change_button";f.innerHTML=n.objLanguageMap.propertys;f.title=n.objLanguageMap.propertys;f.className="download_sub_option_change_button";f.onclick=function(){a.ableDownloadSubOptionFrame();a.displaySaveCancelButton();};r.appendChild(f);this.elmOptionChangeButton=f;var k=document.createElement("button");k.tabIndex=11;k.id="download_sub_option_save_button";k.innerHTML=n.objLanguageMap.save;k.title=n.objLanguageMap.save;k.className="download_sub_option_save_button";k.onclick=function(){var s=parseInt(l.value);if(!(s>=1&&s<=100)){a.changeDetailErrorText(n.objLanguageMap.qualityError+"\n"+n.objLanguageMap.qualityErrorValue);return;}h.rotate90=i.checked;h.dpiX=parseInt(m.value);h.dpiY=parseInt(b.value);h.quality=parseInt(l.value);a.changeDetailErrorText("");a.displayChangeButton();a.disableDownloadSubOptionFrame();};r.appendChild(k);this.elmOptionSaveButton=k;var p=document.createElement("button");p.tabIndex=12;p.id="download_sub_option_cancel_button";p.innerHTML=n.objLanguageMap.cancel;p.title=n.objLanguageMap.cancel;p.className="download_sub_option_cancel_button";p.onclick=function(){i.checked=h.rotate90;m.value=h.dpiX;b.value=h.dpiY;l.value=h.quality;a.changeDetailErrorText("");a.displayChangeButton();a.disableDownloadSubOptionFrame();};r.appendChild(p);this.elmOptionCancelButton=p;this.disableDownloadSubOptionFrame();this.displayChangeButton();};mCR_ReportDownloadSubOptionFrame.prototype.createPdfOptionDetail=function(a){var r=a;var s=this;var k=this.objReport;var h=document.createElement("div");h.style.position="absolute";h.style.top="0px";h.style.left="0px";h.style.width="100%";h.style.height="100%";this.elmDownloadSubOptionFrame.appendChild(h);this.elmDownloadSubOptionDetailDiv=h;var n=document.createElement("div");n.style.position="absolute";n.style.top="0px";n.style.left="5%";n.style.width="95%";n.style.height="80%";n.style.overflowX="hidden";n.style.overflowY="auto";h.appendChild(n);var p=document.createElement("div");p.style.position="absolute";p.style.left="0px";p.style.width="100%";p.style.top="35px";p.style.height="35px";p.style.textAlign="left";n.appendChild(p);var q=document.createElement("SPAN");var o=document.createTextNode(k.objLanguageMap.password+" : ");q.appendChild(o);p.appendChild(q);var d=document.createElement("input");d.tabIndex=7;d.type="password";d.style.fontSize="12px";d.style.width="30%";d.title=k.objLanguageMap.password;p.appendChild(d);var p=document.createElement("div");p.style.position="absolute";p.style.left="0px";p.style.width="100%";p.style.top="70px";p.style.height="30px";p.style.textAlign="left";n.appendChild(p);var f=document.createElement("input");f.tabIndex=8;f.id="download_texttoimage_option";f.setAttribute("type","checkbox");f.checked=true;p.appendChild(f);var i=document.createElement("label");i.innerText=k.objLanguageMap.textToImage;i.setAttribute("for","download_texttoimage_option");p.appendChild(i);var p=document.createElement("div");p.style.position="absolute";p.style.left="0px";p.style.width="100%";p.style.top="100px";p.style.height="30px";p.style.textAlign="left";n.appendChild(p);var l=document.createElement("input");l.tabIndex=9;l.id="download_importoriginimage_option";l.setAttribute("type","checkbox");l.checked=true;p.appendChild(l);var i=document.createElement("label");i.innerText=k.objLanguageMap.importOriginImage;i.setAttribute("for","download_importoriginimage_option");p.appendChild(i);var p=document.createElement("div");p.style.position="absolute";p.style.left="0px";p.style.width="100%";p.style.top="130px";p.style.height="30px";p.style.textAlign="left";n.appendChild(p);var b=document.createElement("input");b.tabIndex=10;b.id="download_removehyperlink_option";b.setAttribute("type","checkbox");b.checked=true;p.appendChild(b);var i=document.createElement("label");i.innerText=k.objLanguageMap.removeHyperlink;i.setAttribute("for","download_removehyperlink_option");p.appendChild(i);var p=document.createElement("div");p.style.position="absolute";p.style.left="0px";p.style.width="100%";p.style.top="160px";p.style.height="30px";p.style.textAlign="left";n.appendChild(p);var j=document.createElement("input");j.tabIndex=11;j.id="download_usecodex_option";j.setAttribute("type","checkbox");j.checked=true;p.appendChild(j);var i=document.createElement("label");i.innerText=k.objLanguageMap.useCodeX;i.setAttribute("for","download_usecodex_option");p.appendChild(i);f.checked=r.textToImage;d.value=r.userpw;l.checked=r.importOriginImage;b.checked=r.removeHyperlink;j.checked=r.useCodeX;this.createDetailErrorText(h);var m=document.createElement("button");m.tabIndex=6;m.id="download_sub_option_change_button";m.innerHTML=k.objLanguageMap.propertys;m.className="download_sub_option_change_button";m.title=k.objLanguageMap.propertys;m.onclick=function(){s.ableDownloadSubOptionFrame();s.displaySaveCancelButton();};h.appendChild(m);this.elmOptionChangeButton=m;var c=document.createElement("button");c.tabIndex=11;c.id="download_sub_option_save_button";c.innerHTML=k.objLanguageMap.save;c.title=k.objLanguageMap.save;c.className="download_sub_option_save_button";c.onclick=function(){r.textToImage=f.checked;r.userpw=d.value;r.importOriginImage=l.checked;r.removeHyperlink=b.checked;r.useCodeX=j.checked;s.displayChangeButton();s.disableDownloadSubOptionFrame();};h.appendChild(c);this.elmOptionSaveButton=c;var g=document.createElement("button");g.tabIndex=12;g.id="download_sub_option_cancel_button";g.innerHTML=k.objLanguageMap.cancel;g.title=k.objLanguageMap.cancel;g.className="download_sub_option_cancel_button";g.onclick=function(){f.checked=r.textToImage;d.value=r.userpw;l.checked=r.importOriginImage;b.checked=r.removeHyperlink;j.checked=r.useCodeX;s.displayChangeButton();s.disableDownloadSubOptionFrame();};h.appendChild(g);this.elmOptionCancelButton=g;this.disableDownloadSubOptionFrame();this.displayChangeButton();};mCR_ReportDownloadSubOptionFrame.prototype.createPptOptionDetail=function(i){var g=i;var a=this;var l=this.objReport;var n=document.createElement("div");n.style.position="absolute";n.style.top="0px";n.style.left="0px";n.style.width="100%";n.style.height="100%";this.elmDownloadSubOptionFrame.appendChild(n);this.elmDownloadSubOptionDetailDiv=n;var f=document.createElement("div");f.style.position="absolute";f.style.top="0px";f.style.left="5%";f.style.width="95%";f.style.height="80%";f.style.overflowX="hidden";f.style.overflowY="auto";n.appendChild(f);var b=document.createElement("div");b.style.position="absolute";b.style.left="0px";b.style.width="100%";b.style.top="35px";b.style.height="30px";b.style.textAlign="left";f.appendChild(b);var k=document.createElement("input");k.tabIndex=7;k.id="download_mergetable_option";k.setAttribute("type","checkbox");k.checked=true;b.appendChild(k);var c=document.createElement("label");c.innerText=l.objLanguageMap.mergeTable;c.setAttribute("for","download_mergetable_option");b.appendChild(c);var b=document.createElement("div");b.style.position="absolute";b.style.left="0px";b.style.width="100%";b.style.top="65px";b.style.height="30px";b.style.textAlign="left";f.appendChild(b);var h=document.createElement("input");h.tabIndex=8;h.id="download_ignorelinespace_option";h.setAttribute("type","checkbox");h.checked=true;b.appendChild(h);var c=document.createElement("label");c.innerText=l.objLanguageMap.ignoreLineSpace;c.setAttribute("for","download_ignorelinespace_option");b.appendChild(c);var b=document.createElement("div");b.style.position="absolute";b.style.left="0px";b.style.width="100%";b.style.top="95px";b.style.height="30px";b.style.textAlign="left";f.appendChild(b);var o=document.createElement("input");o.tabIndex=9;o.id="download_removehyperlink_option";o.setAttribute("type","checkbox");o.checked=true;b.appendChild(o);var c=document.createElement("label");c.innerText=l.objLanguageMap.removeHyperlink;c.setAttribute("for","download_removehyperlink_option");b.appendChild(c);k.checked=g.mergeTable;h.checked=g.ignoreLineSpace;o.checked=g.removeHyperlink;this.createDetailErrorText(n);var d=document.createElement("button");d.tabIndex=6;d.id="download_sub_option_change_button";d.innerHTML=l.objLanguageMap.propertys;d.title=l.objLanguageMap.propertys;d.className="download_sub_option_change_button";d.onclick=function(){a.ableDownloadSubOptionFrame();a.displaySaveCancelButton();};n.appendChild(d);this.elmOptionChangeButton=d;var j=document.createElement("button");j.tabIndex=10;j.id="download_sub_option_save_button";j.innerHTML=l.objLanguageMap.save;j.title=l.objLanguageMap.save;j.className="download_sub_option_save_button";j.onclick=function(){g.mergeTable=k.checked;g.ignoreLineSpace=h.checked;g.removeHyperlink=o.checked;a.displayChangeButton();a.disableDownloadSubOptionFrame();};n.appendChild(j);this.elmOptionSaveButton=j;var m=document.createElement("button");m.tabIndex=11;m.id="download_sub_option_cancel_button";m.innerHTML=l.objLanguageMap.cancel;m.title=l.objLanguageMap.cancel;m.className="download_sub_option_cancel_button";m.onclick=function(){k.checked=g.mergeTable;h.checked=g.ignoreLineSpace;o.checked=g.removeHyperlink;a.displayChangeButton();a.disableDownloadSubOptionFrame();};n.appendChild(m);this.elmOptionCancelButton=m;this.disableDownloadSubOptionFrame();this.displayChangeButton();};mCR_ReportDownloadSubOptionFrame.prototype.createPptxOptionDetail=function(a){var s=a;var t=this;var i=this.objReport;var g=document.createElement("div");g.style.position="absolute";g.style.top="0px";g.style.left="0px";g.style.width="100%";g.style.height="100%";this.elmDownloadSubOptionFrame.appendChild(g);this.elmDownloadSubOptionDetailDiv=g;var l=document.createElement("div");l.style.position="absolute";l.style.top="0px";l.style.left="5%";l.style.width="95%";l.style.height="80%";l.style.overflowX="hidden";l.style.overflowY="auto";g.appendChild(l);var p=document.createElement("div");p.style.position="absolute";p.style.left="0px";p.style.width="100%";p.style.top="35px";p.style.height="30px";p.style.textAlign="left";l.appendChild(p);var n=document.createElement("input");n.id="download_mergetable_option";n.setAttribute("type","checkbox");n.checked=true;p.appendChild(n);var h=document.createElement("label");h.innerText=i.objLanguageMap.mergeTable;h.setAttribute("for","download_mergetable_option");p.appendChild(h);var p=document.createElement("div");p.style.position="absolute";p.style.left="0px";p.style.width="100%";p.style.top="65px";p.style.height="30px";p.style.textAlign="left";l.appendChild(p);var b=document.createElement("input");b.id="download_removehyperlink_option";b.setAttribute("type","checkbox");b.checked=true;p.appendChild(b);var h=document.createElement("label");h.innerText=i.objLanguageMap.removeHyperlink;h.setAttribute("for","download_removehyperlink_option");p.appendChild(h);var p=document.createElement("div");p.style.position="absolute";p.style.left="0px";p.style.width="100%";p.style.top="95px";p.style.height="30px";p.style.textAlign="left";l.appendChild(p);var o=document.createElement("input");o.id="download_splittextbyline_option";o.setAttribute("type","checkbox");o.checked=true;p.appendChild(o);var h=document.createElement("label");h.innerText=i.objLanguageMap.splitTextByLine;h.setAttribute("for","download_splittextbyline_option");p.appendChild(h);var p=document.createElement("div");p.style.position="absolute";p.style.left="0px";p.style.width="100%";p.style.top="130px";p.style.height="35px";p.style.textAlign="left";l.appendChild(p);var q=document.createElement("SPAN");var m=document.createTextNode(i.objLanguageMap.defaultCharGap+" : ");q.appendChild(m);p.appendChild(q);var r=document.createElement("input");r.tabIndex=9;r.type="text";r.style.fontSize="12px";r.style.width="30%";r.title=i.objLanguageMap.defaultCharGap;r.onkeypress=function(){t.keyCheckEvent(event);};p.appendChild(r);var p=document.createElement("div");p.style.position="absolute";p.style.left="0px";p.style.width="100%";p.style.top="165px";p.style.height="35px";p.style.textAlign="left";l.appendChild(p);var q=document.createElement("SPAN");var m=document.createTextNode(i.objLanguageMap.lineSpaceRate+" : ");q.appendChild(m);p.appendChild(q);var k=document.createElement("input");k.tabIndex=9;k.type="text";k.style.fontSize="12px";k.style.width="30%";k.title=i.objLanguageMap.lineSpaceRate;k.onkeypress=function(){t.keyCheckEvent(event);};p.appendChild(k);var p=document.createElement("div");p.style.position="absolute";p.style.left="0px";p.style.width="100%";p.style.top="200px";p.style.height="30px";p.style.textAlign="left";l.appendChild(p);var d=document.createElement("input");d.id="download_putcheckboxintocell_option";d.setAttribute("type","checkbox");d.checked=true;p.appendChild(d);var h=document.createElement("label");h.innerText=i.objLanguageMap.putCheckboxIntoCell;h.setAttribute("for","download_putcheckboxintocell_option");p.appendChild(h);var p=document.createElement("div");p.style.position="absolute";p.style.left="0px";p.style.width="100%";p.style.top="235px";p.style.height="35px";p.style.textAlign="left";l.appendChild(p);var q=document.createElement("SPAN");var m=document.createTextNode(i.objLanguageMap.password+" : ");q.appendChild(m);p.appendChild(q);var u=document.createElement("input");u.tabIndex=20;u.type="password";u.style.fontSize="12px";u.style.width="30%";u.title=i.objLanguageMap.password;p.appendChild(u);n.checked=s.mergeTable;b.checked=s.removeHyperlink;o.checked=s.splitTextByLine;r.value=s.defaultCharGap.toString();k.value=s.lineSpaceRate.toString();d.checked=s.putCheckboxIntoCell;u.value=s.userPassword;this.createDetailErrorText(g);var j=document.createElement("button");j.id="download_sub_option_change_button";j.innerHTML=i.objLanguageMap.propertys;j.title=i.objLanguageMap.propertys;j.className="download_sub_option_change_button";j.onclick=function(){t.ableDownloadSubOptionFrame();t.displaySaveCancelButton();};g.appendChild(j);this.elmOptionChangeButton=j;var c=document.createElement("button");c.id="download_sub_option_save_button";c.innerHTML=i.objLanguageMap.save;c.title=i.objLanguageMap.save;c.className="download_sub_option_save_button";c.onclick=function(){var v=parseFloat(r.value);if(!(v>=-3&&v<=3)){t.changeDetailErrorText(i.objLanguageMap.defaultCharGapError+"\n"+i.objLanguageMap.defaultCharGapValue2Error);return;}s.mergeTable=n.checked;s.removeHyperlink=b.checked;s.splitTextByLine=o.checked;s.defaultCharGap=parseFloat(r.value);s.lineSpaceRate=parseFloat(k.value);s.putCheckboxIntoCell=d.checked;s.userPassword=u.value;t.changeDetailErrorText("");t.displayChangeButton();t.disableDownloadSubOptionFrame();};g.appendChild(c);this.elmOptionSaveButton=c;var f=document.createElement("button");f.id="download_sub_option_cancel_button";f.innerHTML=i.objLanguageMap.cancel;f.title=i.objLanguageMap.cancel;f.className="download_sub_option_cancel_button";f.onclick=function(){n.checked=s.mergeTable;b.checked=s.removeHyperlink;o.checked=s.splitTextByLine;r.value=s.defaultCharGap.toString();k.value=s.lineSpaceRate.toString();d.checked=s.putCheckboxIntoCell;u.value=s.userPassword;t.changeDetailErrorText("");t.displayChangeButton();t.disableDownloadSubOptionFrame();};g.appendChild(f);this.elmOptionCancelButton=f;this.disableDownloadSubOptionFrame();this.displayChangeButton();};mCR_ReportDownloadSubOptionFrame.prototype.createTifOptionDetail=function(j){var h=j;var a=this;var n=this.objReport;var r=document.createElement("div");r.style.position="absolute";r.style.top="0px";r.style.left="0px";r.style.width="100%";r.style.height="100%";this.elmDownloadSubOptionFrame.appendChild(r);this.elmDownloadSubOptionDetailDiv=r;var g=document.createElement("div");g.style.position="absolute";g.style.top="0px";g.style.left="5%";g.style.width="95%";g.style.height="80%";g.style.overflowX="hidden";g.style.overflowY="auto";r.appendChild(g);var c=document.createElement("div");c.style.position="absolute";c.style.left="0px";c.style.width="100%";c.style.top="35px";c.style.height="30px";c.style.textAlign="left";g.appendChild(c);var i=document.createElement("input");i.tabIndex=7;i.id="download_rotate_option";i.setAttribute("type","checkbox");i.checked=true;c.appendChild(i);var d=document.createElement("label");d.innerText=n.objLanguageMap.rotate90;d.setAttribute("for","download_rotate_option");c.appendChild(d);var c=document.createElement("div");c.style.position="absolute";c.style.left="0px";c.style.width="100%";c.style.top="65px";c.style.height="35px";c.style.textAlign="left";g.appendChild(c);var o=document.createElement("SPAN");var q=document.createTextNode(n.objLanguageMap.dpiX+" : ");o.appendChild(q);c.appendChild(o);var m=document.createElement("input");m.tabIndex=8;m.type="text";m.style.fontSize="12px";m.style.width="30%";m.title=n.objLanguageMap.dpiX;m.onkeypress=function(){a.keyCheckEvent(event);};c.appendChild(m);var c=document.createElement("div");c.style.position="absolute";c.style.left="0px";c.style.width="100%";c.style.top="100px";c.style.height="35px";c.style.textAlign="left";g.appendChild(c);var o=document.createElement("SPAN");var q=document.createTextNode(n.objLanguageMap.dpiY+" : ");o.appendChild(q);c.appendChild(o);var b=document.createElement("input");b.tabIndex=9;b.type="text";b.style.fontSize="12px";b.style.width="30%";b.title=n.objLanguageMap.dpiY;b.onkeypress=function(){a.keyCheckEvent(event);};c.appendChild(b);var c=document.createElement("div");c.style.position="absolute";c.style.left="0px";c.style.width="100%";c.style.top="140px";c.style.height="35px";c.style.textAlign="left";g.appendChild(c);var o=document.createElement("SPAN");var q=document.createTextNode(n.objLanguageMap.grayScale+" : ");o.appendChild(q);c.appendChild(o);var l=document.createElement("SELECT");l.tabIndex=10;l.style.width="30%";l.style.height="60%";l.style.fontSize="12px";l.title=n.objLanguageMap.grayScale;l.className="report_download_sub_option_select";this.createDownloadSubOption(l,"true","true");this.createDownloadSubOption(l,"false","false");c.appendChild(l);i.checked=h.rotate90;m.value=h.dpiX;b.value=h.dpiY;l.value=h.blackWhite.toString();this.createDetailErrorText(r);var f=document.createElement("button");f.tabIndex=6;f.id="download_sub_option_change_button";f.innerHTML=n.objLanguageMap.propertys;f.title=n.objLanguageMap.propertys;f.className="download_sub_option_change_button";f.onclick=function(){a.ableDownloadSubOptionFrame();a.displaySaveCancelButton();};r.appendChild(f);this.elmOptionChangeButton=f;var k=document.createElement("button");k.tabIndex=11;k.id="download_sub_option_save_button";k.innerHTML=n.objLanguageMap.save;k.title=n.objLanguageMap.save;k.className="download_sub_option_save_button";k.onclick=function(){h.rotate90=i.checked;h.dpiX=parseInt(m.value);h.dpiY=parseInt(b.value);h.blackWhite=parseInt(l.value);a.displayChangeButton();a.disableDownloadSubOptionFrame();};r.appendChild(k);this.elmOptionSaveButton=k;var p=document.createElement("button");p.tabIndex=12;p.id="download_sub_option_cancel_button";p.innerHTML=n.objLanguageMap.cancel;p.title=n.objLanguageMap.cancel;p.className="download_sub_option_cancel_button";p.onclick=function(){i.checked=h.rotate90;m.value=h.dpiX;b.value=h.dpiY;l.value=h.blackWhite;a.displayChangeButton();a.disableDownloadSubOptionFrame();};r.appendChild(p);this.elmOptionCancelButton=p;this.disableDownloadSubOptionFrame();this.displayChangeButton();};function mCR_ReportPrintHTMLManualFrame(a){this.objReport=a;this.objCss={strClass:"",strStyle:""};this.elmPrintHTMLManualFrame=null;this.elmPrintHTMLManualDiv=null;}mCR_ReportPrintHTMLManualFrame.prototype.createPrintHTMLManualFrame=function(){var c=this;var b=document.createElement("div");b.className="report_print_html_manual_frame";var d=document.createElement("div");d.className="report_print_html_manual_shadow_div";d.onclick=function(){c.closePrintHTMLManualFrame();};b.appendChild(d);var a=document.createElement("div");a.className="report_print_html_manual_div";b.appendChild(a);this.elmPrintHTMLManualFrame=b;this.elmPrintHTMLManualDiv=a;this.objReport.objTargetDOM.appendChild(b);this.createManualDetail();};mCR_ReportPrintHTMLManualFrame.prototype.createManualDetail=function(){var j=this;var a="";if(mCR_isIE){a="IE ";}else{a="Firefox ";}var b=document.createElement("div");b.className="report_print_html_manual_title_frame";this.elmPrintHTMLManualDiv.appendChild(b);var f=document.createElement("button");f.id="report_print_html_manual_close_button";if(mCR_isIE7||mCR_isIE8){f.className="report_print_html_manual_close_button report_print_html_manual_close_button_lowie";}else{f.className="report_print_html_manual_close_button";}f.onclick=function(){j.closePrintHTMLManualFrame();};b.appendChild(f);var g=document.createElement("SPAN");g.style.top="50%";g.style.transform="translateY(-50%)";g.style.fontWeight="bold";g.style.fontSize="13px";g.style.left="3%";g.style.position="absolute";var i=document.createTextNode(a+this.objReport.objLanguageMap.print_info2);g.appendChild(i);b.appendChild(g);var c=document.createElement("div");c.className="report_print_html_manual_detail_cover_div";this.elmPrintHTMLManualDiv.appendChild(c);var d=this.elmPrintHTMLManualDiv.offsetWidth;var k=document.createElement("div");k.className="report_print_html_manual_detail_frame";var h=document.createElement("img");if(mCR_isIE){h.src="img/report/iePrintOption1.png";}else{h.src="img/report/firefoxPrintOption1.png";}k.appendChild(h);c.appendChild(k);if(d<1920){h.style.position="relative";h.style.width="100%";}var k=document.createElement("div");k.className="report_print_html_manual_detail_frame";var h=document.createElement("img");k.appendChild(h);c.appendChild(k);if(mCR_isIE){h.src="img/report/iePrintOption2.png";if(d<571){h.style.position="relative";h.style.width="100%";}}else{h.src="img/report/firefoxPrintOption2.png";if(d<1920){h.style.position="relative";h.style.width="100%";}}if(!mCR_isIE){var k=document.createElement("div");k.className="report_print_html_manual_detail_frame";var h=document.createElement("img");h.src="img/report/firefoxPrintOption3.png";k.appendChild(h);c.appendChild(k);if(d<405){h.style.position="relative";h.style.width="100%";}}};mCR_ReportPrintHTMLManualFrame.prototype.closePrintHTMLManualFrame=function(){this.objReport.closePrintHTMLManualFrame();};function mCR_ReportPrintMainOptionFrame(a){this.objReport=a;this.objCss={strClass:"",strStyle:""};this.strPrintType="pdf";this.firstPage=0;this.lastPage=0;this.customFirstPageInput=null;this.customLastPageInput=null;this.elmPrintMainOptionFrame=null;this.elmPrintMainOptionSelect=null;this.elmPrintButton=null;this.elmPrintRangeDiv=null;}mCR_ReportPrintMainOptionFrame.prototype.createPrintMainOptionFrame=function(){var h=this.objReport;var o=this;this.firstPage=1;this.lastPage=h.objPageInfo.nPageCount;var l=document.createElement("div");l.id="report_print_main_option_frame";if((h.objBody.elmBody.offsetWidth/h.objBody.elmBody.offsetHeight)>1.4){l.className="report_print_main_option_frame_div "+this.objCss.strClass;}else{l.className="report_print_main_option_frame_div report_print_main_option_frame_div_vertical "+this.objCss.strClass;}if(this.objReport.objStyleInfo.strHeaderHeight!=null){l.style.top=this.objReport.objStyleInfo.strHeaderHeight;}this.elmPrintMainOptionFrame=l;this.objReport.objTargetDOM.appendChild(l);var q=document.createElement("div");q.className="report_print_main_option_frame_cover_div";l.appendChild(q);var s=document.createElement("div");s.className="report_print_main_option_select_div";q.appendChild(s);var p=document.createElement("div");p.className="report_print_main_option_method_title_div";s.appendChild(p);var m=document.createElement("SPAN");m.style.top="50%";m.style.transform="translateY(-50%)";m.style.fontWeight="bold";m.style.fontSize="13px";m.style.left="3%";m.style.position="absolute";var n=document.createTextNode(h.objLanguageMap.printType);m.appendChild(n);p.appendChild(m);var b=document.createElement("div");b.className="report_print_main_option_select_cover_div";s.appendChild(b);var f=document.createElement("label");f.className="report_print_main_option_select_label";f.setAttribute("for","select_label");b.appendChild(f);var r=document.createElement("SELECT");r.title=h.objLanguageMap.printType;r.tabIndex=1;r.className="report_print_main_option_select";var k=h.objPrintOptionInfo;var j=h.objPrintOptionInfo.length;for(var g=0;g<j;g++){if(k[g].visible){this.createPrintMainOption(r,k[g].text,k[g].value,k[g].name);}}r.value=k[0].value;f.innerHTML=r[r.selectedIndex].text;this.strPrintType=k[0].value;var a=this.strPrintType;r.onchange=function(){o.strPrintType=this.value;f.innerHTML=r[r.selectedIndex].text;if(o.strPrintType=="exe"){o.elmPrintRangeDiv.style.display="none";d.disabled=true;}else{o.elmPrintRangeDiv.style.display="block";if(o.strPrintType=="pdf"){if(!(mCR_isFirefox||mCR_isEdge||mCR_isSafari)&&!mCR_objPDFInfo.acrobat&&!h.isUsePrintButtonWithoutAcrobat){d.style.display="none";}}else{d.style.display="block";}}if(h.isUsePrintSubOptionFrame){h.objPrintSubOptionFrame.choiceOption();}};this.elmPrintMainOptionSelect=r;b.appendChild(r);var d=document.createElement("button");d.tabIndex=3;d.id="print_main_option_print_button";d.innerHTML=h.objLanguageMap.print;d.className="print_main_option_print_button";d.title=h.objLanguageMap.print;d.onclick=function(){if(parseInt(o.customFirstPageInput.value)>parseInt(o.customLastPageInput.value)&&!o.customFirstPageInput.disabled){alert(h.objLanguageMap.printNum_validation);}else{if(o.strPrintType=="pdf"){h.runPDFPrint(o.firstPage,o.lastPage,false);o.closePrintMainOptionFrame();}else{if(o.strPrintType=="html"){h.runHTML5Print(o.firstPage,o.lastPage);o.closePrintMainOptionFrame();}else{h.mCR_printEXEView();}}}};l.appendChild(d);this.elmPrintButton=d;var c=document.createElement("button");c.id="print_main_option_cancel_button";c.tabIndex=4;c.innerHTML=h.objLanguageMap.cancel;c.className="print_main_option_cancel_button";c.title=h.objLanguageMap.cancel;c.onclick=function(){o.closePrintMainOptionFrame();};l.appendChild(c);this.createPrintRangeOptionDiv(q);if(r.value=="exe"){this.elmPrintRangeDiv.style.display="none";d.disabled=true;}else{this.elmPrintRangeDiv.style.display="block";if(r.value=="pdf"){if(!(mCR_isFirefox||mCR_isEdge||mCR_isSafari)&&!mCR_objPDFInfo.acrobat&&!h.isUsePrintButtonWithoutAcrobat){d.style.display="none";}}else{d.style.display="block";}}r.focus();};mCR_ReportPrintMainOptionFrame.prototype.createPrintMainOption=function(c,a,f,d){var b=document.createElement("OPTION");b.text=a;b.className="report_print_main_option";b.value=f;b.name=d;c.add(b);};mCR_ReportPrintMainOptionFrame.prototype.createPrintRangeOptionDiv=function(f){var d=this.objReport;var h=document.createElement("div");h.className="report_print_main_option_range_div";this.elmPrintRangeDiv=h;f.appendChild(h);var k=document.createElement("div");k.className="report_print_main_option_range_title_div";h.appendChild(k);var g=document.createElement("SPAN");g.style.top="50%";g.style.transform="translateY(-50%)";g.style.fontWeight="bold";g.style.fontSize="13px";g.style.left="3%";g.style.position="absolute";var i=document.createTextNode(this.objReport.objLanguageMap.print_range);g.appendChild(i);k.appendChild(g);var a=document.createElement("div");a.style.position="absolute";a.style.top="18%";a.style.left="5%";a.style.width="90%";a.style.height="80%";h.appendChild(a);var c=false;var j=false;var b=false;if(d.objPrintRangeOption.type==0){c=true;}else{if(d.objPrintRangeOption.type==1){j=true;}else{b=true;}}this.createPrintRangeOptionDetail(a,this.objReport.objLanguageMap.total_page,"total_page","5%",c,false);this.createPrintRangeOptionDetail(a,this.objReport.objLanguageMap.currentPage,"recent_page","25%",j,false);this.createPrintRangeOptionDetail(a,this.objReport.objLanguageMap.page_designation,"custom_page","45%",b,true);};mCR_ReportPrintMainOptionFrame.prototype.createPrintRangeOptionDetail=function(a,n,b,f,c,d){var m=this;var i=this.objReport;var k=document.createElement("div");k.style.position="absolute";k.style.left="0px";k.style.width="100%";k.style.height="10%";k.style.textAlign="left";k.style.top=f;a.appendChild(k);var o=document.createElement("input");o.name="print_range_option";o.id=b;o.tabIndex=2;o.setAttribute("type","radio");o.checked=c;o.title=n;o.onclick=function(){m.checkPrintOptionRadioButton(i,o);};k.appendChild(o);var h=document.createElement("label");h.innerText=n;h.title=n;h.setAttribute("for",b);k.appendChild(h);if(d){var l=document.createTextNode("\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0");k.appendChild(l);var g=document.createElement("input");g.type="text";if(i.objPrintRangeOption.type==2){if(i.objPrintRangeOption.pageFrom=="last"){g.value=i.objPageInfo.nPageCount;}else{if(i.objPrintRangeOption.pageFrom<=i.objPageInfo.nPageCount){g.value=i.objPrintRangeOption.pageFrom;}else{g.value=1;}}}else{g.value=1;g.disabled=true;}g.style.width="15%";g.title=i.objLanguageMap.from;k.appendChild(g);g.onkeypress=function(){m.keyCheckEvent(event);};g.onchange=function(){m.comparePageEvent(i,m,this,true);};this.customFirstPageInput=g;var j=document.createElement("SPAN");var l=document.createTextNode(i.objLanguageMap.from);j.appendChild(l);k.appendChild(j);var g=document.createElement("input");g.type="text";if(i.objPrintRangeOption.type==2){if(i.objPrintRangeOption.pageTo=="last"){g.value=i.objPageInfo.nPageCount;}else{if(i.objPrintRangeOption.pageTo<=i.objPageInfo.nPageCount){g.value=i.objPrintRangeOption.pageTo;}else{g.value=i.objPageInfo.nPageCount;}}}else{g.value=i.objPageInfo.nPageCount;g.disabled=true;}g.style.width="15%";g.title=i.objLanguageMap.to;k.appendChild(g);g.onkeypress=function(){m.keyCheckEvent(event);};g.onchange=function(){m.comparePageEvent(i,m,this,false);};this.customLastPageInput=g;var j=document.createElement("SPAN");var l=document.createTextNode(i.objLanguageMap.to);j.appendChild(l);k.appendChild(j);}};mCR_ReportPrintMainOptionFrame.prototype.checkPrintOptionRadioButton=function(a,b){if(b.id=="total_page"){if(b.checked){this.customFirstPageInput.disabled=true;this.customLastPageInput.disabled=true;this.firstPage=1;this.lastPage=a.objPageInfo.nPageCount;}}else{if(b.id=="recent_page"){if(b.checked){this.customFirstPageInput.disabled=true;this.customLastPageInput.disabled=true;this.firstPage=a.objPageInfo.nSelectPageIndex+1;this.lastPage=a.objPageInfo.nSelectPageIndex+1;}}else{if(b.checked){this.customFirstPageInput.disabled=false;this.customLastPageInput.disabled=false;this.firstPage=parseInt(this.customFirstPageInput.value);this.lastPage=parseInt(this.customLastPageInput.value);}}}};mCR_ReportPrintMainOptionFrame.prototype.resizeDiv=function(a){if(a){this.elmPrintMainOptionFrame.className="report_print_main_option_frame_div "+this.objCss.strClass;}else{this.elmPrintMainOptionFrame.className="report_print_main_option_frame_div report_print_main_option_frame_div_vertical "+this.objCss.strClass;}};mCR_ReportPrintMainOptionFrame.prototype.keyCheckEvent=function(b){var a=b.keyCode;if(!((a>=48&&a<=57))){if(b.preventDefault){b.preventDefault();}b.returnValue=false;}else{return;}};mCR_ReportPrintMainOptionFrame.prototype.comparePageEvent=function(b,c,f,a){var d=parseInt(f.value);if(d>=1&&d<=b.objPageInfo.nPageCount){if(a){c.firstPage=d;}else{c.lastPage=d;}return;}else{if(a){f.value=1;}else{f.value=b.objPageInfo.nPageCount;}}};mCR_ReportPrintMainOptionFrame.prototype.closePrintMainOptionFrame=function(){this.objReport.closePrintMainOptionFrame();};mCR_ReportPrintMainOptionFrame.prototype.setSyle=function(a){this.objCss.strStyle=a;if(this.elmBody!=null){this.elmBody.style.cssText=a;}};mCR_ReportPrintMainOptionFrame.prototype.setClass=function(a){this.objCss.strClass=a;if(this.elmBody!=null){this.elmBody.className="report_print_main_option_frame_div "+a;}};function mCR_ReportPrintSubOptionFrame(b,c,a){this.objReport=b;this.objCss={strClass:"",strStyle:""};this.isPdfMessage=true;this.elmPrintRangeSpan=null;this.elmPrintSubOptionFrame=null;this.elmPrintSubOptionDetailDiv=null;this.strPrintSubOptionFrameDetailPdf=c;this.strPrintSubOptionFrameDetailHTML=a;}mCR_ReportPrintSubOptionFrame.prototype.createPrintSubOptionFrame=function(){var a=this.objReport;var c=this;var b=document.createElement("div");b.id="report_print_sub_option_frame";if((a.objBody.elmBody.offsetWidth/a.objBody.elmBody.offsetHeight)>1.4){b.className="report_print_sub_option_frame_div "+this.objCss.strClass;}else{b.className="report_print_sub_option_frame_div report_print_sub_option_frame_div_vertical "+this.objCss.strClass;}if(this.objReport.objStyleInfo.strHeaderHeight!=null){b.style.top=this.objReport.objStyleInfo.strHeaderHeight;}this.elmPrintSubOptionFrame=b;this.objReport.objTargetDOM.appendChild(b);this.choiceOption();};mCR_ReportPrintSubOptionFrame.prototype.choiceOption=function(){var a=this.objReport.objPrintMainOptionFrame.strPrintType;if(this.elmPrintSubOptionDetailDiv!=null){this.elmPrintSubOptionFrame.removeChild(this.elmPrintSubOptionDetailDiv);this.elmPrintSubOptionDetailDiv=null;}if(a=="pdf"){this.createPDFOptionDetail();}else{if(a=="html"){this.createHTMLOptionDetail();}else{this.createEXEOptionDetail();}}};mCR_ReportPrintSubOptionFrame.prototype.createPDFOptionDetail=function(){var h=mCR_objPDFInfo;var c=this.objReport;var j=document.createElement("div");j.className="report_print_sub_option_info_div";this.elmPrintSubOptionFrame.appendChild(j);this.elmPrintSubOptionDetailDiv=j;var k=document.createElement("div");k.className="report_print_sub_option_info_title_div";j.appendChild(k);var d=document.createElement("div");d.className="report_print_sub_option_info_contents_div";j.appendChild(d);var f=document.createElement("SPAN");f.style.top="50%";f.style.transform="translateY(-50%)";f.style.fontWeight="bold";f.style.fontSize="13px";f.style.left="3%";f.style.position="absolute";var i=document.createTextNode(this.objReport.objLanguageMap.print_info2);f.appendChild(i);k.appendChild(f);var a=document.createElement("SPAN");a.style.top="70px";a.style.left="0px";a.style.position="absolute";var g=null;if(mCR_isFirefox||mCR_isEdge||mCR_isSafari){g=c.objLanguageMap.pdfPrintLimit1;}else{if(h.acrobat){if(h.acrobatVersion==9){if(c.objAdobeMessage.isMessage){g=c.objAdobeMessage.strMessage;this.isPdfMessage=false;}else{g=c.objLanguageMap.adobe9Info+c.objLanguageMap.adobe9Info2+" "+c.objLanguageMap.adobe9Info3+"\n <a href='https://get.adobe.com/reader/?loc=kr' target='_blank'>https://get.adobe.com/reader/?loc=kr</a> \n"+c.objLanguageMap.adobe9Info4;}}else{g=c.objLanguageMap.adobePrintStatus;}}else{if(c.objAdobeMessage.isMessage){g=c.objAdobeMessage.strMessage;this.isPdfMessage=false;}else{g=c.objLanguageMap.adobe9Info5+" "+c.objLanguageMap.adobe9Info2+" "+c.objLanguageMap.adobe9Info3+"\n <a href='https://get.adobe.com/reader/?loc=kr' target='_blank'>https://get.adobe.com/reader/?loc=kr</a> \n"+c.objLanguageMap.adobe9Info4;}}}if(this.strPrintSubOptionFrameDetailPdf!=null){g=this.strPrintSubOptionFrameDetailPdf;}a.innerHTML=g;d.appendChild(a);if(this.strPrintSubOptionFrameDetailPdf==null&&this.isPdfMessage==true){var a=document.createElement("SPAN");a.style.top="190px";a.style.left="0px";a.style.position="absolute";var b=document.createTextNode(c.objLanguageMap.adobeInstallStatus+" : "+(h.acrobat?c.objLanguageMap.adobeInstallStatusOk:c.objLanguageMap.adobeInstallStatusFail));a.appendChild(b);d.appendChild(a);var a=document.createElement("SPAN");a.style.top="220px";a.style.left="0px";a.style.position="absolute";var b=document.createTextNode(c.objLanguageMap.adobeVersionStatus+" : "+(null!=h.acrobatVersion?h.acrobatVersion:c.objLanguageMap.adobeVersionFailMsg));a.appendChild(b);d.appendChild(a);}};mCR_ReportPrintSubOptionFrame.prototype.createHTMLOptionDetail=function(){var d=this.objReport;var i=mCR_getAcrobatInfo();var k=document.createElement("div");k.className="report_print_sub_option_info_div";this.elmPrintSubOptionFrame.appendChild(k);this.elmPrintSubOptionDetailDiv=k;var l=document.createElement("div");l.className="report_print_sub_option_info_title_div";k.appendChild(l);var f=document.createElement("div");f.className="report_print_sub_option_info_contents_div";k.appendChild(f);var g=document.createElement("SPAN");g.style.top="50%";g.style.transform="translateY(-50%)";g.style.fontWeight="bold";g.style.fontSize="13px";g.style.left="3%";g.style.position="absolute";var j=document.createTextNode(this.objReport.objLanguageMap.print_info2);g.appendChild(j);l.appendChild(g);var a=document.createElement("SPAN");a.style.top="70px";a.style.left="0px";a.style.position="absolute";var h=null;if(mCR_isSafari||mCR_isChrome||mCR_isEdge||mCR_isOpera||mCR_isFirefox){h=this.objReport.objLanguageMap.allowedToPrint;}else{if(mCR_isIE9||mCR_isIE10||mCR_isIE11){h=this.objReport.objLanguageMap.allowedToPrint;}else{h=this.objReport.objLanguageMap.notAllowedToPrint;}}if(this.strPrintSubOptionFrameDetailHTML!=null){h=this.strPrintSubOptionFrameDetailHTML;}var b=document.createTextNode(h);a.appendChild(b);f.appendChild(a);if(this.strPrintSubOptionFrameDetailHTML==null){var a=document.createElement("SPAN");a.style.top="107px";a.style.left="0px";a.style.position="absolute";var b=document.createTextNode("IE9 이상, mac safari, chrome, edge, opera, firefox 지원");a.appendChild(b);f.appendChild(a);if(this.objReport.objPageInfo.nPageCount>100){var a=document.createElement("SPAN");a.style.top="144px";a.style.left="0px";a.style.position="absolute";var b=document.createTextNode(this.objReport.objLanguageMap.printLimit1+" "+this.objReport.objLanguageMap.printLimit2);a.appendChild(b);f.appendChild(a);}if(mCR_isIE||mCR_isFirefox){var a=document.createElement("SPAN");a.style.top="197px";a.style.left="0px";a.style.position="absolute";var b=document.createTextNode(this.objReport.objLanguageMap.printSet1+" "+this.objReport.objLanguageMap.printSet2);a.appendChild(b);f.appendChild(a);var c=document.createElement("a");c.style.color="blue";c.style.textDecoration="underline";c.style.cursor="pointer";c.text="(인쇄가이드문서)";c.onclick=function(){d.openPrintHTMLManualFrame();};a.appendChild(c);}}};mCR_ReportPrintSubOptionFrame.prototype.createEXEOptionDetail=function(){var c=this.objReport;var f=document.createElement("div");f.className="report_print_sub_option_info_div";this.elmPrintSubOptionFrame.appendChild(f);this.elmPrintSubOptionDetailDiv=f;var d=document.createElement("div");d.className="report_print_sub_option_info_title_div";f.appendChild(d);var b=document.createElement("div");b.className="report_print_sub_option_info_contents_div";f.appendChild(b);var a=document.createElement("SPAN");a.style.top="50%";a.style.transform="translateY(-50%)";a.style.fontWeight="bold";a.style.fontSize="13px";a.style.left="3%";a.style.position="absolute";var h=document.createTextNode(this.objReport.objLanguageMap.print_info2);a.appendChild(h);d.appendChild(a);var g=document.createElement("SPAN");g.style.top="70px";g.style.left="0px";g.style.position="absolute";var i=document.createTextNode(c.objLanguageMap.exeInfo5);g.appendChild(i);b.appendChild(g);this.elmPrintRangeSpan=g;if(!c.isExeVersionChecked){c.ClipReportExePrintCheck(function(j){var k=j.substring(j.lastIndexOf("."));if(Number(k)==0){g.innerHTML=c.objLanguageMap.exeInfo1+"\n"+c.objLanguageMap.exeInfo2+'\n<a href="'+c.strExeLink+'">'+c.strExeLink+"</a>\n\n"+c.objLanguageMap.exeInfo3;}else{if(mCR_exeUpdateVersionCheck(c.exe_print_version,j)){g.innerHTML=c.objLanguageMap.exeInfo4+"\n"+c.objLanguageMap.exeInfo2+'\n<a href="'+c.strExeLink+'">'+c.strExeLink+"</a>\n\n"+c.objLanguageMap.exeInfo3;}else{c.isExeVersionChecked=true;c.exe_print_version=j;c.objPrintMainOptionFrame.elmPrintButton.disabled=false;g.innerHTML="version : "+j+"\n  "+c.objLanguageMap.exeInfo0;}}});}else{c.objPrintMainOptionFrame.elmPrintButton.disabled=false;g.innerHTML="version : "+c.exe_print_version+"\n  "+c.objLanguageMap.exeInfo0;}};mCR_ReportPrintSubOptionFrame.prototype.resizeDiv=function(a){if(a){this.elmPrintSubOptionFrame.className="report_print_sub_option_frame_div "+this.objCss.strClass;}else{this.elmPrintSubOptionFrame.className="report_print_sub_option_frame_div report_print_sub_option_frame_div_vertical "+this.objCss.strClass;}};mCR_ReportPrintSubOptionFrame.prototype.closePrintSubOptionFrame=function(){this.objReport.closePrintSubOptionFrame();};function mCR_ReportThumbnailFrame(a){this.objReport=a;this.objCss={strClass:"",strStyle:""};this.nImageSize=280;this.nPageTextSize=30;this.nToggleButtonSize=20;this.elmReportThumbnailFullFrame=null;this.elmReportThumbnailFrame=null;this.elmReportThumbnailToggleFrame=null;this.elmSelectedTumbnailImage=null;this.elmThumbnailImageList=[];this.elmIsTumbnailList=[];}mCR_ReportThumbnailFrame.prototype.createThumbnailFrame=function(){var b=this.objReport;var d=this;var g=document.createElement("div");g.id="report_thumbnail_full_frame";g.className="report_thumbnail_full_frame_div "+this.objCss.strClass;if(this.objReport.objStyleInfo.strHeaderHeight!=null){g.style.top=this.objReport.objStyleInfo.strHeaderHeight;}this.objReport.objTargetDOM.appendChild(g);this.elmReportThumbnailFullFrame=g;var h=document.createElement("div");h.id="report_thumbnail_title_div";h.className="report_thumbnail_title_div";g.appendChild(h);var a=document.createElement("SPAN");a.style.position="absolute";a.style.left="10px";a.style.top="4px";var f=document.createTextNode(b.objLanguageMap.thumbnail);a.appendChild(f);h.appendChild(a);var c=document.createElement("button");c.id="report_thumbnail_close_button";if(mCR_isIE7||mCR_isIE8){c.className="report_thumbnail_close_button report_thumbnail_close_button_lowie";}else{c.className="report_thumbnail_close_button";}c.onclick=function(){b.closeOptions();};h.appendChild(c);var i=document.createElement("div");i.id="report_thumbnail_frame";i.className="report_thumbnail_frame_div "+this.objCss.strClass;if(!this.objReport.isUpperMenu){i.className=i.className+" clip_report_menu_up";}i.style.cssText=this.objCss.strStyle;i.addEventListener("scroll",function(){d.showThumbnailInScreen();});this.elmReportThumbnailFrame=i;g.appendChild(i);};mCR_ReportThumbnailFrame.prototype.createThumbnailImage=function(g,c){var b=this.objReport;var h=document.createElement("div");h.className="thumbnail_img_div";this.elmReportThumbnailFrame.appendChild(h);var a=document.createElement("SPAN");a.style.position="absolute";a.style.left="10px";a.style.top="5px";var d=document.createTextNode(g+1);a.appendChild(d);h.appendChild(a);var i=document.createElement("div");i.className="thumbnail_inner_img_div";if(c){i.style.width="257px";i.style.height="257px";}i.alt=g+1;i.onclick=function(){b.selectPage(parseInt(this.alt));};h.appendChild(i);var f=null;if(c){}else{f=document.createElement("img");f.id="thumbnail_img";f.className="thumbnail_img";f.style.position="relative";f.style.right="0px";i.appendChild(f);}this.elmThumbnailImageList.push(i);this.elmIsTumbnailList.push(false);};mCR_ReportThumbnailFrame.prototype.allThumbnailImage=function(){for(var a=0;a<700;a++){this.objReport.getThumbnailImage(a);}};mCR_ReportThumbnailFrame.prototype.processThumbnailImage=function(){var b=parseInt(this.elmReportThumbnailFrame.scrollTop/this.nImageSize);if(b>3){for(var a=b-3;a<b+8;a++){this.objReport.getThumbnailImage(a);}}};mCR_ReportThumbnailFrame.prototype.openThumbnailFrame=function(){this.elmReportThumbnailFullFrame.style.width=(this.nImageSize+this.nPageTextSize+this.nToggleButtonSize)+"px";this.elmReportThumbnailFullFrame.style.display="block";};mCR_ReportThumbnailFrame.prototype.closeThumbnailFrame=function(){this.elmReportThumbnailFullFrame.style.width="0px";this.elmReportThumbnailFullFrame.style.display="none";};mCR_ReportThumbnailFrame.prototype.getWidth=function(){return(this.nImageSize+this.nPageTextSize+this.nToggleButtonSize);};mCR_ReportThumbnailFrame.prototype.moveThumbnailImage=function(a){this.elmReportThumbnailFrame.scrollTop=this.elmThumbnailImageList[a].parentNode.offsetTop;this.showThumbnailInScreen();};mCR_ReportThumbnailFrame.prototype.showThumbnailInScreen=function(){var c=(this.objReport.objOption.nViewType!=0);var h=this.elmReportThumbnailFrame.scrollTop;var a=this.elmReportThumbnailFrame.clientHeight;var b=h+a;var g=this.elmThumbnailImageList.length;for(var d=0;d<g;d++){var f=this.elmThumbnailImageList[d].parentNode;if(f.offsetTop>=h||f.offsetTop+f.offsetHeight>=h){if(f.offsetTop<=b||f.offsetTop+f.offsetHeight<=b){if(!this.elmIsTumbnailList[d]){if(c){this.objReport.createThumbnailCanvas(d);}else{this.objReport.getThumbnailImage(d);}this.elmIsTumbnailList[d]=true;}}else{break;}}}};mCR_ReportThumbnailFrame.prototype.changeTunmbnailStyle=function(a){if(this.elmThumbnailImageList.length!=0){if(this.elmSelectedTumbnailImage!=null){this.elmSelectedTumbnailImage.className="thumbnail_inner_img_div";}this.elmSelectedTumbnailImage=this.elmThumbnailImageList[a];this.elmThumbnailImageList[a].className="thumbnail_inner_img_div selected_thumbnail_img_div";}};function mCR_ReportTOCFrame(a){this.objReport=a;this.objCss={strClass:"",strStyle:""};this.elmReportTOCFullFrame=null;this.elmReportTOCFrame=null;this.elmULTree=null;this.elmSelectedTOC=null;this.nTOCTextSize=310;this.nToggleButtonSize=20;}mCR_ReportTOCFrame.prototype.createTOCFrame=function(){var b=this.objReport;var g=document.createElement("div");g.id="report_toc_full_frame";g.className="report_toc_full_frame_div "+this.objCss.strClass;if(this.objReport.objStyleInfo.strHeaderHeight!=null){g.style.top=this.objReport.objStyleInfo.strHeaderHeight;}this.objReport.objTargetDOM.appendChild(g);this.elmReportTOCFullFrame=g;var f=document.createElement("div");f.id="report_toc_title_div";f.className="report_toc_title_div";g.appendChild(f);var a=document.createElement("SPAN");a.style.position="absolute";a.style.left="10px";a.style.top="4px";var d=document.createTextNode(b.objLanguageMap.toc);a.appendChild(d);f.appendChild(a);var c=document.createElement("button");c.id="report_toc_close_button";if(mCR_isIE7||mCR_isIE8){c.className="report_toc_close_button report_toc_close_button_lowie";}else{c.className="report_toc_close_button";}c.onclick=function(){b.closeTOCFrame();};f.appendChild(c);var h=document.createElement("div");h.id="report_toc_frame";h.className="report_toc_frame_div "+this.objCss.strClass;if(!this.objReport.isUpperMenu){h.className=h.className+" clip_report_menu_up";}h.style.cssText=this.objCss.strStyle;h.onscoll=function(){};this.elmReportTOCFrame=h;g.appendChild(h);};mCR_ReportTOCFrame.prototype.makingTOCView=function(b){var b=b;var c=b.length;for(var a=0;a<c;a++){this.makingTOCDetailDiv(b[a]);}};mCR_ReportTOCFrame.prototype.makingTOCDetailDiv=function(b){var d=this;var g=this.objReport;var c=null;var a=null;var k=b.page;var i=null;if(b.depth==0){c="report_toc_depth0_div";a="report_toc_depth0_span";i=Base64.decode(b.title);}else{if(b.depth==1){c="report_toc_depth1_div";a="report_toc_depth1_span";i="- "+Base64.decode(b.title);}else{if(b.depth==2){c="report_toc_depth2_div";a="report_toc_depth2_span";i="- "+Base64.decode(b.title);}}}var f=document.createElement("div");f.style.position="relative";f.style.left="0px";f.style.right="0px";f.style.height="50px";f.style.textAlign="left";f.className=c;f.onclick=function(){g.selectPage(k);d.changeTOCStyle(this);};this.elmReportTOCFrame.appendChild(f);var h=document.createElement("SPAN");h.style.position="absolute";h.className=a;var j=document.createTextNode(i);h.appendChild(j);f.appendChild(h);var h=document.createElement("SPAN");h.style.position="absolute";h.style.right="10px";h.style.top="25%";var j=document.createTextNode(k+"page");h.appendChild(j);f.appendChild(h);};mCR_ReportTOCFrame.prototype.openTOCFrame=function(){this.elmReportTOCFullFrame.style.width=(this.nTOCTextSize+this.nToggleButtonSize)+"px";this.elmReportTOCFullFrame.style.display="block";};mCR_ReportTOCFrame.prototype.closeTOCFrame=function(){this.elmReportTOCFullFrame.style.width="0px";this.elmReportTOCFullFrame.style.display="none";this.changeTOCStyle(null);};mCR_ReportTOCFrame.prototype.getWidth=function(){return(this.nTOCTextSize+this.nToggleButtonSize);};mCR_ReportTOCFrame.prototype.changeTOCStyle=function(a){if(this.elmSelectedTOC!=null){this.elmSelectedTOC.className=this.elmSelectedTOC.className.replace(" selected_toc_div","");}this.elmSelectedTOC=a;if(this.elmSelectedTOC!=null){this.elmSelectedTOC.className=this.elmSelectedTOC.className+" selected_toc_div";}};function mCR_ReportSearchWordFrame(a){this.objReport=a;this.objCss={strClass:"",strStyle:""};this.nSearchWordSize=304;this.nToggleButtonSize=142;this.elmReportSearchWordFullFrame=null;this.elmReportSearchWordFrame=null;this.elmSearchWordInput=null;this.elmSelectedSearchWord=null;this.strSearchWord="";this.arrSearchWordDiv=new Array();this.elmSearchWordPlaceDiv=null;this.arrSearchWordInfo=null;this.arrElementSearchWord=null;this.elmInnerSelectedSearchWord=null;this.elmSelectedSearchWordLabel=null;this.isSearching=false;this.nTotalCount=0;this.nSlectedNum=0;this.arrElementSearchWordArray=null;this.elmSearchWordPlaceDivArray=null;}mCR_ReportSearchWordFrame.prototype.createSearchWordFrame=function(){var f=this.objReport;var d=this;var k=document.createElement("div");k.id="report_searchword_full_frame";k.className="report_searchword_full_frame_div "+this.objCss.strClass;if(this.objReport.objStyleInfo.strHeaderHeight!=null){k.style.top=this.objReport.objStyleInfo.strHeaderHeight;}this.objReport.objTargetDOM.appendChild(k);this.elmReportSearchWordFullFrame=k;var b=document.createElement("div");b.id="report_searchword_div";b.className="report_searchword_div";k.appendChild(b);var i=document.createElement("label");i.style.cssText="position:absolute;font-size:13px;top:10px;right:136px;color:white;";i.innerText=this.nSlectedNum+" / "+this.nTotalCount;b.appendChild(i);i.title=f.objLanguageMap.orderOfListAndListBySearched;this.elmSelectedSearchWordLabel=i;var a=document.createElement("input");a.style.position="absolute";a.type="text";a.style.fontSize="13px";a.style.width="190px";a.style.height="26px";a.style.top="4px";a.style.left="5px";a.title=f.objLanguageMap.searchContent;a.onkeypress=function(){var n=event.keyCode;if(n==13){d.searchWord();}};this.elmSearchWordInput=a;b.appendChild(a);var g=document.createElement("button");g.id="report_searchword_search_button";g.className="report_searchword_search_button";g.title=f.objLanguageMap.search;g.onclick=function(){d.searchWord();};b.appendChild(g);var m=document.createElement("button");m.id="report_searchword_up_button";m.className="report_searchword_up_button";m.title=f.objLanguageMap.moveUpOfList;m.onclick=function(){d.changePrevWord();};b.appendChild(m);var j=document.createElement("button");j.id="report_searchword_down_button";j.className="report_searchword_down_button";j.title=f.objLanguageMap.moveDownOfList;j.onclick=function(){d.changeNextWord();};b.appendChild(j);var c=document.createElement("button");c.id="report_searchword_toggle_button";c.className="report_searchword_toggle_button";c.onclick=function(){if(d.isSearching){if(d.elmReportSearchWordFullFrame.style.height=="70%"){d.changeListSize(false);}else{d.changeListSize(true);}}};c.title=f.objLanguageMap.toggleListSize;b.appendChild(c);var h=document.createElement("button");h.id="report_searchword_close_button";h.className="report_searchword_close_button";h.title=f.objLanguageMap.close;h.onclick=function(){f.closeOptions();};b.appendChild(h);var l=document.createElement("div");l.id="report_searchword_frame_div";l.className="report_searchword_frame_div "+this.objCss.strClass;if(!this.objReport.isUpperMenu){l.className=l.className+" clip_report_menu_up";}l.style.cssText=this.objCss.strStyle;l.addEventListener("scroll",function(){});this.elmReportSearchWordFrame=l;k.appendChild(l);};mCR_ReportSearchWordFrame.prototype.openSearchWordFrame=function(){this.elmReportSearchWordFullFrame.style.width=(this.nSearchWordSize+this.nToggleButtonSize)+"px";this.elmReportSearchWordFullFrame.style.display="block";this.elmSearchWordInput.focus();};mCR_ReportSearchWordFrame.prototype.closeSearchWordFrame=function(){if(this.elmSearchWordPlaceDiv!=null){this.clearSearchWordPlaceDiv();}this.strSearchWord="";this.arrElementSearchWord=null;this.arrSearchWordInfo=null;this.clearSearchWordView();this.changeListSize(false);this.nTotalCount=0;this.nSlectedNum=0;this.changeLabel();this.elmSearchWordInput.value="";this.elmReportSearchWordFullFrame.style.width="0px";this.elmReportSearchWordFullFrame.style.display="none";this.isSearching=false;};mCR_ReportSearchWordFrame.prototype.getWidth=function(){return(this.nSearchWordSize+this.nToggleButtonSize);};mCR_ReportSearchWordFrame.prototype.changeListSize=function(a){if(a){this.elmReportSearchWordFullFrame.style.height="70%";this.elmReportSearchWordFrame.style.display="block";}else{this.elmReportSearchWordFullFrame.style.height="40px";this.elmReportSearchWordFrame.style.display="none";}};mCR_ReportSearchWordFrame.prototype.searchWord=function(){if(this.strSearchWord!=this.elmSearchWordInput.value){this.strSearchWord=this.elmSearchWordInput.value;if(this.elmSearchWordPlaceDiv!=null){this.clearSearchWordPlaceDiv();}this.arrElementSearchWordArray=new Array();this.elmSearchWordPlaceDivArray=new Array();this.objReport.searchWord(this.elmSearchWordInput.value,this.objReport.objClipDocument);this.nSlectedNum=0;this.createSearchWordView();this.arrElementSearchWord=null;this.arrSearchWordInfo=null;this.isSearching=true;this.createSearchWordPlaceDiv(this.objReport.objPageInfo.nSelectPageIndex+1);if(this.elmSelectedSearchWord!=null){this.elmReportSearchWordFrame.scrollTop=this.elmSelectedSearchWord.offsetTop;}}};mCR_ReportSearchWordFrame.prototype.createSearchWordView=function(){this.clearSearchWordView();var b=this.objReport.getSearchWordArrayCount();this.nTotalCount=b;if(b!=0){for(var a=0;a<b;a++){this.createSearchWordViewDiv(a);}this.changeListSize(true);}else{this.nTotalCount=0;this.nSlectedNum=0;this.changeLabel();this.changeListSize(false);alert("조건에 맞는 글자가 없습니다.");}};mCR_ReportSearchWordFrame.prototype.clearSearchWordView=function(){var b=this.arrSearchWordDiv.length;if(b!=0){for(var a=0;a<b;a++){this.elmReportSearchWordFrame.removeChild(this.arrSearchWordDiv[a]);}this.arrSearchWordDiv.splice(0,b);}};mCR_ReportSearchWordFrame.prototype.createSearchWordViewDiv=function(h){var i=this;var j=this.objReport;var f=j.getSearchWordInfo(h);var m=f.pageNum;var g=f.number;var l=null;var b="report_search_word_div";var a="report_search_word_span";l=f.text;var c=document.createElement("div");c.style.position="relative";c.style.left="0px";c.style.right="0px";c.style.height="50px";c.style.textAlign="left";c.className=b;c.onclick=function(){if(j.objPageInfo.nSelectPageIndex+1!=m){if(j.isScrollView&&j.objOption.nViewType!=0){i.clearStyleInPage();}j.selectPage(m);i.changeSearchWordViewStyle(this);i.arrSearchWordInfo=null;i.arrElementSearchWord=null;i.createSearchWordPlaceDiv(m,g);}else{i.changeSelectedInPage(g);}};this.elmReportSearchWordFrame.appendChild(c);this.arrSearchWordDiv.push(c);var k=document.createElement("SPAN");k.style.position="absolute";k.className=a;k.innerHTML=l;c.appendChild(k);var d=document.createElement("SPAN");d.style.position="absolute";d.style.right="4px";d.style.top="25%";d.innerHTML=f.pageNum+"page";c.appendChild(d);};mCR_ReportSearchWordFrame.prototype.changeSearchWordViewStyle=function(a){if(this.elmSelectedSearchWord!=null){this.elmSelectedSearchWord.className=this.elmSelectedSearchWord.className.replace(" selected_search_word_div","");}this.elmSelectedSearchWord=a;if(this.elmSelectedSearchWord!=null){this.elmSelectedSearchWord.className=this.elmSelectedSearchWord.className+" selected_search_word_div";}};mCR_ReportSearchWordFrame.prototype.createSearchWordPlaceDiv=function(g,b){var c=this;if(this.objReport.isScrollView&&this.objReport.objOption.nViewType!=0){if(this.objReport.arrDocPageDivList[g-1].childElementCount<2){window.setTimeout(function(){c.createSearchWordPlaceDiv(g,b);},30);}else{if(this.objReport.arrDocPageDivList[g-1].lastElementChild.lastElementChild.style.zIndex!="45"){var d=document.createElement("div");d.style.cssText="position: absolute; left:0px; right:0px; top:0px; bottom:0px;z-index:45;";this.elmSearchWordPlaceDiv=d;this.elmSearchWordPlaceDivArray[g-1]=this.elmSearchWordPlaceDiv;var j=this.objReport.getSelectedPageSearchWordInfo(g);var h=j.length;this.arrSearchWordInfo=j;this.arrElementSearchWord=new Array();if(h>0){var i=null;if(this.objReport.objClipDocument!=null){i=this.objReport.objClipDocument.getPageStyle(j[0].pageStyleKey);}var l=i.topMargin;var k=i.leftMargin;for(var f=0;f<h;f++){var a=document.createElement("div");a.className="search_word_inner_div";if(b==null){if(f==0){a.className=a.className+" selected_search_word_inner_div";this.elmInnerSelectedSearchWord=a;this.changeSearchWordViewStyle(this.arrSearchWordDiv[j[f].number]);this.nSlectedNum=j[f].number+1;this.changeLabel();}}else{if(j[f].number==b){a.className=a.className+" selected_search_word_inner_div";this.elmInnerSelectedSearchWord=a;this.nSlectedNum=j[f].number+1;this.changeLabel();}}a.style.width=(j[f].right-j[f].left)/100+"cm";a.style.height=(j[f].bottom-j[f].top)/100+"cm";a.style.top=(l+j[f].top)/100+"cm";a.style.left=(k+j[f].left)/100+"cm";d.appendChild(a);this.arrElementSearchWord.push(a);}}this.arrElementSearchWordArray[g-1]=this.arrElementSearchWord;this.objReport.arrDocPageDivList[g-1].lastElementChild.appendChild(d);}else{this.arrElementSearchWord=this.arrElementSearchWordArray[g-1];this.arrSearchWordInfo=this.objReport.getSelectedPageSearchWordInfo(g);this.elmSearchWordPlaceDiv=this.elmSearchWordPlaceDivArray[g-1];var h=this.arrSearchWordInfo.length;if(h>0){for(var f=0;f<h;f++){if(b==null){if(f==0){this.arrElementSearchWord[f].className=this.arrElementSearchWord[f].className+" selected_search_word_inner_div";this.elmInnerSelectedSearchWord=this.arrElementSearchWord[f];this.changeSearchWordViewStyle(this.arrSearchWordDiv[j[f].number]);this.nSlectedNum=this.arrSearchWordInfo[f].number+1;this.changeLabel();}}else{if(this.arrSearchWordInfo[f].number==b){this.arrElementSearchWord[f].className=this.arrElementSearchWord[f].className+" selected_search_word_inner_div";this.elmInnerSelectedSearchWord=this.arrElementSearchWord[f];this.nSlectedNum=this.arrSearchWordInfo[f].number+1;this.changeLabel();}}}}}}}else{if(this.objReport.objBody.elmBody.childElementCount<2){window.setTimeout(function(){c.createSearchWordPlaceDiv(g,b);},30);}else{if(this.elmSearchWordPlaceDiv==null||this.objReport.objBody.elmBody.lastElementChild!=this.elmSearchWordPlaceDiv.parentElement){var d=document.createElement("div");d.style.cssText="position: absolute; left:0px; right:0px; top:0px; bottom:0px;z-index:45;";this.elmSearchWordPlaceDiv=d;var j=this.objReport.getSelectedPageSearchWordInfo(g);var h=j.length;this.arrSearchWordInfo=j;this.arrElementSearchWord=new Array();if(h>0){var i=null;if(this.objReport.objClipDocument!=null){i=this.objReport.objClipDocument.getPageStyle(j[0].pageStyleKey);}var l=i.topMargin;var k=i.leftMargin;for(var f=0;f<h;f++){var a=document.createElement("div");a.className="search_word_inner_div";if(b==null){if(f==0){a.className=a.className+" selected_search_word_inner_div";this.elmInnerSelectedSearchWord=a;this.changeSearchWordViewStyle(this.arrSearchWordDiv[j[f].number]);this.nSlectedNum=j[f].number+1;this.changeLabel();}}else{if(j[f].number==b){a.className=a.className+" selected_search_word_inner_div";this.elmInnerSelectedSearchWord=a;this.nSlectedNum=j[f].number+1;this.changeLabel();}}a.style.width=(j[f].right-j[f].left)/100+"cm";a.style.height=(j[f].bottom-j[f].top)/100+"cm";a.style.top=(l+j[f].top)/100+"cm";a.style.left=(k+j[f].left)/100+"cm";d.appendChild(a);this.arrElementSearchWord.push(a);}}this.objReport.objBody.elmBody.lastElementChild.appendChild(d);}}}};mCR_ReportSearchWordFrame.prototype.changeInnerSearchWordViewStyle=function(a){if(this.elmInnerSelectedSearchWord!=null){this.elmInnerSelectedSearchWord.className=this.elmInnerSelectedSearchWord.className.replace(" selected_search_word_inner_div","");}this.elmInnerSelectedSearchWord=a;if(this.elmInnerSelectedSearchWord!=null){this.elmInnerSelectedSearchWord.className=this.elmInnerSelectedSearchWord.className+" selected_search_word_inner_div";}};mCR_ReportSearchWordFrame.prototype.changeNextWord=function(){if(this.nSlectedNum<this.nTotalCount){var a=this.arrSearchWordInfo.length;for(var c=0;c<a;c++){if(this.arrSearchWordInfo[c].number==this.nSlectedNum-1){if(c==a-1){if(this.objReport.isScrollView&&this.objReport.objOption.nViewType!=0){this.clearStyleInPage();}var b=this.nSlectedNum;var d=this.objReport.getSearchWordInfo(b).pageNum;this.objReport.selectPage(d);this.changeSearchWordViewStyle(this.arrSearchWordDiv[b]);this.arrSearchWordInfo=null;this.arrElementSearchWord=null;this.createSearchWordPlaceDiv(d,b);}else{this.changeSelectedInPage(this.nSlectedNum);}if(this.elmSelectedSearchWord!=null){this.elmReportSearchWordFrame.scrollTop=this.elmSelectedSearchWord.offsetTop;}break;}}}else{alert("마지막 검색 문자입니다.");}};mCR_ReportSearchWordFrame.prototype.changePrevWord=function(){if(this.nSlectedNum-1>0){var a=this.arrSearchWordInfo.length;for(var c=0;c<a;c++){if(this.arrSearchWordInfo[c].number==this.nSlectedNum-1){if(c==0){if(this.objReport.isScrollView&&this.objReport.objOption.nViewType!=0){this.clearStyleInPage();}var b=this.nSlectedNum;var d=this.objReport.getSearchWordInfo(b-2).pageNum;this.objReport.selectPage(d);this.changeSearchWordViewStyle(this.arrSearchWordDiv[b-2]);this.arrSearchWordInfo=null;this.arrElementSearchWord=null;this.createSearchWordPlaceDiv(d,b-2);}else{this.changeSelectedInPage(this.nSlectedNum-2);}if(this.elmSelectedSearchWord!=null){this.elmReportSearchWordFrame.scrollTop=this.elmSelectedSearchWord.offsetTop;}break;}}}else{alert("첫번째 검색 문자입니다.");}};mCR_ReportSearchWordFrame.prototype.changeSelectedInPage=function(b){this.changeSearchWordViewStyle(this.arrSearchWordDiv[b]);var a=this.arrSearchWordInfo.length;for(var c=0;c<a;c++){if(this.arrSearchWordInfo[c].number==b){this.nSlectedNum=b+1;this.changeLabel();this.changeInnerSearchWordViewStyle(this.arrElementSearchWord[c]);break;}}};mCR_ReportSearchWordFrame.prototype.changeLabel=function(){this.elmSelectedSearchWordLabel.innerText=this.nSlectedNum+" / "+this.nTotalCount;};mCR_ReportSearchWordFrame.prototype.clearStyleInPage=function(){if(this.elmInnerSelectedSearchWord!=null){this.elmInnerSelectedSearchWord.className=this.elmInnerSelectedSearchWord.className.replace(" selected_search_word_inner_div","");}};mCR_ReportSearchWordFrame.prototype.clearSearchWordPlaceDiv=function(){if(this.objReport.isScrollView&&this.objReport.objOption.nViewType!=0){if(this.elmSearchWordPlaceDivArray!=null){var a=this.objReport.objPageInfo.nPageCount;for(var b=0;b<a;b++){if(this.elmSearchWordPlaceDivArray[b]!=null){this.elmSearchWordPlaceDivArray[b].parentElement.removeChild(this.elmSearchWordPlaceDivArray[b]);}}this.arrElementSearchWordArray=null;this.elmSearchWordPlaceDivArray=null;}}else{this.elmSearchWordPlaceDiv.parentElement.removeChild(this.elmSearchWordPlaceDiv);this.elmSearchWordPlaceDiv=null;}};var mCR_DocumentControlType={Label:0,Shape:1,Line:2,Table:3,TableCell:4,TableCellDumy:5,Barcode:6,Checkbox:7,Chart:8,SubReport:9,Crosstab:10,CrosstabMatrixHeader:11,CrosstabMatrixRowLabel:12,CrosstabMatrixColumnLabel:13,CrosstabMatrixSummarized:14,Sign:15,HTML:16,EFormSign:20,EFormCamera:21,EFormInputLabel:22,EFormCheckGroup:23,EFormCheck:24,EFormRadioGroup:25,EFormRadio:26,CopyProtecter:30,Ext2DBarcode:31,ExtBarcode:32,VoiceEye:33,VoiceEye2DBarcode:34,MarkAnyVoiceEye:35,VerifyBarcode:36,Input:40,InputCheckbox:41,InputRadiobox:42,InputSign:43,InputImage:44,Calendar:45,InputSelectBox:46,Button:47,Chart2:48,Video:49};var mCR_ImageFotmatType={None:0,BMP:1,JPG:2,PNG:3,GIF:4};var mCR_TextShapeType={Line:0,Rectangle:1,RoundRectangle:2,Ellipse:3};var mCR_LinkType={None:-1,Web:0,Report:1,Drilling:2};var mCR_VerticalAlignmentMethod={Top:0,Center:1,Bottom:2};var mCR_HorizontalAlignmentMethod={Left:0,Middle:1,Right:2,Equal:3,Both:4};var mCR_BackStyleType={Normal:0,Transparent:1};var mCR_LineStyle={None:0,Solid:1,Dash:2,Dot:3,DashDot:4,DashDotDot:5,Strong:7,DoubleLine:8,StrongDouble:9,InnerLine:21};function documentReader(){this.useMultiLanguage=false;}documentReader.prototype.documentReaderFromJSON=function(g,f,h){var a=new docDocument();a.reportServerPath=f;a.reportKey=h;a.version=g.a;a.title=decodeURI(g.b);a.subject=g.c;a.author=g.d;a.keyword=g.e;a.etc=g.f;a.styleManager=this.styleManagerReaderFromJSON(g.g);a.checkedPageCount=g.h;a.checkedTotalPageCount=g.i;a.xPositionList=g.j;for(var c=0;c<g.o.length;c++){var i="report";if(null!=g.o[c].d){i=g.o[c].d;}var d={reportID:i};a.documentReportInfoList.push(d);}a.useMultiLanguage=g.k;this.useMultiLanguage=a.useMultiLanguage;this.pageListRead(a.documentPageList,g.l);a.documentMemo=g.r2;a.documentStorage=g.r;if(null!=g.s1){a.checkImageName=g.s1;}if(null!=g.t1){a.radioImageName=g.t1;}if(g.u){a.objDynamicScript=g.u;}if(g.v){a.arrTocItem=new Array();for(var c=0;c<g.v.length;c++){var b={depth:0,title:"",page:0};b.depth=g.v[c][0];b.title=decodeURI(g.v[c][1]);b.page=g.v[c][2];a.arrTocItem.push(b);}}if(g.x){a.objDoodleInfo=g.x;}if(g.y){a.isThumbnail=g.y;}return a;};documentReader.prototype.pageListRead=function(c,b){for(var a=0;a<b.length;a++){c.push(this.readDocumentPage(b[a]));}};documentReader.prototype.styleManagerReaderFromJSON=function(b){var a=new Object();a.pageList=this.stylePageReaderFromJSON(b.a);a.shapeList=this.styleShapeReaderFromJSON(b.b);a.backgroundList=this.styleBackgroundReaderFromJSON(b.c);a.lineList=this.styleLineReaderFromJSON(b.d);a.fontList=this.styleFontReaderFromJSON(b.e);a.textOptionList=this.styleTextOptionReaderFromJSON(b.f);a.textTagList=this.styleTextTagReaderFromJSON(b.g);a.textMarginList=this.styleTextMarginReaderFromJSON(b.h);a.visibleOptionList=this.styleVisibleOptionReaderFromJSON(b.i);a.backgroundImageList=this.styleBackgroundImageReaderFromJSON(b.j);a.fontNameList=this.styleFontNameReaderFromJSON(b.k);return a;};documentReader.prototype.stylePageReaderFromJSON=function(a){var c=new Array();for(var b=0;b<a.length;b++){var d=new docStylePage();d.paperType=a[b][0];d.width=a[b][1];d.height=a[b][2];d.orientation=a[b][3];d.leftMargin=a[b][4];d.topMargin=a[b][5];d.rightMargin=a[b][6];d.bottomMargin=a[b][7];d.pageCount=a[b][8];d.multiColumnDirection=a[b][9];c.push(d);}return c;};documentReader.prototype.styleShapeReaderFromJSON=function(d){var c=new Array();for(var b=0;b<d.length;b++){var a=new docStyleShape();a.shapeType=d[b][0];a.roundRate=d[b][1];c.push(a);}return c;};documentReader.prototype.styleBackgroundReaderFromJSON=function(a){var d=new Array();for(var c=0;c<a.length;c++){var b=new docStyleBackground();b.backStyle=a[c][0];b.backColor=a[c][1];b.fillStyle=a[c][2];b.fillColor=a[c][3];b.gradientStyle=a[c][4];b.gradientStartColor=a[c][5];b.gradientEndColor=a[c][6];d.push(b);}return d;};documentReader.prototype.styleLineReaderFromJSON=function(c){var d=new Array();for(var b=0;b<c.length;b++){var a=new docStyleLine();a.style=c[b][0];a.width=c[b][1];a.color=c[b][2];d.push(a);}return d;};documentReader.prototype.styleFontReaderFromJSON=function(c){var d=new Array();for(var b=0;b<c.length;b++){var a=new docStyleFont();a.nameIndex=c[b][0];a.size=c[b][1];a.bold=c[b][2];a.italic=c[b][3];a.underline=c[b][4];a.strike=c[b][5];a.color=c[b][6];a.underLineStyle=c[b][7];a.underLineColor=c[b][8];a.strikeLineStyle=c[b][9];a.strikeLineColor=c[b][10];a.nameEngIndex=a.nameIndex;if(c[b].length>11){a.nameEngIndex=c[b][11];}if(c[b].length>12){a.underLineWidth=c[b][12];a.autoUnderLineWidth=c[b][13];a.strikeLineWidth=c[b][14];a.autoStrikeLineWidth=c[b][15];}d.push(a);}return d;};documentReader.prototype.styleTextOptionReaderFromJSON=function(d){var a=new Array();for(var c=0;c<d.length;c++){var b=new docStyleTextOption();b.horizontalAlignment=d[c][0];b.verticalAlignment=d[c][1];b.wordWrap=d[c][2];b.wordBreaking=d[c][3];b.wordSpace=d[c][4];b.lineSpace=d[c][5];b.charSet=d[c][6];b.outputFormat=decodeURI(d[c][7]);b.autoFont=d[c][8];a.push(b);}return a;};documentReader.prototype.styleTextTagReaderFromJSON=function(a){var d=new Array();for(var c=0;c<a.length;c++){var b=new docStyleTextTag();b.use=a[c][0];b.bold=a[c][1];b.italic=a[c][2];b.underline=a[c][3];b.strike=a[c][4];b.color=a[c][5];b.round=a[c][6];b.rectangle=a[c][7];b.supScript=a[c][8];b.subScript=a[c][9];b.lineBreak="br";if(a.length>10){b.lineBreak=a[c][10];}b.fontName="font";if(a.length>11){b.fontName=a[c][11];}b.fontSize="";if(a.length>12){b.fontSize=a[c][12];}d.push(b);}return d;};documentReader.prototype.styleTextMarginReaderFromJSON=function(b){var a=new Array();for(var c=0;c<b.length;c++){var d=new docStyleTextMargin();d.left=b[c][0];d.top=b[c][1];d.right=b[c][2];d.bottom=b[c][3];a.push(d);}return a;};documentReader.prototype.styleVisibleOptionReaderFromJSON=function(a){var c=new Array();for(var b=0;b<a.length;b++){var d=new docStyleVisibleOption();d.toView=a[b][0];d.toPrint=a[b][1];d.toXLS=a[b][2];d.toPDF=a[b][3];d.toHWP=a[b][4];d.toHTM=a[b][5];d.toPPT=a[b][6];d.toRTF=a[b][7];d.toBMP=a[b][8];d.toJPG=a[b][9];d.toTIF=a[b][10];d.toTXT=a[b][11];c.push(d);}return c;};documentReader.prototype.styleBackgroundImageReaderFromJSON=function(b){var a=new Array();for(var c=0;c<b.length;c++){var d=new docStyleBackgroundImage();d.imageDrawMethod=b[c][0];d.imageFrame=b[c][1];d.horizontalAlignment=b[c][2];d.verticalAlignment=b[c][3];d.rate=b[c][4];d.transparency=b[c][5];a.push(d);}return a;};documentReader.prototype.styleFontNameReaderFromJSON=function(c){var b=new Array();for(var a=0;a<c.length;a++){b.push(decodeURI(c[a]));}return b;};documentReader.prototype.readDocumentPage=function(a,b){var c=new documentPage();c.pageStyleKey=a.a;c.pageIndex=a.b;this.readImageList(c,a.c);this.readSubSectionList(c,a.d,b);c.backGround=a.e!=null?this.readSubSection(c,a.e):null;c.foreGround=a.f!=null?this.readSubSection(c,a.f):null;return c;};documentReader.prototype.readSubSectionList=function(a,g,c){if(c==null){c=false;}var f=g.length;for(var b=0;b<f;b++){var d=this.readSubSection(a,g[b]);if(c){if(d.isEditEasyMode){a.subSectionList.push(d);}}else{a.subSectionList.push(d);}}};documentReader.prototype.readSubSection=function(b,d){var c=new docSubSection();var a=d.a.split(",");c.type=a[0];c.area.left=Number(a[1]);c.area.top=Number(a[2]);c.area.right=Number(a[3]);c.area.bottom=Number(a[4]);c.backgroundStyleKey=Number(a[5]);c.orderTop=Number(a[6]);this.readDocumentControl(b,c,d.b);c.isDrilling=d.c;if(c.isDrilling){c.isDrillingView=false;}c.drillingName=d.d;if(null!=d.e){c.sectionType=d.e;}if(null!=d.f&&""!=d.f){c.editEasyModeId=d.f;}if(null!=d.g){c.isEditEasyMode=d.g;}if(null!=d.h){c.sectionName=d.h;}return c;};documentReader.prototype.readDocumentControl=function(a,d,f){var b=f[0].length;for(var c=0;c<b;c++){switch(f[0][c][0]){case mCR_DocumentControlType.Line:this.lineReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Shape:this.shapeReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Label:this.labelReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Table:this.tableReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Crosstab:this.crosstabReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Barcode:this.barcodeReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Chart:this.chartReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.SubReport:this.reportControlReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.VoiceEye:this.voiceEyeReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.MarkAnyVoiceEye:this.markAnyVoiceReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.VerifyBarcode:this.verifyBarcodeReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Checkbox:this.checkboxReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.InputSign:this.inputSignReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.InputCheckbox:this.inputCheckboxReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.InputImage:this.inputImageReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Input:this.inputboxReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.InputSelectBox:this.inputSelectboxReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Calendar:this.inputCalendarReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Button:this.inputButtonReaderFromJSON(a,d,f[0][c]);break;case mCR_DocumentControlType.Video:this.inputVideoReaderFromJSON(a,d,f[0][c]);break;}}};documentReader.prototype.inputButtonReaderFromJSON=function(b,f,g){var c=new docInputButton();c.subSection=f;var a=g[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);c.shapeStyleKey=parseInt(a[4]);c.backgroundStyleKey=parseInt(a[5]);c.outterlineStyleKey=parseInt(a[6]);c.visibleOptionStyleKey=parseInt(a[7]);c.visible=a[8]=="1";c.conditionVisible=a[9]=="1";c.pageCountConditionType=parseInt(a[10]);c.primaryName=decodeURIComponent(a[11]);this.textInfoReaderFromJSON(c.textInfo,g[2]);c.transparencyRate=g[3];var d=decodeURIComponent(g[4]);if(d.indexOf("@clipreport@")==0){d=null;}c.accessibilityString=d;f.controlPageList.push(c);};documentReader.prototype.inputVideoReaderFromJSON=function(b,f,g){var c=new docInputVideo();c.subSection=f;var a=g[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);c.shapeStyleKey=parseInt(a[4]);c.backgroundStyleKey=parseInt(a[5]);c.outterlineStyleKey=parseInt(a[6]);c.visibleOptionStyleKey=parseInt(a[7]);c.visible=a[8]=="1";c.conditionVisible=a[9]=="1";c.pageCountConditionType=parseInt(a[10]);c.primaryName=decodeURIComponent(a[11]);c.transparencyRate=g[2];var d=decodeURIComponent(g[3]);if(d.indexOf("@clipreport@")==0){d=null;}c.accessibilityString=d;f.controlPageList.push(c);};documentReader.prototype.inputCalendarReaderFromJSON=function(b,f,g){var c=new docInputCalendar();c.subSection=f;var a=g[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);c.shapeStyleKey=parseInt(a[4]);c.backgroundStyleKey=parseInt(a[5]);c.outterlineStyleKey=parseInt(a[6]);c.primaryName=decodeURIComponent(g[2]);var d=decodeURIComponent(g[3]);if(d.indexOf("@clipreport@")==0){d=null;}c.accessibilityString=d;c.transparencyRate=g[4];c.fontStyleKey=g[5];c.textMarginStyleKey=g[6];c.textOptionStyleKey=g[7];c.visibleOptionStyleKey=g[8];this.textInfoReaderFromJSON(c.textInfo,g[9]);f.controlPageList.push(c);};documentReader.prototype.inputSelectboxReaderFromJSON=function(b,f,g){var c=new docInputSelectbox();c.subSection=f;var a=g[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);c.shapeStyleKey=parseInt(a[4]);c.backgroundStyleKey=parseInt(a[5]);c.outterlineStyleKey=parseInt(a[6]);c.primaryName=decodeURIComponent(g[2]);var d=decodeURIComponent(g[3]);if(d.indexOf("@clipreport@")==0){d=null;}c.accessibilityString=d;c.transparencyRate=g[4];this.textInfoReaderFromJSON(c.textInfo,g[5]);f.controlPageList.push(c);};documentReader.prototype.inputboxReaderFromJSON=function(b,f,g){var c=new docInputbox();c.subSection=f;var a=g[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);c.shapeStyleKey=parseInt(a[4]);c.backgroundStyleKey=parseInt(a[5]);c.outterlineStyleKey=parseInt(a[6]);c.visibleOptionStyleKey=parseInt(a[7]);c.visible=a[8]=="1";c.conditionVisible=a[9]=="1";c.pageCountConditionType=parseInt(a[10]);c.primaryName=decodeURIComponent(a[11]);this.textInfoReaderFromJSON(c.textInfo,g[2]);c.transparencyRate=g[3];var d=decodeURIComponent(g[4]);if(d.indexOf("@clipreport@")==0){d=null;}c.accessibilityString=d;f.controlPageList.push(c);};documentReader.prototype.inputImageReaderFromJSON=function(b,d,g){var f=new docInputImage();f.subSection=d;var a=g[1].split(",");f.rect.left=parseInt(a[0]);f.rect.top=parseInt(a[1]);f.rect.right=parseInt(a[2]);f.rect.bottom=parseInt(a[3]);f.shapeStyleKey=parseInt(a[4]);f.backgroundStyleKey=parseInt(a[5]);f.outterlineStyleKey=parseInt(a[6]);f.visibleOptionStyleKey=parseInt(a[7]);f.visible=a[8]=="1";f.conditionVisible=a[9]=="1";f.pageCountConditionType=parseInt(a[10]);f.primaryName=decodeURIComponent(a[11]);f.transparencyRate=parseInt(a[12]);var c=decodeURIComponent(g[2]);if(c.indexOf("@clipreport@")==0){c=null;}f.accessibilityString=c;d.controlPageList.push(f);};documentReader.prototype.inputCheckboxReaderFromJSON=function(b,d,g){var f=new docInputCheckbox();f.subSection=d;var a=g[1].split(",");f.rect.left=parseInt(a[0]);f.rect.top=parseInt(a[1]);f.rect.right=parseInt(a[2]);f.rect.bottom=parseInt(a[3]);f.outterlineStyleKey=parseInt(a[4]);f.visibleOptionStyleKey=parseInt(a[5]);f.visible=a[6]=="1";f.conditionVisible=a[7]=="1";f.pageCountConditionType=parseInt(a[8]);f.checkSize=parseInt(a[9]);f.selectType=parseInt(a[10]);f.selectArea=parseInt(a[11]);f.primaryName=decodeURIComponent(a[12]);var c=decodeURIComponent(a[13]);if(c.indexOf("@clipreport@")==0){c=null;}f.accessibilityString=c;f.useText=a[14]=="true";f.shapeStyleKey=parseInt(a[15]);f.backgroundStyleKey=parseInt(a[16]);f.guideTransparency=parseInt(a[17]);this.textInfoReaderFromJSON(f.textInfo,g[2]);d.controlPageList.push(f);};documentReader.prototype.inputSignReaderFromJSON=function(b,f,g){var c=new docInputSign();c.subSection=f;var a=g[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);c.shapeStyleKey=parseInt(a[4]);c.backgroundStyleKey=parseInt(a[5]);c.outterlineStyleKey=parseInt(a[6]);c.visibleOptionStyleKey=parseInt(a[7]);c.penWidth=parseInt(a[8]);c.penColor=parseInt(a[9]);c.primaryName=decodeURIComponent(a[10]);c.isNecessaryCheck=g[2];c.necessaryName=decodeURIComponent(g[3]);c.guileLineColor=g[4];c.guileLineWidth=g[5];c.guileLineStyle=g[6];c.transparencyRate=g[7];c.horizontalAlignmentMethod=g[8];c.verticalAlignmentMethod=g[9];var d=decodeURIComponent(g[10]);if(d.indexOf("@clipreport@")==0){d=null;}c.accessibilityString=d;f.controlPageList.push(c);};documentReader.prototype.lineReaderFromJSON=function(b,d,f){var c=new docLine();c.subSection=d;var a=f[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);c.lineStyleKey=parseInt(a[4]);c.visibleOptionStyleKey=parseInt(a[5]);if(a[6]=="1"){c.visible=true;}else{c.visible=false;}if(a[7]=="1"){c.conditionVisible=true;}else{c.conditionVisible=false;}c.pageCountConditionType=parseInt(a[8]);d.controlPageList.push(c);};documentReader.prototype.shapeReaderFromJSON=function(b,d,f){var c=new docShape();c.subSection=d;var a=f[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);c.shapeStyleKey=parseInt(a[4]);c.backgroundStyleKey=parseInt(a[5]);c.outterlineStyleKey=parseInt(a[6]);c.visibleOptionStyleKey=parseInt(a[7]);if(a[8]=="1"){c.visible=true;}else{c.visible=false;}if(a[9]=="1"){c.conditionVisible=true;}else{c.conditionVisible=false;}c.pageCountConditionType=parseInt(a[10]);d.controlPageList.push(c);};documentReader.prototype.checkboxReaderFromJSON=function(a,b,d){var c=new docCheckbox();c.subSection=b;this.checkboxRead(c,a,d);b.controlPageList.push(c);};documentReader.prototype.checkboxRead=function(f,b,g){var a=g[1].split(",");f.rect.left=parseInt(a[0]);f.rect.top=parseInt(a[1]);f.rect.right=parseInt(a[2]);f.rect.bottom=parseInt(a[3]);f.shapeStyleKey=parseInt(a[4]);f.outterlineStyleKey=parseInt(a[5]);f.visibleOptionStyleKey=parseInt(a[6]);f.checkColor=parseInt(a[7]);f.checkValue=a[8]=="1"?true:false;f.checkType=parseInt(a[9]);if(null!=g[2]){a=g[2].split(",");f.imageRect.left=parseInt(a[0]);f.imageRect.top=parseInt(a[1]);f.imageRect.right=parseInt(a[2]);f.imageRect.bottom=parseInt(a[3]);}var d=decodeURIComponent(g[4]);if(d.indexOf("@clipreport@")==0){d=null;}f.accessibilityString=d;var c=g[3];if(c){f.editable=c;f.editableIndex=b.editableControlList.length;b.editableControlList.push(f);}};documentReader.prototype.barcodeReaderFromJSON=function(c,g,h){var d=new docBarcode();d.subSection=g;var b=h[1].split(",");d.rect.left=parseInt(b[0]);d.rect.top=parseInt(b[1]);d.rect.right=parseInt(b[2]);d.rect.bottom=parseInt(b[3]);d.shapeStyleKey=parseInt(b[4]);d.backgroundStyleKey=parseInt(b[5]);d.outterlineStyleKey=parseInt(b[6]);d.visibleOptionStyleKey=parseInt(b[7]);var a=decodeURI(b[9]);a=a.replace(/\%2C/g,",");d.text=a;d.showText=(b[10]=="1");d.optResolution=(b[11]=="1");d.fontBold=(b[12]=="1");d.wideRatio=Number(b[13]);d.fontSize=parseInt(b[14]);d.fontName=b[15];d.barcodeColor=parseInt(b[16]);d.barcodeAngle=parseInt(b[17]);d.barcodeSymbology=parseInt(b[18]);var f=decodeURIComponent(b[19]);if(f.indexOf("@clipreport@")==0){f=null;}d.accessibilityString=f;g.controlPageList.push(d);};documentReader.prototype.chartReaderFromJSON=function(b,f,g){var d=new docChart();d.subSection=f;var a=g[1].split(",");d.rect.left=parseInt(a[0]);d.rect.top=parseInt(a[1]);d.rect.right=parseInt(a[2]);d.rect.bottom=parseInt(a[3]);d.visibleOptionStyleKey=parseInt(a[4]);if(g[2]!=null){this.webLinkInfoReaderFromJSON(d,g[2]);}d.dataType=g[3];if(d.dataType=="svg"||d.dataType=="png"){d.svgString=decodeURI(g[4]);}else{if(d.dataType=="doc"){d.svgString=g[4];}}if(null!=g[5]){var c=decodeURIComponent(g[5]);if(c.indexOf("@clipreport@")==0){c=null;}d.accessibilityString=c;}f.controlPageList.push(d);};documentReader.prototype.voiceEyeReaderFromJSON=function(b,d,f){var c=new DocVoiceEye();c.subSection=d;var a=f[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);if(null!=a[4]){c.visibleOptionStyleKey=parseInt(a[4]);}c.svgString=decodeURI(f[2]);d.controlPageList.push(c);};documentReader.prototype.markAnyVoiceReaderFromJSON=function(b,d,f){var c=new DocMarkAnyVoice();c.subSection=d;var a=f[1].split(",");c.rect.left=parseInt(a[0]);c.rect.top=parseInt(a[1]);c.rect.right=parseInt(a[2]);c.rect.bottom=parseInt(a[3]);if(null!=a[4]){c.visibleOptionStyleKey=parseInt(a[4]);}c.svgString=decodeURI(f[2]);d.controlPageList.push(c);};documentReader.prototype.verifyBarcodeReaderFromJSON=function(b,c,f){var d=new DocVerifyBarcode();d.subSection=c;var a=f[1].split(",");d.rect.left=parseInt(a[0]);d.rect.top=parseInt(a[1]);d.rect.right=parseInt(a[2]);d.rect.bottom=parseInt(a[3]);if(null!=a[4]){d.visibleOptionStyleKey=parseInt(a[4]);}d.text=decodeURI(f[3]);d.text=d.text.replace(/\%2C/g,",");c.controlPageList.push(d);};documentReader.prototype.reportControlReaderFromJSON=function(a,c,d){var b=new docReportControl();b.subSection=c;b.rect.left=d[1];b.rect.top=d[2];b.rect.right=d[3];b.rect.bottom=d[4];b.visibleOptionStyleKey=d[5];this.readReportControlSubSectionList(a,d[6],b);c.controlPageList.push(b);};documentReader.prototype.readReportControlSubSectionList=function(a,g,b){var f=g.length;for(var c=0;c<f;c++){var d=this.readReportControlSubSection(a,g[c],b);b.subSectionList.push(d);}};documentReader.prototype.readReportControlSubSection=function(a,d,b){var c=new docReportControlSubSection();c.type=d[0];c.area.left=d[1];c.area.top=d[2];c.area.right=d[3];c.area.bottom=d[4];c.backgroundStyleKey=d[5];c.docReportControl=b;this.readDocumentControl(a,c,d[6]);return c;};documentReader.prototype.crosstabReaderFromJSON=function(b,c,f){var d=new docCrosstab();d.subSection=c;var a=f[1].split(",");d.rect.left=parseInt(a[0]);d.rect.top=parseInt(a[1]);d.rect.right=parseInt(a[2]);d.rect.bottom=parseInt(a[3]);d.outterlineStyleKey=parseInt(a[4]);d.visibleOptionStyleKey=parseInt(a[5]);this.crosstabMatrixReaderToJSON(f[2],d.matrixHeader);this.crosstabMatrixReaderToJSON(f[3],d.matrixRow);this.crosstabMatrixReaderToJSON(f[4],d.matrixColumn);this.crosstabMatrixReaderToJSON(f[5],d.matrixSummarized);c.controlPageList.push(d);};documentReader.prototype.crosstabMatrixReaderToJSON=function(g,f){this.crosstabRowReaderToJSON(g[1],f);var d=g[2];var c=d[0];var b=d[1];for(var a=0;a<c.length;a++){f.rowHeightList.push(c[a]);}for(var a=0;a<b.length;a++){f.columnWidthList.push(b[a]);}};documentReader.prototype.crosstabRowReaderToJSON=function(f,g){var d=f.length;for(var a=0;a<d;a++){var c=f[a];var b=new docCrosstabRow(g);g.rowList.push(b);this.crosstabCellListReaderToJSON(c,g,b);}};documentReader.prototype.crosstabCellListReaderToJSON=function(d,i,c){var f=d.length;for(var g=0;g<f;g++){var m=d[g];var a=m[0];switch(a){case mCR_DocumentControlType.TableCell:var l=new docCrosstabCellNormal(c);this.crosstabCellReaderToJSON(m,l);c.addCrosstabCell(l);break;case mCR_DocumentControlType.TableCellDumy:var h=m[1];var k=m[2];var j=i.getCrosstabCellNormal(h,k);var b=new docCrosstabCellDumy();b.setBaseCell(j);c.addCrosstabCell(b);break;}}};documentReader.prototype.crosstabCellReaderToJSON=function(f,b){var a=f[1].split(",");var g=f[2];var h=f[3];var d=f[4];var c=decodeURIComponent(f[5]);if(c.indexOf("@clipreport@")==0){c=null;}b.backgroundStyleKey=parseInt(a[0]);b.rowSpan=parseInt(a[1]);b.colSpan=parseInt(a[2]);b.leftLineStyleKey=parseInt(a[3]);b.topLineStyleKey=parseInt(a[4]);b.rightLineStyleKey=parseInt(a[5]);b.bottomLineStyleKey=parseInt(a[6]);b.frontDiagonalLineStyleKey=parseInt(a[7]);b.backDiagonalLineStyleKey=parseInt(a[8]);if(g!=null){this.readImageInfoFromJSON(b.imageInfo,g);b.imageInfo.setParent(b);}if(h!=null){this.textInfoReaderFromJSON(b.detailTextInfo,h);}if(f[6]!=null){this.webLinkInfoReaderFromJSON(b,f[6]);}b.accessibilityString=c;};documentReader.prototype.tableReaderFromJSON=function(b,f,g){var d=new docTable();d.subSection=f;var a=g[1].split(",");d.rect.left=parseInt(a[0]);d.rect.top=parseInt(a[1]);d.rect.right=parseInt(a[2]);d.rect.bottom=parseInt(a[3]);d.outterlineStyleKey=parseInt(a[4]);d.visibleOptionStyleKey=parseInt(a[5]);d.roundLeftTop=parseInt(a[6]);d.roundRightTop=parseInt(a[7]);d.roundLeftBottom=parseInt(a[8]);d.roundRightBottom=parseInt(a[9]);if(a.length>=12){d.nextTableID=a[10];d.prevTableID=a[11];}if(a.length>=14){d.lineFDiagonaStyleKey=a[12];d.lineBDiagonaStyleKey=a[13];}if(g.length>10){var c=decodeURIComponent(g[10]);if(c.indexOf("@clipreport@")==0){c=null;}d.accessibilityString=c;}this.tableRowReaderFromJSON(b,d,g[2]);this.tableRowolArrangerReaderFromJSON(d.rowColArranger,g[3]);f.controlPageList.push(d);};documentReader.prototype.tableRowolArrangerReaderFromJSON=function(h,g){var d=g[0];var c=g[1];for(var a=0;a<d.length;a++){var f=d[a];h.addRowHeight(f);}for(var a=0;a<c.length;a++){var b=c[a];h.addColumnWidth(b);}};documentReader.prototype.tableRowReaderFromJSON=function(a,s,g){var h=g.length;for(var l=0;l<h;l++){var o=g[l];var b=new docTableRow();s.addTableRow(b);var f=o.length;for(var d=0;d<f;d++){var m=o[d];if((typeof m)=="boolean"){b.setPageSubSection(m);}else{var k=m[0];switch(k){case mCR_DocumentControlType.TableCell:var r=new docTableCellNormal();this.tableCellReaderFromJSON(a,r,m);b.addTableCell(r);break;case mCR_DocumentControlType.TableCellDumy:var n=m[1];var q=m[2];var p=s.getTableCellNormal(Number(n),Number(q));var c=new docTableCellDumy();c.setBaseCell(p);b.addTableCell(c);break;}}}}};documentReader.prototype.tableCellReaderFromJSON=function(b,k,g){var h=g[1].split(",");var m=g[2];var i=g[3];var c=g[4];var d=g[5];var a=g[6];var j=decodeURIComponent(g[7]);if(j.indexOf("@clipreport@")==0){j=null;}k.backgroundStyleKey=parseInt(h[0]);k.rowSpan=parseInt(h[1]);k.colSpan=parseInt(h[2]);k.leftLineStyleKey=parseInt(h[3]);k.topLineStyleKey=parseInt(h[4]);k.rightLineStyleKey=parseInt(h[5]);k.bottomLineStyleKey=parseInt(h[6]);k.frontDiagonalLineStyleKey=parseInt(h[7]);k.backDiagonalLineStyleKey=parseInt(h[8]);if(h.length>=11){k.splitCellID1=h[9];k.splitCellID2=h[10];}if(m!=null){this.readImageInfoFromJSON(k.imageInfo,m);k.imageInfo.setParent(k);}if(i!=null){this.textInfoReaderFromJSON(k.detailTextInfo,i);}k.isCheckbox=(c==1)?true:false;if(k.isCheckbox){var f=new docCheckbox();this.checkboxRead(f,b,d);k.documentCheckbox=f;}k.name=a;k.accessibilityString=j;if(g[8]!=null){this.webLinkInfoReaderFromJSON(k,g[8]);}var l=g[9];if(l){k.editable=l;k.editableIndex=b.editableControlList.length;b.editableControlList.push(k);}};documentReader.prototype.labelReaderFromJSON=function(b,g,h){var f=new docLabel();f.subSection=g;var a=h[1].split(",");f.rect.left=parseInt(a[0]);f.rect.top=parseInt(a[1]);f.rect.right=parseInt(a[2]);f.rect.bottom=parseInt(a[3]);f.shapeStyleKey=parseInt(a[4]);f.backgroundStyleKey=parseInt(a[5]);f.outterlineStyleKey=parseInt(a[6]);f.visibleOptionStyleKey=parseInt(a[7]);if(a.length>8){f.visible=(a[8]==1)?true:false;f.conditionVisible=(a[9]==1)?true:false;f.pageCountConditionType=parseInt(a[10]);}if(h[2]!=null){this.readImageInfoFromJSON(f.imageInfo,h[2]);f.imageInfo.setParent(f);}this.textInfoReaderFromJSON(f.textInfo,h[3]);this.webLinkInfoReaderFromJSON(f,h[4]);var d=decodeURIComponent(h[5]);if(d.indexOf("@clipreport@")==0){d=null;}f.accessibilityString=d;var c=h[6];if(c){f.editable=c;f.editableIndex=b.editableControlList.length;b.editableControlList.push(f);}g.controlPageList.push(f);};documentReader.prototype.webLinkInfoReaderFromJSON=function(d,c){var a=c.a.split(",");var b=a[0];var f=d.webLinkInfo;f.type=b;if(b==mCR_LinkType.Web){f.linkUrl=decodeURI(a[1]);}else{f.linkUrl=a[1];}f.webLinkType=decodeURI(a[2]);f.frameName=decodeURIComponent(a[3]);f.windowWidth=parseInt(a[4]);f.windowHeight=parseInt(a[5]);};documentReader.prototype.textInfoReaderFromJSON=function(d,f){if(f.length==0){return;}else{var c=f[0];var b=d;if(typeof c=="string"){var a=c.split(",");b.isPageCount=(a[0]==1)?true:false;b.isTotalPageCount=(a[1]==1)?true:false;b.useMultiLanguage=(a[2]==1)?true:false;b.pageFormula=(a[3]==1)?true:false;this.textLineReaderFromJSON(b,b.useMultiLanguage,f[1]);if(f[2]!=null){this.originalTextInfoReaderFromJSON(b,f[2]);}if(f[3]!=null){b.scriptString=decodeURIComponent(f[3]);}}else{this.textLineReaderDRMFromJSON(b,f[1]);}}};documentReader.prototype.textLineReaderFromJSON=function(d,c,j){var h=j.length;for(var g=0;g<h;g++){var f=new docTextLine();var b=this.textCharacterBatchReaderFromJSON(f,j[g][0]);if((c||this.useMultiLanguage)&&typeof j[g][4]!="undefined"){b=j[g][4];}var a=j[g][1].split(",");f.yPosition=parseInt(a[0]);f.text=decodeURIComponent(b);f.height=parseInt(a[1]);f.eraseSpaceCount=parseInt(a[2]);this.textShapeReaderFromJSON(f,j[g][2]);f.continuesLine=(parseFloat(j[g][3])==1)?true:false;d.textLineList.push(f);}};documentReader.prototype.textLineReaderDRMFromJSON=function(b,g){var f=g.length;for(var d=0;d<f;d++){var c=new docTextLine();c.xPosition=g[0];c.yPosition=g[1];c.height=g[2];var a=g[3];if(a!=null){c.text=decodeURIComponent(a);}b.textLineList.push(c);}};documentReader.prototype.textCharacterBatchReaderFromJSON=function(b,q){var c=q.length;var g="";for(var k=0;k<c;k++){var r="";var n=q[k][0].split(",");var m=b.characterBatchList.length;var p=null;if(m==0){p=new docTextCharacterBatch();p.fontStyleKey=parseInt(n[0]);p.smallChar=(n[1]==1)?true:false;p.sup=(n[2]==1)?true:false;p.sub=(n[3]==1)?true:false;b.characterBatchList.push(p);}else{var l=b.characterBatchList[m-1];if((l.fontStyleKey==n[0])&&(l.smallChar==(n[1]==1)?true:false)&&(l.sup==(n[2]==1)?true:false)&&(l.sub==(n[3]==1)?true:false)){p=l;}else{p=new docTextCharacterBatch();p.fontStyleKey=parseInt(n[0]);p.smallChar=(n[1]==1)?true:false;p.sup=(n[2]==1)?true:false;p.sub=(n[3]==1)?true:false;b.characterBatchList.push(p);}}var a=q[k][1][0].length;var d=q[k][1][0];var f=q[k][1][1];for(var h=0;h<a;h++){var o=new docTextCharacter();o.character=decodeURIComponent(d[h]);o.xPosition=parseInt(f[h]);p.characterList.push(o);r+=d[h];}if(r==""){r="%09";}g+=r;}return g;};documentReader.prototype.textShapeReaderFromJSON=function(c,f){var g=f.length;for(var b=0;b<g;b++){var a=f[b].a.split(",");var d=new docTextShape();d.rect.set(parseInt(a[0]),parseInt(a[1]),parseInt(a[2]),parseInt(a[3]));d.shapeType=parseInt(a[4]);d.lineStyleKey=parseInt(a[5]);c.textShapeList.push(d);}};documentReader.prototype.originalTextInfoReaderFromJSON=function(b,h){var f=b.getOriginalTextInfo();var a=h.a.split(",");f.text=decodeURIComponent(a[0]);f.originalText=decodeURIComponent(a[1]);f.fontStyleKey=parseInt(a[2]);f.textOptionStyleKey=parseInt(a[3]);f.textMarginStyleKey=parseInt(a[4]);f.textTagStyleKey=parseInt(a[5]);f.originalFontSize=parseInt(a[6]);f.post=(parseInt(a[7])==1?true:false);if(a.length>8){f.textRotation=parseInt(a[8]);}if(a.length>9){f.charDirection=parseInt(a[9]);}f.nameList=this.decodeArrayReaderFromJSON(h.b);var c=null;var g=h.c.length;if(g>0){c=new Array();for(var d=0;d<g;d++){c.push(this.decodeArrayReaderFromJSON(h.c[d]));}}f.result=c;};documentReader.prototype.decodeArrayReaderFromJSON=function(b){var a=null;var d=b.length;if(d>0){a=new Array();for(var c=0;c<b;c++){a.push(decodeURI(b[c]));}}return a;};documentReader.prototype.readImageList=function(a,b){var d=b.length;for(var c=0;c<d;c++){var f=new docImageData();f.dpiX=b[c].b;f.dpiY=b[c].c;f.imageWidth=b[c].f;f.imageHeight=b[c].g;f.filePath=b[c].a;f.formatType=b[c].d;f.isFieldData=b[c].h;this.addNewImageKey(a.imageList,f);}};documentReader.prototype.addNewImageKey=function(a,c){var b=a.length;a.push(c);return b;};documentReader.prototype.readImageInfoFromJSON=function(c,d){var b=d.a.split(",");var a=c;a.imageFilePath=decodeURI(b[0]);a.imageFormatType=this.returnImageFormatType(b[1]);a.backgroundImageStyleKey=b[2];a.imageDataKey=b[3];if(b.length>=6){a.startPosition=b[4];a.endPosition=b[5];}};documentReader.prototype.returnImageFormatType=function(a){if(a==0){return"None";}else{if(a==1){return"BMP";}else{if(a==2){return"JPG";}else{if(a==3){return"PNG";}else{if(a==4){return"GIF";}}}}}};function docDocument(){this.version="";this.title="";this.subject="";this.author="";this.keyword="";this.etc="";this.styleManager=null;this.checkedPageCount=null;this.checkedTotalPageCount=null;this.xPositionList=null;this.useMultiLanguage=null;this.documentPageList=new Array();this.reportServerPath="";this.reportKey="";this.documentMemo={};this.documentReportInfoList=new Array();}docDocument.prototype.getPageInStyle=function(a){return this.getPageStyle(a.pageStyleKey);};docDocument.prototype.getUseMultiLanguage=function(){return this.useMultiLanguage;};docDocument.prototype.getBackgroundImageStyle=function(a){var b=this.styleManager.backgroundImageList;if(a<b.length){return b[a];}else{return null;}};docDocument.prototype.getBackgroundStyle=function(b){var a=this.styleManager.backgroundList;if(b<a.length){return a[b];}else{return null;}};docDocument.prototype.getLineStyle=function(b){var a=this.styleManager.lineList;if(b<a.length){return a[b];}else{return null;}};docDocument.prototype.getShapeStyle=function(b){var a=this.styleManager.shapeList;if(b<a.length){return a[b];}else{return null;}};docDocument.prototype.getVisibleOptionStyle=function(a){var b=this.styleManager.visibleOptionList;if(a<b.length){return b[a];}else{return null;}};docDocument.prototype.getFontStyle=function(b){var a=this.styleManager.fontList;if(b<a.length){return a[b];}else{return null;}};docDocument.prototype.getPageStyle=function(a){var b=this.styleManager.pageList;if(a<b.length){return b[a];}else{return null;}};docDocument.prototype.getTextOptionStyle=function(b){var a=this.styleManager.textOptionList;if(b<a.length){return a[b];}else{return null;}};docDocument.prototype.getTextTagStyle=function(a){var b=this.styleManager.textTagList;if(a<b.length){return b[a];}else{return null;}};docDocument.prototype.getTextMarginStyle=function(b){var a=this.styleManager.textMarginList;if(b<a.length){return a[b];}else{return null;}};docDocument.prototype.getFontNameStyle=function(b){var a=this.styleManager.fontNameList;if(b<a.length){return a[b];}else{return null;}};docDocument.prototype.getPageListLength=function(){if(null!=this.documentPageList){return this.documentPageList.length;}return 0;};docDocument.prototype.addPage=function(a){this.documentPageList.push(a);};docDocument.prototype.removeAllPage=function(){this.documentPageList=new Array();};function documentPage(){this.pageStyleKey=null;this.pageIndex=null;this.imageList=new Array();this.subSectionList=new Array();this.editableControlList=new Array();this.backGround=null;this.foreGround=null;this.width=0;this.height=0;}documentPage.prototype.getWidth=function(){return this.width;};documentPage.prototype.getHeight=function(){return this.height;};documentPage.prototype.getImageData=function(a){if(a<this.imageList.length){return this.imageList[a];}else{return null;}};function docRect(){this.left=0;this.right=0;this.top=0;this.bottom=0;}docRect.prototype.addRect=function(d,c,b,a){this.left+=d;this.top+=c;this.right+=b;this.bottom+=a;return this;};docRect.prototype.set=function(b,d,c,a){this.left=b;this.top=d;this.right=b+c;this.bottom=d+a;};docRect.prototype.setLeft=function(a){this.left=a;};docRect.prototype.setRight=function(a){this.right=a;};docRect.prototype.setTop=function(a){this.top=a;};docRect.prototype.setBottom=function(a){this.bottom=a;};docRect.prototype.offsetRect=function(a,b){this.left+=a;this.right+=a;this.top+=b;this.bottom+=b;};docRect.prototype.getWidth=function(){return this.right-this.left;};docRect.prototype.setWidth=function(a){this.right=this.left+a;};docRect.prototype.getHeight=function(){return this.bottom-this.top;};docRect.prototype.setHeight=function(a){this.bottom=this.top+a;};docRect.prototype.getLeft=function(){return this.left;};docRect.prototype.getRight=function(){return this.right;};docRect.prototype.getTop=function(){return this.top;};docRect.prototype.getBottom=function(){return this.bottom;};docRect.prototype.copyRect=function(a){this.left=a.left;this.right=a.right;this.top=a.top;this.bottom=a.bottom;};docRect.prototype.newRateRect=function(b){var a=new docRect();a.left=this.left*b;a.right=this.right*b;a.top=this.top*b;a.bottom=this.bottom*b;return a;};docRect.prototype.toString=function(){return this.left+","+this.right+","+this.top+","+this.bottom;};function docImageData(){this.dpiX=0;this.dpiY=0;this.imageWidth=0;this.imageHeight=0;this.filePath="";this.formatType="";this.isFieldData=false;}function docSubSection(){this.type=null;this.area=new docRect();this.backgroundStyleKey=null;this.orderTop=null;this.controlPageList=new Array();this.pageMarginRect=null;this.drillingName="";this.isDrilling=false;this.isDrillingView=true;this.sectionType=-1;this.editEasyModeId="noName1";this.isEditEasyMode=false;this.sectionName="";}docSubSection.prototype.getLeftInPage=function(){if(null==this.pageMarginRect){this.pageMarginRect=new docRect();this.pageMarginRect.copyRect(this.area);}return this.pageMarginRect.left;};docSubSection.prototype.getTopInPage=function(){if(null==this.pageMarginRect){this.pageMarginRect=new docRect();this.pageMarginRect.copyRect(this.area);}return this.pageMarginRect.top;};docSubSection.prototype.offsetRect=function(b,a){if(null==this.pageMarginRect){this.pageMarginRect=new docRect();this.pageMarginRect.copyRect(this.area);}else{this.pageMarginRect.copyRect(this.area);}this.pageMarginRect.offsetRect(b,a);return this.pageMarginRect;};function docLine(){this.type=mCR_DocumentControlType.Line;this.subSection=null;this.rect=new docRect();this.lineStyleKey=null;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docLine.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docShape(){this.type=mCR_DocumentControlType.Shape;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=null;this.backgroundStyleKey=null;this.outterlineStyleKey=null;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docShape.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docBarcode(){this.type=mCR_DocumentControlType.Barcode;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=null;this.backgroundStyleKey=null;this.outterlineStyleKey=null;this.svgString=null;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;this.text="";this.barcodeSymbology=1;this.barcodeColor=0;this.barcodeAngle=0;this.showText=false;this.fontName="나눔고딕";this.fontSize=10;this.fontBold=false;this.optResolution=false;this.wideRatio=3;this.accessibilityString="";}docBarcode.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docChart(){this.type=mCR_DocumentControlType.Chart;this.subSection=null;this.rect=new docRect();this.visibleOptionStyleKey=-1;this.svgString=null;this.webLinkInfo=new docWebLinkInfo();this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;this.dataType="";}docChart.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docCheckbox(){this.type=mCR_DocumentControlType.Checkbox;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=null;this.outterlineStyleKey=null;this.visibleOptionStyleKey=-1;this.checkColor=null;this.checkValue=null;this.checkType=null;this.imageRect=new docRect();this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;this.accessibilityString="";}docCheckbox.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function checkboxRevisePosition(d){var b=new docRect();b.copyRect(d);var c=b.getWidth();var a=b.getHeight();var f=0;if(c>a){b.left=b.left+((c-a)/2);b.right=b.left+a;f=a/5;}else{b.top=b.top+((a-c)/2);b.bottom=b.top+c;f=c/5;}b.left+=f;b.top+=f;b.right-=f;b.bottom-=f;return b;}function docTable(){this.type=mCR_DocumentControlType.Table;this.outterlineStyleKey=null;this.accessibilityString=null;this.accessibilityDirectionType=null;this.roundLeftTop=0;this.roundRightTop=0;this.roundLeftBottom=0;this.roundRightBottom=0;this.table=new Array();this.rowColArranger=new rowColArranger();this.tableAutoMerge=null;this.tableSectionExpand=null;this.tableKeepTogether=null;this.tableAutoMergeSide=null;this.mergedTableForExport=null;this.cellMergeOrder=null;this.prevTableID=null;this.nextTableID=null;this.tableUseSplitLine=null;this.lineSplitStyleKey=null;this.lineFDiagonaStyleKey=null;this.lineBDiagonaStyleKey=null;this.rect=new docRect();this.visibleOptionStyleKey=-1;}docTable.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};docTable.prototype.getCellRectInPage=function(a,c,b){return this.getCellRect(a,c,b);};docTable.prototype.getCellRect=function(k,h,j){var b=0;var i=0;var a=0;var l=0;var d=k.getColSpan();var f=k.getRowSpan();for(var c=0;c<j;c++){b+=this.rowColArranger.getColumnWidth(c);}for(var c=0;c<h;c++){i+=this.rowColArranger.getRowHeight(c);}for(var c=j;c<(j+d);c++){a+=this.rowColArranger.getColumnWidth(c);}for(var c=h;c<(h+f);c++){l+=this.rowColArranger.getRowHeight(c);}var g=new docRect();g.set(b,i,a,l);return g;};docTable.prototype.addTableRow=function(a){a.setTable(this);this.table.push(a);};docTable.prototype.getRowCount=function(){return this.table.length;};docTable.prototype.getRowIndex=function(a){return this.table.indexOf(a);};docTable.prototype.getColumnCount=function(){if(this.table.length==0){return 0;}if(this.table[0]!=null){return this.table[0].getColumnCount();}else{return 0;}};docTable.prototype.getTableCellNormal=function(d,a){var c=null;if(d>=0&&a>=0&&d<this.getRowCount()&&a<this.getColumnCount()){var b=this.table[d].getTableCell(a);if(b!=null&&b.getType()==mCR_DocumentControlType.TableCell){c=b;}}return c;};function docTableRow(){this.table=null;this.parentSubSection=null;this.cellList=new Array();this.pageSubSection=false;}docTableRow.prototype.getTableCell=function(a){if(this.getColumnCount()>a){return this.cellList[a];}return null;};docTableRow.prototype.getColumnCount=function(){return this.cellList.length;};docTableRow.prototype.setTable=function(a){this.table=a;};docTableRow.prototype.setPageSubSection=function(a){this.pageSubSection=a;};docTableRow.prototype.addTableCell=function(a){if(a.getType()==mCR_DocumentControlType.TableCell){a.setTableRow(this);}this.cellList.push(a);};docTableRow.prototype.getColIndex=function(a){return this.cellList.indexOf(a);};docTableRow.prototype.getRowIndex=function(){return this.table.getRowIndex(this);};docTableRow.prototype.getCellRectInPage=function(a,b){return this.table.getCellRectInPage(a,this.getRowIndex(),b);};function docTableCellNormal(){this.tableRow=null;this.backgroundStyleKey=-1;this.leftLineStyleKey=-1;this.topLineStyleKey=-1;this.rightLineStyleKey=-1;this.bottomLineStyleKey=-1;this.imageInfo=new docImageInfo();this.detailTextInfo=new docTextInfo();this.isCheckbox=false;this.documentCheckbox=null;this.cellMergeInfo=null;this.webLinkInfo=new docWebLinkInfo();this.canGrow=false;this.editableIndex=-1;this.splitCellCopyText=false;this.spliterSetText=true;this.splitCellID1="";this.splitCellID2="";this.name=null;this.rowSpan=null;this.colSpan=null;this.frontDiagonalLineStyleKey=-1;this.backDiagonalLineStyleKey=-1;this.accessibilityString=null;this.tableRow=null;this.editable=null;}docTableCellNormal.prototype.getType=function(){return 4;};docTableCellNormal.prototype.setTableRow=function(a){this.tableRow=a;};docTableCellNormal.prototype.getRectInPage=function(){return this.tableRow.getCellRectInPage(this,this.getColIndex());};docTableCellNormal.prototype.getColIndex=function(){return this.tableRow.getColIndex(this);};docTableCellNormal.prototype.getColSpan=function(){return this.colSpan;};docTableCellNormal.prototype.getRowSpan=function(){return this.rowSpan;};docTableCellNormal.prototype.setTextInfo=function(a){this.detailTextInfo=a;};function docTableCellDumy(){this.baseCell=null;}docTableCellDumy.prototype.setBaseCell=function(a){this.baseCell=a;};docTableCellDumy.prototype.getType=function(){return 5;};function rowColArranger(){this.rowHeightList=new Array();this.columnWidthList=new Array();}rowColArranger.prototype.addRowHeight=function(a){this.rowHeightList.push(a);};rowColArranger.prototype.addColumnWidth=function(a){this.columnWidthList.push(a);};rowColArranger.prototype.getRowHeight=function(a){return this.rowHeightList[a];};rowColArranger.prototype.getColumnWidth=function(a){return this.columnWidthList[a];};function docCellInfo(a){this.dumy=a;this.leftLineStyleKey=-1;this.topLineStyleKey=-1;this.rightLineStyleKey=-1;this.bottomLineStyleKey=-1;this.isLeftLast=false;this.isTopLast=false;this.rowSpan=1;this.colSpan=1;}function docCellMap(){this.cellMap=new Array();this.leftTopCell=null;this.rightTopCell=null;this.leftBottomCell=null;this.rightBottomCell=null;}function docCrosstab(){this.type=mCR_DocumentControlType.Crosstab;this.subSection=null;this.rect=new docRect();this.outterlineStyleKey=null;this.accessibilityString=null;this.visibleOptionStyleKey=-1;this.headerRowHeightList=new Array();this.headerColumnWidthList=new Array();this.rowRowHeightList=new Array();this.columnColumnWidthList=new Array();this.matrixHeader=new docCrosstabMatrix(this,mCR_DocumentControlType.CrosstabMatrixHeader,this.headerRowHeightList,this.headerColumnWidthList);this.matrixRow=new docCrosstabMatrix(this,mCR_DocumentControlType.CrosstabMatrixRowLabel,this.rowRowHeightList,this.headerColumnWidthList);this.matrixColumn=new docCrosstabMatrix(this,mCR_DocumentControlType.CrosstabMatrixColumnLabel,this.headerRowHeightList,this.columnColumnWidthList);this.matrixSummarized=new docCrosstabMatrix(this,mCR_DocumentControlType.CrosstabMatrixSummarized,this.rowRowHeightList,this.columnColumnWidthList);}docCrosstab.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};docCrosstab.prototype.getMatrixX=function(){var a=0;var c=this.matrixRow.getColumnCount();for(var b=0;b<c;b++){a+=this.matrixRow.getColumnWidth(b);}return a;};docCrosstab.prototype.getMatrixY=function(){var c=0;var b=this.matrixColumn.getRowCount();for(var a=0;a<b;a++){c+=this.matrixColumn.getRowHeight(a);}return c;};function docCrosstabMatrix(c,d,b,a){this.crosstab=c;this.type=d;this.rowHeightList=b;this.columnWidthList=a;this.rowList=new Array();}docCrosstabMatrix.prototype.getCrosstabCellNormal=function(d,b){var a=null;if(d>=0&&b>=0&&d<this.getRowCount()&&b<this.getColumnCount()){var c=this.rowList[d].getCrosstabCell(b);if(c.getType()==mCR_DocumentControlType.TableCell){a=c;}else{a=c.getBaseCell();}}return a;};docCrosstabMatrix.prototype.getCrosstabBaseCell=function(b,a){if(b>=0&&a>=0&&b<this.getRowCount()&&a<this.getColumnCount()){return this.rowList[b].getCrosstabCell(a);}return null;};docCrosstabMatrix.prototype.getRowCount=function(){return this.rowList.length;};docCrosstabMatrix.prototype.getColumnCount=function(){if(this.rowList.length==0){return 0;}if(this.rowList[0]!=null){return this.rowList[0].getColumnCount();}else{return 0;}};docCrosstabMatrix.prototype.getColumnWidth=function(a){return this.columnWidthList[a];};docCrosstabMatrix.prototype.getRowIndex=function(a){return this.rowList.indexOf(a);};docCrosstabMatrix.prototype.getCellRectInPage=function(a,f,b){var c=this.getCellRect(a);var d=this.crosstab;if(this.crosstab!=null){c.offsetRect(d.rect.left,d.rect.top);if(d.subSection!=null){c.offsetRect(d.subSection.getLeftInPage(),d.subSection.getTopInPage());}}return c;};docCrosstabMatrix.prototype.getCellRect=function(l){var b=this.getX();var i=this.getY();var a=0;var k=0;var h=l.getRowIndex();var j=l.getColIndex();var f=l.getColSpan();var g=l.getRowSpan();for(var d=0;d<j;d++){b+=this.getColumnWidth(d);}for(var d=0;d<h;d++){i+=this.getRowHeight(d);}for(var d=j;d<(j+f);d++){a+=this.getColumnWidth(d);}for(var d=h;d<(h+g);d++){k+=this.getRowHeight(d);}var c=new docRect();c.left=b;c.top=i;c.right=b+a;c.bottom=i+k;return c;};docCrosstabMatrix.prototype.getRowHeight=function(a){return this.rowHeightList[a];};docCrosstabMatrix.prototype.getX=function(){var a=0;switch(this.type){case mCR_DocumentControlType.CrosstabMatrixHeader:case mCR_DocumentControlType.CrosstabMatrixRowLabel:break;case mCR_DocumentControlType.CrosstabMatrixColumnLabel:case mCR_DocumentControlType.CrosstabMatrixSummarized:a=this.crosstab.getMatrixX();break;}return a;};docCrosstabMatrix.prototype.getY=function(){var a=0;switch(this.type){case mCR_DocumentControlType.CrosstabMatrixHeader:case mCR_DocumentControlType.CrosstabMatrixColumnLabel:break;case mCR_DocumentControlType.CrosstabMatrixRowLabel:case mCR_DocumentControlType.CrosstabMatrixSummarized:a=this.crosstab.getMatrixY();break;}return a;};function docCrosstabRow(a){this.matrix=a;this.cellList=new Array();}docCrosstabRow.prototype.getColumnCount=function(){return this.cellList.length;};docCrosstabRow.prototype.getCrosstabCell=function(a){if(this.getColumnCount()>a){return this.cellList[a];}return null;};docCrosstabRow.prototype.addCrosstabCell=function(a){if(a.getType()==mCR_DocumentControlType.TableCell){a.setTableRow(this);}this.cellList.push(a);};docCrosstabRow.prototype.getCellRectInPage=function(a){var c=this.getRowIndex();var b=this.getColIndex(a);return this.matrix.getCellRectInPage(a,c,b);};docCrosstabRow.prototype.getRowIndex=function(){return this.matrix.getRowIndex(this);};docCrosstabRow.prototype.getColIndex=function(a){return this.cellList.indexOf(a);};docCrosstabRow.prototype.getColumnCount=function(){return this.cellList.length;};function docCrosstabCellDumy(){this.baseCell=null;}docCrosstabCellDumy.prototype.setBaseCell=function(a){this.baseCell=a;};docCrosstabCellDumy.prototype.getType=function(){return mCR_DocumentControlType.TableCellDumy;};function docCrosstabCellNormal(a){this.crosstabRow=a;this.backgroundStyleKey=-1;this.leftLineStyleKey=-1;this.topLineStyleKey=-1;this.rightLineStyleKey=-1;this.bottomLineStyleKey=-1;this.imageInfo=new docImageInfo();this.detailTextInfo=new docTextInfo();this.webLinkInfo=new docWebLinkInfo();this.canGrow=false;this.name=null;this.rowSpan=null;this.colSpan=null;this.frontDiagonalLineStyleKey=null;this.backDiagonalLineStyleKey=null;this.accessibilityString=null;this.cellMergeRowDataDuplication=false;this.cellMergeColumnDataDuplication=false;this.cellMergeRowReferenceText="";this.cellMergeColumnReferenceText="";}docCrosstabCellNormal.prototype.getType=function(){return mCR_DocumentControlType.TableCell;};docCrosstabCellNormal.prototype.setTableRow=function(a){this.crosstabRow=a;};docCrosstabCellNormal.prototype.getRectInPage=function(){return this.crosstabRow.getCellRectInPage(this);};docCrosstabCellNormal.prototype.getRowSpan=function(){return this.rowSpan;};docCrosstabCellNormal.prototype.getColSpan=function(){return this.colSpan;};docCrosstabCellNormal.prototype.getRowIndex=function(){return this.crosstabRow.getRowIndex();};docCrosstabCellNormal.prototype.getColIndex=function(){return this.crosstabRow.getColIndex(this);};docCrosstabCellNormal.prototype.setTextInfo=function(a){this.detailTextInfo=a;};function docReportControl(){this.type=mCR_DocumentControlType.SubReport;this.subSection=null;this.rect=new docRect();this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;this.subSectionList=new Array();}docReportControl.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docReportControlSubSection(){this.type=null;this.area=new docRect();this.backgroundStyleKey=null;this.orderTop=null;this.controlPageList=new Array();this.docReportControl=null;}docReportControlSubSection.prototype.getLeftInPage=function(){return this.docReportControl.getRectInPage().left+this.area.left;};docReportControlSubSection.prototype.getTopInPage=function(){return this.docReportControl.getRectInPage().top+this.area.top;};docReportControlSubSection.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.area);if(this.docReportControl!=null){a.offsetRect(this.docReportControl.getRectInPage().left,this.docReportControl.getRectInPage().top);}return a;};function DocMarkAnyVoice(){this.type=mCR_DocumentControlType.MarkAnyVoiceEye;this.subSection=null;this.rect=new docRect();this.visibleOptionStyleKey=-1;this.svgString=null;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}DocMarkAnyVoice.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function DocVerifyBarcode(){this.type=mCR_DocumentControlType.VerifyBarcode;this.subSection=null;this.rect=new docRect();this.visibleOptionStyleKey=-1;this.text="";this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}DocVerifyBarcode.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function DocVoiceEye(){this.type=mCR_DocumentControlType.VoiceEye;this.subSection=null;this.rect=new docRect();this.visibleOptionStyleKey=-1;this.svgString=null;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}DocVoiceEye.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docInputSign(){this.type=mCR_DocumentControlType.InputSign;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=null;this.backgroundStyleKey=null;this.outterlineStyleKey=null;this.visibleOptionStyleKey=-1;this.penWidth=3;this.penColor=0;this.primaryName=null;this.isNecessaryCheck=false;this.necessaryName=null;this.guileLineColor=255;this.guileLineWidth=75;this.guileLineStyle=0;this.transparencyRate=null;this.horizontalAlignmentMethod=1;this.verticalAlignmentMethod=1;this.accessibilityString=null;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docInputSign.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docInputCheckbox(){this.type=mCR_DocumentControlType.InputCheckbox;this.subSection=null;this.rect=new docRect();this.outterlineStyleKey;this.primaryName;this.textInfo=new docTextInfo();this.checkSize;this.selectType=0;this.selectArea=1;this.useText;this.shapeStyleKey=-1;this.backgroundStyleKey;this.accessibilityString="";this.guideTransparency=100;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docInputCheckbox.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docInputImage(){this.type=mCR_DocumentControlType.InputImage;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=null;this.backgroundStyleKey=null;this.outterlineStyleKey=null;this.visibleOptionStyleKey=-1;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;this.primaryName=null;this.transparencyRate=null;this.accessibilityString=null;}docInputImage.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docInputbox(){this.type=mCR_DocumentControlType.Input;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=-1;this.backgroundStyleKey;this.outterlineStyleKey;this.primaryName;this.textInfo=new docTextInfo();this.accessibilityString;this.transparencyRate=100;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docInputbox.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docInputSelectbox(){this.type=mCR_DocumentControlType.InputSelectBox;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=-1;this.backgroundStyleKey;this.outterlineStyleKey;this.primaryName;this.textInfo=new docTextInfo();this.accessibilityString;this.transparencyRate=100;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docInputSelectbox.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docInputCalendar(){this.type=mCR_DocumentControlType.Calendar;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=-1;this.backgroundStyleKey;this.outterlineStyleKey;this.primaryName;this.accessibilityString;this.transparencyRate=100;this.fontStyleKey;this.textMarginStyleKey;this.textOptionStyleKey;this.textInfo=new docTextInfo();this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docInputCalendar.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docInputButton(){this.type=mCR_DocumentControlType.Button;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=-1;this.backgroundStyleKey;this.outterlineStyleKey;this.primaryName;this.textInfo=new docTextInfo();this.accessibilityString;this.transparencyRate=100;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docInputButton.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docInputVideo(){this.type=mCR_DocumentControlType.Video;this.subSection=null;this.rect=new docRect();this.shapeStyleKey=-1;this.backgroundStyleKey;this.outterlineStyleKey;this.primaryName;this.accessibilityString;this.transparencyRate=100;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docInputVideo.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docLabel(){this.type=mCR_DocumentControlType.Label;this.rect=new docRect();this.shapeStyleKey=null;this.backgroundStyleKey=null;this.outterlineStyleKey=null;this.imageInfo=new docImageInfo();this.textInfo=new docTextInfo();this.webLinkInfo=new docWebLinkInfo();this.accessibilityString=null;this.editable=false;this.editableIndex=-1;this.visibleOptionStyleKey=-1;this.visible=true;this.conditionVisible=true;this.pageCountConditionType=-1;}docLabel.prototype.setTextInfo=function(a){this.textInfo=a;};docLabel.prototype.getRectInPage=function(){var a=new docRect();a.copyRect(this.rect);if(this.subSection!=null){a.offsetRect(this.subSection.getLeftInPage(),this.subSection.getTopInPage());}return a;};function docOriginalTextInfo(){this.text=null;this.originalText=null;this.fontStyleKey=null;this.textOptionStyleKey=null;this.textMarginStyleKey=null;this.textTagStyleKey=null;this.originalFontSize=null;this.post=null;this.textRotation=0;this.charDirection=0;this.nameList=null;this.result=null;}docOriginalTextInfo.prototype.getFontStyleKey=function(){return this.fontStyleKey;};docOriginalTextInfo.prototype.getTextRotation=function(){return this.textRotation;};docOriginalTextInfo.prototype.getCharDirection=function(){return this.charDirection;};docOriginalTextInfo.prototype.getTextOptionStyleKey=function(){return this.textOptionStyleKey;};docOriginalTextInfo.prototype.getTextMarginStyleKey=function(){return this.textMarginStyleKey;};function docTextCharacter(){this.character=null;this.xPosition=null;}docTextCharacter.prototype.getX=function(){return this.xPosition;};docTextCharacter.prototype.getCharacter=function(){return this.character;};function docTextCharacterBatch(){this.fontStyleKey=null;this.smallChar=null;this.sup=null;this.sub=null;this.characterList=new Array();}docTextCharacterBatch.prototype.getCharacter=function(a){return this.characterList[a];};docTextCharacterBatch.prototype.getCharacterCount=function(){return this.characterList.length;};docTextCharacterBatch.prototype.getIsSmallChar=function(){return this.smallChar;};docTextCharacterBatch.prototype.getIsSup=function(){return this.sup;};docTextCharacterBatch.prototype.getIsSub=function(){return this.sub;};docTextCharacterBatch.prototype.getFontStyleKey=function(){return this.fontStyleKey;};function docTextInfo(){this.isPageCount=null;this.isTotalPageCount=null;this.textLineList=new Array();this.originalTextInfo=new docOriginalTextInfo();this.useMultiLanguage=false;this.pageFormula=null;this.formulaFieldIndex=-1;this.scriptString=null;}docTextInfo.prototype.getUseMultiLanguage=function(){return this.useMultiLanguage;};docTextInfo.prototype.getOriginalTextInfo=function(){return this.originalTextInfo;};docTextInfo.prototype.getTextLineCount=function(){return this.textLineList.length;};docTextInfo.prototype.getTextLine=function(a){return this.textLineList[a];};docTextInfo.prototype.getHeight=function(){if(this.textLineList.length==0){return 0;}else{var a=this.getLastTextLine();return a.getY2();}};docTextInfo.prototype.getLastTextLine=function(){return this.textLineList[this.textLineList.length-1];};function docTextLine(){this.xPosition=null;this.yPosition=null;this.text=null;this.height=null;this.eraseSpaceCount=null;this.continuesLine=null;this.textShapeList=new Array();this.characterBatchList=new Array();}docTextLine.prototype.getCharacterBatchCount=function(){return this.characterBatchList.length;};docTextLine.prototype.getCharacterBatch=function(a){return this.characterBatchList[a];};docTextLine.prototype.getY=function(a){return this.yPosition;};docTextLine.prototype.getY2=function(a){return this.yPosition+this.height;};docTextLine.prototype.getHeight=function(a){return this.height;};docTextLine.prototype.getText=function(){return this.text;};docTextLine.prototype.getTextShapeCount=function(){return this.textShapeList.length;};docTextLine.prototype.getTextShape=function(a){return this.textShapeList[a];};docTextLine.prototype.isPaint=function(a,b){if(this.getY2()<=a+this.getHeight()*0.15||b==0){return true;}return false;};function docTextShape(){this.rect=new docRect();this.shapeType=null;this.lineStyleKey=null;}function docImageInfo(){this.parent=null;this.imageFilePath="";this.imageFormatType=0;this.backgroundImageStyleKey=-1;this.imageDataKey=-1;this.startPosition=0;this.endPosition=100;this.imageData=null;}docImageInfo.prototype.setParent=function(a){this.parent=a;};function docWebLinkInfo(){this.type=null;this.linkUrl=null;this.webLinkType=null;this.frameName=null;this.windowWidth=null;this.windowHeight=null;this.editText=null;this.editableIndex=-1;this.fontStyle="";this.objControl=null;this.isChecked=false;}docWebLinkInfo.prototype.getType=function(){return this.type;};docWebLinkInfo.prototype.getLinkUrl=function(){return this.linkUrl;};function docStyleBackground(){this.backStyle=null;this.backColor=null;this.fillStyle=null;this.fillColor=null;this.gradientStyle=null;this.gradientStartColor=null;this.gradientEndColor=null;}docStyleBackground.prototype.getBackStyle=function(){return this.backStyle;};function docStyleBackgroundImage(){this.imageDrawMethod=null;this.imageFrame=null;this.horizontalAlignment=null;this.verticalAlignment=null;this.rate=null;this.transparency=null;}function docStyleFont(){this.nameIndex=null;this.size=null;this.bold=null;this.italic=null;this.underline=null;this.strike=null;this.color=null;this.underLineStyle=null;this.underLineColor=null;this.strikeLineStyle=null;this.strikeLineColor=null;this.nameEngIndex=null;this.underLineWidth=75;this.autoUnderLineWidth=true;this.strikeLineWidth=75;this.autoStrikeLineWidth=true;}function docStyleLine(){this.style=null;this.width=null;this.color=null;}docStyleLine.prototype.setStyle=function(a,b,c){this.style=a;this.width=b;this.color=c;};function docStylePage(){this.paperType=null;this.width=null;this.height=null;this.orientation=null;this.leftMargin=null;this.topMargin=null;this.rightMargin=null;this.bottomMargin=null;this.pageCount=null;this.multiColumnDirection=null;}function docStyleShape(){this.shapeType=null;this.roundRate=null;}function docStyleTextMargin(){this.left=null;this.top=null;this.right=null;this.bottom=null;}function docStyleTextOption(){this.horizontalAlignment=null;this.verticalAlignment=null;this.wordWrap=null;this.wordBreaking=null;this.wordSpace=null;this.lineSpace=null;this.charSet=null;this.outputFormat=null;this.autoFont=null;}docStyleTextOption.prototype.getHorizontalAlignment=function(){return this.horizontalAlignment;};docStyleTextOption.prototype.getVerticalAlignment=function(){return this.verticalAlignment;};function docStyleTextTag(){this.use=null;this.bold=null;this.italic=null;this.underline=null;this.strike=null;this.color=null;this.round=null;this.rectangle=null;this.supScript=null;this.subScript=null;this.lineBreak=null;this.fontName=null;this.fontSize=null;}function docStyleVisibleOption(){this.toView=null;this.toPrint=null;this.toXLS=null;this.toPDF=null;this.toHWP=null;this.toHTM=null;this.toPPT=null;this.toRTF=null;this.toBMP=null;this.toJPG=null;this.toTIF=null;this.toTXT=null;}function mCR_Symbology(a,d,b,c){this.isCanvas=a;this.g=d;this.barcode=b;this.rect=c;this.errorCode=0;this.errorMsg="";}mCR_Symbology.prototype.drawErrorMsg=function(){};mCR_Symbology.prototype.getBarcodeWidth=function(){var a=0;switch(this.barcode.barcodeAngle){case 0:case 2:a=this.rect.getWidth();break;case 1:case 3:a=this.rect.getHeight();break;}return a;};mCR_Symbology.prototype.drawBarCodeRect=function(f,d,c,a){f=f*0.378;d=d*0.378;c=c*0.378;a=a*0.378;if(this.isCanvas){this.g.beginPath();this.g.rect(f,d,c,a);this.g.fillStyle=mCR_getStrColor(this.barcode.barcodeColor);this.g.fill();}else{var b=document.createElementNS("http://www.w3.org/2000/svg","rect");b.setAttribute("x",f);b.setAttribute("y",d);b.setAttribute("width",c);b.setAttribute("height",a);b.setAttribute("stroke","none");b.setAttribute("fill",mCR_getStrColor(this.barcode.barcodeColor));this.g.appendChild(b);}};mCR_Symbology.prototype.drawBarAngle0=function(c,b,a){if(a!=null){this.drawBarCodeRect(Math.round(c),this.rect.top,Math.round(b),a);}else{this.drawBarCodeRect(c,this.rect.top,b,this.rect.getHeight());}};mCR_Symbology.prototype.drawBarAngle90=function(c,b,a){if(a!=null){this.drawBarCodeRect(this.rect.left,Math.round(c-b),a,Math.round(b));}else{this.drawBarCodeRect(this.rect.left,(c-b),this.rect.getWidth(),b);}};mCR_Symbology.prototype.drawBarAngle180=function(c,b,a,d){if(a!=null){this.drawBarCodeRect(Math.round(c-b),d,Math.round(b),a);}else{this.drawBarCodeRect((c-b),this.rect.top,b,this.rect.getHeight());}};mCR_Symbology.prototype.drawBarAngle270=function(c,b,a,d){if(a!=null){this.drawBarCodeRect(d,Math.round(c),a,Math.round(b));}else{this.drawBarCodeRect(this.rect.left,c,this.rect.getWidth(),b);}};mCR_Symbology.prototype.drawBarCodeFontRect=function(c,b,g,a,f){c=c*0.378;b=b*0.378;if(this.isCanvas){this.g.save();this.g.font=g;this.g.fillStyle=mCR_getStrColor(this.barcode.barcodeColor);switch(a){case 0:this.g.fillText(f,c,b);break;case 1:this.g.translate(c,b);this.g.rotate(270*Math.PI/180);this.g.fillText(f,0,0);break;case 2:this.g.translate(c,b);this.g.rotate(180*Math.PI/180);this.g.fillText(f,0,0);break;case 3:this.g.translate(c,b);this.g.rotate(90*Math.PI/180);this.g.fillText(f,0,0);break;}this.g.restore();}else{var d=document.createElementNS("http://www.w3.org/2000/svg","text");switch(a){case 0:d.setAttribute("x",c);d.setAttribute("y",b);break;case 1:d.setAttribute("transform","rotate(270,"+c+","+b+") translate("+0+",0)");d.setAttribute("x",c);d.setAttribute("y",b);break;case 2:d.setAttribute("transform","rotate(180,"+c+","+b+") translate("+0+",0)");d.setAttribute("x",c);d.setAttribute("y",b);break;case 3:d.setAttribute("transform","rotate(90,"+c+","+b+") translate("+0+",0)");d.setAttribute("x",c);d.setAttribute("y",b);break;}if(this.barcode.fontBold){d.setAttribute("font-weight","bold");}d.setAttribute("fill",mCR_getStrColor(this.barcode.barcodeColor));d.setAttribute("font-family",this.barcode.fontName);d.setAttribute("font-size",this.barcode.fontSize+"px");d.textContent=f;this.g.appendChild(d);}};mCR_Symbology.prototype.drawBarCodeFontAngle0=function(b,a,d,c){this.drawBarCodeFontRect(b,a,d,0,c);};mCR_Symbology.prototype.drawBarCodeFontAngle90=function(b,a,d,c){this.drawBarCodeFontRect(b,a,d,1,c);};mCR_Symbology.prototype.drawBarCodeFontAngle180=function(b,a,d,c){this.drawBarCodeFontRect(b,a,d,2,c);};mCR_Symbology.prototype.drawBarCodeFontAngle270=function(b,a,d,c){this.drawBarCodeFontRect(b,a,d,3,c);};function BarcodeEAN_Pattern(b,a){this.pattern=b;this.text=a;this.halfStatus=(a=="");}BarcodeEAN_Pattern.prototype.getPattern=function(){return this.pattern;};BarcodeEAN_Pattern.prototype.getText=function(){return this.text;};BarcodeEAN_Pattern.prototype.getHalfStatus=function(){return this.halfStatus;};function mCR_SymbologyCode39(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);this.START_CHAR=43;this.END_CHAR=43;}mCR_SymbologyCode39.prototype=Object.create(mCR_Symbology.prototype);mCR_SymbologyCode39.prototype.constructor=mCR_SymbologyCode39;mCR_SymbologyCode39.prototype.drawBarcode=function(){var a=this.createPattern(this.barcode.text);if(this.errorCode==0){this.drawPattern(a);}else{this.drawErrorMsg();}};mCR_SymbologyCode39.prototype.drawPattern=function(b){var a=this.getDimension(b);this.drawNWPattern(b,a);};mCR_SymbologyCode39.prototype.drawNWPattern=function(b,a){switch(this.barcode.barcodeAngle){case 0:this.drawNWPatternAngle0(b,a);break;case 1:this.drawNWPatternAngle90(b,a);break;case 2:this.drawNWPatternAngle180(b,a);break;case 3:this.drawNWPatternAngle270(b,a);break;}};mCR_SymbologyCode39.prototype.drawNWPatternAngle0=function(g,f){var a=this.rect.left;var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle0(a,c);}a=a+c;}};mCR_SymbologyCode39.prototype.drawNWPatternAngle90=function(g,f){var a=(this.rect.top+this.rect.getHeight());var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle90(a,c);}a=a-c;}};mCR_SymbologyCode39.prototype.drawNWPatternAngle180=function(g,f){var a=(this.rect.left+this.rect.getWidth());var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle180(a,c);}a=a-c;}};mCR_SymbologyCode39.prototype.drawNWPatternAngle270=function(g,f){var a=(this.rect.top);var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle270(a,c);}a=a+c;}};mCR_SymbologyCode39.prototype.getBarWidth=function(b,d){var a;var c=this.barcode.wideRatio;if(b=="n"){a=d;}else{a=d*c;}return a;};mCR_SymbologyCode39.prototype.getDimension=function(c){var d=this.getBarModuleSize(c);var a=this.getBarcodeWidth();var b=0;if(this.barcode.optResolution){b=Math.floor((a/d));if(b<1){b=1;}}else{b=(a/d);}return b;};mCR_SymbologyCode39.prototype.getBarModuleSize=function(d){var g=d.length;var a=0;for(var b=0;b<g;b++){if(d.charAt(b)=="w"){a++;}}var c=this.barcode.wideRatio;var f=g+(a*(c-1))-1;return f;};mCR_SymbologyCode39.prototype.createPattern=function(h){var g="";var f=h.length;if(f>2){if(h.charAt(0)=="*"&&h.charAt(f-1)=="*"){h=h.substring(1,f-1);f=h.length;}}if(f==0){this.errorCode=1;this.errorMsg="value size error";}else{var a=0;g=this.getStartPattern();for(var b=0;b<f;b++){var c=h.charAt(b);var d=this.getCharacterCode(c);if(d!=-1){g+=this.retrievePattern(d);a+=d;}else{this.errorCode=2;this.errorMsg="Unvalid data";g="";break;}}if(this.errorCode==0){g=g+this.getStopPattern();}}return g;};mCR_SymbologyCode39.prototype.getStartPattern=function(){return this.retrievePattern(this.START_CHAR);};mCR_SymbologyCode39.prototype.getStopPattern=function(){return this.retrievePattern(this.END_CHAR);};mCR_SymbologyCode39.prototype.getCharacterCode=function(b){var a=-1;switch(b){case"0":a=0;break;case"1":a=1;break;case"2":a=2;break;case"3":a=3;break;case"4":a=4;break;case"5":a=5;break;case"6":a=6;break;case"7":a=7;break;case"8":a=8;break;case"9":a=9;break;case"A":a=10;break;case"B":a=11;break;case"C":a=12;break;case"D":a=13;break;case"E":a=14;break;case"F":a=15;break;case"G":a=16;break;case"H":a=17;break;case"I":a=18;break;case"J":a=19;break;case"K":a=20;break;case"L":a=21;break;case"M":a=22;break;case"N":a=23;break;case"O":a=24;break;case"P":a=25;break;case"Q":a=26;break;case"R":a=27;break;case"S":a=28;break;case"T":a=29;break;case"U":a=30;break;case"V":a=31;break;case"W":a=32;break;case"X":a=33;break;case"Y":a=34;break;case"Z":a=35;break;case"-":a=36;break;case".":a=37;break;case" ":a=38;break;case"$":a=39;break;case"/":a=40;break;case"+":a=41;break;case"%":a=42;break;case"*":a=43;break;}return a;};mCR_SymbologyCode39.prototype.retrievePattern=function(a){var b="";switch(a){case 0:b="nnnwwnwnnn";break;case 1:b="wnnwnnnnwn";break;case 2:b="nnwwnnnnwn";break;case 3:b="wnwwnnnnnn";break;case 4:b="nnnwwnnnwn";break;case 5:b="wnnwwnnnnn";break;case 6:b="nnwwwnnnnn";break;case 7:b="nnnwnnwnwn";break;case 8:b="wnnwnnwnnn";break;case 9:b="nnwwnnwnnn";break;case 10:b="wnnnnwnnwn";break;case 11:b="nnwnnwnnwn";break;case 12:b="wnwnnwnnnn";break;case 13:b="nnnnwwnnwn";break;case 14:b="wnnnwwnnnn";break;case 15:b="nnwnwwnnnn";break;case 16:b="nnnnnwwnwn";break;case 17:b="wnnnnwwnnn";break;case 18:b="nnwnnwwnnn";break;case 19:b="nnnnwwwnnn";break;case 20:b="wnnnnnnwwn";break;case 21:b="nnwnnnnwwn";break;case 22:b="wnwnnnnwnn";break;case 23:b="nnnnwnnwwn";break;case 24:b="wnnnwnnwnn";break;case 25:b="nnwnwnnwnn";break;case 26:b="nnnnnnwwwn";break;case 27:b="wnnnnnwwnn";break;case 28:b="nnwnnnwwnn";break;case 29:b="nnnnwnwwnn";break;case 30:b="wwnnnnnnwn";break;case 31:b="nwwnnnnnwn";break;case 32:b="wwwnnnnnnn";break;case 33:b="nwnnwnnnwn";break;case 34:b="wwnnwnnnnn";break;case 35:b="nwwnwnnnnn";break;case 36:b="nwnnnnwnwn";break;case 37:b="wwnnnnwnnn";break;case 38:b="nwwnnnwnnn";break;case 39:b="nwnwnwnnnn";break;case 40:b="nwnwnnnwnn";break;case 41:b="nwnnnwnwnn";break;case 42:b="nnnwnwnwnn";break;case 43:b="nwnnwnwnnn";break;}return b;};function mCR_SymbologyCode39A(a,d,b,c){mCR_SymbologyCode39.call(this,a,d,b,c);}mCR_SymbologyCode39A.prototype=Object.create(mCR_SymbologyCode39.prototype);mCR_SymbologyCode39A.prototype.constructor=mCR_SymbologyCode39A;mCR_SymbologyCode39A.prototype.drawBarcode=function(){var c=this.barcode.text;var d="";for(var a=0;a<c.length;a++){d+=this.encoding(c.charCodeAt(a));}var b=this.createPattern(d);if(this.errorCode==0){this.drawPattern(b);}else{this.drawErrorMsg();}};mCR_SymbologyCode39A.prototype.encoding=function(b){var a="";switch(b){case 0:a="%U";break;case 1:a="$A";break;case 2:a="$B";break;case 3:a="$C";break;case 4:a="$D";break;case 5:a="$E";break;case 6:a="$F";break;case 7:a="$G";break;case 8:a="$H";break;case 9:a="$I";break;case 10:a="$J";break;case 11:a="$K";break;case 12:a="$L";break;case 13:a="$M";break;case 14:a="$N";break;case 15:a="$O";break;case 16:a="$P";break;case 17:a="$Q";break;case 18:a="$R";break;case 19:a="$S";break;case 20:a="$T";break;case 21:a="$U";break;case 22:a="$V";break;case 23:a="$W";break;case 24:a="$X";break;case 25:a="$Y";break;case 26:a="$Z";break;case 27:a="%A";break;case 28:a="%B";break;case 29:a="%C";break;case 30:a="%D";break;case 31:a="%E";break;case 32:a=" ";break;case 33:a="/A";break;case 34:a="/B";break;case 35:a="/C";break;case 36:a="/D";break;case 37:a="/E";break;case 38:a="/F";break;case 39:a="/G";break;case 40:a="/H";break;case 41:a="/I";break;case 42:a="/J";break;case 43:a="/K";break;case 44:a="/L";break;case 45:a="-";break;case 46:a=".";break;case 47:a="/O";break;case 48:a="0";break;case 49:a="1";break;case 50:a="2";break;case 51:a="3";break;case 52:a="4";break;case 53:a="5";break;case 54:a="6";break;case 55:a="7";break;case 56:a="8";break;case 57:a="9";break;case 58:a="/Z";break;case 59:a="%F";break;case 60:a="%G";break;case 61:a="%H";break;case 62:a="%I";break;case 63:a="%J";break;case 64:a="%V";break;case 65:a="A";break;case 66:a="B";break;case 67:a="C";break;case 68:a="D";break;case 69:a="E";break;case 70:a="F";break;case 71:a="G";break;case 72:a="H";break;case 73:a="I";break;case 74:a="J";break;case 75:a="K";break;case 76:a="L";break;case 77:a="M";break;case 78:a="N";break;case 79:a="O";break;case 80:a="P";break;case 81:a="Q";break;case 82:a="R";break;case 83:a="S";break;case 84:a="T";break;case 85:a="U";break;case 86:a="V";break;case 87:a="W";break;case 88:a="X";break;case 89:a="Y";break;case 90:a="Z";break;case 91:a="%K";break;case 92:a="%L";break;case 93:a="%M";break;case 94:a="%N";break;case 95:a="%O";break;case 96:a="%W";break;case 97:a="+A";break;case 98:a="+B";break;case 99:a="+C";break;case 100:a="+D";break;case 101:a="+E";break;case 102:a="+F";break;case 103:a="+G";break;case 104:a="+H";break;case 105:a="+I";break;case 106:a="+J";break;case 107:a="+K";break;case 108:a="+L";break;case 109:a="+M";break;case 110:a="+N";break;case 111:a="+O";break;case 112:a="+P";break;case 113:a="+Q";break;case 114:a="+R";break;case 115:a="+S";break;case 116:a="+T";break;case 117:a="+U";break;case 118:a="+V";break;case 119:a="+W";break;case 120:a="+X";break;case 121:a="+Y";break;case 122:a="+Z";break;case 123:a="%P";break;case 124:a="%Q";break;case 125:a="%R";break;case 126:a="%S";break;case 127:a="%T";break;}return a;};function mCR_SymbologyCode93(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);}mCR_SymbologyCode93.prototype=Object.create(mCR_Symbology.prototype);mCR_SymbologyCode93.prototype.constructor=mCR_SymbologyCode93;mCR_SymbologyCode93.prototype.drawBarcode=function(){var a=this.createPattern(this.barcode.text);if(this.errorCode==0){this.drawPattern(a);}else{this.drawErrorMsg();}};mCR_SymbologyCode93.prototype.drawPattern=function(b){var a=this.getDimension(b);this.drawBSPattern(b,a);};mCR_SymbologyCode93.prototype.drawBSPattern=function(b,a){switch(this.barcode.barcodeAngle){case 0:this.drawBSPatternAngle0(b,a);break;case 1:this.drawBSPatternAngle90(b,a);break;case 2:this.drawBSPatternAngle180(b,a);break;case 3:this.drawBSPatternAngle270(b,a);break;}};mCR_SymbologyCode93.prototype.drawBSPatternAngle0=function(g,f){var a=this.rect.left;var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle0(a,c);a=a+c;}c=0;a=a+f;}}if(c!=0){this.drawBarAngle0(a,c);}};mCR_SymbologyCode93.prototype.drawBSPatternAngle90=function(g,f){var a=(this.rect.top+this.rect.getHeight());var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle90(a,c);a=a-c;}c=0;a=a-f;}}if(c!=0){this.drawBarAngle90(a,c);}};mCR_SymbologyCode93.prototype.drawBSPatternAngle180=function(g,f){var a=(this.rect.left+this.rect.getWidth());var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle180(a,c);a=a-c;}c=0;a=a-f;}}if(c!=0){this.drawBarAngle180(a,c);}};mCR_SymbologyCode93.prototype.drawBSPatternAngle270=function(g,f){var a=(this.rect.top);var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle270(a,c);a=a+c;}c=0;a=a+f;}}if(c!=0){this.drawBarAngle270(a,c);}};mCR_SymbologyCode93.prototype.getDimension=function(d){var a=d.length;var b=this.getBarcodeWidth();var c=0;if(this.barcode.optResolution){c=Math.floor((b/a));if(c<1){c=1;}}else{c=(b/a);}return c;};mCR_SymbologyCode93.prototype.createPattern=function(i){var g="";var f=i.length;if(f>0){var a=0;var h=0;g+=this.retrievePattern(47);for(var b=0;b<f;b++){var c=this.getCharacterCode(i.charAt(b));if(c!=-1){g+=this.retrievePattern(c);}else{this.errorCode=2;this.errorMsg="Unvalid data";g="";break;}var d=f-b;d=d%20;if(d==0){d=20;}var j=f-b+1;j=j%15;if(j==0){j=15;}a+=(c*d);h+=(c*j);}if(this.errorCode==0){a%=47;h+=a;h%=47;g+=this.retrievePattern(a);g+=this.retrievePattern(h);g+=this.retrievePattern(47);g+="b";}}return g;};mCR_SymbologyCode93.prototype.getCharacterCode=function(a){var b=-1;switch(a){case"0":b=0;break;case"1":b=1;break;case"2":b=2;break;case"3":b=3;break;case"4":b=4;break;case"5":b=5;break;case"6":b=6;break;case"7":b=7;break;case"8":b=8;break;case"9":b=9;break;case"A":b=10;break;case"B":b=11;break;case"C":b=12;break;case"D":b=13;break;case"E":b=14;break;case"F":b=15;break;case"G":b=16;break;case"H":b=17;break;case"I":b=18;break;case"J":b=19;break;case"K":b=20;break;case"L":b=21;break;case"M":b=22;break;case"N":b=23;break;case"O":b=24;break;case"P":b=25;break;case"Q":b=26;break;case"R":b=27;break;case"S":b=28;break;case"T":b=29;break;case"U":b=30;break;case"V":b=31;break;case"W":b=32;break;case"X":b=33;break;case"Y":b=34;break;case"Z":b=35;break;case"-":b=36;break;case".":b=37;break;case" ":b=38;break;case"$":b=39;break;case"/":b=40;break;case"+":b=41;break;case"%":b=42;break;case"!":b=43;break;case"#":b=44;break;case"&":b=45;break;case"@":b=46;break;case"*":b=47;break;}return b;};mCR_SymbologyCode93.prototype.retrievePattern=function(a){var b="";switch(a){case 0:b="bsssbsbss";break;case 1:b="bsbssbsss";break;case 2:b="bsbsssbss";break;case 3:b="bsbssssbs";break;case 4:b="bssbsbsss";break;case 5:b="bssbssbss";break;case 6:b="bssbsssbs";break;case 7:b="bsbsbssss";break;case 8:b="bsssbssbs";break;case 9:b="bssssbsbs";break;case 10:b="bbsbsbsss";break;case 11:b="bbsbssbss";break;case 12:b="bbsbsssbs";break;case 13:b="bbssbsbss";break;case 14:b="bbssbssbs";break;case 15:b="bbsssbsbs";break;case 16:b="bsbbsbsss";break;case 17:b="bsbbssbss";break;case 18:b="bsbbsssbs";break;case 19:b="bssbbsbss";break;case 20:b="bsssbbsbs";break;case 21:b="bsbsbbsss";break;case 22:b="bsbssbbss";break;case 23:b="bsbsssbbs";break;case 24:b="bssbsbbss";break;case 25:b="bsssbsbbs";break;case 26:b="bbsbbsbss";break;case 27:b="bbsbbssbs";break;case 28:b="bbsbsbbss";break;case 29:b="bbsbssbbs";break;case 30:b="bbssbsbbs";break;case 31:b="bbssbbsbs";break;case 32:b="bsbbsbbss";break;case 33:b="bsbbssbbs";break;case 34:b="bssbbsbbs";break;case 35:b="bssbbbsbs";break;case 36:b="bssbsbbbs";break;case 37:b="bbbsbsbss";break;case 38:b="bbbsbssbs";break;case 39:b="bbbssbsbs";break;case 40:b="bsbbsbbbs";break;case 41:b="bsbbbsbbs";break;case 42:b="bbsbsbbbs";break;case 43:b="bssbssbbs";break;case 44:b="bbbsbbsbs";break;case 45:b="bbbsbsbbs";break;case 46:b="bssbbssbs";break;case 47:b="bsbsbbbbs";break;}return b;};function mCR_SymbologyCode93A(a,d,b,c){mCR_SymbologyCode93.call(this,a,d,b,c);}mCR_SymbologyCode93A.prototype=Object.create(mCR_SymbologyCode93.prototype);mCR_SymbologyCode93A.prototype.constructor=mCR_SymbologyCode93A;mCR_SymbologyCode93A.prototype.drawBarcode=function(){var f="";var b=this.barcode.text.length;var d=this.barcode.text;for(var a=0;a<b;a++){f+=this.encoding(d.charCodeAt(a));}var c=this.createPattern(f);if(this.errorCode==0){this.drawPattern(c);}else{this.drawErrorMsg();}};mCR_SymbologyCode93A.prototype.encoding=function(b){var a="";switch(b){case 0:a="%U";break;case 1:a="$A";break;case 2:a="$B";break;case 3:a="$C";break;case 4:a="$D";break;case 5:a="$E";break;case 6:a="$F";break;case 7:a="$G";break;case 8:a="$H";break;case 9:a="$I";break;case 10:a="$J";break;case 11:a="$K";break;case 12:a="$L";break;case 13:a="$M";break;case 14:a="$N";break;case 15:a="$O";break;case 16:a="$P";break;case 17:a="$Q";break;case 18:a="$R";break;case 19:a="$S";break;case 20:a="$T";break;case 21:a="$U";break;case 22:a="$V";break;case 23:a="$W";break;case 24:a="$X";break;case 25:a="$Y";break;case 26:a="$Z";break;case 27:a="%A";break;case 28:a="%B";break;case 29:a="%C";break;case 30:a="%D";break;case 31:a="%E";break;case 32:a=" ";break;case 33:a="/A";break;case 34:a="/B";break;case 35:a="/C";break;case 36:a="/D";break;case 37:a="/E";break;case 38:a="/F";break;case 39:a="/G";break;case 40:a="/H";break;case 41:a="/I";break;case 42:a="/J";break;case 43:a="/K";break;case 44:a="/L";break;case 45:a="-";break;case 46:a=".";break;case 47:a="/O";break;case 48:a="0";break;case 49:a="1";break;case 50:a="2";break;case 51:a="3";break;case 52:a="4";break;case 53:a="5";break;case 54:a="6";break;case 55:a="7";break;case 56:a="8";break;case 57:a="9";break;case 58:a="/Z";break;case 59:a="%F";break;case 60:a="%G";break;case 61:a="%H";break;case 62:a="%I";break;case 63:a="%J";break;case 64:a="%V";break;case 65:a="A";break;case 66:a="B";break;case 67:a="C";break;case 68:a="D";break;case 69:a="E";break;case 70:a="F";break;case 71:a="G";break;case 72:a="H";break;case 73:a="I";break;case 74:a="J";break;case 75:a="K";break;case 76:a="L";break;case 77:a="M";break;case 78:a="N";break;case 79:a="O";break;case 80:a="P";break;case 81:a="Q";break;case 82:a="R";break;case 83:a="S";break;case 84:a="T";break;case 85:a="U";break;case 86:a="V";break;case 87:a="W";break;case 88:a="X";break;case 89:a="Y";break;case 90:a="Z";break;case 91:a="%K";break;case 92:a="%L";break;case 93:a="%M";break;case 94:a="%N";break;case 95:a="%O";break;case 96:a="%W";break;case 97:a="+A";break;case 98:a="+B";break;case 99:a="+C";break;case 100:a="+D";break;case 101:a="+E";break;case 102:a="+F";break;case 103:a="+G";break;case 104:a="+H";break;case 105:a="+I";break;case 106:a="+J";break;case 107:a="+K";break;case 108:a="+L";break;case 109:a="+M";break;case 110:a="+N";break;case 111:a="+O";break;case 112:a="+P";break;case 113:a="+Q";break;case 114:a="+R";break;case 115:a="+S";break;case 116:a="+T";break;case 117:a="+U";break;case 118:a="+V";break;case 119:a="+W";break;case 120:a="+X";break;case 121:a="+Y";break;case 122:a="+Z";break;case 123:a="%P";break;case 124:a="%Q";break;case 125:a="%R";break;case 126:a="%S";break;case 127:a="%T";break;}return a;};function mCR_SymbologyCodaBar(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);}mCR_SymbologyCodaBar.prototype=Object.create(mCR_Symbology.prototype);mCR_SymbologyCodaBar.prototype.constructor=mCR_SymbologyCodaBar;mCR_SymbologyCodaBar.prototype.drawBarcode=function(){var g=this.createPattern(this.barcode.text);if(this.errorCode==0){if(this.barcode.showText){var j=this.barcode.fontSize;var h=this.barcode.fontName;var c=this.barcode.fontBold;var a=this.barcode.fontSize*1.32814;var b=document.createElement("canvas");var i=b.getContext("2d");var d="";if(c){d="bold "+a+"px "+h;}else{d=a+"px "+h;}i.font=d;var f=parseFloat(i.measureText(this.barcode.text).width.toFixed(2));i=null;b=null;switch(this.barcode.barcodeAngle){case 0:this.drawFontAngle0(f,a,d);break;case 1:this.drawFontAngle90(f,a,d);break;case 2:this.drawFontAngle180(f,a,d);break;case 3:this.drawFontAngle270(f,a,d);break;}}this.drawPattern(g);}else{this.drawErrorMsg();}};mCR_SymbologyCodaBar.prototype.drawPattern=function(b){var a=this.getDimension(b);this.drawNWPattern(b,a);};mCR_SymbologyCodaBar.prototype.drawNWPattern=function(b,a){switch(this.barcode.barcodeAngle){case 0:this.drawNWPatternAngle0(b,a);break;case 1:this.drawNWPatternAngle90(b,a);break;case 2:this.drawNWPatternAngle180(b,a);break;case 3:this.drawNWPatternAngle270(b,a);break;}};mCR_SymbologyCodaBar.prototype.drawFontAngle0=function(f,c,d){this.rect.bottom-=c*2.64;var b=this.rect.left+parseInt(""+((this.rect.getWidth()/2)-(f*2.64/2)));var a=this.rect.top+this.rect.getHeight()+(c*2.64-parseInt(""+(c*2.64/5)));this.drawBarCodeFontAngle0(b,a,d,this.barcode.text);};mCR_SymbologyCodaBar.prototype.drawFontAngle90=function(f,c,d){var b=this.rect.left+(this.rect.getWidth()-parseInt(""+(c*2.64/5)));var a=this.rect.top+parseInt(((this.rect.getHeight()/2)-(f*2.64/2)))+f*2.64;this.rect.right-=c*2.64;this.drawBarCodeFontAngle90(b,a,d,this.barcode.text);};mCR_SymbologyCodaBar.prototype.drawFontAngle180=function(f,c,d){this.rect.top+=c*2.64;var b=this.rect.left+parseInt(""+((this.rect.getWidth()/2)-(f*2.64/2)))+f*2.64;var a=this.rect.top-((c*2.64)-parseInt(""+(c*2.64/5)));this.drawBarCodeFontAngle180(b,a,d,this.barcode.text);};mCR_SymbologyCodaBar.prototype.drawFontAngle270=function(f,c,d){this.rect.left+=c*2.64;var b=this.rect.left-(c*2.64-parseInt(""+(c*2.64/5)));var a=this.rect.top+parseInt(""+((this.rect.getHeight()/2)-(f*2.64/2)));this.drawBarCodeFontAngle270(b,a,d,this.barcode.text);};mCR_SymbologyCodaBar.prototype.drawNWPatternAngle0=function(g,f){var a=this.rect.left;var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle0(a,c);}a=a+c;}};mCR_SymbologyCodaBar.prototype.drawNWPatternAngle90=function(g,f){var a=(this.rect.top+this.rect.getHeight());var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle90(a,c);}a=a-c;}};mCR_SymbologyCodaBar.prototype.drawNWPatternAngle180=function(g,f){var a=(this.rect.left+this.rect.getWidth());var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle180(a,c);}a=a-c;}};mCR_SymbologyCodaBar.prototype.drawNWPatternAngle270=function(g,f){var a=(this.rect.top);var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle270(a,c);}a=a+c;}};mCR_SymbologyCodaBar.prototype.getBarWidth=function(b,d){var a;var c=this.barcode.wideRatio;if(b=="n"){a=d;}else{a=d*c;}return a;};mCR_SymbologyCodaBar.prototype.getDimension=function(c){var d=this.getBarModuleSize(c);var a=this.getBarcodeWidth();var b=0;if(this.barcode.optResolution){b=Math.floor((a/d));if(b<1){b=1;}}else{b=(a/d);}return b;};mCR_SymbologyCodaBar.prototype.getBarModuleSize=function(d){var g=d.length;var a=0;for(var b=0;b<g;b++){if(d.charAt(b)=="w"){a++;}}var c=this.barcode.wideRatio;var f=g+(a*(c-1))-1;return f;};mCR_SymbologyCodaBar.prototype.createPattern=function(d){var c="";var b=d.length;if(b==0){this.errorCode=1;this.errorMsg="value size error";}else{c+=this.retrievePattern("A");for(var a=0;a<b;a++){var f=this.retrievePattern(d.charAt(a));if(f!=""){c+=f;}else{c="";this.errorCode=2;this.errorMsg="Unvalid data";break;}}c+=this.retrievePattern("A");}return c;};mCR_SymbologyCodaBar.prototype.retrievePattern=function(a){var b="";switch(a){case"0":b="nnnnnwwn";break;case"1":b="nnnnwwnn";break;case"2":b="nnnwnnwn";break;case"3":b="wwnnnnnn";break;case"4":b="nnwnnwnn";break;case"5":b="wnnnnwnn";break;case"6":b="nwnnnnwn";break;case"7":b="nwnnwnnn";break;case"8":b="nwwnnnnn";break;case"9":b="wnnwnnnn";break;case"-":b="nnnwwnnn";break;case"$":b="nnwwnnnn";break;case":":b="wnnnwnwn";break;case"/":b="wnwnnnwn";break;case".":b="wnwmwnnn";break;case"+":b="nnwnwnwn";break;case"A":b="nnwwnwnn";break;case"B":b="nwnwnnwn";break;case"C":b="nnnwnwwn";break;case"D":b="nnnwwwnn";break;}return b;};function mCR_SymbologyCode11(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);this._START=11;this._STOP=12;}mCR_SymbologyCode11.prototype=Object.create(mCR_Symbology.prototype);mCR_SymbologyCode11.prototype.constructor=mCR_SymbologyCode11;mCR_SymbologyCode11.prototype.drawBarcode=function(){var a=this.createPattern(this.barcode.text);if(this.errorCode==0){this.drawPattern(a);}else{this.drawErrorMsg();}};mCR_SymbologyCode11.prototype.drawPattern=function(b){var a=this.getDimension(b);this.drawBSPattern(b,a);};mCR_SymbologyCode11.prototype.drawBSPattern=function(b,a){switch(this.barcode.barcodeAngle){case 0:this.drawBSPatternAngle0(b,a);break;case 1:this.drawBSPatternAngle90(b,a);break;case 2:this.drawBSPatternAngle180(b,a);break;case 3:this.drawBSPatternAngle270(b,a);break;}};mCR_SymbologyCode11.prototype.drawBSPatternAngle0=function(g,f){var a=this.rect.left;var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle0(a,c);a=a+c;}c=0;a=a+f;}}if(c!=0){this.drawBarAngle0(a,c);}};mCR_SymbologyCode11.prototype.drawBSPatternAngle90=function(g,f){var a=(this.rect.top+this.rect.getHeight());var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle90(a,c);a=a-c;}c=0;a=a-f;}}if(c!=0){this.drawBarAngle90(a,c);}};mCR_SymbologyCode11.prototype.drawBSPatternAngle180=function(g,f){var a=(this.rect.left+this.rect.getWidth());var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle180(a,c);a=a-c;}c=0;a=a-f;}}if(c!=0){this.drawBarAngle180(a,c);}};mCR_SymbologyCode11.prototype.drawBSPatternAngle270=function(g,f){var a=(this.rect.top);var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle270(a,c);a=a+c;}c=0;a=a+f;}}if(c!=0){this.drawBarAngle270(a,c);}};mCR_SymbologyCode11.prototype.getDimension=function(d){var a=d.length;var b=this.getBarcodeWidth();var c=0;if(this.barcode.optResolution){c=Math.floor((b/a));if(c<1){c=1;}}else{c=(b/a);}return c;};mCR_SymbologyCode11.prototype.createPattern=function(k){var f="";var l=0;var g=0;f+=this.retrievePattern(this._START);var j=k.length;for(var i=0;i<j;i++){var h=k.charAt(i);var a=this.getCharacterCode(h);if(a!=-1){f+=this.retrievePattern(a);l+=(a*(j-i));g+=(a*(j-i+1));}else{this.errorCode=2;this.errorMsg="Unvalid data";break;}}var d=l%11;g+=d;var b=g%11;f+=this.retrievePattern(d);f+=this.retrievePattern(b);f+=this.retrievePattern(this._STOP);return f;};mCR_SymbologyCode11.prototype.getCharacterCode=function(b){var a=-1;switch(b){case"0":a=0;break;case"1":a=1;break;case"2":a=2;break;case"3":a=3;break;case"4":a=4;break;case"5":a=5;break;case"6":a=6;break;case"7":a=7;break;case"8":a=8;break;case"9":a=9;break;case"-":a=10;break;}return a;};mCR_SymbologyCode11.prototype.retrievePattern=function(a){var b="";switch(a){case 0:b="bsbsbbs";break;case 1:b="bbsbsbbs";break;case 2:b="bssbsbbs";break;case 3:b="bbssbsbs";break;case 4:b="bsbbsbbs";break;case 5:b="bbsbbsbs";break;case 6:b="bssbbsbs";break;case 7:b="bsbssbbs";break;case 8:b="bbsbssbs";break;case 9:b="bbsbsbs";break;case 10:b="bsbbsbs";break;case this._START:b="bsbbssbs";break;case this._STOP:b="bsbbssb";break;}return b;};function mCR_SymbologyCode128(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);this.codeset=null;this.CODESET_A=0;this.CODESET_B=1;this.CODESET_C=2;this.SHIFT=98;this.CODE_C=99;this.CODE_B=100;this.CODE_A=101;this.START_A=103;this.START_B=104;this.START_C=105;this.STOP=106;}mCR_SymbologyCode128.prototype=Object.create(mCR_Symbology.prototype);mCR_SymbologyCode128.prototype.constructor=mCR_SymbologyCode128;mCR_SymbologyCode128.prototype.drawBarcode=function(){var a=this.createPattern(this.barcode.text);if(this.errorCode==0){this.drawPattern(a);}else{this.drawErrorMsg();}};mCR_SymbologyCode128.prototype.drawPattern=function(b){var a=this.getDimension(b);this.drawBSPattern(b,a);};mCR_SymbologyCode128.prototype.drawBSPattern=function(b,a){switch(this.barcode.barcodeAngle){case 0:this.drawBSPatternAngle0(b,a);break;case 1:this.drawBSPatternAngle90(b,a);break;case 2:this.drawBSPatternAngle180(b,a);break;case 3:this.drawBSPatternAngle270(b,a);break;}};mCR_SymbologyCode128.prototype.drawBSPatternAngle0=function(g,f){var a=this.rect.left;var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle0(a,c);a=a+c;}c=0;a=a+f;}}if(c!=0){this.drawBarAngle0(a,c);}};mCR_SymbologyCode39.prototype.drawBSPatternAngle90=function(g,f){var a=(this.rect.top+this.rect.getHeight());var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle90(a,c);a=a-c;}c=0;a=a-f;}}if(c!=0){this.drawBarAngle90(a,c);}};mCR_SymbologyCode128.prototype.drawBSPatternAngle180=function(g,f){var a=(this.rect.left+this.rect.getWidth());var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle180(a,c);a=a-c;}c=0;a=a-f;}}if(c!=0){this.drawBarAngle180(a,c);}};mCR_SymbologyCode39.prototype.drawBSPatternAngle270=function(g,f){var a=(this.rect.top);var d=g.length;var c=0;for(var b=0;b<d;b++){if(g.charAt(b)=="b"){c+=f;}else{if(c!=0){this.drawBarAngle270(a,c);a=a+c;}c=0;a=a+f;}}if(c!=0){this.drawBarAngle270(a,c);}};mCR_SymbologyCode128.prototype.getDimension=function(d){var a=d.length;var b=this.getBarcodeWidth();var c=0;if(this.barcode.optResolution){c=Math.floor((b/a));if(c<1){c=1;}}else{c=(b/a);}return c;};mCR_SymbologyCode128.prototype.createPattern=function(q){var o="";var k=q.length;if(k==0){this.errorCode=1;this.errorMsg="value size error";}else{this.intiCodeset(q);var p=0;var n=1;o+=this.getStartPattern();p+=this.getStartCode();for(var l=0;l<k;l++){if(this.codeset==this.CODESET_C){if(l<k-1){var d=q.charAt(l);var c=q.charAt(l+1);if(this.isNum(d)&&this.isNum(c)){var m=d-"0";var j=c-"0";var b=(m*10)+j;l++;o+=this.retrievePattern(b);p+=(b*n);n++;}else{var b=this.getCharacterCodeB(d);if(b!=-1){this.codeset=this.CODESET_B;o+=this.retrievePattern(this.CODE_B);p+=(this.CODE_B*n);n++;o+=this.retrievePattern(b);p+=(b*n);n++;}else{b=this.getCharacterCodeA(d);if(b!=-1){this.codeset=this.CODESET_A;o+=this.retrievePattern(this.CODE_A);p+=(this.CODE_A*n);n++;o+=this.retrievePattern(b);p+=(b*n);n++;}else{this.errorCode=2;this.errorMsg="Unvalid data";}}}}else{var d=q.charAt(l);this.codeset=this.CODESET_B;o+=this.retrievePattern(this.CODE_B);p+=(this.CODE_B*n);n++;var b=this.getCharacterCodeB(d);o+=this.retrievePattern(b);p+=(b*n);n++;}}else{if(this.codeset==this.CODESET_A){var f=0;for(var g=l;g<k;g++){var a=q.charAt(g);if(this.isNum(a)==true){f++;}else{break;}}if(f>5&&f%2==0){this.codeset=this.CODESET_C;o+=this.retrievePattern(this.CODE_C);p+=(this.CODE_C*n);n++;var d=q.charAt(l);var c=q.charAt(l+1);var m=d-"0";var j=c-"0";var b=(m*10)+j;l++;o+=this.retrievePattern(b);p+=(b*n);n++;}else{var d=q.charAt(l);var b=this.getCharacterCodeA(d);if(b!=-1){o+=this.retrievePattern(b);p+=(b*n);n++;}else{b=this.getCharacterCodeB(d);if(b!=-1){this.codeset=this.CODESET_B;o+=this.retrievePattern(this.CODE_B);p+=(this.CODE_B*n);n++;o+=this.retrievePattern(b);p+=(b*n);n++;}else{this.errorCode=2;this.errorMsg="Unvalid data";}}}}else{if(this.codeset==this.CODESET_B){var f=0;for(var g=l;g<k;g++){var a=q.charAt(g);if(this.isNum(a)==true){f++;}else{break;}}if(f>5&&f%2==0){this.codeset=this.CODESET_C;o+=this.retrievePattern(this.CODE_C);p+=(this.CODE_C*n);n++;var d=q.charAt(l);var c=q.charAt(l+1);var m=d-"0";var j=c-"0";var b=(m*10)+j;l++;o+=this.retrievePattern(b);p+=(b*n);n++;}else{var d=q.charAt(l);var b=this.getCharacterCodeB(d);if(b!=-1){o+=this.retrievePattern(b);p+=(b*n);n++;}else{b=this.getCharacterCodeA(d);if(b!=-1){this.codeset=this.CODESET_A;o+=this.retrievePattern(this.CODE_A);p+=(this.CODE_A*n);n++;o+=this.retrievePattern(b);p+=(b*n);n++;}else{this.errorCode=2;this.errorMsg="Unvalid data";}}}}}}}var h=p%103;o+=this.retrievePattern(h);o+=this.getStopPattern();}return o;};mCR_SymbologyCode128.prototype.intiCodeset=function(g){this.codeset=this.CODESET_B;var f=g.length;if(f==2){var d=g.charAt(0);var c=g.charAt(1);if(this.isNum(d)&&this.isNum(c)){this.codeset=this.CODESET_C;}}else{if(f>=4){var d=g.charAt(0);var c=g.charAt(1);var b=g.charAt(2);var a=g.charAt(3);if(this.isNum(d)&&this.isNum(c)&&this.isNum(b)&&this.isNum(a)){this.codeset=this.CODESET_C;}}}if(this.codeset==this.CODESET_B){if(this.getCharacterCodeB(g.charAt(0))==-1){this.codeset=this.CODESET_A;}}};mCR_SymbologyCode128.prototype.getStartCode=function(){var a=this.START_B;switch(this.codeset){case this.CODESET_A:a=this.START_A;break;case this.CODESET_B:a=this.START_B;break;case this.CODESET_C:a=this.START_C;break;}return a;};mCR_SymbologyCode128.prototype.isNum=function(a){if(a>="0"&&a<="9"){return true;}else{return false;}};mCR_SymbologyCode128.prototype.getStartPattern=function(){return this.retrievePattern(this.getStartCode());};mCR_SymbologyCode128.prototype.getStopPattern=function(){return this.retrievePattern(this.STOP);};mCR_SymbologyCode128.prototype.getCharacterCodeA=function(a){var b=-1;switch(a){case" ":b=0;break;case"!":b=1;break;case'"':b=2;break;case"#":b=3;break;case"$":b=4;break;case"%":b=5;break;case"&":b=6;break;case"'":b=7;break;case"(":b=8;break;case")":b=9;break;case"*":b=10;break;case"+":b=11;break;case",":b=12;break;case"-":b=13;break;case".":b=14;break;case"/":b=15;break;case"0":b=16;break;case"1":b=17;break;case"2":b=18;break;case"3":b=19;break;case"4":b=20;break;case"5":b=21;break;case"6":b=22;break;case"7":b=23;break;case"8":b=24;break;case"9":b=25;break;case":":b=26;break;case";":b=27;break;case"<":b=28;break;case"=":b=29;break;case">":b=30;break;case"?":b=31;break;case"@":b=32;break;case"A":b=33;break;case"B":b=34;break;case"C":b=35;break;case"D":b=36;break;case"E":b=37;break;case"F":b=38;break;case"G":b=39;break;case"H":b=40;break;case"I":b=41;break;case"J":b=42;break;case"K":b=43;break;case"L":b=44;break;case"M":b=45;break;case"N":b=46;break;case"O":b=47;break;case"P":b=48;break;case"Q":b=49;break;case"R":b=50;break;case"S":b=51;break;case"T":b=52;break;case"U":b=53;break;case"V":b=54;break;case"W":b=55;break;case"X":b=56;break;case"Y":b=57;break;case"Z":b=58;break;case"[":b=59;break;case"\\":b=60;break;case"]":b=61;break;case"^":b=62;break;case"_":b=63;break;case 0:b=64;break;case 1:b=65;break;case 2:b=66;break;case 3:b=67;break;case 4:b=68;break;case 5:b=69;break;case 6:b=70;break;case 7:b=71;break;case 8:b=72;break;case 9:b=73;break;case 10:b=74;break;case 11:b=75;break;case 12:b=76;break;case 13:b=77;break;case 14:b=78;break;case 15:b=79;break;case 16:b=80;break;case 17:b=81;break;case 18:b=82;break;case 19:b=83;break;case 20:b=84;break;case 21:b=85;break;case 22:b=86;break;case 23:b=87;break;case 24:b=88;break;case 25:b=89;break;case 26:b=90;break;case 27:b=91;break;case 28:b=92;break;case 29:b=93;break;case 30:b=94;break;case 31:b=95;break;}return b;};mCR_SymbologyCode128.prototype.getCharacterCodeB=function(a){var b=-1;switch(a){case" ":b=0;break;case"!":b=1;break;case'"':b=2;break;case"#":b=3;break;case"$":b=4;break;case"%":b=5;break;case"&":b=6;break;case"'":b=7;break;case"(":b=8;break;case")":b=9;break;case"*":b=10;break;case"+":b=11;break;case",":b=12;break;case"-":b=13;break;case".":b=14;break;case"/":b=15;break;case"0":b=16;break;case"1":b=17;break;case"2":b=18;break;case"3":b=19;break;case"4":b=20;break;case"5":b=21;break;case"6":b=22;break;case"7":b=23;break;case"8":b=24;break;case"9":b=25;break;case":":b=26;break;case";":b=27;break;case"<":b=28;break;case"=":b=29;break;case">":b=30;break;case"?":b=31;break;case"@":b=32;break;case"A":b=33;break;case"B":b=34;break;case"C":b=35;break;case"D":b=36;break;case"E":b=37;break;case"F":b=38;break;case"G":b=39;break;case"H":b=40;break;case"I":b=41;break;case"J":b=42;break;case"K":b=43;break;case"L":b=44;break;case"M":b=45;break;case"N":b=46;break;case"O":b=47;break;case"P":b=48;break;case"Q":b=49;break;case"R":b=50;break;case"S":b=51;break;case"T":b=52;break;case"U":b=53;break;case"V":b=54;break;case"W":b=55;break;case"X":b=56;break;case"Y":b=57;break;case"Z":b=58;break;case"[":b=59;break;case"\\":b=60;break;case"]":b=61;break;case"^":b=62;break;case"_":b=63;break;case"`":b=64;break;case"a":b=65;break;case"b":b=66;break;case"c":b=67;break;case"d":b=68;break;case"e":b=69;break;case"f":b=70;break;case"g":b=71;break;case"h":b=72;break;case"i":b=73;break;case"j":b=74;break;case"k":b=75;break;case"l":b=76;break;case"m":b=77;break;case"n":b=78;break;case"o":b=79;break;case"p":b=80;break;case"q":b=81;break;case"r":b=82;break;case"s":b=83;break;case"t":b=84;break;case"u":b=85;break;case"v":b=86;break;case"w":b=87;break;case"x":b=88;break;case"y":b=89;break;case"z":b=90;break;case"{":b=91;break;case"|":b=92;break;case"}":b=93;break;case"~":b=94;break;case 127:b=95;break;}return b;};mCR_SymbologyCode128.prototype.retrievePattern=function(a){var b="";switch(a){case 0:b="bbsbbssbbss";break;case 1:b="bbssbbsbbss";break;case 2:b="bbssbbssbbs";break;case 3:b="bssbssbbsss";break;case 4:b="bssbsssbbss";break;case 5:b="bsssbssbbss";break;case 6:b="bssbbssbsss";break;case 7:b="bssbbsssbss";break;case 8:b="bsssbbssbss";break;case 9:b="bbssbssbsss";break;case 10:b="bbssbsssbss";break;case 11:b="bbsssbssbss";break;case 12:b="bsbbssbbbss";break;case 13:b="bssbbsbbbss";break;case 14:b="bssbbssbbbs";break;case 15:b="bsbbbssbbss";break;case 16:b="bssbbbsbbss";break;case 17:b="bssbbbssbbs";break;case 18:b="bbssbbbssbs";break;case 19:b="bbssbsbbbss";break;case 20:b="bbssbssbbbs";break;case 21:b="bbsbbbssbss";break;case 22:b="bbssbbbsbss";break;case 23:b="bbbsbbsbbbs";break;case 24:b="bbbsbssbbss";break;case 25:b="bbbssbsbbss";break;case 26:b="bbbssbssbbs";break;case 27:b="bbbsbbssbss";break;case 28:b="bbbssbbsbss";break;case 29:b="bbbssbbssbs";break;case 30:b="bbsbbsbbsss";break;case 31:b="bbsbbsssbbs";break;case 32:b="bbsssbbsbbs";break;case 33:b="bsbsssbbsss";break;case 34:b="bsssbsbbsss";break;case 35:b="bsssbsssbbs";break;case 36:b="bsbbsssbsss";break;case 37:b="bsssbbsbsss";break;case 38:b="bsssbbsssbs";break;case 39:b="bbsbsssbsss";break;case 40:b="bbsssbsbsss";break;case 41:b="bbsssbsssbs";break;case 42:b="bsbbsbbbsss";break;case 43:b="bsbbsssbbbs";break;case 44:b="bsssbbsbbbs";break;case 45:b="bsbbbsbbsss";break;case 46:b="bsbbbsssbbs";break;case 47:b="bsssbbbsbbs";break;case 48:b="bbbsbbbsbbs";break;case 49:b="bbsbsssbbbs";break;case 50:b="bbsssbsbbbs";break;case 51:b="bbsbbbsbsss";break;case 52:b="bbsbbbsssbs";break;case 53:b="bbsbbbsbbbs";break;case 54:b="bbbsbsbbsss";break;case 55:b="bbbsbsssbbs";break;case 56:b="bbbsssbsbbs";break;case 57:b="bbbsbbsbsss";break;case 58:b="bbbsbbsssbs";break;case 59:b="bbbsssbbsbs";break;case 60:b="bbbsbbbbsbs";break;case 61:b="bbssbssssbs";break;case 62:b="bbbbsssbsbs";break;case 63:b="bsbssbbssss";break;case 64:b="bsbssssbbss";break;case 65:b="bssbsbbssss";break;case 66:b="bssbssssbbs";break;case 67:b="bssssbsbbss";break;case 68:b="bssssbssbbs";break;case 69:b="bsbbssbssss";break;case 70:b="bsbbssssbss";break;case 71:b="bssbbsbssss";break;case 72:b="bssbbssssbs";break;case 73:b="bssssbbsbss";break;case 74:b="bssssbbssbs";break;case 75:b="bbssssbssbs";break;case 76:b="bbssbsbssss";break;case 77:b="bbbbsbbbsbs";break;case 78:b="bbssssbsbss";break;case 79:b="bsssbbbbsbs";break;case 80:b="bsbssbbbbss";break;case 81:b="bssbsbbbbss";break;case 82:b="bssbssbbbbs";break;case 83:b="bsbbbbssbss";break;case 84:b="bssbbbbsbss";break;case 85:b="bssbbbbssbs";break;case 86:b="bbbbsbssbss";break;case 87:b="bbbbssbsbss";break;case 88:b="bbbbssbssbs";break;case 89:b="bbsbbsbbbbs";break;case 90:b="bbsbbbbsbbs";break;case 91:b="bbbbsbbsbbs";break;case 92:b="bsbsbbbbsss";break;case 93:b="bsbsssbbbbs";break;case 94:b="bsssbsbbbbs";break;case 95:b="bsbbbbsbsss";break;case 96:b="bsbbbbsssbs";break;case 97:b="bbbbsbsbsss";break;case 98:b="bbbbsbsssbs";break;case 99:b="bsbbbsbbbbs";break;case 100:b="bsbbbbsbbbs";break;case 101:b="bbbsbsbbbbs";break;case 102:b="bbbbsbsbbbs";break;case 103:b="bbsbssssbss";break;case 104:b="bbsbssbssss";break;case 105:b="bbsbssbbbss";break;case 106:b="bbsssbbbsbsbb";break;}return b;};function mCR_SymbologyCode128A(a,d,b,c){mCR_SymbologyCode128.call(this,a,d,b,c);}mCR_SymbologyCode128A.prototype=Object.create(mCR_SymbologyCode128.prototype);mCR_SymbologyCode128A.prototype.constructor=mCR_SymbologyCode128A;mCR_SymbologyCode128A.prototype.intiCodeset=function(a){this.codeset=this.CODESET_A;};function mCR_SymbologyCode128B(a,d,b,c){mCR_SymbologyCode128.call(this,a,d,b,c);}mCR_SymbologyCode128B.prototype=Object.create(mCR_SymbologyCode128.prototype);mCR_SymbologyCode128B.prototype.constructor=mCR_SymbologyCode128B;mCR_SymbologyCode128B.prototype.intiCodeset=function(a){this.codeset=this.CODESET_B;};function mCR_SymbologyCode128C(a,d,b,c){mCR_SymbologyCode128.call(this,a,d,b,c);}mCR_SymbologyCode128C.prototype=Object.create(mCR_SymbologyCode128.prototype);mCR_SymbologyCode128C.prototype.constructor=mCR_SymbologyCode128C;mCR_SymbologyCode128C.prototype.intiCodeset=function(a){this.codeset=this.CODESET_C;};function mCR_Symbology2of5(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);}mCR_Symbology2of5.prototype=Object.create(mCR_Symbology.prototype);mCR_Symbology2of5.prototype.constructor=mCR_Symbology2of5;mCR_Symbology2of5.prototype.drawBarcode=function(){};mCR_Symbology2of5.prototype.createPattern=function(a){return"";};mCR_Symbology2of5.prototype.retrievePattern=function(a){var b="";switch(a){case"0":b="NNWWN";break;case"1":b="WNNNW";break;case"2":b="NWNNW";break;case"3":b="WWNNN";break;case"4":b="NNWNW";break;case"5":b="WNWNN";break;case"6":b="NWWNN";break;case"7":b="NNNWW";break;case"8":b="WNNWN";break;case"9":b="NWNWN";break;}return b;};function mCR_Symbology2of5Matrix(a,d,b,c){mCR_Symbology2of5.call(this,a,d,b,c);}mCR_Symbology2of5Matrix.prototype=Object.create(mCR_Symbology2of5.prototype);mCR_Symbology2of5Matrix.prototype.constructor=mCR_Symbology2of5Matrix;mCR_Symbology2of5Matrix.prototype.drawBarcode=function(){var a=this.createPattern(this.barcode.text);if(this.errorCode==0){this.drawPattern(a);}else{this.drawErrorMsg();}};mCR_Symbology2of5Matrix.prototype.drawPattern=function(b){var a=this.getDimension(b);this.drawNWPattern(b,a);};mCR_Symbology2of5Matrix.prototype.drawNWPattern=function(b,a){switch(this.barcode.barcodeAngle){case 0:this.drawNWPatternAngle0(b,a);break;case 1:this.drawNWPatternAngle90(b,a);break;case 2:this.drawNWPatternAngle180(b,a);break;case 3:this.drawNWPatternAngle270(b,a);break;}};mCR_Symbology2of5Matrix.prototype.drawNWPatternAngle0=function(g,f){var a=this.rect.left;var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle0(a,c);}a=a+c;}};mCR_Symbology2of5Matrix.prototype.drawNWPatternAngle90=function(g,f){var a=(this.rect.top+this.rect.getHeight());var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle90(a,c);}a=a-c;}};mCR_Symbology2of5Matrix.prototype.drawNWPatternAngle180=function(g,f){var a=(this.rect.left+this.rect.getWidth());var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle180(a,c);}a=a-c;}};mCR_Symbology2of5Matrix.prototype.drawNWPatternAngle270=function(g,f){var a=(this.rect.top);var d=g.length;for(var b=0;b<d;b++){var c=this.getBarWidth(g.charAt(b),f);if(b%2==0){this.drawBarAngle270(a,c);}a=a+c;}};mCR_Symbology2of5Matrix.prototype.getBarWidth=function(b,d){var a;var c=this.barcode.wideRatio;if(b=="n"||b=="N"){a=d;}else{a=d*c;}return a;};mCR_Symbology2of5Matrix.prototype.getDimension=function(c){var d=this.getBarModuleSize(c);var a=this.getBarcodeWidth();var b=0;if(this.barcode.optResolution){b=Math.floor((a/d));if(b<1){b=1;}}else{b=(a/d);}return b;};mCR_Symbology2of5Matrix.prototype.getBarModuleSize=function(d){var g=d.length;var a=0;for(var b=0;b<g;b++){if(d.charAt(b)=="W"){a++;}}var c=this.barcode.wideRatio;var f=g+(a*(c-1));return f;};mCR_Symbology2of5Matrix.prototype.createPattern=function(f){var d="";d+=this.startCode();var a=f.length;for(var g=0;g<a;g++){var b=f.charAt(g);var c=this.retrievePattern(b);d+=c;d+="n";}d+=this.endCode();return d;};mCR_Symbology2of5Matrix.prototype.startCode=function(){return"WNNNNn";};mCR_Symbology2of5Matrix.prototype.endCode=function(){return"WNNNN";};function mCR_Symbology2of5Industrial(a,d,b,c){mCR_Symbology2of5Matrix.call(this,a,d,b,c);}mCR_Symbology2of5Industrial.prototype=Object.create(mCR_Symbology2of5Matrix.prototype);mCR_Symbology2of5Industrial.prototype.constructor=mCR_Symbology2of5Industrial;mCR_Symbology2of5Industrial.prototype.createPattern=function(j){var g="";g+=this.startCode();var i=j.length;for(var h=0;h<i;h++){var c=j.charAt(h);var d=this.retrievePattern(c);g+=d;}g+=this.endCode();var f="";var b=g.length;for(var a=0;a<b;a++){f+=g.charAt(a);if(a<b-1){f+="n";}}return f;};mCR_Symbology2of5Industrial.prototype.startCode=function(){return"WWN";};mCR_Symbology2of5Industrial.prototype.endCode=function(){return"WNW";};function mCR_Symbology2of5IATA(a,d,b,c){mCR_Symbology2of5Industrial.call(this,a,d,b,c);}mCR_Symbology2of5IATA.prototype=Object.create(mCR_Symbology2of5Industrial.prototype);mCR_Symbology2of5IATA.prototype.constructor=mCR_Symbology2of5IATA;mCR_Symbology2of5IATA.prototype.startCode=function(){return"NN";};mCR_Symbology2of5IATA.prototype.endCode=function(){return"WN";};function mCR_Symbology2of5Interleaved(a,d,b,c){mCR_Symbology2of5Matrix.call(this,a,d,b,c);}mCR_Symbology2of5Interleaved.prototype=Object.create(mCR_Symbology2of5Matrix.prototype);mCR_Symbology2of5Interleaved.prototype.constructor=mCR_Symbology2of5Interleaved;mCR_Symbology2of5Interleaved.prototype.createPattern=function(h){var d="";d+=this.startCode();var g=h.length;if(g%2==1){h="0"+h;g++;}for(var f=0;f<g;f+=2){var c=h.charAt(f);var b=h.charAt(f+1);var j=this.retrievePattern(c);var i=this.retrievePattern(b);for(var a=0;a<5;a++){d+=j.charAt(a);d+=i.charAt(a);}}d+=this.endCode();return d;};mCR_Symbology2of5Interleaved.prototype.startCode=function(){return"NNNN";};mCR_Symbology2of5Interleaved.prototype.endCode=function(){return"WNN";};function mCR_SymbologyEAN13(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);this.parity_LeftOdd=0;this.parity_LeftEven=1;this.parity_Right=2;this.rectHalf=new docRect();this.rectFont=new docRect();this.checkMethod=false;this.fontHeight=null;this.fontSize=null;this.fontFamily=null;this.FontStyle=null;}mCR_SymbologyEAN13.prototype=Object.create(mCR_Symbology.prototype);mCR_SymbologyEAN13.prototype.constructor=mCR_SymbologyEAN13;mCR_SymbologyEAN13.prototype.drawBarcode=function(){var n=this.barcode.text;if(!this.checkValue(n)){this.errorCode=2;this.errorMsg="Unvalid data";}if(n.length==12){this.checkMethod=true;}else{if(n.length==13){this.checkMethod=false;}else{this.errorCode=1;this.errorMsg="value size error";}}if(this.errorCode==0){var l=0;var d=41;if(this.barcode.showText){this.fontSize=this.barcode.fontSize;this.fontFamily=this.barcode.fontName;this.FontStyle=this.barcode.fontBold;d=this.barcode.fontSize*1.32814;this.fontHeight=d;}this.rectHalf.copyRect(this.rect);this.rectFont.copyRect(this.rect);switch(this.barcode.barcodeAngle){case 2:this.rect.top=this.rect.top+d*2.64;this.rectHalf.top=this.rectHalf.top+(d*2.64/2);break;case 0:this.rect.bottom=this.rect.bottom-d*2.64;this.rectHalf.bottom=this.rectHalf.bottom-(d*2.64/2);break;case 3:this.rect.left=this.rect.left+d*2.64;this.rectHalf.left=this.rectHalf.left+(d*2.64/2);break;case 1:this.rect.right=this.rect.right-d*2.64;this.rectHalf.right=this.rectHalf.right-(d*2.64/2);break;}var c=new Array();var o=n.charAt(0);var a="";a+=o;var g=this.getCharacterCode(o);var f=this.getParityType(g);l=g;c.push(new BarcodeEAN_Pattern("sssssss",a));c.push(new BarcodeEAN_Pattern("bsb",""));for(var m=1;m<=6;m++){var j=n.charAt(m);var b=this.getCharacterCode(j);var k=this.retrievePattern(b,f[m-1]);var p="";p+=j;c.push(new BarcodeEAN_Pattern(k,p));var h=((m%2)==1)?3:1;l+=b*h;}c.push(new BarcodeEAN_Pattern("s"," "));c.push(new BarcodeEAN_Pattern("bsbs",""));for(var m=7;m<=11;m++){var j=n.charAt(m);var b=this.getCharacterCode(j);var k=this.retrievePattern(b,this.parity_Right);var p="";p+=j;c.push(new BarcodeEAN_Pattern(k,p));var h=((m%2)==1)?3:1;l+=b*h;}if(this.checkMethod){var i=10-(l%10);if(i==10){i=0;}c.push(new BarcodeEAN_Pattern(this.retrievePattern(i,this.parity_Right),i.toString()));}else{var j=n.charAt(12);var b=this.getCharacterCode(j);var k=this.retrievePattern(b,this.parity_Right);var p="";p+=j;c.push(new BarcodeEAN_Pattern(k,p));}c.push(new BarcodeEAN_Pattern("bsb",""));this.drawPattern(c);}else{this.drawErrorMsg();}};mCR_SymbologyEAN13.prototype.getParityType=function(b){var a=new Array();switch(b){case 0:a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);break;case 1:a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);break;case 2:a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);break;case 3:a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);break;case 4:a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);break;case 5:a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);break;case 6:a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftOdd);break;case 7:a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);break;case 8:a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);break;case 9:a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);a.push(this.parity_LeftEven);a.push(this.parity_LeftOdd);break;}return a;};mCR_SymbologyEAN13.prototype.drawPattern=function(b){var a=this.getDimension();this.drawBSPattern(b,a);};mCR_SymbologyEAN13.prototype.drawBSPattern=function(b,a){switch(this.barcode.barcodeAngle){case 0:this.drawBSPatternAngle0(b,a);break;case 1:this.drawBSPatternAngle90(b,a);break;case 2:this.drawBSPatternAngle180(b,a);break;case 3:this.drawBSPatternAngle270(b,a);break;}};mCR_SymbologyEAN13.prototype.drawBSPatternAngle0=function(a,k){var h=this.rect.left;var b=0;var i="";var f=a.length;for(var c=0;c<f;c++){var n=a[c];var g=n.getPattern();var m=n.getText();var l=0;if(this.barcode.showText){l=n.getHalfStatus()?this.rectHalf.getHeight():this.rect.getHeight();}else{l=this.rect.getHeight();}if(m!=""&&m!=" "){i+=m;}var j=g.length;for(var d=0;d<j;d++){if(g.charAt(d)=="b"){b+=k;}else{if(b!=0){this.drawBarAngle0(h,b,l);h=h+b;}b=0;h=h+k;}}if(b!=0){this.drawBarAngle0(h,b,l);}}if(this.barcode.showText){this.drawFontAngle0(i);}};mCR_SymbologyEAN13.prototype.drawBSPatternAngle90=function(a,k){var h=this.rect.bottom;var b=0;var i="";var f=a.length;for(var c=0;c<f;c++){var n=a[c];var g=n.getPattern();var m=n.getText();var l=n.getHalfStatus()?this.rectHalf.getWidth():this.rect.getWidth();if(m!=""&&m!=" "){i+=m;}var j=g.length;for(var d=0;d<j;d++){if(g.charAt(d)=="b"){b+=k;}else{if(b!=0){this.drawBarAngle90(h,b,l);h=h-b;}b=0;h=h-k;}}if(b!=0){this.drawBarAngle90(h,b,l);}}if(this.barcode.showText){this.drawFontAngle90(i);}};mCR_SymbologyEAN13.prototype.drawBSPatternAngle180=function(a,k){var h=this.rect.right;var b=0;var i="";var f=a.length;for(var c=0;c<f;c++){var n=a[c];var g=n.getPattern();var m=n.getText();var l=n.getHalfStatus()?this.rectHalf.getHeight():this.rect.getHeight();var o=n.getHalfStatus()?this.rectHalf.top:this.rect.top;if(m!=""&&m!=" "){i+=m;}var j=g.length;for(var d=0;d<j;d++){if(g.charAt(d)=="b"){b+=k;}else{if(b!=0){this.drawBarAngle180(h,b,l,o);h=h-b;}b=0;h=h-k;}}if(b!=0){this.drawBarAngle180(h,b,l,o);}}if(this.barcode.showText){this.drawFontAngle180(i);}};mCR_SymbologyEAN13.prototype.drawBSPatternAngle270=function(b,l){var i=this.rect.top;var c=0;var j="";var g=b.length;for(var d=0;d<g;d++){var o=b[d];var h=o.getPattern();var n=o.getText();var m=o.getHalfStatus()?this.rectHalf.getWidth():this.rect.getWidth();var a=o.getHalfStatus()?this.rectHalf.left:this.rect.left;if(n!=""&&n!=" "){j+=n;}var k=h.length;for(var f=0;f<k;f++){if(h.charAt(f)=="b"){c+=l;}else{if(c!=0){this.drawBarAngle270(i,c,m,a);i=i+c;}c=0;i=i+l;}}if(c!=0){this.drawBarAngle270(i,c,m,a);}}if(this.barcode.showText){this.drawFontAngle270(j);}};mCR_SymbologyEAN13.prototype.drawFontAngle0=function(g){var a=document.createElement("canvas");var l=a.getContext("2d");var b="";if(this.FontStyle){b="bold "+this.fontHeight+"px "+this.fontFamily;}else{b=this.fontHeight+"px "+this.fontFamily;}l.font=b;var d=l.measureText("0").width*2.64;l=null;a=null;var j=this.getDimension(this.rectFont);var f=((j*3.5)-(d/2));var k=this.rectFont.left;var h=this.rectFont.bottom;for(var c=0;c<g.length;c++){this.drawBarCodeFontAngle0(k+f,h,b,g.substring(c,c+1));k+=(j*7);switch(c){case 0:k+=(j*3);break;case 6:k+=(j*5);break;}}};mCR_SymbologyEAN13.prototype.drawFontAngle90=function(g){var a=document.createElement("canvas");var l=a.getContext("2d");var b="";if(this.FontStyle){b="bold "+this.fontHeight+"px "+this.fontFamily;}else{b=this.fontHeight+"px "+this.fontFamily;}l.font=b;var d=l.measureText("0").width*2.64;l=null;a=null;var j=this.getDimension(this.rectFont);var f=((j*3.5)-(d/2));var k=this.rectFont.right;var h=this.rectFont.bottom;for(var c=0;c<g.length;c++){this.drawBarCodeFontAngle90(k,h-f,b,g.substring(c,c+1));h-=(j*7);switch(c){case 0:h-=(j*3);break;case 6:h-=(j*5);break;}}};mCR_SymbologyEAN13.prototype.drawFontAngle180=function(g){var a=document.createElement("canvas");var l=a.getContext("2d");var b="";if(this.FontStyle){b="bold "+this.fontHeight+"px "+this.fontFamily;}else{b=this.fontHeight+"px "+this.fontFamily;}l.font=b;var d=l.measureText("0").width*2.64;l=null;a=null;var j=this.getDimension(this.rectFont);var f=((j*3.5)-(d/2));var k=this.rectFont.right;var h=this.rectFont.top;for(var c=0;c<g.length;c++){this.drawBarCodeFontAngle180(k-f,h,b,g.substring(c,c+1));k-=(j*7);switch(c){case 0:k-=(j*3);break;case 6:k-=(j*5);break;}}};mCR_SymbologyEAN13.prototype.drawFontAngle270=function(g){var a=document.createElement("canvas");var l=a.getContext("2d");var b="";if(this.FontStyle){b="bold "+this.fontHeight+"px "+this.fontFamily;}else{b=this.fontHeight+"px "+this.fontFamily;}l.font=b;var d=l.measureText("0").width*2.64;l=null;a=null;var j=this.getDimension(this.rectFont);var f=((j*3.5)-(d/2));var k=this.rectFont.left;var h=this.rectFont.top;for(var c=0;c<g.length;c++){this.drawBarCodeFontAngle270(k,h+f,b,g.substring(c,c+1));h+=(j*7);switch(c){case 0:h+=(j*3);break;case 6:h+=(j*5);break;}}};mCR_SymbologyEAN13.prototype.getDimension=function(){var a=this.getBarcodeWidth();var b=0;if(this.barcode.optResolution){b=Math.floor((a/((13*7)+11+6)));if(b<1){b=1;}}else{b=(a/((13*7)+11+6));}return b;};mCR_SymbologyEAN13.prototype.createPattern=function(h){var g="";var f=h.length;if(f>2){if(h.charAt(0)=="*"&&h.charAt(f-1)=="*"){h=h.substring(1,f-2);f=h.length;}}if(f==0){this.errorCode=1;this.errorMsg="value size error";}else{var a=0;g=this.getStartPattern();for(var b=0;b<f;b++){var c=h.charAt(b);var d=this.getCharacterCode(c);if(d!=-1){g+=this.retrievePattern(d);a+=d;}else{this.errorCode=2;this.errorMsg="Unvalid data";g="";break;}}if(this.errorCode==0){g=g+this.getStopPattern();}}return g;};mCR_SymbologyEAN13.prototype.checkValue=function(f){var a=true;var c=f.length;for(var b=0;b<c;b++){var d=f.charAt(b);if(d<"0"||d>"9"){a=false;break;}}return a;};mCR_SymbologyEAN13.prototype.getCharacterCode=function(b){var a=-1;if(b>="0"&&b<="9"){a=b-"0";}return a;};mCR_SymbologyEAN13.prototype.retrievePattern=function(a,b){var c="";switch(b){case this.parity_LeftOdd:switch(a){case 0:c="sssbbsb";break;case 1:c="ssbbssb";break;case 2:c="ssbssbb";break;case 3:c="sbbbbsb";break;case 4:c="sbsssbb";break;case 5:c="sbbsssb";break;case 6:c="sbsbbbb";break;case 7:c="sbbbsbb";break;case 8:c="sbbsbbb";break;case 9:c="sssbsbb";break;}break;case this.parity_LeftEven:switch(a){case 0:c="sbssbbb";break;case 1:c="sbbssbb";break;case 2:c="ssbbsbb";break;case 3:c="sbssssb";break;case 4:c="ssbbbsb";break;case 5:c="sbbbssb";break;case 6:c="ssssbsb";break;case 7:c="ssbsssb";break;case 8:c="sssbssb";break;case 9:c="ssbsbbb";break;}break;case this.parity_Right:switch(a){case 0:c="bbbssbs";break;case 1:c="bbssbbs";break;case 2:c="bbsbbss";break;case 3:c="bssssbs";break;case 4:c="bsbbbss";break;case 5:c="bssbbbs";break;case 6:c="bsbssss";break;case 7:c="bsssbss";break;case 8:c="bssbsss";break;case 9:c="bbbsbss";break;}break;}return c;};function mCR_SymbologyEAN8(a,d,b,c){mCR_SymbologyEAN13.call(this,a,d,b,c);}mCR_SymbologyEAN8.prototype=Object.create(mCR_SymbologyEAN13.prototype);mCR_SymbologyEAN8.prototype.constructor=mCR_SymbologyEAN8;mCR_SymbologyEAN8.prototype.drawBarcode=function(){var m=this.barcode.text;if(!this.checkValue(m)){this.errorCode=2;this.errorMsg="Unvalid data";}if(m.length==7){this.checkMethod=true;}else{if(m.length==8){this.checkMethod=false;}else{this.errorCode=1;this.errorMsg="value size error";}}if(this.errorCode==0){var j=0;var d=41;if(this.barcode.showText){this.fontSize=this.barcode.fontSize;this.fontFamily=this.barcode.fontName;this.FontStyle=this.barcode.fontBold;d=this.barcode.fontSize*1.32814;this.fontHeight=d;}this.rectHalf.copyRect(this.rect);this.rectFont.copyRect(this.rect);switch(this.barcode.barcodeAngle){case 2:this.rect.top=this.rect.top+d*2.64;this.rectHalf.top=this.rectHalf.top+(d*2.64/2);break;case 0:this.rect.bottom=this.rect.bottom-d*2.64;this.rectHalf.bottom=this.rectHalf.bottom-(d*2.64/2);break;case 3:this.rect.left=this.rect.left+d*2.64;this.rectHalf.left=this.rectHalf.left+(d*2.64/2);break;case 1:this.rect.right=this.rect.right-d*2.64;this.rectHalf.right=this.rectHalf.right-(d*2.64/2);break;}var b=new Array();b.push(new BarcodeEAN_Pattern("bsb",""));for(var l=0;l<4;l++){var k=m.charAt(l);var a=this.getCharacterCode(k);var i=this.retrievePattern(a,this.parity_LeftOdd);var n="";n+=k;b.push(new BarcodeEAN_Pattern(i,n));var g=((l%2)==1)?1:3;j+=a*g;}b.push(new BarcodeEAN_Pattern("s"," "));b.push(new BarcodeEAN_Pattern("bsbs",""));for(var l=4;l<7;l++){var k=m.charAt(l);var a=this.getCharacterCode(k);var i=this.retrievePattern(a,this.parity_Right);var n="";n+=k;b.push(new BarcodeEAN_Pattern(i,n));var f=((l%2)==1)?1:3;j+=a*f;}if(this.checkMethod){var h=10-(j%10);if(h==10){h=0;}b.push(new BarcodeEAN_Pattern(this.retrievePattern(h,this.parity_Right),h.toString()));}else{var k=m.charAt(7);var a=this.getCharacterCode(k);var i=this.retrievePattern(a,this.parity_Right);var n="";n+=k;b.push(new BarcodeEAN_Pattern(i,n));}b.push(new BarcodeEAN_Pattern("bsb",""));this.drawPattern(b);}else{this.drawErrorMsg();}};mCR_SymbologyEAN8.prototype.drawFontAngle0=function(g){var a=document.createElement("canvas");var l=a.getContext("2d");var b="";if(this.FontStyle){b="bold "+this.fontHeight+"px "+this.fontFamily;}else{b=this.fontHeight+"px "+this.fontFamily;}l.font=b;var d=l.measureText("0").width*2.64;l=null;a=null;var j=this.getDimension(this.rectFont);var f=((j*3.5)-(d/2));var k=this.rectFont.left;var h=this.rectFont.bottom;k+=(j*3);for(var c=0;c<g.length;c++){this.drawBarCodeFontAngle0(k+f,h,b,g.substring(c,c+1));k+=(j*7);switch(c){case 3:k+=(j*5);break;}}};mCR_SymbologyEAN8.prototype.drawFontAngle90=function(g){var a=document.createElement("canvas");var l=a.getContext("2d");var b="";if(this.FontStyle){b="bold "+this.fontHeight+"px "+this.fontFamily;}else{b=this.fontHeight+"px "+this.fontFamily;}l.font=b;var d=l.measureText("0").width*2.64;l=null;a=null;var j=this.getDimension(this.rectFont);var f=((j*3.5)-(d/2));var k=this.rectFont.right;var h=this.rectFont.bottom;h-=(j*3);for(var c=0;c<g.length;c++){this.drawBarCodeFontAngle90(k,h-f,b,g.substring(c,c+1));h-=(j*7);switch(c){case 3:h-=(j*5);break;}}};mCR_SymbologyEAN8.prototype.drawFontAngle180=function(g){var a=document.createElement("canvas");var l=a.getContext("2d");var b="";if(this.FontStyle){b="bold "+this.fontHeight+"px "+this.fontFamily;}else{b=this.fontHeight+"px "+this.fontFamily;}l.font=b;var d=l.measureText("0").width*2.64;l=null;a=null;var j=this.getDimension(this.rectFont);var f=((j*3.5)-(d/2));var k=this.rectFont.right;var h=this.rectFont.top;k-=(j*3);for(var c=0;c<g.length;c++){this.drawBarCodeFontAngle180(k-f,h,b,g.substring(c,c+1));k-=(j*7);switch(c){case 3:k-=(j*5);break;}}};mCR_SymbologyEAN8.prototype.drawFontAngle270=function(g){var a=document.createElement("canvas");var l=a.getContext("2d");var b="";if(this.FontStyle){b="bold "+this.fontHeight+"px "+this.fontFamily;}else{b=this.fontHeight+"px "+this.fontFamily;}l.font=b;var d=l.measureText("0").width;l=null;a=null;var j=this.getDimension(this.rectFont);var f=((j*3.5)-(d/2));var k=this.rectFont.left;var h=this.rectFont.top;h+=(j*3);for(var c=0;c<g.length;c++){this.drawBarCodeFontAngle270(k,h+f,b,g.substring(c,c+1));h+=(j*7);switch(c){case 3:h+=(j*5);break;}}};mCR_SymbologyEAN8.prototype.getDimension=function(){var a=this.getBarcodeWidth();var b=0;if(this.barcode.optResolution){b=Math.floor((a/((8*7)+11)));if(b<1){b=1;}}else{b=(a/((8*7)+11));}return b;};function mCR_SymbologyKoreanPostalCode(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);}mCR_SymbologyKoreanPostalCode.prototype=Object.create(mCR_Symbology.prototype);mCR_SymbologyKoreanPostalCode.prototype.constructor=mCR_SymbologyKoreanPostalCode;mCR_SymbologyKoreanPostalCode.prototype.drawBarcode=function(){var a=this.createPattern(this.barcode.text);if(this.errorCode==0){this.drawPattern(a);}else{this.drawErrorMsg();}};mCR_SymbologyKoreanPostalCode.prototype.drawPattern=function(b){var a=this.getDimension(b);this.drawBSPattern(b,a);};mCR_SymbologyKoreanPostalCode.prototype.drawBSPattern=function(b,a){switch(this.barcode.barcodeAngle){case 0:this.drawBSPatternAngle0(b,a);break;case 1:this.drawBSPatternAngle90(b,a);break;case 2:this.drawBSPatternAngle180(b,a);break;case 3:this.drawBSPatternAngle270(b,a);break;}};mCR_SymbologyKoreanPostalCode.prototype.drawBSPatternAngle0=function(h,g){var b=(g/4);var a=this.rect.left;var d=b;var f=h.length;for(var c=0;c<f;c++){if(h.charAt(c)=="b"){a+=(b*1.5);this.drawBarAngle0(a,d);a+=(b*2.5);}else{a+=g;}}};mCR_SymbologyKoreanPostalCode.prototype.drawBSPatternAngle90=function(h,g){var b=(g/4);var a=this.rect.bottom;var d=b;var f=h.length;for(var c=0;c<f;c++){if(h.charAt(c)=="b"){a-=(b*1.5);this.drawBarAngle90(a,d);a-=(b*2.5);}else{a-=g;}}};mCR_SymbologyKoreanPostalCode.prototype.drawBSPatternAngle180=function(h,g){var b=(g/4);var a=this.rect.right;var d=b;var f=h.length;for(var c=0;c<f;c++){if(h.charAt(c)=="b"){a-=(b*1.5);this.drawBarAngle180(a,d);a-=(b*2.5);}else{a-=g;}}};mCR_SymbologyKoreanPostalCode.prototype.drawBSPatternAngle270=function(h,g){var b=(g/4);var a=this.rect.top;var d=b;var f=h.length;for(var c=0;c<f;c++){if(h.charAt(c)=="b"){a+=(b*1.5);this.drawBarAngle270(a,d);a+=(b*2.5);}else{a+=g;}}};mCR_SymbologyKoreanPostalCode.prototype.getDimension=function(d){var a=d.length;var b=this.getBarcodeWidth();var c=0;c=(b/a);return c;};mCR_SymbologyKoreanPostalCode.prototype.createPattern=function(k){var h="";var f=k.length;if(f==6||f==5){var d=0;for(var a=f-1;a>=0;a--){var i=k.charAt(a);var b=this.getCharacterCode(i);var j=this.retrievePattern(b);if(j!=""){h+=j;d+=b;}else{this.errorCode=2;this.errorMsg="Unvalid data";h="";break;}}if(this.errorCode==0){var g=10-(d%10);h+=this.retrievePattern(g);}}else{this.errorCode=1;this.errorMsg="value size error";}return h;};mCR_SymbologyKoreanPostalCode.prototype.getCharacterCode=function(b){var a=-1;if(b>="0"&&b<="9"){a=b-"0";}return a;};mCR_SymbologyKoreanPostalCode.prototype.retrievePattern=function(a){var b="";switch(a){case 1:b="ssbbbb";break;case 2:b="sbsbbb";break;case 3:b="bssbbb";break;case 4:b="sbbsbb";break;case 5:b="bsbsbb";break;case 6:b="bbssbb";break;case 7:b="sbbbsb";break;case 8:b="bsbbsb";break;case 9:b="bbsbsb";break;case 0:b="bbbssb";break;}return b;};function mCR_SymbologyQRCode(a,d,b,c){mCR_Symbology.call(this,a,d,b,c);}mCR_SymbologyQRCode.prototype=Object.create(mCR_Symbology.prototype);mCR_SymbologyQRCode.prototype.constructor=mCR_SymbologyQRCode;mCR_SymbologyQRCode.prototype.drawBarcode=function(){var a=this.createPattern(this.barcode.text);if(this.errorCode==0){this.drawPattern(a);}else{this.drawErrorMsg();}};mCR_SymbologyQRCode.prototype.createPattern=function(c){var a=null;var b=c.length;if(b==0){this.errorCode=1;this.errorMsg="value size error";}else{try{a=jQuery.parseJSON(c);}catch(d){this.errorCode=2;this.errorMsg="Unvalid data";}}return a;};mCR_SymbologyQRCode.prototype.drawPattern=function(k){var b=new docRect();if(this.rect.getWidth()<this.rect.getHeight()){var g=(this.rect.getHeight()-this.rect.getWidth())/2;b.set(this.rect.left,(this.rect.top+g),this.rect.getWidth(),this.rect.getWidth());}else{var g=(this.rect.getWidth()-this.rect.getHeight())/2;b.set(this.rect.left+g,this.rect.top,this.rect.getHeight(),this.rect.getHeight());}var a=k.length;var l=(b.getWidth()/a);var h=b.left,f=b.top;for(var d=0;d<a;d++){for(var c=0;c<a;c++){if(k[d][c]==1){this.drawBarCodeRect(h,f,l,l);}h+=l;}h=b.left;f+=l;}};function mCR_SymbologyDataMatrix(a,d,b,c){mCR_SymbologyQRCode.call(this,a,d,b,c);}mCR_SymbologyDataMatrix.prototype=Object.create(mCR_SymbologyQRCode.prototype);mCR_SymbologyDataMatrix.prototype.constructor=mCR_SymbologyDataMatrix;function mCR_SymbologyPDF417(a,d,b,c){mCR_SymbologyQRCode.call(this,a,d,b,c);}mCR_SymbologyPDF417.prototype=Object.create(mCR_SymbologyQRCode.prototype);mCR_SymbologyPDF417.prototype.constructor=mCR_SymbologyPDF417;mCR_SymbologyPDF417.prototype.drawPattern=function(m){var b=new docRect();b.set(this.rect.left,this.rect.top,this.rect.getWidth(),this.rect.getHeight());var k=b.getWidth();var c=b.getHeight();var a=k;var f=m[0].length;var h=m.length;var l=a/f;if(c>h*l){b.top=b.top+((c-h*l)/2);}for(var g=0;g<h;g++){for(var d=0;d<f;d++){if(m[g][d]==1){this.drawBarCodeRect(b.left+(d*l),b.top+(g*l),l,l);}}}};function mCR_exportSVG(b,a){this.objDocument=b;this.objDocumentPage=null;this.objPageStyle=null;this.elmSVG=null;this.elmBodyGroup=null;this.elmCanvas=null;this.nPixelRate=0.378;this.nPtToPxRate=1.32814;this.elmChangeGroup=null;this.objLineHashMap=null;this.pageImageCount=0;this.tempImageDrawCount=0;this.callFunction=null;this.webLinkList=new Array();this.isPrint=a;this.isAccessibility=false;this.isEasyInput=false;this.ruleCtrlVisible=false;}mCR_exportSVG.prototype.exportPage=function(c,a,d){this.callFunction=a;this.objDocumentPage=this.objDocument.documentPageList[c];this.startPage();d.appendChild(this.elmSVG);this.exportSubSectionsInPage();this.endPage();if(this.pageImageCount==0){if(this.callFunction!=null){var b=this;window.setTimeout(function(){b.callFunction();},10);}}return this.elmSVG;};mCR_exportSVG.prototype.callGetWebLinkList=function(){return this.webLinkList;};mCR_exportSVG.prototype.setEasyInput=function(a){this.isEasyInput=a;};mCR_exportSVG.prototype.setRuleCtrlVisible=function(a){this.ruleCtrlVisible=a;};mCR_exportSVG.prototype.setAccessibility=function(a){this.isAccessibility=a;};mCR_exportSVG.prototype.startPage=function(){this.objPageStyle=this.objDocument.getPageStyle(this.objDocumentPage.pageStyleKey);if(this.isEasyInput){var a=new docStylePage();a.paperType=this.objPageStyle.orientation;a.width=0;a.height=0;a.orientation=this.objPageStyle.orientation;a.leftMargin=0;a.topMargin=0;a.rightMargin=0;a.bottomMargin=0;a.pageCount=1;a.multiColumnDirection=this.objPageStyle.multiColumnDirection;for(var d=0;d<this.objDocumentPage.subSectionList.length;d++){var g=this.objDocumentPage.subSectionList[d];if(!g.isDrilling){var c=g.area.getHeight();g.area.top=a.height;a.height+=c;g.area.bottom=a.height;var b=g.area.getWidth();g.area.left=0;g.area.right=b;if(a.width<b){a.width=b;}}}this.objPageStyle=a;}this.elmSVG=document.createElementNS("http://www.w3.org/2000/svg","svg");this.elmSVG.setAttribute("fill-opacity","1");this.elmSVG.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");this.elmSVG.setAttribute("xmlns","http://www.w3.org/2000/svg");this.elmSVG.setAttribute("color-rendering","auto");this.elmSVG.setAttribute("color-interpolation","auto");this.elmSVG.setAttribute("text-interpolation","auto");this.elmSVG.setAttribute("stroke-linecap","square");this.elmSVG.setAttribute("stroke-miterlimit","10");this.elmSVG.setAttribute("stroke-opacity","1");this.elmSVG.setAttribute("shape-rendering","auto");this.elmSVG.setAttribute("stroke-dasharray","none");this.elmSVG.setAttribute("stroke-linejoin","miter");this.elmSVG.setAttribute("stroke-dashoffset","0");this.elmSVG.setAttribute("image-rendering","auto");this.elmSVG.setAttribute("style","overflow:hidden");this.elmSVG.setAttribute("width",(this.objPageStyle.width/100)+"cm");this.elmSVG.setAttribute("height",(this.objPageStyle.height/100)+"cm");this.elmBodyGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmBodyGroup.setAttribute("transform","scale(1) translate(0,0)");this.elmdefs=document.createElementNS("http://www.w3.org/2000/svg","defs");this.elmBodyGroup.appendChild(this.elmdefs);var f=document.createElementNS("http://www.w3.org/2000/svg","g");f.setAttribute("fill","white");f.setAttribute("stroke","white");var h=document.createElementNS("http://www.w3.org/2000/svg","rect");h.setAttribute("x","0");h.setAttribute("y","0");h.setAttribute("width",(this.objPageStyle.width/100)+"cm");h.setAttribute("height",(this.objPageStyle.height/100)+"cm");h.setAttribute("stroke","none");this.objDocumentPage.width=this.objPageStyle.width;this.objDocumentPage.height=this.objPageStyle.height;f.appendChild(h);this.elmBodyGroup.appendChild(f);this.elmSVG.appendChild(this.elmBodyGroup);this.objLineHashMap=function(){};this.objAccHashMap=function(){};};mCR_exportSVG.prototype.exportSubSectionsInPage=function(){if(this.objDocumentPage.backGround&&!this.isEasyInput){this.objDocumentPage.backGround.area.right=this.objPageStyle.width-this.objPageStyle.leftMargin-this.objPageStyle.rightMargin;this.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmChangeGroup.setAttribute("id","bgSubSection");this.exportSubSection(this.objDocumentPage.backGround);this.setDefaultGroupStyle();this.exportControlsInSubSection(this.objDocumentPage.backGround);this.elmBodyGroup.appendChild(this.elmChangeGroup);}this.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmChangeGroup.setAttribute("id","mainSubSectionBG");for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){var c=this.objDocumentPage.subSectionList[a];if(c.isDrillingView){this.exportSubSection(c);}}this.elmBodyGroup.appendChild(this.elmChangeGroup);var b=new Array();for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){var c=this.objDocumentPage.subSectionList[a];if(c.isDrillingView){if(c.sectionType!=7){this.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmChangeGroup.setAttribute("id","mainSubSection"+a);this.setDefaultGroupStyle();this.exportControlsInSubSection(c);if(!c.isDrilling){this.elmBodyGroup.appendChild(this.elmChangeGroup);}}else{b.push(c);}}}b.sort(function(f,d){if(f.area.top>d.area.top){return 1;}if(f.area.top<d.area.top){return -1;}return 0;});for(var a=0;a<b.length;a++){this.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmChangeGroup.setAttribute("id","mainSubSectionPB"+a);this.setDefaultGroupStyle();this.exportControlsInSubSection(b[a]);this.elmBodyGroup.appendChild(this.elmChangeGroup);}b=null;if(this.objDocumentPage.foreGround&&!this.isEasyInput){this.objDocumentPage.foreGround.area.right=this.objPageStyle.width-this.objPageStyle.leftMargin-this.objPageStyle.rightMargin;this.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmChangeGroup.setAttribute("id","fgSubSection");this.exportSubSection(this.objDocumentPage.foreGround);this.setDefaultGroupStyle();this.exportControlsInSubSection(this.objDocumentPage.foreGround);this.elmBodyGroup.appendChild(this.elmChangeGroup);}};mCR_exportSVG.prototype.exportSubSection=function(f){var d=f.offsetRect(this.objPageStyle.leftMargin,this.objPageStyle.topMargin);var b=this.objDocument.getBackgroundStyle(f.backgroundStyleKey);if(null!=b&&b.backStyle==0){var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x",(d.left/100)+"cm");a.setAttribute("y",(d.top/100)+"cm");a.setAttribute("width",(d.getWidth()/100)+"cm");a.setAttribute("height",(d.getHeight()/100)+"cm");a.setAttribute("stroke","none");a.setAttribute("fill",mCR_getStrColor(b.backColor));this.elmChangeGroup.appendChild(a);}if(this.ruleCtrlVisible){if(f.isEditEasyMode){var c=this;window.setTimeout(function(){c.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");c.setDefaultGroupStyle();c.elmBodyGroup.appendChild(c.elmChangeGroup);var g=document.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("x",(d.left/100)+"cm");g.setAttribute("y",(d.top/100)+"cm");g.setAttribute("width",(d.getWidth()/100)+"cm");g.setAttribute("height",(d.getHeight()/100)+"cm");g.setAttribute("stroke","blue");g.setAttribute("stroke-width","2px");g.setAttribute("fill","none");c.elmChangeGroup.appendChild(g);var h=document.createElementNS("http://www.w3.org/2000/svg","text");h.setAttribute("stroke","blue");h.setAttribute("font-size","11pt");h.setAttribute("x",(d.left*0.378)+3);h.setAttribute("y",(d.top*0.378)+13);h.textContent=f.sectionName+"("+f.editEasyModeId+")";c.elmChangeGroup.appendChild(h);},300);}}};mCR_exportSVG.prototype.exportReportControlSubSection=function(d){var c=d.getRectInPage();var b=this.objDocument.getBackgroundStyle(d.backgroundStyleKey);if(null!=b&&b.backStyle==0){var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x",(c.left/100)+"cm");a.setAttribute("y",(c.top/100)+"cm");a.setAttribute("width",(c.getWidth()/100)+"cm");a.setAttribute("height",(c.getHeight()/100)+"cm");a.setAttribute("stroke","none");a.setAttribute("fill",mCR_getStrColor(b.backColor));this.elmChangeGroup.appendChild(a);}};mCR_exportSVG.prototype.endPage=function(){this.objLineHashMap=null;this.objAccHashMap=null;};mCR_exportSVG.prototype.exportControlsInSubSection=function(f){for(var b=0;b<f.controlPageList.length;b++){var a=f.controlPageList[b];var d=true;if(-1!=a.visibleOptionStyleKey){var c=this.objDocument.getVisibleOptionStyle(a.visibleOptionStyleKey);if(null!=c){if(this.isPrint){d=c.toPrint;}else{d=c.toView;}}}if(d){this.exportControl(a);}}};mCR_exportSVG.prototype.exportControl=function(a){var c=true;if(a.pageCountConditionType==21){var b=this.objDocument.checkedTotalPageCount;var d=pageIndex+1==b/2+1;if(a.visible){if(d==true){c=false;}}else{c=d||a.conditionVisible;}}else{if(a.pageCountConditionType==-1){c=a.conditionVisible;}}if(c){switch(a.type){case mCR_DocumentControlType.Line:this.exportLine(a);break;case mCR_DocumentControlType.Shape:this.exportShape(a);break;case mCR_DocumentControlType.Label:this.exportLabel(a);break;case mCR_DocumentControlType.Table:this.exportTable(a);break;case mCR_DocumentControlType.Crosstab:this.exportCrosstab(a);break;case mCR_DocumentControlType.Barcode:this.exportBarcode(a);break;case mCR_DocumentControlType.Chart:this.exportChart(a);break;case mCR_DocumentControlType.SubReport:this.exportReportControl(a);break;case mCR_DocumentControlType.Checkbox:this.exportCheckbox(a,this.elmChangeGroup,false);break;case mCR_DocumentControlType.VoiceEye:this.exportVoiceEye(a);break;case mCR_DocumentControlType.MarkAnyVoiceEye:this.exportMarkAnyVoice(a);break;case mCR_DocumentControlType.VerifyBarcode:this.exportVerifyBarcode(a);break;case mCR_DocumentControlType.Input:this.exportInputbox(a);break;case mCR_DocumentControlType.Button:this.exportInputButton(a);break;case mCR_DocumentControlType.Video:this.exportInputVideo(a);break;case mCR_DocumentControlType.InputSelectBox:this.exportInputSelectBox(a);break;case mCR_DocumentControlType.Calendar:this.exportInputCalendar(a);break;case mCR_DocumentControlType.InputSign:this.exportInputSign(a);break;case mCR_DocumentControlType.InputImage:this.exportInputImage(a);break;case mCR_DocumentControlType.InputCheckbox:this.exportInputCheckbox(a);break;}}};mCR_exportSVG.prototype.exportInputCheckbox=function(f){var l=f.getRectInPage();var h=f.checkSize;var d=this.objDocument.documentStorage[f.primaryName];if(null!=d){if(d.visible){var c=null;if(f.useText){c=new docRect();c.set(0,0,h,h);var k=l.top+((l.getHeight()-h)/2);c.offsetRect(l.left,k);l.left+=h;var m=this.paintText(l,f.textInfo);if(m!=null){this.elmChangeGroup.appendChild(m);}}else{c=l;}var o=this.objDocument.getLineStyle(f.outterlineStyleKey);var i=this.objDocument.getShapeStyle(f.shapeStyleKey);if(null!=o&&null!=i){var g=this.paintShapeStyle(c,i);this.paintLineStyle(o,g);this.elmChangeGroup.appendChild(g);}if("true"==d.checked){var j=d.imageType=="check"?this.objDocument.checkImageName:this.objDocument.radioImageName;var n=mCR_makeImageURL(this.objDocument,j);var b=document.createElementNS("http://www.w3.org/2000/svg","image");b.setAttribute("x",(c.left/100)+"cm");b.setAttribute("y",(c.top/100)+"cm");b.setAttribute("width",(c.getWidth()/100)+"cm");b.setAttribute("height",(c.getHeight()/100)+"cm");b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);this.pageImageCount++;var a=this;b.onload=function(){a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};b.onerror=function(){window.console.log("InputCheck or radio ID:"+d.id+" image error url >>"+n);a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};this.elmChangeGroup.appendChild(b);}}else{if(f.useText){l.left+=h;var m=this.paintText(l,f.textInfo);if(m!=null){this.elmChangeGroup.appendChild(m);}}}}};mCR_exportSVG.prototype.exportInputImage=function(a){var b=a.getRectInPage();var c=this.objDocument.documentStorage[a.primaryName];if((b.getWidth()!=0&&b.getHeight()!=0)&&null!=c){if(c.visible&&""!=c.image){var g=c.image.replace(/\s/gi,"+");var f=document.createElementNS("http://www.w3.org/2000/svg","image");f.setAttribute("x",(b.left/100)+"cm");f.setAttribute("y",(b.top/100)+"cm");f.setAttribute("width",(b.getWidth()/100)+"cm");f.setAttribute("height",(b.getHeight()/100)+"cm");f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","data:image/png;base64,"+g);this.pageImageCount++;var d=this;f.onload=function(){d.tempImageDrawCount++;if(d.pageImageCount<=d.tempImageDrawCount){if(null!=d.callFunction){d.callFunction();}d.callFunction=null;}};f.onerror=function(){window.console.log("InputImage ID:"+c.id+" image error url >> "+g);d.tempImageDrawCount++;if(d.pageImageCount<=d.tempImageDrawCount){if(null!=d.callFunction){d.callFunction();}d.callFunction=null;}};this.elmChangeGroup.appendChild(f);}else{if(c.visible&&""==c.image){this.setInputControlInfo(b,"image");}}}};mCR_exportSVG.prototype.exportInputSign=function(h){var i=h.getRectInPage();var d=this.objDocument.documentStorage[h.primaryName];if((i.getWidth()!=0&&i.getHeight()!=0)&&null!=d){if(d.visible&&""!=d.image){var j=this.objDocument.getLineStyle(h.outterlineStyleKey);var g=this.objDocument.getShapeStyle(h.shapeStyleKey);if(null!=j&&null!=g){var f=this.paintShapeStyle(i,g);this.paintLineStyle(j,f);this.elmChangeGroup.appendChild(f);}var b=d.image.replace(/\s/gi,"+");var c=document.createElementNS("http://www.w3.org/2000/svg","image");c.setAttribute("x",(i.left/100)+"cm");c.setAttribute("y",(i.top/100)+"cm");c.setAttribute("width",(i.getWidth()/100)+"cm");c.setAttribute("height",(i.getHeight()/100)+"cm");c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","data:image/png;base64,"+b);this.pageImageCount++;var a=this;c.onload=function(){a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};c.onerror=function(){window.console.log("InputSign ID:"+d.id+" image error url >> "+b);a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};this.elmChangeGroup.appendChild(c);}else{if(d.visible&&""==d.image){this.setInputControlInfo(i,"sign");}}}};mCR_exportSVG.prototype.exportInputCalendar=function(a){var c=a.getRectInPage();var d=this.objDocument.documentStorage[a.primaryName];if(null!=d){if(d.visible){var b=this.paintText(c,a.textInfo);if(b!=null){this.elmChangeGroup.appendChild(b);}}}};mCR_exportSVG.prototype.exportInputSelectBox=function(a){var c=a.getRectInPage();var d=this.objDocument.documentStorage[a.primaryName];if(null!=d){if(d.visible){var b=this.paintText(c,a.textInfo);if(b!=null){this.elmChangeGroup.appendChild(b);}}}};mCR_exportSVG.prototype.exportInputButton=function(a){var c=a.getRectInPage();var d=this.objDocument.documentStorage[a.primaryName];if(null!=d){if(d.visible){var b=this.paintText(c,a.textInfo);if(b!=null){this.elmChangeGroup.appendChild(b);}}}};mCR_exportSVG.prototype.exportInputVideo=function(a){};mCR_exportSVG.prototype.exportInputbox=function(c){var b=c.getRectInPage();var d=this.objDocument.documentStorage[c.primaryName];if(null!=d){if(d.visible){var a=this.paintText(b,c.textInfo);if(a!=null){this.elmChangeGroup.appendChild(a);}}}};mCR_exportSVG.prototype.makeTableGroup=function(b){var a=document.createElementNS("http://www.w3.org/2000/svg","g");if(b){a.setAttribute("stroke","none");a.setAttribute("fill","none");}else{a.setAttribute("stroke-linecap","butt");a.setAttribute("stroke-width","0.75pt");a.setAttribute("stroke","rgb(0,0,0)");a.setAttribute("fill","none");}return a;};mCR_exportSVG.prototype.exportTable=function(a){var g=a;var f=g.getRectInPage();var d=this.makeTableGroup(true);var h=this.makeTableGroup(false);var b=new docCellMap();if(this.isAccessibility&&null!=g.accessibilityString&&""!=g.accessibilityString){var c={type:20,msg:g.accessibilityString};this.setWebLinkInfo(f,c);}this.elmChangeGroup.appendChild(d);this.paintCellsBackgroundText(f,g,d,b);this.paintCellsOutterLine(f,g,h,b);this.elmChangeGroup.appendChild(h);};mCR_exportSVG.prototype.paintCellsBackgroundText=function(h,p,j,d){var i=p.getRowCount();for(var g=0;g<i;g++){var b=new Array();d.cellMap.push(b);var n=p.getColumnCount();for(var m=0;m<n;m++){var l=p.getTableCellNormal(g,m);if(l!=null){var c=new docCellInfo(false);c.colSpan=l.colSpan;c.rowSpan=l.rowSpan;b.push(c);this.paintCellBackground(h,l,j);if(l.webLinkInfo!=null){if(l.webLinkInfo.type!=-1){var k=l.getRectInPage();k.offsetRect(h.left,h.top);this.setWebLinkInfo(k,l.webLinkInfo);}}if(this.isAccessibility){if(null!=l.accessibilityString){var f=l.accessibilityString;f=f.replace(/\@pc\@|\@pn\@/g,l.detailTextInfo.getOriginalTextInfo().text);var o={type:20,ctrl:1,msg:f};var a=l.getRectInPage();a.offsetRect(h.left,h.top);this.setWebLinkInfo(a,o);}else{var o={type:400,ctrl:1,msg:""};var a=l.getRectInPage();a.offsetRect(h.left,h.top);this.setWebLinkInfo(a,o);}}}else{var c=new docCellInfo(true);b.push(c);}}}};mCR_exportSVG.prototype.paintCellsOutterLine=function(f,m,h,c){this.checkingLastCell(c);var g=m.getRowCount();var k=null;for(var d=0;d<g;d++){k=m.getColumnCount();for(var l=0;l<k;l++){var j=m.getTableCellNormal(d,l);if(j!=null){this.paintCellOutterLine(f,j,h,m,d,g,l,k,c);}}}var a=this.objDocument.getLineStyle(m.lineFDiagonaStyleKey);if(a.style!=mCR_LineStyle.None){var i=this.paintLineBDiagonal(c.leftBottomCell.getRectInPage().addRect(f.getLeft(),f.getTop(),f.getLeft(),f.getTop()),c.rightTopCell.getRectInPage().addRect(f.getLeft(),f.getTop(),f.getLeft(),f.getTop()),a,m.roundLeftBottom,m.roundRightTop);h.appendChild(i);}var b=this.objDocument.getLineStyle(m.lineBDiagonaStyleKey);if(b.style!=mCR_LineStyle.None){var i=this.paintLineFDiagonal(c.leftTopCell.getRectInPage().addRect(f.getLeft(),f.getTop(),f.getLeft(),f.getTop()),c.rightBottomCell.getRectInPage().addRect(f.getLeft(),f.getTop(),f.getLeft(),f.getTop()),b,m.roundLeftTop,m.roundRightBottom);h.appendChild(i);}};mCR_exportSVG.prototype.checkingLastCell=function(d){var a=d.cellMap.length;for(var f=0;f<a;f++){var g=d.cellMap[f].length;for(var c=0;c<g;c++){var b=d.cellMap[f][c];if(b.rowSpan>1){if(f+b.rowSpan==a){b.isTopLast=true;}}if(b.colSpan>1){if(c+b.colSpan==g){b.isLeftLast=true;}}if(f==a-1&&!b.dumy){b.isTopLast=true;}if(c==g-1&&!b.dumy){b.isLeftLast=true;}}}};mCR_exportSVG.prototype.paintCellOutterLine=function(w,v,u,o,a,c,b,k,n){var x=v.getRectInPage();x.setLeft(w.getLeft()+x.getLeft());x.setTop(w.getTop()+x.getTop());x.setRight(w.getLeft()+x.getRight());x.setBottom(w.getTop()+x.getBottom());var J=n.cellMap[a][b];var D=this.objDocument.getLineStyle(v.leftLineStyleKey);var h=this.objDocument.getLineStyle(v.topLineStyleKey);var q=this.objDocument.getLineStyle(v.rightLineStyleKey);var t=this.objDocument.getLineStyle(v.bottomLineStyleKey);var B=this.objDocument.getLineStyle(v.frontDiagonalLineStyleKey);var j=this.objDocument.getLineStyle(v.backDiagonalLineStyleKey);if(D!=null&&h!=null&&q!=null&&t!=null&&h!=null){var y=false;var z=false;var m=false;var K=false;if(a==0){var F=this.objDocument.getLineStyle(o.outterlineStyleKey);if(F.style!=0){h=F;}}if(b==0){var F=this.objDocument.getLineStyle(o.outterlineStyleKey);if(F.style!=0){D=F;}}if(J.isLeftLast){var F=this.objDocument.getLineStyle(o.outterlineStyleKey);if(F.style!=0){q=F;}}if(J.isTopLast){var F=this.objDocument.getLineStyle(o.outterlineStyleKey);if(F.style!=0){t=F;}}var C=this.getWidthMarginNormal(D.width,D.style)/100;var E=this.getWidthMarginNormal(q.width,q.style)/100;var f=this.getWidthMarginNormal(h.width,h.style)/100;var i=this.getWidthMarginNormal(t.width,t.style)/100;var G=null;var r=null;var d=null;var l=null;var s=null;var L=null;var p=null;var A=null;if(D.style==mCR_LineStyle.DoubleLine){d=this.getWidthMarginOutter(h.width,h.style)/100;l=this.getWidthMarginOutter(t.width,t.style)/100;p=this.getWidthMarginInner(h.width,h.style)/100;A=this.getWidthMarginInner(t.width,t.style)/100;}else{if(D.style==mCR_LineStyle.InnerLine){p=this.getWidthMarginInner(h.width,h.style)/100;A=this.getWidthMarginInner(t.width,t.style)/100;}}if(h.style==mCR_LineStyle.DoubleLine){G=this.getWidthMarginOutter(D.width,D.style)/100;r=this.getWidthMarginOutter(q.width,q.style)/100;s=this.getWidthMarginInner(D.width,D.style)/100;L=this.getWidthMarginInner(q.width,q.style)/100;}else{if(h.style==mCR_LineStyle.InnerLine){s=this.getWidthMarginInner(D.width,D.style)/100;L=this.getWidthMarginInner(q.width,q.style)/100;}}if(q.style==mCR_LineStyle.DoubleLine){if(d==null){d=this.getWidthMarginOutter(h.width,h.style)/100;}if(l==null){l=this.getWidthMarginOutter(t.width,t.style)/100;}if(p==null){p=this.getWidthMarginInner(h.width,h.style)/100;}if(A==null){A=this.getWidthMarginInner(t.width,t.style)/100;}}else{if(q.style==mCR_LineStyle.InnerLine){if(p==null){p=this.getWidthMarginInner(h.width,h.style)/100;}if(A==null){A=this.getWidthMarginInner(t.width,t.style)/100;}}}if(t.style==mCR_LineStyle.DoubleLine){if(G==null){G=this.getWidthMarginOutter(D.width,D.style)/100;}if(r==null){r=this.getWidthMarginOutter(q.width,q.style)/100;}if(s==null){s=this.getWidthMarginInner(D.width,D.style)/100;}if(L==null){L=this.getWidthMarginInner(q.width,q.style)/100;}}else{if(t.style==mCR_LineStyle.InnerLine){if(s==null){s=this.getWidthMarginInner(D.width,D.style)/100;}if(L==null){L=this.getWidthMarginInner(q.width,q.style)/100;}}}if(a==0&&b==0){n.leftTopCell=v;if(o.roundLeftTop==1){y=true;}}if(a==0&&J.isLeftLast){n.rightTopCell=v;if(o.roundRightTop==1){z=true;}}if(J.isTopLast&&b==0){n.leftBottomCell=v;if(o.roundLeftBottom==1){m=true;}}if(J.isTopLast&&J.isLeftLast){n.rightBottomCell=v;if(o.roundRightBottom==1){K=true;}}if(D.style!=0){if(b!=0&&n.cellMap[a][b-1].rightLineStyleKey==0){}else{J.leftLineStyleKey=v.leftLineStyleKey;if(D.style==mCR_LineStyle.DoubleLine){var H=this.getCellLineWidth(D.width)/100;this.paintCellLineLeft(x,D,y,m,d,l,-H,u);this.paintCellLineLeft(x,D,y,m,p,A,H,u);}else{if(D.style==mCR_LineStyle.InnerLine){var H=this.getCellLineWidth(D.width)/100;this.paintCellLineLeft(x,D,y,m,p,A,H,u);}else{var H=0;this.paintCellLineLeft(x,D,y,m,f,i,H,u);}}}}if(h.style!=0){if(a!=0&&n.cellMap[a-1][b].bottomLineStyleKey==0){}else{J.topLineStyleKey=v.topLineStyleKey;if(h.style==mCR_LineStyle.DoubleLine){var I=this.getCellLineWidth(h.width)/100;this.paintCellLineTop(x,h,y,z,G,r,-I,u);this.paintCellLineTop(x,h,y,z,s,L,I,u);}else{if(h.style==mCR_LineStyle.InnerLine){var I=this.getCellLineWidth(h.width)/100;this.paintCellLineTop(x,h,y,z,s,L,I,u);}else{var I=0;this.paintCellLineTop(x,h,y,z,C,E,I,u);}}}}if(q.style!=0){if(!J.isLeftLast&&n.cellMap[a][b+1].leftLineStyleKey==0){}else{J.rightLineStyleKey=v.rightLineStyleKey;if(q.style==mCR_LineStyle.DoubleLine){var H=this.getCellLineWidth(q.width)/100;this.paintCellLineRight(x,q,z,K,d,l,H,u);this.paintCellLineRight(x,q,z,K,p,A,-H,u);}else{if(q.style==mCR_LineStyle.InnerLine){var H=this.getCellLineWidth(q.width)/100;this.paintCellLineRight(x,q,z,K,p,A,-H,u);}else{var H=0;this.paintCellLineRight(x,q,z,K,f,i,H,u);}}}}if(t.style!=0){if(!J.isTopLast&&n.cellMap[a+1][b].bottomLineStyleKey==0){}else{J.bottomLineStyleKey=v.bottomLineStyleKey;if(t.style==mCR_LineStyle.DoubleLine){var I=this.getCellLineWidth(t.width)/100;this.paintCellLineBottom(x,t,m,K,G,r,I,u);this.paintCellLineBottom(x,t,m,K,s,L,-I,u);}else{if(t.style==mCR_LineStyle.InnerLine){var I=this.getCellLineWidth(t.width)/100;this.paintCellLineBottom(x,t,m,K,s,L,-I,u);}else{var I=0;this.paintCellLineBottom(x,t,m,K,C,E,I,u);}}}}if(B.style!=0){var g=this.paintLineBDiagonal(x,x,B,m,z);u.appendChild(g);}if(j.style!=0){var g=this.paintLineFDiagonal(x,x,j,y,K);u.appendChild(g);}}};mCR_exportSVG.prototype.paintRoundLeftTop=function(j,b,i,d,k){var l=document.createElementNS("http://www.w3.org/2000/svg","path");this.paintLineStyle(b,l);var a=((j.getLeft())*0.378+i*37.8).toFixed(2);var g=((j.getTop()+j.getHeight()/2)*0.378+d*37.8).toFixed(2);var h=((j.getTop()+j.getHeight()*0.2929)*0.378+d*37.8).toFixed(2);var c=(((j.getLeft()+j.getWidth()/2*0.2929)*0.378)+i*37.8).toFixed(2);var f=((j.getTop()+j.getHeight()/2*0.2929)*0.378+d*37.8).toFixed(2);l.setAttribute("d","M"+a+" "+g+" C"+a+" "+g+" "+a+" "+h+" "+c+" "+f);k.appendChild(l);};mCR_exportSVG.prototype.paintRoundTopLeft=function(j,c,i,f,k){var l=document.createElementNS("http://www.w3.org/2000/svg","path");this.paintLineStyle(c,l);var a=((j.getTop())*0.378+f*37.8).toFixed(2);var g=(((j.getLeft()+j.getWidth()/2)*0.378)+i*37.8).toFixed(2);var b=((j.getLeft()+j.getWidth()*0.2929)*0.378+i*37.8).toFixed(2);var d=(((j.getLeft()+j.getWidth()/2*0.2929)*0.378)+i*37.8).toFixed(2);var h=((j.getTop()+j.getHeight()/2*0.2929)*0.378+f*37.8).toFixed(2);l.setAttribute("d","M"+d+" "+h+" C"+b+" "+a+" "+g+" "+a+" "+g+" "+a);k.appendChild(l);};mCR_exportSVG.prototype.paintRoundTopRight=function(j,b,h,d,k){var l=document.createElementNS("http://www.w3.org/2000/svg","path");this.paintLineStyle(b,l);var a=(j.getTop()*0.378+d*37.8).toFixed(2);var g=(j.getRight()*0.378+h*37.8).toFixed(2);var m=((j.getRight()-j.getWidth()/2)*0.378+h*37.8).toFixed(2);var c=((j.getRight()-j.getWidth()*0.2929)*0.378+h*37.8).toFixed(2);var i=(((j.getRight()-j.getWidth()/2*0.2929)*0.378)+h*37.8).toFixed(2);var f=((j.getTop()+j.getHeight()/2*0.2929)*0.378+d*37.8).toFixed(2);l.setAttribute("d","M"+i+" "+f+" C"+c+" "+a+" "+m+" "+a+" "+m+" "+a);k.appendChild(l);};mCR_exportSVG.prototype.paintRoundRightTop=function(j,a,h,b,k){var l=document.createElementNS("http://www.w3.org/2000/svg","path");this.paintLineStyle(a,l);var d=(j.getRight()*0.378+h*37.8).toFixed(2);var i=(((j.getRight()-j.getWidth()/2*0.2929)*0.378)+h*37.8).toFixed(2);var g=((j.getTop()+j.getHeight()*0.2929)*0.378+b*37.8).toFixed(2);var c=((j.getTop()+j.getHeight()/2*0.2929)*0.378+b*37.8).toFixed(2);var f=((j.getTop()+j.getHeight()/2)*0.378+b*37.8).toFixed(2);l.setAttribute("d","M"+d+" "+f+" C"+d+" "+f+" "+d+" "+g+" "+i+" "+c);k.appendChild(l);};mCR_exportSVG.prototype.paintRoundLeftBottom=function(j,b,i,d,k){var l=document.createElementNS("http://www.w3.org/2000/svg","path");this.paintLineStyle(b,l);var a=((j.getLeft())*0.378+i*37.8).toFixed(2);var g=((j.getBottom()-j.getHeight()/2)*0.378+d*37.8).toFixed(2);var h=((j.getBottom()-j.getHeight()*0.2929)*0.378+d*37.8).toFixed(2);var c=(((j.getLeft()+j.getWidth()/2*0.2929)*0.378)+i*37.8).toFixed(2);var f=((j.getBottom()-j.getHeight()/2*0.2929)*0.378+d*37.8).toFixed(2);l.setAttribute("d","M"+a+" "+g+" C"+a+" "+g+" "+a+" "+h+" "+c+" "+f);k.appendChild(l);};mCR_exportSVG.prototype.paintRoundBottomLeft=function(i,b,h,d,j){var k=document.createElementNS("http://www.w3.org/2000/svg","path");this.paintLineStyle(b,k);var l=((i.getBottom())*0.378+d*37.8).toFixed(2);var f=(((i.getLeft()+i.getWidth()/2)*0.378)+h*37.8).toFixed(2);var a=((i.getLeft()+i.getWidth()*0.2929)*0.378+h*37.8).toFixed(2);var c=(((i.getLeft()+i.getWidth()/2*0.2929)*0.378)+h*37.8).toFixed(2);var g=((i.getBottom()-i.getHeight()/2*0.2929)*0.378+d*37.8).toFixed(2);k.setAttribute("d","M"+c+" "+g+" C"+a+" "+l+" "+f+" "+l+" "+f+" "+l);j.appendChild(k);};mCR_exportSVG.prototype.paintRoundRightBottom=function(j,a,h,b,k){var l=document.createElementNS("http://www.w3.org/2000/svg","path");this.paintLineStyle(a,l);var d=(j.getRight()*0.378+h*37.8).toFixed(2);var f=((j.getBottom()-j.getHeight()/2)*0.378+b*37.8).toFixed(2);var i=(((j.getRight()-j.getWidth()/2*0.2929)*0.378)+h*37.8).toFixed(2);var g=((j.getBottom()-j.getHeight()*0.2929)*0.378+b*37.8).toFixed(2);var c=((j.getBottom()-j.getHeight()/2*0.2929)*0.378+b*37.8).toFixed(2);l.setAttribute("d","M"+d+" "+f+" C"+d+" "+f+" "+d+" "+g+" "+i+" "+c);k.appendChild(l);};mCR_exportSVG.prototype.paintRoundBottomRight=function(i,a,g,c,j){var k=document.createElementNS("http://www.w3.org/2000/svg","path");this.paintLineStyle(a,k);var l=((i.getBottom())*0.378+c*37.8).toFixed(2);var f=(i.getRight()*0.378+g*37.8).toFixed(2);var m=((i.getRight()-i.getWidth()/2)*0.378+g*37.8).toFixed(2);var b=((i.getRight()-i.getWidth()*0.2929)*0.378+g*37.8).toFixed(2);var h=(((i.getRight()-i.getWidth()/2*0.2929)*0.378)+g*37.8).toFixed(2);var d=((i.getBottom()-i.getHeight()/2*0.2929)*0.378+c*37.8).toFixed(2);k.setAttribute("d","M"+h+" "+d+" C"+b+" "+l+" "+m+" "+l+" "+m+" "+l);j.appendChild(k);};mCR_exportSVG.prototype.paintCellLineBottom=function(j,h,f,k,c,g,b,l){var m=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(h,m);var i=(j.getBottom()/100)+b;var a=null;var d=null;if(!(f||k)){a=(j.getLeft()/100);d=(j.getRight()/100);}else{if(f){this.paintRoundBottomLeft(j,h,-b,b,l);a=((j.getRight()-j.getWidth()/2)/100);d=(j.getRight()/100);}else{this.paintRoundBottomRight(j,h,-b,-b,l);a=(j.getLeft()/100);d=((j.getLeft()+j.getWidth()/2)/100);}}a=a-c;d=d+g;m.setAttribute("x1",a+"cm");m.setAttribute("x2",d+"cm");m.setAttribute("y1",i+"cm");m.setAttribute("y2",i+"cm");this.lineDeduplication(a,i,d,i,h,m);l.appendChild(m);};mCR_exportSVG.prototype.paintCellLineRight=function(g,d,b,i,j,f,c,k){var m=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(d,m);var h=c+(g.getRight()/100);var a=null;var l=null;if(!(b||i)){a=(g.getTop()/100);l=(g.getBottom()/100);}else{if(i){this.paintRoundRightBottom(g,d,-c,-c,k);a=(g.getTop()/100);l=((g.getTop()+g.getHeight()/2)/100);}else{this.paintRoundRightTop(g,d,c,-c,k);a=((g.getBottom()-g.getHeight()/2)/100);l=(g.getBottom()/100);}}a=a-j;l=l+f;m.setAttribute("x1",h+"cm");m.setAttribute("x2",h+"cm");m.setAttribute("y1",a+"cm");m.setAttribute("y2",l+"cm");this.lineDeduplication(h,a,h,l,d,m);k.appendChild(m);};mCR_exportSVG.prototype.paintCellLineTop=function(k,h,i,b,d,g,c,l){var m=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(h,m);var j=(k.getTop()/100)+c;var a=null;var f=null;if(!(i||b)){a=(k.getLeft()/100);f=(k.getRight()/100);}else{if(i){this.paintRoundTopLeft(k,h,c,c,l);a=((k.getRight()-k.getWidth()/2)/100);f=(k.getRight()/100);}else{this.paintRoundTopRight(k,h,-c,c,l);a=(k.getLeft()/100);f=((k.getLeft()+k.getWidth()/2)/100);}}a=a-d;f=f+g;m.setAttribute("x1",a+"cm");m.setAttribute("x2",f+"cm");m.setAttribute("y1",j+"cm");m.setAttribute("y2",j+"cm");this.lineDeduplication(a,j,f,j,h,m);l.appendChild(m);};mCR_exportSVG.prototype.paintCellLineLeft=function(h,d,f,c,j,g,b,k){var m=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(d,m);var i=b+(h.getLeft()/100);var a=null;var l=null;if(!(f||c)){a=(h.getTop()/100);l=(h.getBottom()/100);}else{if(c){this.paintRoundLeftBottom(h,d,b,-b,k);a=(h.getTop()/100);l=((h.getTop()+h.getHeight()/2)/100);}else{this.paintRoundLeftTop(h,d,b,b,k);a=((h.getBottom()-h.getHeight()/2)/100);l=(h.getBottom()/100);}}a=a-j;l=l+g;m.setAttribute("x1",i+"cm");m.setAttribute("x2",i+"cm");m.setAttribute("y1",a+"cm");m.setAttribute("y2",l+"cm");this.lineDeduplication(i,a,i,l,d,m);k.appendChild(m);};mCR_exportSVG.prototype.paintLineFDiagonal=function(f,l,c,d,j){var k=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(c,k);var h=0.7071;var b=(f.getLeft()/100);var a=((l.getLeft()+l.getWidth())/100);var i=(f.getTop()/100);var g=((l.getTop()+l.getHeight())/100);if(d){b+=((f.getWidth()/2*(1-h))/100);i+=((f.getHeight()/2*(1-h))/100);}if(j){a-=((l.getWidth()/2*(1-h))/100);g-=((l.getHeight()/2*(1-h))/100);}k.setAttribute("x1",b+"cm");k.setAttribute("x2",a+"cm");k.setAttribute("y1",i+"cm");k.setAttribute("y2",g+"cm");this.lineDeduplication(b,i,a,g,c,k);return k;};mCR_exportSVG.prototype.paintLineBDiagonal=function(g,l,f,d,b){var k=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(f,k);var i=0.7071;var c=(g.getLeft()/100);var a=((l.getLeft()+l.getWidth())/100);var j=((g.getTop()+g.getHeight())/100);var h=(l.getTop()/100);if(d){c+=((g.getWidth()/2*(1-i))/100);j-=((g.getHeight()/2*(1-i))/100);}if(b){a-=((l.getWidth()/2*(1-i))/100);h+=((l.getHeight()/2*(1-i))/100);}k.setAttribute("x1",c+"cm");k.setAttribute("x2",a+"cm");k.setAttribute("y1",j+"cm");k.setAttribute("y2",h+"cm");this.lineDeduplication(c,j,a,h,f,k);return k;};mCR_exportSVG.prototype.getWidthMarginNormal=function(b,a){var c=(b/72*2.54);var d=0;if(a==mCR_LineStyle.DoubleLine||a==mCR_LineStyle.InnerLine){d=c/2+2;}else{d=(c/2)-1;if(d<0){d=0;}}return d;};mCR_exportSVG.prototype.getWidthMarginOutter=function(b,a){var c=this.getCellLineWidth(b);var d=0;if(a==mCR_LineStyle.DoubleLine||a==mCR_LineStyle.InnerLine){d=c/2*3-2;}else{d=(c/2)-1;}return d;};mCR_exportSVG.prototype.getWidthMarginInner=function(b,a){var c=this.getCellLineWidth(b);var d=0;if(a==mCR_LineStyle.DoubleLine||a==mCR_LineStyle.InnerLine){d=-1*c/2-2;}else{d=(c/2)-1;}return d;};mCR_exportSVG.prototype.getCellLineWidth=function(a){var b=4;var c=a/72*2.54;if(c<b){c=b;}return c;};mCR_exportSVG.prototype.paintCellBackground=function(i,m,l){var k=m.getRectInPage();k.setLeft(i.getLeft()+k.getLeft());k.setTop(i.getTop()+k.getTop());k.setRight(i.getLeft()+k.getRight());k.setBottom(i.getTop()+k.getBottom());var g=new Object();g.shapeType=3;var f=this.objDocument.getBackgroundStyle(m.backgroundStyleKey);if((f!=null)&&(k.getWidth()!=0&&k.getHeight()!=0)){var d=null;if(f.getBackStyle()!=mCR_BackStyleType.Transparent){d=this.paintShapeStyle(k,g);this.paintBackgroundStyle(k,f,d);}if(m.imageInfo.imageDataKey!=-1){if(f.getBackStyle()!=1){d.setAttribute("stroke","none");l.appendChild(d);d=this.paintShapeStyle(k,g);}else{d=this.paintShapeStyle(k,g);}var h=this.objDocument.getBackgroundImageStyle(m.imageInfo.backgroundImageStyleKey);var c=this.objDocumentPage.getImageData(m.imageInfo.imageDataKey);if(h!=null&&c!=null){this.paintBackgroundImageStyle(k,h,c,d);}}if(m.isCheckbox){var b=this.makeTableGroup(false);l.appendChild(b);this.shiftCheckboxPosition(m,k);this.exportCheckbox(m.documentCheckbox,b,true);if(m.editable){var a=m.getRectInPage();a.offsetRect(i.left,i.top);this.setCheckEditWebLinkInfo(m.documentCheckbox,a,m.editableIndex,m.documentCheckbox.checkValue);}}else{if(m.editable){var a=m.getRectInPage();a.offsetRect(i.left,i.top);this.setEditWebLinkInfo(m,a,m.detailTextInfo,m.editableIndex);}}var j=this.paintText(k,m.detailTextInfo);if(d!=null){l.appendChild(d);}if(j!=null){l.appendChild(j);}}};mCR_exportSVG.prototype.shiftCheckboxPosition=function(b,c){var f=c;var d=b.documentCheckbox.rect;var g=d.getWidth();var a=d.getHeight();var i=f.left+((f.getWidth()-g)/2);var h=f.top+((f.getHeight()-a)/2);d.left=i;d.top=h;d.right=i+g;d.bottom=h+a;};mCR_exportSVG.prototype.exportCrosstab=function(a){var c=this.makeTableGroup(true);this.drawMatrixCells(a.matrixHeader,c);this.drawMatrixCells(a.matrixRow,c);this.drawMatrixCells(a.matrixColumn,c);this.drawMatrixCells(a.matrixSummarized,c);var b=this.makeTableGroup(false);c.appendChild(b);this.drawCrosstabOutterline(a,b);this.elmChangeGroup.appendChild(c);};mCR_exportSVG.prototype.drawMatrixCells=function(a,n){var i=a.getRowCount();var k=a.getColumnCount();var f=new docStyleShape();f.shapeType=0;for(var h=0;h<i;h++){for(var l=0;l<k;l++){var b=a.getCrosstabBaseCell(h,l);if(b.getType()==mCR_DocumentControlType.TableCell){var g=b.getRectInPage();var f=new docStyleShape();f.shapeType=0;var c=null;var d=this.objDocument.getBackgroundStyle(b.backgroundStyleKey);if(d.getBackStyle()!=mCR_BackStyleType.Transparent){c=this.paintShapeStyle(g,f);this.paintBackgroundStyle(g,d,c);}var j=this.paintText(g,b.detailTextInfo);if(c!=null){n.appendChild(c);}if(j!=null){n.appendChild(j);}if(b.editable){this.setEditWebLinkInfo(b,b.getRectInPage(),b.detailTextInfo,b.editableIndex);}if(b.webLinkInfo!=null){if(b.webLinkInfo.type!=-1){this.setWebLinkInfo(b.getRectInPage(),b.webLinkInfo);}}if(this.isAccessibility&&null!=b.accessibilityString){var o={type:20,msg:b.accessibilityString};this.setWebLinkInfo(b.getRectInPage(),o);}}}}var m=this.makeTableGroup(false);n.appendChild(m);for(var h=0;h<i;h++){for(var l=0;l<k;l++){var b=a.getCrosstabBaseCell(h,l);if(b.getType()==mCR_DocumentControlType.TableCell){this.drawCellLine(b,m);}}}};mCR_exportSVG.prototype.drawCellLine=function(d,g){var m=d.getRectInPage();var n=this.objDocument.getLineStyle(d.leftLineStyleKey);var z=this.objDocument.getLineStyle(d.topLineStyleKey);var w=this.objDocument.getLineStyle(d.rightLineStyleKey);var f=this.objDocument.getLineStyle(d.bottomLineStyleKey);var t=this.objDocument.getLineStyle(d.frontDiagonalLineStyleKey);var A=this.objDocument.getLineStyle(d.backDiagonalLineStyleKey);if(n!=null&&z!=null&&w!=null&&f!=null&&z!=null){var a=this.getWidthMarginNormal(z.width,z.style)/100;var j=this.getWidthMarginNormal(f.width,f.style)/100;var r=this.getWidthMarginNormal(n.width,n.style)/100;var v=this.getWidthMarginNormal(w.width,w.style)/100;if(n.style!=0){var p=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(n,p);var l=(m.getLeft()/100);var h=(m.getTop()/100)-a;var q=(m.getBottom()/100)+j;p.setAttribute("x1",l+"cm");p.setAttribute("x2",l+"cm");p.setAttribute("y1",h+"cm");p.setAttribute("y2",q+"cm");this.lineDeduplication(l,h,l,q,n,p);g.appendChild(p);}if(z.style!=0){var p=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(z,p);var k=(m.getTop()/100);var i=(m.getLeft()/100)-r;var o=(m.getRight()/100)+v;p.setAttribute("x1",i+"cm");p.setAttribute("x2",o+"cm");p.setAttribute("y1",k+"cm");p.setAttribute("y2",k+"cm");this.lineDeduplication(i,k,o,k,z,p);g.appendChild(p);}if(w.style!=0){var p=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(w,p);var l=(m.getRight()/100);var h=(m.getTop()/100)-a;var q=(m.getBottom()/100)+j;p.setAttribute("x1",l+"cm");p.setAttribute("x2",l+"cm");p.setAttribute("y1",h+"cm");p.setAttribute("y2",q+"cm");this.lineDeduplication(l,h,l,q,w,p);g.appendChild(p);}if(f.style!=0){var p=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(f,p);var k=(m.getBottom()/100);var i=(m.getLeft()/100)-r;var o=(m.getRight()/100)+v;p.setAttribute("x1",i+"cm");p.setAttribute("x2",o+"cm");p.setAttribute("y1",k+"cm");p.setAttribute("y2",k+"cm");this.lineDeduplication(i,k,o,k,f,p);g.appendChild(p);}if(t.style!=0){var p=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(t,p);var u=(m.getLeft()/100);var s=((m.getLeft()+m.getWidth())/100);var c=(m.getTop()/100);var b=((m.getTop()+m.getHeight())/100);p.setAttribute("x1",u+"cm");p.setAttribute("x2",s+"cm");p.setAttribute("y1",c+"cm");p.setAttribute("y2",b+"cm");this.lineDeduplication(u,c,s,b,t,p);g.appendChild(p);}if(A.style!=0){var p=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(A,p);var u=(m.getLeft()/100);var s=((m.getLeft()+m.getWidth())/100);var c=((m.getTop()+m.getHeight())/100);var b=(m.getTop()/100);p.setAttribute("x1",u+"cm");p.setAttribute("x2",s+"cm");p.setAttribute("y1",c+"cm");p.setAttribute("y2",b+"cm");this.lineDeduplication(u,c,s,b,A,p);g.appendChild(p);}}};mCR_exportSVG.prototype.drawCrosstabOutterline=function(b,f){var d=b.getRectInPage();var a=this.objDocument.getLineStyle(b.outterlineStyleKey);var g=new docStyleShape();g.shapeType=0;var c=null;if(a.style!=mCR_LineStyle.None){c=this.paintShapeStyle(d,g);this.paintLineStyle(a,c);}if(c!=null){f.appendChild(c);}};mCR_exportSVG.prototype.exportLabel=function(c){var i=c.getRectInPage();var k=this.objDocument.getLineStyle(c.outterlineStyleKey);var f=this.objDocument.getShapeStyle(c.shapeStyleKey);var d=this.objDocument.getBackgroundStyle(c.backgroundStyleKey);if((null!=k&&null!=f&&null!=d)&&(i.getWidth()!=0&&i.getHeight()!=0)){var a=this.paintShapeStyle(i,f);this.paintBackgroundStyle(i,d,a);if(c.imageInfo.imageDataKey!=-1){if(d.backStyle!=1){a.setAttribute("stroke","none");this.elmChangeGroup.appendChild(a);a=this.paintShapeStyle(i,f);}var g=this.objDocument.getBackgroundImageStyle(c.imageInfo.backgroundImageStyleKey);var b=this.objDocumentPage.getImageData(c.imageInfo.imageDataKey);if(null!=g&&null!=b){this.paintBackgroundImageStyle(i,g,b,a);}}this.paintLineStyle(k,a);var j=this.paintText(i,c.textInfo);this.elmChangeGroup.appendChild(a);if(j!=null){this.elmChangeGroup.appendChild(j);}if(c.editable){this.setEditWebLinkInfo(c,c.getRectInPage(),c.textInfo,c.editableIndex);}if(c.webLinkInfo!=null){if(c.webLinkInfo.type!=-1){this.setWebLinkInfo(c.getRectInPage(),c.webLinkInfo);}}if(this.isAccessibility&&null!=c.accessibilityString){var h=c.accessibilityString;h=h.replace(/\@pc\@|\@pn\@/g,c.textInfo.getOriginalTextInfo().text);var l={type:20,msg:h};this.setWebLinkInfo(c.getRectInPage(),l);}}};mCR_exportSVG.prototype.exportVerifyBarcode=function(i){var h=i.getRectInPage();var c=this.objDocument.getShapeStyle(i.shapeStyleKey);var b=this.objDocument.getBackgroundStyle(i.backgroundStyleKey);if((h.getWidth()!=0&&h.getHeight()!=0)){var k=h.getHeight();h.setWidth(k);var a=null;try{a=jQuery.parseJSON(i.text);}catch(f){a=null;window.console.log("not Found VerifyBarcode data >> "+i.text);}if(null!=a){var j=document.createElementNS("http://www.w3.org/2000/svg","g");for(var d=0;d<a.length;d++){var g=new mCR_SymbologyQRCode(false,j,i,h);g.drawPattern(a[d]);h.offsetRect(k+50,0);}this.elmChangeGroup.appendChild(j);}}};mCR_exportSVG.prototype.exportBarcode=function(g){var f=g.getRectInPage();var h=this.objDocument.getShapeStyle(g.shapeStyleKey);var a=this.objDocument.getBackgroundStyle(g.backgroundStyleKey);if((f.getWidth()!=0&&f.getHeight()!=0)){var c=this.paintShapeStyle(f,h);this.paintBackgroundStyle(f,a,c);c.setAttribute("stroke","none");this.elmChangeGroup.appendChild(c);var d=document.createElementNS("http://www.w3.org/2000/svg","g");this.barcodePainterDraw(d,g,f);this.elmChangeGroup.appendChild(d);if(this.isAccessibility&&null!=g.accessibilityString){var b={type:20,msg:g.accessibilityString};this.setWebLinkInfo(g.getRectInPage(),b);}}};mCR_exportSVG.prototype.exportChart=function(a){if(a.dataType=="png"){this.exportChartImage(a);}else{if(a.dataType=="doc"){this.exportChartDocument(a);}}if(this.isAccessibility&&null!=a.accessibilityString){var b={type:20,msg:a.accessibilityString};this.setWebLinkInfo(a.getRectInPage(),b);}};mCR_exportSVG.prototype.exportChartImage=function(a){var b=a.getRectInPage();if((b.getWidth()!=0&&b.getHeight()!=0)){var d=document.createElementNS("http://www.w3.org/2000/svg","image");d.setAttribute("x",(b.left/100)+"cm");d.setAttribute("y",(b.top/100)+"cm");d.setAttribute("width",(b.getWidth()/100)+"cm");d.setAttribute("height",(b.getHeight()/100)+"cm");d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","data:image/png;base64,"+a.svgString);this.pageImageCount++;var c=this;d.onload=function(){c.tempImageDrawCount++;if(c.pageImageCount<=c.tempImageDrawCount){if(null!=c.callFunction){c.callFunction();}c.callFunction=null;}};d.onerror=function(){window.console.log("chart image error url >> "+a.svgString);c.tempImageDrawCount++;if(c.pageImageCount<=c.tempImageDrawCount){if(null!=c.callFunction){c.callFunction();}c.callFunction=null;}};this.elmChangeGroup.appendChild(d);if(a.webLinkInfo!=null){if(a.webLinkInfo.type!=-1){this.setWebLinkInfo(a.getRectInPage(),a.webLinkInfo);}}}};mCR_exportSVG.prototype.exportChartDocument=function(a){var b=document.createElementNS("http://www.w3.org/2000/svg","g");b.setAttribute("id","chart");b.setAttribute("stroke","none");b.setAttribute("fill","none");this.elmChangeGroup.appendChild(b);var d=new mCR_exportChartPaintSvg(this,b,a.getRectInPage());var c=new mCR_exportChart(d,a.svgString);c.exportt();};mCR_exportSVG.prototype.exportVoiceEye=function(a){var b=a.getRectInPage();var c=a.svgString.trim();if((b.getWidth()!=0&&b.getHeight()!=0)&&""!=c){var f=document.createElementNS("http://www.w3.org/2000/svg","image");f.setAttribute("x",(b.left/100)+"cm");f.setAttribute("y",(b.top/100)+"cm");f.setAttribute("width",(b.getWidth()/100)+"cm");f.setAttribute("height",(b.getHeight()/100)+"cm");f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","data:image/png;base64,"+c);this.pageImageCount++;var d=this;f.onload=function(){d.tempImageDrawCount++;if(d.pageImageCount<=d.tempImageDrawCount){if(null!=d.callFunction){d.callFunction();}d.callFunction=null;}};f.onerror=function(){window.console.log("voiceEye image error url >> "+c);d.tempImageDrawCount++;if(d.pageImageCount<=d.tempImageDrawCount){if(null!=d.callFunction){d.callFunction();}d.callFunction=null;}};this.elmChangeGroup.appendChild(f);}};mCR_exportSVG.prototype.exportMarkAnyVoice=function(a){var b=a.getRectInPage();var c=a.svgString.trim();if((b.getWidth()!=0&&b.getHeight()!=0)&&""!=c){var f=document.createElementNS("http://www.w3.org/2000/svg","image");f.setAttribute("x",(b.left/100)+"cm");f.setAttribute("y",(b.top/100)+"cm");f.setAttribute("width",(b.getWidth()/100)+"cm");f.setAttribute("height",(b.getHeight()/100)+"cm");f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","data:image/png;base64,"+c);this.pageImageCount++;var d=this;f.onload=function(){d.tempImageDrawCount++;if(d.pageImageCount<=d.tempImageDrawCount){if(null!=d.callFunction){d.callFunction();}d.callFunction=null;}};f.onerror=function(){window.console.log("MarkAynVoice image error url >> "+c);d.tempImageDrawCount++;if(d.pageImageCount<=d.tempImageDrawCount){if(null!=d.callFunction){d.callFunction();}d.callFunction=null;}};this.elmChangeGroup.appendChild(f);}};mCR_exportSVG.prototype.exportReportControl=function(a){for(var b=0;b<a.subSectionList.length;b++){this.exportReportControlSubSection(a.subSectionList[b]);}for(var b=0;b<a.subSectionList.length;b++){this.exportControlsInSubSection(a.subSectionList[b]);}};mCR_exportSVG.prototype.exportCheckbox=function(a,h,d){var i=a.getRectInPage();var j=this.objDocument.getLineStyle(a.outterlineStyleKey);var f=this.objDocument.getShapeStyle(a.shapeStyleKey);if((null!=j&&null!=f)&&(i.getWidth()!=0&&i.getHeight()!=0)){var c=this.paintShapeStyle(i,f);this.paintLineStyle(j,c);h.appendChild(c);if(a.checkValue){var g=checkboxRevisePosition(i);var b=this.brushCheck(g,a.checkType,a.checkColor);h.appendChild(b);}if(this.isAccessibility&&!d&&null!=a.accessibilityString){var k={type:20,msg:a.accessibilityString};this.setWebLinkInfo(a.getRectInPage(),k);}}};mCR_exportSVG.prototype.exportShape=function(f){var d=f.getRectInPage();var b=this.objDocument.getLineStyle(f.outterlineStyleKey);var g=this.objDocument.getShapeStyle(f.shapeStyleKey);var a=this.objDocument.getBackgroundStyle(f.backgroundStyleKey);if((null!=b&&null!=g&&null!=a)&&(d.getWidth()!=0&&d.getHeight()!=0)&&(b.style!=0||a.backStyle!=1)){var c=this.paintShapeStyle(d,g);this.paintBackgroundStyle(d,a,c);this.paintLineStyle(b,c);this.elmChangeGroup.appendChild(c);}};mCR_exportSVG.prototype.exportLine=function(b){var c=b.getRectInPage();var a=this.objDocument.getLineStyle(b.lineStyleKey);if(null!=a&&a.style!=0){var d=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(a,d);d.setAttribute("x1",(c.left/100)+"cm");d.setAttribute("x2",(c.right/100)+"cm");d.setAttribute("y1",(c.top/100)+"cm");d.setAttribute("y2",(c.bottom/100)+"cm");this.lineDeduplication(c.left,c.top,c.right,c.bottom,a,d);this.elmChangeGroup.appendChild(d);}};mCR_exportSVG.prototype.paintBackgroundImageStyle=function(d,f,a,c){if("null"==a.filePath||0==a.imageWidth||0==a.imageHeight){return;}var b=f.imageDrawMethod;switch(b){case 1:this.imageOriginalSize(d,f,a,c);break;case 2:this.imageStretch(d,a,c);break;case 3:this.imageTile(d,f,a,c);break;case 4:this.imageZoom(d,f,a,c);break;case 5:this.imageShrink(d,f,a,c);break;}};mCR_exportSVG.prototype.paintBackgroundStyle=function(c,a,b){if(a.backStyle==1){return;}if(a.gradientStyle==0){switch(a.fillStyle){case 0:b.setAttribute("fill",mCR_getStrColor(a.backColor));break;case 1:this.patternHorizontalLine(a,b);break;case 2:this.patternVerticalLine(a,b);break;case 3:this.patternCrossLine(a,b);break;case 4:this.patternBackDiagonalLine(a,b);break;case 5:this.patternFrontDiagonalLine(a,b);break;case 6:this.patternCrossDiagonalLine(a,b);break;case 7:this.patternDotDensed(a,b);break;case 8:this.patternDot(a,b);break;case 9:this.patternDotRare(a,b);break;}}else{switch(a.gradientStyle){case 1:this.gradientTopBottom(c,a,b);break;case 2:this.gradientBottomTop(c,a,b);break;case 3:this.gradientLeftRight(c,a,b);break;case 4:this.gradientRightLeft(c,a,b);break;case 5:this.gradientRadial(c,a,b);break;case 6:this.gradientDiagonalF(c,a,b);break;case 7:this.gradientDiagonalB(c,a,b);break;}}};mCR_exportSVG.prototype.paintShapeStyle=function(b,c){var a=null;if(c.shapeType==1){a=document.createElementNS("http://www.w3.org/2000/svg","ellipse");a.setAttribute("cx",((b.left/100)+(b.getWidth()/200))+"cm");a.setAttribute("cy",((b.top/100)+(b.getHeight()/200))+"cm");a.setAttribute("rx",(b.getWidth()/200)+"cm");a.setAttribute("ry",(b.getHeight()/200)+"cm");}else{a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x",(b.left/100)+"cm");a.setAttribute("y",(b.top/100)+"cm");a.setAttribute("width",(b.getWidth()/100)+"cm");a.setAttribute("height",(b.getHeight()/100)+"cm");if(c.shapeType==2){a.setAttribute("rx",(c.roundRate/100)+"cm");a.setAttribute("ry",(c.roundRate/100)+"cm");}}return a;};mCR_exportSVG.prototype.paintLineStyle=function(a,c,d){if(typeof d=="undefined"){d=false;}if(a.style==0){c.setAttribute("stroke","none");return;}if(a.width>75||d){c.setAttribute("stroke-width",(a.width/100)+"pt");}if(a.color!=0){c.setAttribute("stroke",mCR_getStrColor(a.color));}var b=a.width>100?a.width/100:1;switch(a.style){case 2:c.setAttribute("stroke-dasharray",(4*b)+","+(2*b));break;case 3:c.setAttribute("stroke-dasharray",(1.333*b)+","+(1.333*b));break;case 4:c.setAttribute("stroke-dasharray",(4*b)+","+(2*b)+","+(1.333*b)+","+(2*b));break;case 5:c.setAttribute("stroke-dasharray",(4*b)+","+(2*b)+","+(1.333*b)+","+(2*b)+","+(1.333*b)+","+(2*b));break;case 7:case 9:c.setAttribute("stroke-width",((a.width*1.5)/100)+"pt");break;case 11:c.setAttribute("stroke-dasharray",(4*5/3*b)+","+(4*b));break;}};mCR_exportSVG.prototype.setDefaultGroupStyle=function(){this.elmChangeGroup.setAttribute("stroke-linecap","butt");this.elmChangeGroup.setAttribute("stroke-width","0.75pt");this.elmChangeGroup.setAttribute("stroke","rgb(0,0,0)");this.elmChangeGroup.setAttribute("fill","none");};mCR_exportSVG.prototype.makeTextGroup=function(a,c){var b=document.createElementNS("http://www.w3.org/2000/svg","g");var d=this.objDocument.getFontStyle(c);if(d!=null){if(d.bold){b.setAttribute("font-weight","bold");b.setAttribute("stroke",mCR_getStrColor(d.color));b.setAttribute("stroke-width","0.1");}else{b.setAttribute("stroke","none");}b.setAttribute("fill",mCR_getStrColor(d.color));if(d.italic){b.setAttribute("font-style","italic");}b.setAttribute("font-family",this.objDocument.getFontNameStyle(d.nameEngIndex)+","+this.objDocument.getFontNameStyle(d.nameIndex));b.setAttribute("font-size",d.size+"pt");if(d.underline||d.strike){}}return b;};mCR_exportSVG.prototype.paintText=function(c,j){if(j.getTextLineCount()>0){var s=j.getOriginalTextInfo().getFontStyleKey();var g=this.makeTextGroup(j,s);var c=c;var m=this.objDocument.getTextMarginStyle(j.getOriginalTextInfo().getTextMarginStyleKey());if(j.getUseMultiLanguage()||this.objDocument.getUseMultiLanguage()){c.setLeft(c.getLeft()+m.left);c.setRight(c.getRight()-m.right);c.setTop(c.getTop()+m.top);c.setBottom(c.getBottom()-m.bottom);var x=this.objDocument.getTextOptionStyle(j.getOriginalTextInfo().getTextOptionStyleKey());var a=x.getHorizontalAlignment();var r=x.getVerticalAlignment();var n=this.objDocument.getFontStyle(s);var l=c.getTop();var f=j.getHeight();if(mCR_VerticalAlignmentMethod.Bottom==r){l=c.getBottom()-f-(f*0.15);}else{if(mCR_VerticalAlignmentMethod.Center==r){l=(c.getBottom()+c.getTop()-f)/2;}}var b=j.getTextLineCount();for(var t=0;t<b;t++){var u=j.getTextLine(t);var w=c.getLeft();var v=l+u.getHeight();v+=u.getY();if(v<=c.getBottom()+(f*0.15)){var q=document.createElementNS("http://www.w3.org/2000/svg","text");if(n!=null){if(n.bold){q.setAttribute("font-weight","bold");q.setAttribute("stroke",mCR_getStrColor(n.color));q.setAttribute("stroke-width","0.1");}else{q.setAttribute("stroke","none");}q.setAttribute("fill",mCR_getStrColor(n.color));if(n.italic){q.setAttribute("font-style","italic");}q.setAttribute("font-family",decodeURIComponent(this.objDocument.getFontNameStyle(n.nameEngIndex))+","+decodeURIComponent(this.objDocument.getFontNameStyle(n.nameIndex)));q.setAttribute("font-size",n.size+"pt");}q.textContent=u.getText();var p=0;if(mCR_HorizontalAlignmentMethod.Right==a){p=this.getTextCanvasWidth(n,u);w=c.getRight()-p*254/96;}else{if(mCR_HorizontalAlignmentMethod.Middle==a){p=this.getTextCanvasWidth(n,u);w=(c.getRight()+c.getLeft()-p*254/96)/2;}}var k=j.getOriginalTextInfo().getCharDirection();if(k==0){}else{var d=1==k?true:false;if(d){q.setAttribute("direction","rtl");if(mCR_isIE){}else{w=c.getRight();if(mCR_HorizontalAlignmentMethod.Left==a){p=this.getTextCanvasWidth(n,u,true);w=c.getLeft()+p*254/96;}else{if(mCR_HorizontalAlignmentMethod.Middle==a){p=this.getTextCanvasWidth(n,u,true);w=c.getRight()-(c.getWidth()-p*254/96)/2;}}}}else{}}q.setAttribute("x",((w)/100)+"cm");q.setAttribute("y",((v)/100)+"cm");g.appendChild(q);}else{break;}}}else{var o=j.getOriginalTextInfo().getTextRotation();var h=c.getHeight();if(o==90){g.setAttribute("transform","rotate(270,"+c.getLeft()*0.378+","+c.getTop()*0.378+") translate("+c.getHeight()*0.378*(-1)+",0)");h=c.getWidth();}else{if(o==180){g.setAttribute("transform","rotate(180,"+c.getLeft()*0.378+","+c.getTop()*0.378+") translate("+c.getWidth()*0.378*(-1)+","+c.getHeight()*0.378*(-1)+")");}else{if(o==270){g.setAttribute("transform","rotate(90,"+c.getLeft()*0.378+","+c.getTop()*0.378+") translate(0,"+c.getWidth()*0.378*(-1)+")");h=c.getWidth();}}}this.drawTextLine(c,m,h,o,j,g,s);}return g;}else{return null;}};mCR_exportSVG.prototype.getTextCanvasWidth=function(h,g,f){if(this.elmCanvas==null){this.elmCanvas=document.createElement("canvas");}var c="";if(h.italic){c="italic ";}var d="";if(h.bold){d="bold ";}var b=this.elmCanvas.getContext("2d");if(f&&f!=null){b.direction="rtl";}else{b.direction="inherit";}b.font=c+d+h.size+"pt "+this.objDocument.getFontNameStyle(h.nameEngIndex);var a=g.getText();return b.measureText(a).width;};mCR_exportSVG.prototype.drawTextShape=function(l,d,a,j){var c=a.getTextShapeCount();var m=null;if(c!=0){m=document.createElementNS("http://www.w3.org/2000/svg","g");m.setAttribute("stroke-linecap","butt");m.setAttribute("stroke-width","0.75pt");m.setAttribute("stroke","rgb(0,0,0)");m.setAttribute("fill","none");}for(var h=0;h<c;h++){var b=a.getTextShape(h);var g=b.rect;var n=this.objDocument.getLineStyle(b.lineStyleKey);var k=b.shapeType;if(null!=n&&n.style!=0){if(k==0){var o=document.createElementNS("http://www.w3.org/2000/svg","line");this.paintLineStyle(n,o);o.setAttribute("x1",((g.getLeft()+l.getLeft())/100)+"cm");o.setAttribute("x2",((g.getWidth()+l.getLeft())/100)+"cm");o.setAttribute("y1",((l.getTop()+g.getTop())/100)+"cm");o.setAttribute("y2",((l.getTop()+g.getTop())/100)+"cm");m.appendChild(o);}else{if(k==2){var f=null;f=document.createElementNS("http://www.w3.org/2000/svg","rect");f.setAttribute("x",((g.getLeft()+l.getLeft())/100)+"cm");f.setAttribute("y",((l.getTop()+g.getTop())/100)+"cm");f.setAttribute("width",(g.getWidth()/100)+"cm");f.setAttribute("height",(g.getHeight()/100)+"cm");f.setAttribute("rx",(g.getWidth()/200)+"cm");f.setAttribute("ry",(g.getHeight()/200)+"cm");this.paintLineStyle(n,f,true);m.appendChild(f);}else{var f=null;f=document.createElementNS("http://www.w3.org/2000/svg","rect");f.setAttribute("x",((g.getLeft()+l.getLeft())/100)+"cm");f.setAttribute("y",((l.getTop()+g.getTop())/100)+"cm");f.setAttribute("width",(g.getWidth()/100)+"cm");f.setAttribute("height",(g.getHeight()/100)+"cm");this.paintLineStyle(n,f,true);m.appendChild(f);}}}}if(c!=0){j.appendChild(m);}};mCR_exportSVG.prototype.drawCharacter=function(h,a,b,f,g,k){var d=a.getCharacterCount();for(var c=0;c<d;c++){var l=a.getCharacter(c);var j=document.createElementNS("http://www.w3.org/2000/svg","text");if(g!=null){if(g.bold){j.setAttribute("font-weight","bold");j.setAttribute("stroke",mCR_getStrColor(g.color));j.setAttribute("stroke-width","0.1");}else{j.setAttribute("stroke","none");}j.setAttribute("fill",mCR_getStrColor(g.color));if(g.italic){j.setAttribute("font-style","italic");}j.setAttribute("font-family",decodeURIComponent(this.objDocument.getFontNameStyle(g.nameEngIndex))+","+decodeURIComponent(this.objDocument.getFontNameStyle(g.nameIndex)));j.setAttribute("font-size",g.size+"pt");}if(a.getIsSmallChar()){j.setAttribute("font-size",k.size*0.65+"pt");}else{if(a.getIsSup()||a.getIsSub()){j.setAttribute("font-size",k.size*0.5+"pt");}}j.setAttribute("x",((l.getX()+h.getLeft())/100)+"cm");j.setAttribute("y",((b)/100)+"cm");j.textContent=l.getCharacter();f.appendChild(j);}};mCR_exportSVG.prototype.adjustDescent=function(d,c,i){var h=d.getTop()+c.getY();var f=i.getIsSmallChar();var g=i.getIsSup();var b=i.getIsSub();var a=c.getHeight();if(g||b){a=a*0.5;if(b){h=h+a;}}else{if(f){a=a*0.65;h+=a;h=h-a*0.8;}}h=h+a-a*0.15;return h;};mCR_exportSVG.prototype.drawTextLine=function(j,d,l,m,c,h,g){var b=c.getTextLineCount();var k=this.objDocument.getFontStyle(g);for(var f=0;f<b;f++){var a=c.getTextLine(f);if(a.getY2()<=l+a.getHeight()*0.15||((m==0||m==180)&&f==0)){this.drawCharacterBatch(j,a,h,g,c,k);}this.drawTextShape(j,d,a,h);}};mCR_exportSVG.prototype.drawCharacterBatch=function(k,a,h,g,b,l){var m=a.getCharacterBatchCount();for(var f=0;f<m;f++){var c=a.getCharacterBatch(f);var j=null;if(c.getFontStyleKey()!=g){j=this.objDocument.getFontStyle(c.getFontStyleKey());}var d=this.adjustDescent(k,a,c);this.drawCharacter(k,c,d,h,j,l);}};mCR_exportSVG.prototype.lineDeduplication=function(c,g,i,a,d,h){var b=new Array();b.push(c);b.push(g);b.push(i);b.push(a);b.push(d.style);b.push(d.width);b.push(d.color);var j=b.join(",");var f=this.objLineHashMap[j];if(null!=f){f.parentNode.removeChild(f);}this.objLineHashMap[j]=h;};mCR_exportSVG.prototype.setWebLinkInfo=function(c,f){var d={rect:c,info:f};if(null!=f.ctrl){var a=c.toString();var b=this.objAccHashMap[a];if(null!=b){if(f.type==20){b.type=20;b.msg=b.msg+f.msg;return;}}else{this.objAccHashMap[a]=f;}}this.webLinkList.push(d);};mCR_exportSVG.prototype.setEditWebLinkInfo=function(b,c,a,f){var h=new docWebLinkInfo();h.type=1;h.editableIndex=f;h.editText=a.getOriginalTextInfo().text;h.objControl=b;var g=a.getOriginalTextInfo().getFontStyleKey();var i=this.objDocument.getFontStyle(g);h.fontStyle="font-size:"+i.size+"pt;font-family:"+this.objDocument.getFontNameStyle(i.nameEngIndex)+";";var d={rect:c,info:h};this.webLinkList.push(d);};mCR_exportSVG.prototype.setCheckEditWebLinkInfo=function(b,c,a,f,h){var g=new docWebLinkInfo();g.type=4;g.editableIndex=f;g.objControl=b;g.isChecked=h;var d={rect:c,info:g};this.webLinkList.push(d);};mCR_exportSVG.prototype.setInputControlInfo=function(b,a){var c={rect:b,info:{type:10,ctrlName:a}};this.webLinkList.push(c);};mCR_exportSVG.prototype.brushCheck=function(j,b,c){var g=null;switch(b){case 0:g=document.createElementNS("http://www.w3.org/2000/svg","polygon");var k="";var f=j.left*0.378;var l=j.right*0.378;var i=j.top*0.378;var a=j.bottom*0.378;var d=(l-f)/6;var m=(a-i)/6;k+=(f+(d*0))+","+(i+(d*2))+" ";k+=(f+(d*2))+","+(i+(d*4))+" ";k+=(f+(d*6))+","+(i+(d*0))+" ";k+=(f+(d*6))+","+(i+(d*2))+" ";k+=(f+(d*2))+","+(i+(d*6))+" ";k+=(f+(d*0))+","+(i+(d*4));g.setAttribute("points",k);break;case 1:g=document.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("x",(j.left/100)+"cm");g.setAttribute("y",(j.top/100)+"cm");g.setAttribute("width",(j.getWidth()/100)+"cm");g.setAttribute("height",(j.getHeight()/100)+"cm");break;case 2:g=document.createElementNS("http://www.w3.org/2000/svg","ellipse");g.setAttribute("cx",((j.left/100)+(j.getWidth()/200))+"cm");g.setAttribute("cy",((j.top/100)+(j.getHeight()/200))+"cm");g.setAttribute("rx",(j.getWidth()/200)+"cm");g.setAttribute("ry",(j.getHeight()/200)+"cm");break;case 3:g=document.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("x",(j.left/100)+"cm");g.setAttribute("y",(j.top/100)+"cm");g.setAttribute("width",(j.getWidth()/100)+"cm");g.setAttribute("height",(j.getHeight()/100)+"cm");var h=(((j.getWidth()/2)*0.3)/100);g.setAttribute("rx",h+"cm");g.setAttribute("ry",h+"cm");break;}g.setAttribute("fill",mCR_getStrColor(c));g.setAttribute("stroke","none");return g;};mCR_exportSVG.prototype.gradientTopBottom=function(f,b,d){var a=mCR_UUID();var c=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");c.setAttribute("id","gradient"+a);c.setAttribute("gradientUnits","userSpaceOnUse");c.setAttribute("spreadMethod","pad");c.setAttribute("x1",(f.left/100)+"cm");c.setAttribute("x2",(f.left/100)+"cm");c.setAttribute("y1",(f.top/100)+"cm");c.setAttribute("y2",(f.bottom/100)+"cm");var g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","0%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientStartColor));c.appendChild(g);g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","100%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientEndColor));c.appendChild(g);this.elmdefs.appendChild(c);d.setAttribute("fill","url(#gradient"+a+")");};mCR_exportSVG.prototype.gradientBottomTop=function(f,b,d){var a=mCR_UUID();var c=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");c.setAttribute("id","gradient"+a);c.setAttribute("gradientUnits","userSpaceOnUse");c.setAttribute("spreadMethod","pad");c.setAttribute("x1",(f.left/100)+"cm");c.setAttribute("x2",(f.left/100)+"cm");c.setAttribute("y1",(f.top/100)+"cm");c.setAttribute("y2",(f.bottom/100)+"cm");var g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","0%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientEndColor));c.appendChild(g);g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","100%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientStartColor));c.appendChild(g);this.elmdefs.appendChild(c);d.setAttribute("fill","url(#gradient"+a+")");};mCR_exportSVG.prototype.gradientLeftRight=function(f,b,d){var a=mCR_UUID();var c=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");c.setAttribute("id","gradient"+a);c.setAttribute("gradientUnits","userSpaceOnUse");c.setAttribute("spreadMethod","pad");c.setAttribute("x1",(f.left/100)+"cm");c.setAttribute("x2",(f.right/100)+"cm");c.setAttribute("y1",(f.top/100)+"cm");c.setAttribute("y2",(f.top/100)+"cm");var g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","0%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientStartColor));c.appendChild(g);g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","100%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientEndColor));c.appendChild(g);this.elmdefs.appendChild(c);d.setAttribute("fill","url(#gradient"+a+")");};mCR_exportSVG.prototype.gradientRightLeft=function(f,b,d){var a=mCR_UUID();var c=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");c.setAttribute("id","gradient"+a);c.setAttribute("gradientUnits","userSpaceOnUse");c.setAttribute("spreadMethod","pad");c.setAttribute("x1",(f.left/100)+"cm");c.setAttribute("x2",(f.right/100)+"cm");c.setAttribute("y1",(f.top/100)+"cm");c.setAttribute("y2",(f.top/100)+"cm");var g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","0%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientEndColor));c.appendChild(g);g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","100%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientStartColor));c.appendChild(g);this.elmdefs.appendChild(c);d.setAttribute("fill","url(#gradient"+a+")");};mCR_exportSVG.prototype.gradientDiagonalF=function(f,b,d){var a=mCR_UUID();var c=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");c.setAttribute("id","gradient"+a);c.setAttribute("gradientUnits","userSpaceOnUse");c.setAttribute("spreadMethod","pad");c.setAttribute("x1",(f.left/100)+"cm");c.setAttribute("x2",(f.right/100)+"cm");c.setAttribute("y1",(f.top/100)+"cm");c.setAttribute("y2",(f.bottom/100)+"cm");var g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","0%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientStartColor));c.appendChild(g);g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","100%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientEndColor));c.appendChild(g);this.elmdefs.appendChild(c);d.setAttribute("fill","url(#gradient"+a+")");};mCR_exportSVG.prototype.gradientDiagonalB=function(f,b,d){var a=mCR_UUID();var c=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");c.setAttribute("id","gradient"+a);c.setAttribute("gradientUnits","userSpaceOnUse");c.setAttribute("spreadMethod","pad");c.setAttribute("x1",(f.right/100)+"cm");c.setAttribute("x2",(f.left/100)+"cm");c.setAttribute("y1",(f.top/100)+"cm");c.setAttribute("y2",(f.bottom/100)+"cm");var g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","0%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientStartColor));c.appendChild(g);g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","100%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientEndColor));c.appendChild(g);this.elmdefs.appendChild(c);d.setAttribute("fill","url(#gradient"+a+")");};mCR_exportSVG.prototype.gradientRadial=function(f,b,d){var a=mCR_UUID();var c=document.createElementNS("http://www.w3.org/2000/svg","radialGradient");c.setAttribute("id","gradient"+a);c.setAttribute("spreadMethod","pad");c.setAttribute("color-interpolation","sRGB");c.setAttribute("fx","50%");c.setAttribute("fy","50%");c.setAttribute("r","65%");var g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","0%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientStartColor));c.appendChild(g);g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("stop-opacity","1");g.setAttribute("offset","100%");g.setAttribute("stop-color",mCR_getStrColor(b.gradientEndColor));c.appendChild(g);this.elmdefs.appendChild(c);d.setAttribute("fill","url(#gradient"+a+")");};mCR_exportSVG.prototype.patternHorizontalLine=function(d,g){var c=0.18;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",c+"cm");f.setAttribute("height",c+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",c+"cm");a.setAttribute("height",c+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1","0cm");h.setAttribute("x2",c+"cm");h.setAttribute("y1",(c/2)+"cm");h.setAttribute("y2",(c/2)+"cm");f.appendChild(h);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.patternVerticalLine=function(d,g){var c=0.18;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",c+"cm");f.setAttribute("height",c+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",c+"cm");a.setAttribute("height",c+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1",(c/2)+"cm");h.setAttribute("x2",(c/2)+"cm");h.setAttribute("y1","0cm");h.setAttribute("y2",c+"cm");f.appendChild(h);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.patternCrossLine=function(d,g){var c=0.18;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",c+"cm");f.setAttribute("height",c+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",c+"cm");a.setAttribute("height",c+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1",(c/2)+"cm");h.setAttribute("x2",(c/2)+"cm");h.setAttribute("y1","0cm");h.setAttribute("y2",c+"cm");f.appendChild(h);h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1","0cm");h.setAttribute("x2",c+"cm");h.setAttribute("y1",(c/2)+"cm");h.setAttribute("y2",(c/2)+"cm");f.appendChild(h);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.patternBackDiagonalLine=function(d,g){var c=0.18;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",c+"cm");f.setAttribute("height",c+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",c+"cm");a.setAttribute("height",c+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1","0cm");h.setAttribute("x2",c+"cm");h.setAttribute("y1","0cm");h.setAttribute("y2",c+"cm");f.appendChild(h);h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1",c+"cm");h.setAttribute("x2",c+"cm");h.setAttribute("y1","0cm");h.setAttribute("y2","0cm");f.appendChild(h);h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1","0cm");h.setAttribute("x2","0cm");h.setAttribute("y1",c+"cm");h.setAttribute("y2",c+"cm");f.appendChild(h);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.patternFrontDiagonalLine=function(d,g){var c=0.18;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",c+"cm");f.setAttribute("height",c+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",c+"cm");a.setAttribute("height",c+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1",c+"cm");h.setAttribute("x2","0cm");h.setAttribute("y1","0cm");h.setAttribute("y2",c+"cm");f.appendChild(h);h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1","0cm");h.setAttribute("x2","0cm");h.setAttribute("y1","0cm");h.setAttribute("y2","0cm");f.appendChild(h);h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1",c+"cm");h.setAttribute("x2",c+"cm");h.setAttribute("y1",c+"cm");h.setAttribute("y2",c+"cm");f.appendChild(h);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.patternCrossDiagonalLine=function(d,g){var c=0.18;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",c+"cm");f.setAttribute("height",c+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",c+"cm");a.setAttribute("height",c+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1",c+"cm");h.setAttribute("x2","0cm");h.setAttribute("y1","0cm");h.setAttribute("y2",c+"cm");f.appendChild(h);h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("stroke",mCR_getStrColor(d.fillColor));h.setAttribute("stroke-width","0.75pt");h.setAttribute("x1","0cm");h.setAttribute("x2",c+"cm");h.setAttribute("y1","0cm");h.setAttribute("y2",c+"cm");f.appendChild(h);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.patternDotDensed=function(d,g){var c=0.08;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",(c)+"cm");f.setAttribute("height",(c)+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",(c)+"cm");a.setAttribute("height",(c)+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width","1");a.setAttribute("height","1");a.setAttribute("fill",mCR_getStrColor(d.fillColor));f.appendChild(a);a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x",(c/2)+"cm");a.setAttribute("y",(c/2)+"cm");a.setAttribute("width","1");a.setAttribute("height","1");a.setAttribute("fill",mCR_getStrColor(d.fillColor));f.appendChild(a);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.patternDot=function(d,g){var c=0.14;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",(c)+"cm");f.setAttribute("height",(c)+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",(c)+"cm");a.setAttribute("height",(c)+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width","1");a.setAttribute("height","1");a.setAttribute("fill",mCR_getStrColor(d.fillColor));f.appendChild(a);a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x",(c/2)+"cm");a.setAttribute("y",(c/2)+"cm");a.setAttribute("width","1");a.setAttribute("height","1");a.setAttribute("fill",mCR_getStrColor(d.fillColor));f.appendChild(a);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.patternDotRare=function(d,g){var c=0.2;var b=mCR_UUID();var f=document.createElementNS("http://www.w3.org/2000/svg","pattern");f.setAttribute("id","pattern"+b);f.setAttribute("x","0cm");f.setAttribute("y","0cm");f.setAttribute("width",(c)+"cm");f.setAttribute("height",(c)+"cm");f.setAttribute("patternUnits","userSpaceOnUse");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width",(c)+"cm");a.setAttribute("height",(c)+"cm");a.setAttribute("fill",mCR_getStrColor(d.backColor));f.appendChild(a);var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0cm");a.setAttribute("y","0cm");a.setAttribute("width","1");a.setAttribute("height","1");a.setAttribute("fill",mCR_getStrColor(d.fillColor));f.appendChild(a);a=document.createElementNS("http://www.w3.org/2000/svg","rect");elmShape.setAttribute("x",(rect.left/100)+"cm");elmShape.setAttribute("y",(rect.top/100)+"cm");elmShape.setAttribute("width",(rect.getWidth()/100)+"cm");elmShape.setAttribute("height",(rect.getHeight()/100)+"cm");a.setAttribute("fill",mCR_getStrColor(d.fillColor));f.appendChild(a);this.elmdefs.appendChild(f);g.setAttribute("fill","url(#pattern"+b+")");};mCR_exportSVG.prototype.imageTile=function(h,f,d,g){var c=mCR_UUID();d.dpiX=d.dpiX>1?d.dpiX:96;d.dpiY=d.dpiY>1?d.dpiY:96;var i=(d.imageWidth/d.dpiX)*96;var j=(d.imageHeight/d.dpiY)*96;i=i*(f.rate/100);j=j*(f.rate/100);var l=document.createElementNS("http://www.w3.org/2000/svg","pattern");l.setAttribute("id","pattern"+c);l.setAttribute("x",(h.left/100)+"cm");l.setAttribute("y",(h.top/100)+"cm");l.setAttribute("width",i+"");l.setAttribute("height",j+"");l.setAttribute("patternUnits","userSpaceOnUse");var k=mCR_makeImageURL(this.objDocument,d.filePath);var b=document.createElementNS("http://www.w3.org/2000/svg","image");b.setAttribute("x","0");b.setAttribute("y","0");b.setAttribute("width",i+"");b.setAttribute("height",j+"");b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",k);b.setAttribute("preserveAspectRatio","none");this.pageImageCount++;var a=this;b.onload=function(){a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};b.onerror=function(){window.console.log("img image error url >> "+k);a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};l.appendChild(b);this.elmdefs.appendChild(l);g.setAttribute("fill","url(#pattern"+c+")");};mCR_exportSVG.prototype.imageStretch=function(f,a,d){var b=mCR_UUID();var c=mCR_makeImageURL(this.objDocument,a.filePath);var h=document.createElementNS("http://www.w3.org/2000/svg","image");h.setAttribute("x",(f.left/100)+"cm");h.setAttribute("y",(f.top/100)+"cm");h.setAttribute("width",(f.getWidth()/100)+"cm");h.setAttribute("height",(f.getHeight()/100)+"cm");h.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);h.setAttribute("preserveAspectRatio","none");this.pageImageCount++;var g=this;h.onload=function(){g.tempImageDrawCount++;if(g.pageImageCount<=g.tempImageDrawCount){if(null!=g.callFunction){g.callFunction();}g.callFunction=null;}};h.onerror=function(){window.console.log("img image error url >> "+c);g.tempImageDrawCount++;if(g.pageImageCount<=g.tempImageDrawCount){if(null!=g.callFunction){g.callFunction();}g.callFunction=null;}};this.elmChangeGroup.appendChild(h);};mCR_exportSVG.prototype.imageNotPatternOriginalSize=function(j,f,d,i){var n=0;var h=0;d.dpiX=d.dpiX>1?d.dpiX:96;d.dpiY=d.dpiY>1?d.dpiY:96;var k=(d.imageWidth/d.dpiX)*96;var l=(d.imageHeight/d.dpiY)*96;k=k*(f.rate/100);l=l*(f.rate/100);if(f.horizontalAlignment==1){var c=(j.getWidth()*0.378);if(c>k){n=(c-k)/2;}}else{if(f.horizontalAlignment==2){var c=(j.getWidth()*0.378);if(c>k){n=c-k;}}}if(f.verticalAlignment==1){var g=(j.getHeight()*0.378);if(g>l){h=(g-l)/2;}}else{if(f.verticalAlignment==2){var g=(j.getHeight()*0.378);if(g>l){h=(g-l);}}}var m=mCR_makeImageURL(this.objDocument,d.filePath);var b=document.createElementNS("http://www.w3.org/2000/svg","image");b.setAttribute("x",(n+(j.left*0.378))+"");b.setAttribute("y",(h+(j.top*0.378))+"");b.setAttribute("width",k+"");b.setAttribute("height",l+"");b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);this.pageImageCount++;var a=this;b.onload=function(){a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};b.onerror=function(){window.console.log("img image error url >> "+m);a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};this.elmChangeGroup.appendChild(b);};mCR_exportSVG.prototype.imageOriginalSize=function(m,g,f,j){if(mCR_checkImageRect(m,g,f)){this.imageNotPatternOriginalSize(m,g,f,j);return;}var c=mCR_UUID();var o=document.createElementNS("http://www.w3.org/2000/svg","pattern");o.setAttribute("id","pattern"+c);o.setAttribute("x",(m.left/100)+"cm");o.setAttribute("y",(m.top/100)+"cm");o.setAttribute("width",(m.getWidth()/100)+"cm");o.setAttribute("height",(m.getHeight()/100)+"cm");o.setAttribute("patternUnits","userSpaceOnUse");var p=0;var i=0;f.dpiX=f.dpiX>1?f.dpiX:96;f.dpiY=f.dpiY>1?f.dpiY:96;var l=(f.imageWidth/f.dpiX)*96;var k=(f.imageHeight/f.dpiY)*96;l=l*(g.rate/100);k=k*(g.rate/100);if(g.horizontalAlignment==1){var d=(m.getWidth()*0.378);if(d>l){p=(d-l)/2;}}else{if(g.horizontalAlignment==2){var d=(m.getWidth()*0.378);if(d>l){p=d-l;}}}if(g.verticalAlignment==1){var h=(m.getHeight()*0.378);if(h>k){i=(h-k)/2;}}else{if(g.verticalAlignment==2){var h=(m.getHeight()*0.378);if(h>k){i=(h-k);}}}var n=mCR_makeImageURL(this.objDocument,f.filePath);var b=document.createElementNS("http://www.w3.org/2000/svg","image");b.setAttribute("x",p+"");b.setAttribute("y",i+"");b.setAttribute("width",l+"");b.setAttribute("height",k+"");b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);this.pageImageCount++;var a=this;b.onload=function(){a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};b.onerror=function(){window.console.log("img image error url >> "+n);a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};o.appendChild(b);this.elmdefs.appendChild(o);j.setAttribute("fill","url(#pattern"+c+")");};mCR_exportSVG.prototype.imageZoom=function(o,g,f,l){var d=(o.getWidth()*0.378);var j=(o.getHeight()*0.378);var q=0;var k=0;f.dpiX=f.dpiX>1?f.dpiX:96;f.dpiY=f.dpiY>1?f.dpiY:96;var n=(f.imageWidth/f.dpiX)*96;var m=(f.imageHeight/f.dpiY)*96;var c=n/m;var h=d/j;if(c>h){var i=m/n;m=d*i;n=d;if(g.verticalAlignment==1){if(j>m){k=(j-m)/2;}}else{if(g.verticalAlignment==2){if(j>m){k=(j-m);}}}}else{var i=n/m;n=j*i;m=j;if(g.horizontalAlignment==1){if(d>n){q=(d-n)/2;}}else{if(g.horizontalAlignment==2){if(d>n){q=d-n;}}}}var p=mCR_makeImageURL(this.objDocument,f.filePath);var b=document.createElementNS("http://www.w3.org/2000/svg","image");b.setAttribute("x",(q+(o.left*0.378))+"");b.setAttribute("y",(k+(o.top*0.378))+"");b.setAttribute("width",n+"");b.setAttribute("height",m+"");b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);this.pageImageCount++;var a=this;b.onload=function(){a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};b.onerror=function(){window.console.log("img image error url >> "+p);a.tempImageDrawCount++;if(a.pageImageCount<=a.tempImageDrawCount){if(null!=a.callFunction){a.callFunction();}a.callFunction=null;}};this.elmChangeGroup.appendChild(b);};mCR_exportSVG.prototype.imageShrink=function(c,d,a,b){if(mCR_checkImageRect(c,d,a)){this.imageNotPatternOriginalSize(c,d,a,b);}else{this.imageZoom(c,d,a,b);}};function mCR_checkImageRect(g,h,b){var f=(g.getWidth()*0.378);var d=(g.getHeight()*0.378);b.dpiX=b.dpiX>1?b.dpiX:96;b.dpiY=b.dpiY>1?b.dpiY:96;var c=(b.imageWidth/b.dpiX)*96;var a=(b.imageHeight/b.dpiY)*96;c=c*(h.rate/100);a=a*(h.rate/100);if(f>=c&&d>=a){return true;}else{return false;}}function mCR_makeImageURL(f,d){var g={image:d,reportkey:f.reportKey};var c=f.reportServerPath;var h="?";if(c.indexOf("?")!=-1){h="&";}var a=h+"uid="+f.reportKey+"&clipUID="+f.reportKey+"&ClipType=exportViewImage&ClipData="+encodeURIComponent(JSON.stringify(g));var b=f.reportServerPath+a;return b;}function mCR_makeImageSendData(c,b){var d={image:b,reportkey:c.reportKey};var a="uid="+c.reportKey+"&clipUID="+c.reportKey+"&ClipType=exportViewImageBase64&ClipData="+encodeURIComponent(JSON.stringify(d));return a;}function mCR_getStrColor(d){var c=d&255;var b=(d>>8)&255;var a=(d>>16)&255;return"rgb("+c+","+b+","+a+")";}function mCR_UUID(){function a(){return((1+Math.random())*65536|0).toString(16).substring(1);}return a()+a()+a()+a()+a()+a()+a()+a();}mCR_exportSVG.prototype.barcodePainterDraw=function(c,d,b){var a=null;switch(d.barcodeSymbology){case 1:a=new mCR_SymbologyCode39(false,c,d,b);break;case 2:a=new mCR_SymbologyCode39A(false,c,d,b);break;case 3:a=new mCR_SymbologyCode93(false,c,d,b);break;case 4:a=new mCR_SymbologyCode93A(false,c,d,b);break;case 5:a=new mCR_SymbologyCodaBar(false,c,d,b);break;case 6:a=new mCR_SymbologyCode11(false,c,d,b);break;case 10:a=new mCR_SymbologyCode128(false,c,d,b);break;case 11:a=new mCR_SymbologyCode128A(false,c,d,b);break;case 12:a=new mCR_SymbologyCode128B(false,c,d,b);break;case 13:a=new mCR_SymbologyCode128C(false,c,d,b);break;case 15:a=new mCR_Symbology2of5IATA(false,c,d,b);break;case 16:a=new mCR_Symbology2of5Matrix(false,c,d,b);break;case 17:a=new mCR_Symbology2of5Industrial(false,c,d,b);break;case 18:a=new mCR_Symbology2of5Interleaved(false,c,d,b);break;case 20:a=new mCR_SymbologyEAN8(false,c,d,b);break;case 21:a=new mCR_SymbologyEAN13(false,c,d,b);break;case 40:a=new mCR_SymbologyKoreanPostalCode(false,c,d,b);break;case 50:a=new mCR_SymbologyQRCode(false,c,d,b);break;case 51:a=new mCR_SymbologyDataMatrix(false,c,d,b);break;case 52:a=new mCR_SymbologyPDF417(false,c,d,b);break;}if(null!=a){a.drawBarcode();}};function mCR_ServerImageCall(b,j,f){if("null"==f){return;}if(null==window.objClipClientPaintConnection||window.objClipClientPaintConnection=="get"){var i=mCR_makeImageURL(b.objDocument,f);var g=new Image();g.src=i;j.imageKey=b.pageImageList.length;b.pageImageList.push(g);g.onload=function(){b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};g.onerror=function(){window.console.log("image error url >> "+i);j.imageKey=-1;b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};}else{if(window.objClipClientPaintConnection.toLocaleLowerCase()=="post"){var c=m_reportHashMap[b.objDocument.reportKey];if(null!=c){var h=c.getProperty(f);if(null!=h){if(typeof h==="string"){var g=new Image();g.src="data:image/png;base64,"+h;j.imageKey=b.pageImageList.length;b.pageImageList.push(g);g.onload=function(){b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};}else{j.imageKey=h;}return;}}j.imageKey=b.pageImageList.length;b.pageImageList.push(null);if(null!=c){c.setProperty(f,j.imageKey);}var d=mCR_makeImageSendData(b.objDocument,f);var a=b.objDocument.reportServerPath;$.ajax({type:"POST",url:a,data:d,success:function(k){try{var n=jQuery.parseJSON(k);if(null!=n){if(n.resValue.status){var l=new Image();l.src="data:image/png;base64,"+n.resValue.viewData;b.pageImageList[j.imageKey]=l;c.setProperty(f,n.resValue.viewData);l.onload=function(){b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};}else{window.console.log("image server error code >> "+n.resValue.event);window.console.log("image ID >> "+f);b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}}}}catch(m){window.console.log("image server json code error >> "+k);window.console.log("image ID >> "+f);b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}}},error:function(k){window.console.log("image connection error >> "+k);window.console.log("image ID >> "+f);b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}}});}}}function mCR_exportSVGForEForm(b,a,c){mCR_exportSVG.call(this,b,a);this.elmEFormLayoutDiv=c;this.elmLayoutTag=null;this.elmLayoutButton=null;this.pageEFormControlIDList=new Array();}mCR_exportSVGForEForm.prototype=Object.create(mCR_exportSVG.prototype);mCR_exportSVGForEForm.prototype.constructor=mCR_exportSVGForEForm;mCR_exportSVGForEForm.prototype.exportPageEFom=function(c,b,a,d){this.pageEFormControlIDList=a;return this.exportPage(c,b,d);};mCR_exportSVGForEForm.prototype.startPage=function(){this.objPageStyle=this.objDocument.getPageStyle(this.objDocumentPage.pageStyleKey);if(this.isEasyInput){var o=new docStylePage();o.paperType=this.objPageStyle.orientation;o.width=0;o.height=0;o.orientation=this.objPageStyle.orientation;o.leftMargin=0;o.topMargin=0;o.rightMargin=0;o.bottomMargin=0;o.pageCount=1;o.multiColumnDirection=this.objPageStyle.multiColumnDirection;for(var k=0;k<this.objDocumentPage.subSectionList.length;k++){var r=this.objDocumentPage.subSectionList[k];if(!r.isDrilling){var m=r.area.getHeight();r.area.top=o.height;o.height+=m;r.area.bottom=o.height;var f=r.area.getWidth();r.area.left=0;r.area.right=f;if(o.width<f){o.width=f;}}}this.objPageStyle=o;}this.elmSVG=document.createElementNS("http://www.w3.org/2000/svg","svg");this.elmSVG.setAttribute("fill-opacity","1");this.elmSVG.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");this.elmSVG.setAttribute("xmlns","http://www.w3.org/2000/svg");this.elmSVG.setAttribute("color-rendering","auto");this.elmSVG.setAttribute("color-interpolation","auto");this.elmSVG.setAttribute("text-interpolation","auto");this.elmSVG.setAttribute("stroke-linecap","square");this.elmSVG.setAttribute("stroke-miterlimit","10");this.elmSVG.setAttribute("stroke-opacity","1");this.elmSVG.setAttribute("shape-rendering","auto");this.elmSVG.setAttribute("stroke-dasharray","none");this.elmSVG.setAttribute("stroke-linejoin","miter");this.elmSVG.setAttribute("stroke-dashoffset","0");this.elmSVG.setAttribute("image-rendering","auto");this.elmSVG.setAttribute("style","overflow:hidden");this.elmSVG.setAttribute("width",(this.objPageStyle.width/100)+"cm");this.elmSVG.setAttribute("height",(this.objPageStyle.height/100)+"cm");this.elmBodyGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmBodyGroup.setAttribute("transform","scale(1) translate(0,0)");this.elmdefs=document.createElementNS("http://www.w3.org/2000/svg","defs");this.elmBodyGroup.appendChild(this.elmdefs);var l=document.createElementNS("http://www.w3.org/2000/svg","g");l.setAttribute("fill","white");l.setAttribute("stroke","white");var b=document.createElementNS("http://www.w3.org/2000/svg","rect");b.setAttribute("x","0");b.setAttribute("y","0");b.setAttribute("width",(this.objPageStyle.width/100)+"cm");b.setAttribute("height",(this.objPageStyle.height/100)+"cm");b.setAttribute("stroke","none");var q=this.objPageStyle.width*this.nPixelRate;var d=this.objPageStyle.height*this.nPixelRate;this.objDocumentPage.width=this.objPageStyle.width;this.objDocumentPage.height=this.objPageStyle.height;l.appendChild(b);this.elmBodyGroup.appendChild(l);this.elmSVG.appendChild(this.elmBodyGroup);this.objLineHashMap=function(){};this.objAccHashMap=function(){};this.elmEFormLayoutDiv.style.cssText="position:relative;background-color:transparent;display:inline-block;width:"+q+"px;height:"+d+"px;";this.elmLayoutTagP=document.createElement("div");this.elmLayoutTagP.style.position="absolute";if(this.isEasyInput){this.elmLayoutTagP.style.left=(this.objPageStyle.leftMargin*this.nPixelRate)+"px";this.elmLayoutTagP.style.right=(this.objPageStyle.rightMargin*this.nPixelRate)+"px";this.elmLayoutTagP.style.top=(this.objPageStyle.topMargin*this.nPixelRate)+"px";this.elmLayoutTagP.style.bottom=(this.objPageStyle.bottomMargin*this.nPixelRate)+"px";}else{this.elmLayoutTagP.style.left="0px";this.elmLayoutTagP.style.right="0px";this.elmLayoutTagP.style.top="0px";this.elmLayoutTagP.style.bottom="0px";}this.elmLayoutTagP.setAttribute("role","text");var a="문서 전체영역 입니다.";if(""!=this.objDocument.title){a=this.objDocument.title;a=a.replace(/\'/g,"작은따옴표");a=a.replace(/\"/g,"큰따옴표");}this.elmLayoutTagP.setAttribute("aria-label",a);var g=new Array();g.push("<style type='text/css'>");g.push(".r_F_S{position:absolute;border:0px solid black !important;padding:0 0 0 0 !important;margin:0 0 0 0 !important;}");mCR_getFontCss(g,this.objDocument.styleManager.fontList,this.objDocument);g.push("</style>");this.elmLayoutTagP.innerHTML=g.join("");this.elmEFormLayoutDiv.appendChild(this.elmLayoutTagP);var p=document.createElement("div");p.id=this.objDocument.reportKey+"memo";p.style.cssText="position:absolute;overflow:hidden;left:0px;top:0px;right:0px;bottom:0px;background-color:rgba(255,255,255,0);";this.elmEFormLayoutDiv.appendChild(p);var i=document.createElement("div");i.id=this.objDocument.reportKey+"doodle";i.style.cssText="position:absolute;overflow:hidden;left:0px;top:0px;right:0px;bottom:0px;background-color:rgba(255,255,255,0);";i.innerHTML='<svg height="100%" version="1.1" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="overflow: hidden; position: relative; shape-rendering: optimizeSpeed;"></svg>';this.elmEFormLayoutDiv.appendChild(i);this.elmLayoutButtonP=document.createElement("div");this.elmLayoutButtonP.style.position="absolute";if(this.isEasyInput){this.elmLayoutButtonP.style.left=(this.objPageStyle.leftMargin*this.nPixelRate)+"px";this.elmLayoutButtonP.style.right=(this.objPageStyle.rightMargin*this.nPixelRate)+"px";this.elmLayoutButtonP.style.top=(this.objPageStyle.topMargin*this.nPixelRate)+"px";this.elmLayoutButtonP.style.bottom=(this.objPageStyle.bottomMargin*this.nPixelRate)+"px";}else{this.elmLayoutButtonP.style.left="0px";this.elmLayoutButtonP.style.right="0px";this.elmLayoutButtonP.style.top="0px";this.elmLayoutButtonP.style.bottom="0px";}var c=document.createElement("div");c.id=this.objDocument.reportKey+"IndexOrder";c.className="eform_IndexOrder";var h=document.createElement("div");h.id=this.objDocument.reportKey+"IO_in";h.className="eform_IndexOrder_inner";var n=document.createElement("button");n.tabIndex="-1";n.className="eform_IndexOrder_left";var j=document.createElement("button");j.tabIndex="-1";j.className="eform_IndexOrder_right";h.appendChild(n);h.appendChild(j);this.elmLayoutButtonP.appendChild(c);this.elmLayoutButtonP.appendChild(h);this.elmEFormLayoutDiv.appendChild(this.elmLayoutButtonP);};mCR_exportSVGForEForm.prototype.exportControlsInSubSection=function(g){if(this.isEasyInput){this.elmLayoutTag=document.createElement("div");this.elmLayoutButton=document.createElement("div");if(g.isDrilling){this.elmLayoutTag.style.display="none";this.elmLayoutButton.style.display="none";}this.elmLayoutTagP.appendChild(this.elmLayoutTag);this.elmLayoutButtonP.appendChild(this.elmLayoutButton);var b=g.area.newRateRect(this.nPixelRate);this.elmLayoutTag.style.position=this.elmLayoutButton.style.position="relative";this.elmLayoutTag.style.top=this.elmLayoutButton.style.top="0px";this.elmLayoutTag.style.left=this.elmLayoutButton.style.left="0px";this.elmLayoutTag.style.width=this.elmLayoutButton.style.width=b.getWidth()+"px";this.elmLayoutTag.style.height=this.elmLayoutButton.style.height=b.getHeight()+"px";this.elmLayoutTag.id=this.elmLayoutButton.id=g.editEasyModeId;}else{this.elmLayoutTag=this.elmLayoutTagP;this.elmLayoutButton=this.elmLayoutButtonP;}for(var c=0;c<g.controlPageList.length;c++){var a=g.controlPageList[c];var f=true;if(-1!=a.visibleOptionStyleKey){var d=this.objDocument.getVisibleOptionStyle(a.visibleOptionStyleKey);if(null!=d){if(this.isPrint){f=d.toPrint;}else{f=d.toView;}}}if(f){this.exportControl(a);}}};mCR_exportSVGForEForm.prototype.exportReportControl=function(d){if(this.isEasyInput){var b=this.elmLayoutTagP;var i=this.elmLayoutButtonP;var j=this.elmLayoutTag;var f=this.elmLayoutButton;var a=d.rect.newRateRect(this.nPixelRate);var h=document.createElement("div");var c=document.createElement("div");h.style.position=c.style.position="absolute";h.style.top=c.style.top=a.top+"px";h.style.left=c.style.left=a.left+"px";h.style.width=c.style.width=a.getWidth()+"px";h.style.height=c.style.height=a.getHeight()+"px";this.elmLayoutTag.appendChild(h);this.elmLayoutButton.appendChild(c);this.elmLayoutTagP=h;this.elmLayoutButtonP=c;}for(var g=0;g<d.subSectionList.length;g++){this.exportReportControlSubSection(d.subSectionList[g]);}for(var g=0;g<d.subSectionList.length;g++){this.exportControlsInSubSection(d.subSectionList[g]);}if(this.isEasyInput){this.elmLayoutTagP=b;this.elmLayoutButtonP=i;this.elmLayoutTag=j;this.elmLayoutButton=f;}};mCR_exportSVGForEForm.prototype.exportInputCheckbox=function(q){var b=null;if(this.isEasyInput){b=q.rect;}else{b=q.getRectInPage();}var r=q.checkSize;this.pageEFormControlIDList.push(q.primaryName);var a=this.objDocument.documentStorage[q.primaryName];if(null!=a){var d=b.getHeight()-r;var k=this.objDocument.getLineStyle(q.outterlineStyleKey);var i=this.objDocument.getShapeStyle(q.shapeStyleKey);var g=this.objDocument.getBackgroundStyle(q.backgroundStyleKey);var l=a.imageType=="check"?"CHECK":"RADIO";l=null==q.accessibilityString?l:q.accessibilityString;var c=document.createElement("div");c.style.cssText="position:absolute;overflow:hidden;";c.style.left=(b.left*this.nPixelRate)+"px";c.style.top=(b.top*this.nPixelRate)+"px";c.style.width=(b.getWidth()*this.nPixelRate)+"px";c.style.height=(b.getHeight()*this.nPixelRate)+"px";var m=document.createElement("div");m.id=this.objDocument.reportKey+q.primaryName+"DIV";m.className="eF_Rect";if(g.backStyle==0){m.style.cssText="background-color:"+mCR_changeRGBAColor(g.backColor,q.guideTransparency);}var h=document.createElement("img");h.id=this.objDocument.reportKey+q.primaryName+"IMG";h.tabIndex="-1";var p="position:absolute;";if(q.useText){p+="left:0.009cm;top:"+((d/2)/100)+"cm;width:"+(r/100)+"cm;height:"+(r/100)+"cm;";}else{p+="left:0cm;top:0cm;width:100%;height:100%;";}if(r<1){p+="visibility:hidden;";}if(i.shapeType==1){p+="border-radius: 100%;";}if(k.style!=0){p+="border:"+mCR_getLineStyleTag(k);}p+="box-sizing: border-box;";h.style.cssText=p;var o=document.createElement("div");o.id=this.objDocument.reportKey+q.primaryName+"FOCUS";o.className="eF_Rect";c.appendChild(m);c.appendChild(h);c.appendChild(o);if(q.useText){var n=document.createElement("span");n.tabIndex="-1";n.style.left=(r/100)+"cm";n.className="s_"+this.objDocument.reportKey+q.textInfo.getOriginalTextInfo().fontStyleKey+" eF_Rect";var j=new docRect();j.copyRect(b);j.left+=r;var f=mRe_createCheckboxTextSvg(j,q.textInfo,this.objDocument);n.innerHTML=f;c.appendChild(n);}this.elmLayoutTag.appendChild(c);var s=document.createElement("button");s.tabIndex="0";s.className="eForm_hidden_button";s.id=this.objDocument.reportKey+q.primaryName;s.title=l;s.style.cssText="position:absolute;overflow:hidden;";s.style.left=(b.left*this.nPixelRate)+"px";s.style.top=(b.top*this.nPixelRate)+"px";if(q.selectArea==0&&q.useText){s.style.width=((r+5)*this.nPixelRate)+"px";}else{s.style.width=(b.getWidth()*this.nPixelRate)+"px";}s.style.height=(b.getHeight()*this.nPixelRate)+"px";s.innerHTML=l;this.elmLayoutButton.appendChild(s);}};mCR_exportSVGForEForm.prototype.exportInputImage=function(m){var i=null;if(this.isEasyInput){i=m.rect;}else{i=m.getRectInPage();}this.pageEFormControlIDList.push(m.primaryName);var f=this.objDocument.documentStorage[m.primaryName];if(null!=f){var j=this.objDocument.getLineStyle(m.outterlineStyleKey);var g=this.objDocument.getBackgroundStyle(m.backgroundStyleKey);var l=m.accessibilityString;if(null==l){l="image";}var h=document.createElement("div");h.style.cssText="position:absolute;overflow:hidden;";h.style.left=(i.left*this.nPixelRate)+"px";h.style.top=(i.top*this.nPixelRate)+"px";h.style.width=(i.getWidth()*this.nPixelRate)+"px";h.style.height=(i.getHeight()*this.nPixelRate)+"px";var b=document.createElement("span");b.id=this.objDocument.reportKey+m.primaryName+"Guide";b.className="eF_Rect";var a="";if(g.backStyle==0){a+="background-color:"+mCR_changeRGBAColor(g.backColor,m.transparencyRate)+";";}if(j.style!=0){a+="border:"+mCR_getLineStyleTag(j);a+="color:"+mCR_getStrColor(j.color)+" !important;";}a+="text-align:left !important;  padding: 0px 0px 0px 0px !important;font-size:10px !important;";b.style.cssText=a;var k=document.createElement("img");k.id=this.objDocument.reportKey+m.primaryName+"Canvas";k.className="eF_Rect2";var d=document.createElement("div");d.id=this.objDocument.reportKey+m.primaryName+"FOCUS";d.className="eF_Rect";h.appendChild(b);h.appendChild(k);h.appendChild(d);this.elmLayoutTag.appendChild(h);var c=document.createElement("button");c.tabIndex="0";c.className="eForm_hidden_button";c.id=this.objDocument.reportKey+m.primaryName;c.title=l;c.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";c.style.left=(i.left*this.nPixelRate)+"px";c.style.top=(i.top*this.nPixelRate)+"px";c.style.width=(i.getWidth()*this.nPixelRate)+"px";c.style.height=(i.getHeight()*this.nPixelRate)+"px";c.innerHTML=l;this.elmLayoutButton.appendChild(c);}};mCR_exportSVGForEForm.prototype.exportInputSign=function(i){var d=null;if(this.isEasyInput){d=i.rect;}else{d=i.getRectInPage();}this.pageEFormControlIDList.push(i.primaryName);var b=this.objDocument.documentStorage[i.primaryName];if(null!=b){var k=this.objDocument.getLineStyle(i.outterlineStyleKey);var m=this.objDocument.getShapeStyle(i.shapeStyleKey);var j=this.objDocument.getBackgroundStyle(i.backgroundStyleKey);if(null!=k&&null!=m){var g=this.paintShapeStyle(d,m);this.paintLineStyle(k,g);this.elmChangeGroup.appendChild(g);}var n=new docStyleLine();n.setStyle(i.guileLineStyle,i.guileLineWidth,i.guileLineColor);var r=i.accessibilityString;if(null==r){r="sign";}var t=document.createElement("div");t.style.cssText="position:absolute;overflow:hidden;";t.style.left=(d.left*this.nPixelRate)+"px";t.style.top=(d.top*this.nPixelRate)+"px";t.style.width=(d.getWidth()*this.nPixelRate)+"px";t.style.height=(d.getHeight()*this.nPixelRate)+"px";var f=document.createElement("span");f.id=this.objDocument.reportKey+i.primaryName+"Guide";f.className="eF_Rect";var u="";if(j.backStyle==0){u+="background-color:"+mCR_changeRGBAColor(j.backColor,i.transparencyRate)+";";}if(n.style!=0){u+="border:"+mCR_getLineStyleTag(n);u+="color:"+mCR_getStrColor(n.color)+" !important;";}u+="text-align:left !important;  padding: 0px 0px 0px 0px !important;font-size:10px !important;";f.style.cssText=u;var c=document.createElement("div");c.className="eF_Rect2 eform_sign_paint_guide";var p=document.createElement("table");p.className="eform_table";p.border="0";p.cellSpacing="0";p.cellPadding="0";var h=document.createElement("tr");var l=document.createElement("td");var a=new docStyleTextOption();a.horizontalAlignment=i.horizontalAlignmentMethod;a.verticalAlignment=i.verticalAlignmentMethod;mCR_setAlignmentMethod(l,a);l.style.cssText="word-wrap:break-word;background-color:transparent !important;";c.id=this.objDocument.reportKey+i.primaryName+"GuideInput";var s=document.createElement("canvas");s.id=this.objDocument.reportKey+i.primaryName+"Canvas";s.className="eF_Rect2";var o=document.createElement("div");o.id=this.objDocument.reportKey+i.primaryName+"FOCUS";o.className="eF_Rect";h.appendChild(l);p.appendChild(h);c.appendChild(p);t.appendChild(f);t.appendChild(c);t.appendChild(s);t.appendChild(o);this.elmLayoutTag.appendChild(t);var q=document.createElement("button");q.tabIndex="0";q.className="eForm_hidden_button";q.id=this.objDocument.reportKey+i.primaryName;q.title=r;q.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";q.style.left=(d.left*this.nPixelRate)+"px";q.style.top=(d.top*this.nPixelRate)+"px";q.style.width=(d.getWidth()*this.nPixelRate)+"px";q.style.height=(d.getHeight()*this.nPixelRate)+"px";q.innerHTML=r;this.elmLayoutButton.appendChild(q);}};mCR_exportSVGForEForm.prototype.exportInputCalendar=function(h){var o=null;if(this.isEasyInput){o=h.rect;}else{o=h.getRectInPage();}this.pageEFormControlIDList.push(h.primaryName);var j=this.objDocument.documentStorage[h.primaryName];if(null!=j){var p=this.objDocument.getLineStyle(h.outterlineStyleKey);var k=this.objDocument.getBackgroundStyle(h.backgroundStyleKey);var l=this.objDocument.getTextOptionStyle(h.textInfo.getOriginalTextInfo().textOptionStyleKey);var q=h.accessibilityString;if(null==q){q="calendar";}var i=document.createElement("div");i.style.cssText="position:absolute;overflow:hidden;";i.style.left=(o.left*this.nPixelRate)+"px";i.style.top=(o.top*this.nPixelRate)+"px";i.style.width=(o.getWidth()*this.nPixelRate)+"px";i.style.height=(o.getHeight()*this.nPixelRate)+"px";var c=document.createElement("div");c.id=this.objDocument.reportKey+h.primaryName+"SPAN";c.className="eF_Rect";var b="";if(k.backStyle==0){b+="background-color:"+mCR_changeRGBAColor(k.backColor,h.transparencyRate)+";";}if(p.style!=0){b+="border:"+mCR_getLineStyleTag(p);b+="color:"+mCR_getStrColor(p.color)+" !important;";}c.style.cssText=b;var d=document.createElement("div");d.className="eF_Rect";var n=document.createElement("table");n.className="eform_table";n.border="0";n.cellSpacing="0";n.cellPadding="0";var a=document.createElement("tr");var m=document.createElement("td");m.id=this.objDocument.reportKey+h.primaryName+"TD";mCR_setAlignmentMethod(m,l);m.style.cssText="word-wrap:break-word;background-color:transparent !important;";m.className="s_"+this.objDocument.reportKey+h.textInfo.getOriginalTextInfo().fontStyleKey;m.appendChild(document.createElement("nobr"));var g=document.createElement("div");g.id=this.objDocument.reportKey+h.primaryName+"FOCUS";g.className="eF_Rect";a.appendChild(m);n.appendChild(a);d.appendChild(n);i.appendChild(c);i.appendChild(d);i.appendChild(g);this.elmLayoutTag.appendChild(i);var f=document.createElement("button");f.tabIndex="0";f.className="eForm_hidden_button";f.id=this.objDocument.reportKey+h.primaryName;f.title=q;f.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";f.style.left=(o.left*this.nPixelRate)+"px";f.style.top=(o.top*this.nPixelRate)+"px";f.style.width=(o.getWidth()*this.nPixelRate)+"px";f.style.height=(o.getHeight()*this.nPixelRate)+"px";f.innerHTML=q;this.elmLayoutButton.appendChild(f);}};mCR_exportSVGForEForm.prototype.exportInputSelectBox=function(i){var d=null;if(this.isEasyInput){d=i.rect;}else{d=i.getRectInPage();}this.pageEFormControlIDList.push(i.primaryName);var b=this.objDocument.documentStorage[i.primaryName];if(null!=b){var m=this.objDocument.getLineStyle(i.outterlineStyleKey);var j=this.objDocument.getBackgroundStyle(i.backgroundStyleKey);var a=this.objDocument.getTextOptionStyle(i.textInfo.getOriginalTextInfo().textOptionStyleKey);var p=i.accessibilityString;if(null==p){p="selectbox";}var l=document.createElement("div");l.style.cssText="position:absolute;overflow:hidden;";l.style.left=(d.left*this.nPixelRate)+"px";l.style.top=(d.top*this.nPixelRate)+"px";l.style.width=(d.getWidth()*this.nPixelRate)+"px";l.style.height=(d.getHeight()*this.nPixelRate)+"px";var f=document.createElement("div");f.id=this.objDocument.reportKey+i.primaryName+"SPAN";f.className="eF_Rect";var s="";if(j.backStyle==0){s+="background-color:"+mCR_changeRGBAColor(j.backColor,i.transparencyRate)+";";}if(m.style!=0){s+="border:"+mCR_getLineStyleTag(m);s+="color:"+mCR_getStrColor(m.color)+" !important;";}f.style.cssText=s;var c=document.createElement("div");c.className="eF_Rect";var n=document.createElement("table");n.className="eform_table";n.border="0";n.cellSpacing="0";n.cellPadding="0";var g=document.createElement("tr");var k=document.createElement("td");var r=document.createElement("nobr");k.id=this.objDocument.reportKey+i.primaryName+"TD";mCR_setAlignmentMethod(k,a);k.style.cssText="word-wrap:break-word;background-color:transparent !important;";k.className="s_"+this.objDocument.reportKey+i.textInfo.getOriginalTextInfo().fontStyleKey;var q=document.createElement("td");q.width="20px";q.align="center";q.vAlign="middle";q.style.fontSize="8pt";q.innerHTML="▼";var o=document.createElement("div");o.id=this.objDocument.reportKey+i.primaryName+"FOCUS";o.className="eF_Rect";k.appendChild(r);g.appendChild(k);g.appendChild(q);n.appendChild(g);c.appendChild(n);l.appendChild(f);l.appendChild(c);l.appendChild(o);this.elmLayoutTag.appendChild(l);var h=document.createElement("select");h.tabIndex="0";h.className="eForm_hidden_button";h.id=this.objDocument.reportKey+i.primaryName;h.title=p;h.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";h.style.left=(d.left*this.nPixelRate)+"px";h.style.top=(d.top*this.nPixelRate)+"px";h.style.width=(d.getWidth()*this.nPixelRate)+"px";h.style.height=(d.getHeight()*this.nPixelRate)+"px";h.innerHTML=p;this.elmLayoutButton.appendChild(h);}};mCR_exportSVGForEForm.prototype.exportInputButton=function(j){var o=null;if(this.isEasyInput){o=j.rect;}else{o=j.getRectInPage();}this.pageEFormControlIDList.push(j.primaryName);var i=this.objDocument.documentStorage[j.primaryName];if(null!=i){var p=this.objDocument.getLineStyle(j.outterlineStyleKey);var k=this.objDocument.getBackgroundStyle(j.backgroundStyleKey);var l=this.objDocument.getTextOptionStyle(j.textInfo.getOriginalTextInfo().textOptionStyleKey);var q=j.accessibilityString;if(null==q){q="button";}var h=document.createElement("div");h.style.cssText="position:absolute;overflow:hidden;";h.style.left=(o.left*this.nPixelRate)+"px";h.style.top=(o.top*this.nPixelRate)+"px";h.style.width=(o.getWidth()*this.nPixelRate)+"px";h.style.height=(o.getHeight()*this.nPixelRate)+"px";var c=document.createElement("div");c.id=this.objDocument.reportKey+j.primaryName+"SPAN";c.className="eF_Rect";var b="";if(k.backStyle==0){b+="background-color:"+mCR_changeRGBAColor(k.backColor,j.transparencyRate)+";";}if(p.style!=0){b+="border:"+mCR_getLineStyleTag(p);b+="color:"+mCR_getStrColor(p.color)+" !important;";}c.style.cssText=b;var d=document.createElement("div");d.className="eF_Rect";var n=document.createElement("table");n.className="eform_table";n.border="0";n.cellSpacing="0";n.cellPadding="0";var a=document.createElement("tr");var m=document.createElement("td");m.id=this.objDocument.reportKey+j.primaryName+"TD";mCR_setAlignmentMethod(m,l);m.style.cssText="word-wrap:break-word;background-color:transparent !important;";m.className="s_"+this.objDocument.reportKey+j.textInfo.getOriginalTextInfo().fontStyleKey;var g=document.createElement("div");g.id=this.objDocument.reportKey+j.primaryName+"FOCUS";g.className="eF_Rect";a.appendChild(m);n.appendChild(a);d.appendChild(n);h.appendChild(c);h.appendChild(d);h.appendChild(g);this.elmLayoutTag.appendChild(h);var f=document.createElement("button");f.tabIndex="0";f.className="eForm_hidden_button";f.id=this.objDocument.reportKey+j.primaryName;f.title=q;f.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";f.style.left=(o.left*this.nPixelRate)+"px";f.style.top=(o.top*this.nPixelRate)+"px";f.style.width=(o.getWidth()*this.nPixelRate)+"px";f.style.height=(o.getHeight()*this.nPixelRate)+"px";f.innerHTML=q;this.elmLayoutButton.appendChild(f);}};mCR_exportSVGForEForm.prototype.exportInputVideo=function(j){var i=null;if(this.isEasyInput){i=j.rect;}else{i=j.getRectInPage();}this.pageEFormControlIDList.push(j.primaryName);var g=this.objDocument.documentStorage[j.primaryName];if(null!=g){var k=this.objDocument.getLineStyle(j.outterlineStyleKey);var h=this.objDocument.getBackgroundStyle(j.backgroundStyleKey);var l=j.accessibilityString;if(null==l){l="video";}var d=document.createElement("div");d.style.cssText="position:absolute;overflow:hidden;";d.style.left=(i.left*this.nPixelRate)+"px";d.style.top=(i.top*this.nPixelRate)+"px";d.style.width=(i.getWidth()*this.nPixelRate)+"px";d.style.height=(i.getHeight()*this.nPixelRate)+"px";var b=document.createElement("div");b.id=this.objDocument.reportKey+j.primaryName+"SPAN";b.className="eF_Rect";var a="";if(h.backStyle==0){a+="background-color:"+mCR_changeRGBAColor(h.backColor,j.transparencyRate)+";";}if(k.style!=0){a+="border:"+mCR_getLineStyleTag(k);a+="color:"+mCR_getStrColor(k.color)+" !important;";}b.style.cssText=a;var c=document.createElement("div");c.id=this.objDocument.reportKey+j.primaryName+"FOCUS";c.className="eF_Rect";d.appendChild(b);d.appendChild(c);this.elmLayoutTag.appendChild(d);var f=document.createElement("video");f.tabIndex="0";f.id=this.objDocument.reportKey+j.primaryName;f.title=l;f.style.cssText="position:absolute;overflow:hidden;border:0 solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";f.style.left=(i.left*this.nPixelRate)+"px";f.style.top=(i.top*this.nPixelRate)+"px";f.style.width=(i.getWidth()*this.nPixelRate)+"px";f.style.height=(i.getHeight()*this.nPixelRate)+"px";f.controls=true;this.elmLayoutButton.appendChild(f);}};mCR_exportSVGForEForm.prototype.exportInputbox=function(r){var d=null;if(this.isEasyInput){d=r.rect;}else{d=r.getRectInPage();}this.pageEFormControlIDList.push(r.primaryName);var b=this.objDocument.documentStorage[r.primaryName];if(null!=b){var n=this.objDocument.getLineStyle(r.outterlineStyleKey);var i=this.objDocument.getBackgroundStyle(r.backgroundStyleKey);var a=this.objDocument.getTextOptionStyle(r.textInfo.getOriginalTextInfo().textOptionStyleKey);var k=this.objDocument.getFontStyle(r.textInfo.getOriginalTextInfo().fontStyleKey);var q=r.accessibilityString;if(null==q){q="inputbox";}var m=document.createElement("div");m.style.cssText="position:absolute;overflow:hidden;";m.style.left=(d.left*this.nPixelRate)+"px";m.style.top=(d.top*this.nPixelRate)+"px";m.style.width=(d.getWidth()*this.nPixelRate)+"px";m.style.height=(d.getHeight()*this.nPixelRate)+"px";var f=document.createElement("div");f.id=this.objDocument.reportKey+r.primaryName+"SPAN";f.className="eF_Rect";var s="";if(i.backStyle==0){s+="background-color:"+mCR_changeRGBAColor(i.backColor,r.transparencyRate)+";";}if(n.style!=0){s+="border:"+mCR_getLineStyleTag(n);s+="color:"+mCR_getStrColor(n.color)+" !important;";}f.style.cssText=s;var c=document.createElement("div");c.className="eF_Rect";var o=document.createElement("table");o.className="eform_table";o.border="0";o.cellSpacing="0";o.cellPadding="0";var g=document.createElement("tr");var l=document.createElement("td");l.id=this.objDocument.reportKey+r.primaryName+"TD";mCR_setAlignmentMethod(l,a);l.style.cssText="word-wrap:break-word;background-color:transparent !important;";l.className="s_"+this.objDocument.reportKey+r.textInfo.getOriginalTextInfo().fontStyleKey;g.appendChild(l);o.appendChild(g);c.appendChild(o);m.appendChild(f);m.appendChild(c);this.elmLayoutTag.appendChild(m);var p=document.createElement("textarea");if(b.isGuideText){var j=b.guideTextColor;var h=document.createElement("textarea");h.tabIndex="-1";h.readonly=true;h.className="eform_guide_textarea mRe_focus s_"+this.objDocument.reportKey+r.textInfo.getOriginalTextInfo().fontStyleKey;h.id=this.objDocument.reportKey+r.primaryName+"GT";h.style.left=(d.left*this.nPixelRate)+"px";h.style.top=(d.top*this.nPixelRate)+"px";h.style.width=(d.getWidth()*this.nPixelRate)+"px";h.style.height=(d.getHeight()*this.nPixelRate)+"px";h.style.color=mCR_getStrColor(j);h.value=decodeURIComponent(b.guideText);p.style.backgroundColor="RGBA(255,255,255,0)";mCR_setInputAlignmentMethod(h,a);mRe_spaceStyle(h,a,k);this.elmLayoutButton.appendChild(h);}p.tabIndex="0";p.className="eform_textarea mRe_focus s_"+this.objDocument.reportKey+r.textInfo.getOriginalTextInfo().fontStyleKey;p.title=q;p.id=this.objDocument.reportKey+r.primaryName;p.style.left=(d.left*this.nPixelRate)+"px";p.style.top=(d.top*this.nPixelRate)+"px";p.style.width=(d.getWidth()*this.nPixelRate)+"px";p.style.height=(d.getHeight()*this.nPixelRate)+"px";this.elmLayoutButton.appendChild(p);mCR_setInputAlignmentMethod(p,a);mRe_spaceStyle(p,a,k);}};function mCR_exportSVGForZoom(b,a){mCR_exportSVG.call(this,b,a);}mCR_exportSVGForZoom.prototype=Object.create(mCR_exportSVG.prototype);mCR_exportSVGForZoom.prototype.constructor=mCR_exportSVGForZoom;mCR_exportSVGForZoom.prototype.exportControl=function(a){var c=true;if(a.pageCountConditionType==21){var b=this.objDocument.checkedTotalPageCount;var d=pageIndex+1==b/2+1;if(a.visible){if(d==true){c=false;}}else{c=d||a.conditionVisible;}}else{if(a.pageCountConditionType==-1){c=a.conditionVisible;}}if(c){switch(a.type){case mCR_DocumentControlType.Line:this.exportLine(a);break;case mCR_DocumentControlType.Shape:this.exportShape(a);break;case mCR_DocumentControlType.Label:this.exportLabel(a);break;case mCR_DocumentControlType.Table:this.exportTable(a);break;case mCR_DocumentControlType.Crosstab:this.exportCrosstab(a);break;case mCR_DocumentControlType.Barcode:this.exportBarcode(a);break;case mCR_DocumentControlType.Chart:this.exportChart(a);break;case mCR_DocumentControlType.SubReport:this.exportReportControl(a);break;case mCR_DocumentControlType.Checkbox:this.exportCheckbox(a,this.elmChangeGroup,false);break;case mCR_DocumentControlType.VoiceEye:this.exportVoiceEye(a);break;case mCR_DocumentControlType.MarkAnyVoiceEye:this.exportMarkAnyVoice(a);break;case mCR_DocumentControlType.VerifyBarcode:this.exportVerifyBarcode(a);break;}}};mCR_exportSVGForZoom.prototype.exportSubSectionsInPage=function(){this.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmChangeGroup.setAttribute("id","mainSubSectionBG");for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){var c=this.objDocumentPage.subSectionList[a];if(c.isDrillingView&&!c.isDrilling){this.exportSubSection(c);}}this.elmBodyGroup.appendChild(this.elmChangeGroup);var b=new Array();for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){var c=this.objDocumentPage.subSectionList[a];if(c.isDrillingView&&!c.isDrilling){if(c.sectionType!=7){this.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmChangeGroup.setAttribute("id","mainSubSection"+a);this.setDefaultGroupStyle();this.exportControlsInSubSection(c);this.elmBodyGroup.appendChild(this.elmChangeGroup);}else{b.push(c);}}}b.sort(function(f,d){if(f.area.top>d.area.top){return 1;}if(f.area.top<d.area.top){return -1;}return 0;});for(var a=0;a<b.length;a++){this.elmChangeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");this.elmChangeGroup.setAttribute("id","mainSubSectionPB"+a);this.setDefaultGroupStyle();this.exportControlsInSubSection(b[a]);this.elmBodyGroup.appendChild(this.elmChangeGroup);}b=null;};function mCR_exportCanvas(b,c,a){this.objDocument=b;this.objDocumentPage=null;this.objPageStyle=null;this.elmCanvas=null;this.objContext=null;this.nPixelRate=0.378;this.nPtToPxRate=1.32814;this.nZoom=c;this.objLineHashMap=null;this.pageImageList=null;this.tempImageDrawCount=0;this.callFunction=null;this.callbackFunction=a;this.webLinkList=new Array();this.isAccessibility=false;this.isEasyInput=false;this.ruleCtrlVisible=false;}mCR_exportCanvas.prototype.exportPage=function(b,c){var a=this;this.objDocumentPage=this.objDocument.documentPageList[b];this.startPage();c.appendChild(this.elmCanvas);this.callFunction=function(){a.exportSubSectionsInPage();a.endPage();if(null!=a.callbackFunction){a.callbackFunction();}};this.exportSubSectionsInPageImage();this.elmCanvas.setAttribute("nZoom",this.nZoom);return this.elmCanvas;};mCR_exportCanvas.prototype.setEasyInput=function(a){this.isEasyInput=a;};mCR_exportCanvas.prototype.setRuleCtrlVisible=function(a){this.ruleCtrlVisible=a;};mCR_exportCanvas.prototype.setAccessibility=function(a){this.isAccessibility=a;};mCR_exportCanvas.prototype.callGetWebLinkList=function(){return this.webLinkList;};mCR_exportCanvas.prototype.startPage=function(){this.objPageStyle=this.objDocument.getPageStyle(this.objDocumentPage.pageStyleKey);if(this.isEasyInput){var b=new docStylePage();b.paperType=this.objPageStyle.orientation;b.width=0;b.height=0;b.orientation=this.objPageStyle.orientation;b.leftMargin=0;b.topMargin=0;b.rightMargin=0;b.bottomMargin=0;b.pageCount=1;b.multiColumnDirection=this.objPageStyle.multiColumnDirection;for(var f=0;f<this.objDocumentPage.subSectionList.length;f++){var h=this.objDocumentPage.subSectionList[f];if(!h.isDrilling){var d=h.area.getHeight();h.area.top=b.height;b.height+=d;h.area.bottom=b.height;var c=h.area.getWidth();h.area.left=0;h.area.right=c;if(b.width<c){b.width=c;}}}this.objPageStyle=b;}this.elmCanvas=document.createElement("canvas");var a=this.objPageStyle.width*this.nPixelRate;var g=this.objPageStyle.height*this.nPixelRate;this.objDocumentPage.width=this.objPageStyle.width;this.objDocumentPage.height=this.objPageStyle.height;this.elmCanvas.setAttribute("width",a*this.nZoom);this.elmCanvas.setAttribute("height",g*this.nZoom);this.objContext=this.elmCanvas.getContext("2d");this.objContext.scale(this.nZoom,this.nZoom);this.objContext.fillStyle="rgb(255,255,255)";this.objContext.fillRect(0,0,a,g);this.pageImageList=new Array();this.objLineHashMap=function(){};this.objAccHashMap=function(){};};mCR_exportCanvas.prototype.exportSubSectionsInPageImage=function(){if(!this.isEasyInput){if(this.objDocumentPage.backGround){this.findControlsInSubSectionImage(this.objDocumentPage.backGround);}}for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){this.findControlsInSubSectionImage(this.objDocumentPage.subSectionList[a]);}if(!this.isEasyInput){if(this.objDocumentPage.foreGround){this.findControlsInSubSectionImage(this.objDocumentPage.foreGround);}}if(this.pageImageList.length==0){this.callFunction();}};mCR_exportCanvas.prototype.findControlsInSubSectionImage=function(f){for(var b=0;b<f.controlPageList.length;b++){var a=f.controlPageList[b];var d=true;if(-1!=a.visibleOptionStyleKey){var c=this.objDocument.getVisibleOptionStyle(a.visibleOptionStyleKey);if(null!=c){d=c.toView;}}if(d){this.findImageControl(a);}}};mCR_exportCanvas.prototype.findImageControl=function(a){var c=true;if(a.pageCountConditionType==21){var b=this.objDocument.checkedTotalPageCount;var d=pageIndex+1==b/2+1;if(a.visible){if(d==true){c=false;}}else{c=d||a.conditionVisible;}}else{if(a.pageCountConditionType==-1){c=a.conditionVisible;}}if(c){switch(a.type){case mCR_DocumentControlType.Label:this.findImageLabel(a);break;case mCR_DocumentControlType.Table:this.findImageTable(a);break;case mCR_DocumentControlType.SubReport:this.findImageReportControl(a);break;case mCR_DocumentControlType.VoiceEye:this.findImageVoiceEye(a);break;case mCR_DocumentControlType.MarkAnyVoiceEye:this.findImageMarkAnyVoice(a);break;case mCR_DocumentControlType.InputSign:this.findInputSign(a);break;case mCR_DocumentControlType.InputImage:this.findInputImage(a);break;case mCR_DocumentControlType.InputCheckbox:this.findInputCheckbox(a);break;}}};mCR_exportCanvas.prototype.findInputCheckbox=function(a){var c=a.getRectInPage();var f=a.checkSize;var d=this.objDocument.documentStorage[a.primaryName];if(null!=d){if(d.visible){if("true"==d.checked){var b=d.imageType=="check"?this.objDocument.checkImageName:this.objDocument.radioImageName;mCR_ServerImageCall(this,a,b);}}}};mCR_exportCanvas.prototype.findInputImage=function(d){var c=d.getRectInPage();var f=this.objDocument.documentStorage[d.primaryName];if((c.getWidth()!=0&&c.getHeight()!=0)&&null!=f){if(f.visible&&""!=f.image){var g=f.image.replace(/\s/gi,"+");var b=new Image();b.src="data:image/png;base64,"+g;d.imageKey=this.pageImageList.length;this.pageImageList.push(b);var a=this;b.onload=function(){a.tempImageDrawCount++;if(a.pageImageList!=null){if(a.pageImageList.length<=a.tempImageDrawCount){a.callFunction();}}};b.onerror=function(){window.console.log("InputImage ID: "+f.id+" image Data error >>"+g);d.imageKey=-1;a.tempImageDrawCount++;if(a.pageImageList!=null){if(a.pageImageList.length<=a.tempImageDrawCount){a.callFunction();}}};}}};mCR_exportCanvas.prototype.findInputSign=function(a){var d=a.getRectInPage();var f=this.objDocument.documentStorage[a.primaryName];if((d.getWidth()!=0&&d.getHeight()!=0)&&null!=f){if(f.visible&&""!=f.image){var g=f.image.replace(/\s/gi,"+");var c=new Image();c.src="data:image/png;base64,"+g;a.imageKey=this.pageImageList.length;this.pageImageList.push(c);var b=this;c.onload=function(){b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};c.onerror=function(){window.console.log("InputSign ID: "+f.id+" image Data error >>"+g);a.imageKey=-1;b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};}}};mCR_exportCanvas.prototype.findImageReportControl=function(a){for(var b=0;b<a.subSectionList.length;b++){this.findControlsInSubSectionImage(a.subSectionList[b]);}};mCR_exportCanvas.prototype.findImageLabel=function(h){var d=h.getRectInPage();var c=this.objDocument.getLineStyle(h.outterlineStyleKey);var g=this.objDocument.getShapeStyle(h.shapeStyleKey);var b=this.objDocument.getBackgroundStyle(h.backgroundStyleKey);if((null!=c&&null!=g&&null!=b)&&(d.getWidth()!=0&&d.getHeight()!=0)){if(h.imageInfo.imageDataKey!=-1){var f=this.objDocument.getBackgroundImageStyle(h.imageInfo.backgroundImageStyleKey);var a=this.objDocumentPage.getImageData(h.imageInfo.imageDataKey);if(null!=f&&null!=a&&"null"!=a.filePath&&0!=a.imageWidth&&0!=a.imageHeight){mCR_ServerImageCall(this,h,a.filePath);}}}};mCR_exportCanvas.prototype.findImageTable=function(b){var g=b.getRectInPage();if((g.getWidth()!=0&&g.getHeight()!=0)){var c=b.getRowCount();for(var h=0;h<c;h++){var f=b.getColumnCount();for(var d=0;d<f;d++){var a=b.getTableCellNormal(h,d);if(a!=null){this.findImageCell(a);}}}}};mCR_exportCanvas.prototype.findImageCell=function(j){var i=j.getRectInPage();var h=this.objDocument.getLineStyle(j.leftLineStyleKey);var b=this.objDocument.getLineStyle(j.topLineStyleKey);var k=this.objDocument.getLineStyle(j.rightLineStyleKey);var a=this.objDocument.getLineStyle(j.bottomLineStyleKey);var g=new Object();g.shapeType=3;var d=this.objDocument.getBackgroundStyle(j.backgroundStyleKey);if((h!=null&&b!=null&&k!=null&&a!=null&&b!=null&&d!=null)&&(i.getWidth()!=0&&i.getHeight()!=0)){if(j.imageInfo.imageDataKey!=-1){var f=this.objDocument.getBackgroundImageStyle(j.imageInfo.backgroundImageStyleKey);var c=this.objDocumentPage.getImageData(j.imageInfo.imageDataKey);if(f!=null&&c!=null&&"null"!=c.filePath&&0!=c.imageWidth&&0!=c.imageHeight){mCR_ServerImageCall(this,j,c.filePath);}}}};mCR_exportCanvas.prototype.findImageBarcode=function(f){var d=f.getRectInPage();var g=this.objDocument.getShapeStyle(f.shapeStyleKey);var a=this.objDocument.getBackgroundStyle(f.backgroundStyleKey);if((d.getWidth()!=0&&d.getHeight()!=0)){var c=new Image();c.src="data:image/png;base64,"+f.svgString;f.imageKey=this.pageImageList.length;this.pageImageList.push(c);var b=this;c.onload=function(){b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};c.onerror=function(){window.console.log("Barcode image Data error >>"+imageUrl);f.imageKey=-1;b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};}};mCR_exportCanvas.prototype.findImageChart=function(a){var d=a.getRectInPage();if((d.getWidth()!=0&&d.getHeight()!=0)){var c=new Image();c.src="data:image/png;base64,"+a.svgString;a.imageKey=this.pageImageList.length;this.pageImageList.push(c);var b=this;c.onload=function(){b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};c.onerror=function(){window.console.log("Chart image Data error >>"+a.svgString);a.imageKey=-1;b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};}};mCR_exportCanvas.prototype.findImageVoiceEye=function(a){var d=a.getRectInPage();if((d.getWidth()!=0&&d.getHeight()!=0)){var c=new Image();c.src="data:image/png;base64,"+a.svgString;a.imageKey=this.pageImageList.length;this.pageImageList.push(c);var b=this;c.onload=function(){b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};c.onerror=function(){window.console.log("VoiceEye image Data error >>"+a.svgString);a.imageKey=-1;b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};}};mCR_exportCanvas.prototype.findImageMarkAnyVoice=function(a){var d=a.getRectInPage();if((d.getWidth()!=0&&d.getHeight()!=0)){var c=new Image();c.src="data:image/png;base64,"+a.svgString;a.imageKey=this.pageImageList.length;this.pageImageList.push(c);var b=this;c.onload=function(){b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};c.onerror=function(){window.console.log("MarkAnyVoice image Data error >>"+a.svgString);a.imageKey=-1;b.tempImageDrawCount++;if(b.pageImageList!=null){if(b.pageImageList.length<=b.tempImageDrawCount){b.callFunction();}}};}};mCR_exportCanvas.prototype.exportSubSectionsInPage=function(){if(this.objDocumentPage.backGround&&!this.isEasyInput){this.objDocumentPage.backGround.area.right=this.objPageStyle.width-this.objPageStyle.leftMargin-this.objPageStyle.rightMargin;this.exportSubSection(this.objDocumentPage.backGround);this.exportControlsInSubSection(this.objDocumentPage.backGround);}for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){var c=this.objDocumentPage.subSectionList[a];if(c.isDrillingView){this.exportSubSection(c);}}var b=new Array();for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){var c=this.objDocumentPage.subSectionList[a];if(c.isDrillingView){if(c.sectionType!=7){this.exportControlsInSubSection(c);}else{b.push(c);}}}b.sort(function(f,d){if(f.area.top>d.area.top){return 1;}if(f.area.top<d.area.top){return -1;}return 0;});for(var a=0;a<b.length;a++){this.exportControlsInSubSection(b[a]);}b=null;if(this.objDocumentPage.foreGround&&!this.isEasyInput){this.exportSubSection(this.objDocumentPage.foreGround);this.exportControlsInSubSection(this.objDocumentPage.foreGround);}};mCR_exportCanvas.prototype.endPage=function(){this.objLineHashMap=null;this.pageImageList=null;this.tempImageDrawCount=0;this.callFunction=null;this.objAccHashMap=null;};mCR_exportCanvas.prototype.exportSubSection=function(f){var c=f.offsetRect(this.objPageStyle.leftMargin,this.objPageStyle.topMargin);var b=c.newRateRect(this.nPixelRate);var a=this.objDocument.getBackgroundStyle(f.backgroundStyleKey);if(null!=a&&a.backStyle==0){this.objContext.fillStyle=mCR_getStrColor(a.backColor);this.objContext.fillRect(b.left,b.top,b.getWidth(),b.getHeight());}if(this.ruleCtrlVisible){if(f.isEditEasyMode){var d=this.objContext;window.setTimeout(function(){d.strokeStyle="blue";d.lineWidth=2;d.rect(b.left,b.top,b.getWidth(),b.getHeight());d.stroke();d.font="11pt 나눔고딕 bold";d.fillStyle="blue";d.fillText(f.sectionName+"("+f.editEasyModeId+")",b.left+3,b.top+14);},300);}}};mCR_exportCanvas.prototype.exportControlsInSubSection=function(f){for(var b=0;b<f.controlPageList.length;b++){var a=f.controlPageList[b];var d=true;if(-1!=a.visibleOptionStyleKey){var c=this.objDocument.getVisibleOptionStyle(a.visibleOptionStyleKey);if(null!=c){d=c.toView;}}if(d){this.exportControl(a);}}};mCR_exportCanvas.prototype.exportControl=function(a){var c=true;if(a.pageCountConditionType==21){var b=this.objDocument.checkedTotalPageCount;var d=pageIndex+1==b/2+1;if(a.visible){if(d==true){c=false;}}else{c=d||a.conditionVisible;}}else{if(a.pageCountConditionType==-1){c=a.conditionVisible;}}if(c){switch(a.type){case mCR_DocumentControlType.Line:this.exportLine(a);break;case mCR_DocumentControlType.Shape:this.exportShape(a);break;case mCR_DocumentControlType.Label:this.exportLabel(a);break;case mCR_DocumentControlType.Crosstab:this.exportCrosstab(a);break;case mCR_DocumentControlType.Table:this.exportTable(a);break;case mCR_DocumentControlType.Barcode:this.exportBarcode(a);break;case mCR_DocumentControlType.Chart:this.exportChart(a);break;case mCR_DocumentControlType.SubReport:this.exportReportControl(a);break;case mCR_DocumentControlType.Checkbox:this.exportCheckbox(a,false);break;case mCR_DocumentControlType.VoiceEye:this.exportVoiceEye(a);break;case mCR_DocumentControlType.MarkAnyVoiceEye:this.exportMarkAnyVoice(a);break;case mCR_DocumentControlType.VerifyBarcode:this.exportVerifyBarcode(a);break;case mCR_DocumentControlType.Input:this.exportInputbox(a);break;case mCR_DocumentControlType.Button:this.exportInputButton(a);break;case mCR_DocumentControlType.InputSelectBox:this.exportInputSelectBox(a);break;case mCR_DocumentControlType.Calendar:this.exportInputCalendar(a);break;case mCR_DocumentControlType.InputSign:this.exportInputSign(a);break;case mCR_DocumentControlType.InputImage:this.exportInputImage(a);break;case mCR_DocumentControlType.InputCheckbox:this.exportInputCheckbox(a);break;}}};mCR_exportCanvas.prototype.exportInputCheckbox=function(f){var j=f.getRectInPage();var g=f.checkSize;var d=this.objDocument.documentStorage[f.primaryName];if(null!=d){if(d.visible){var b=null;if(f.useText){b=new docRect();b.set(0,0,g,g);var i=j.top+((j.getHeight()-g)/2);b.offsetRect(j.left,i);j.left+=g;var c=new docRect();c.copyRect(j);this.paintText(c,f.textInfo);}else{b=j;}var k=this.objDocument.getLineStyle(f.outterlineStyleKey);var h=this.objDocument.getShapeStyle(f.shapeStyleKey);if(null!=k&&null!=h){this.paintShapeStyle(h,b);this.paintLineStyle(k);this.objContext.stroke();}if("true"==d.checked){var a=b.newRateRect(this.nPixelRate);this.objContext.drawImage(this.pageImageList[f.imageKey],a.left,a.top,a.getWidth(),a.getHeight());}}else{if(f.useText){j.left+=g;var c=new docRect();c.copyRect(j);this.paintText(c,f.textInfo);}}}};mCR_exportCanvas.prototype.exportInputImage=function(b){var c=b.getRectInPage();var d=this.objDocument.documentStorage[b.primaryName];if((c.getWidth()!=0&&c.getHeight()!=0)&&null!=d){if(d.visible&&""!=d.image){var a=c.newRateRect(this.nPixelRate);this.objContext.drawImage(this.pageImageList[b.imageKey],a.left,a.top,a.getWidth(),a.getHeight());}else{if(d.visible&&""==d.image){this.setInputControlInfo(c,"image");}}}};mCR_exportCanvas.prototype.exportInputSign=function(c){var d=c.getRectInPage();var g=this.objDocument.documentStorage[c.primaryName];if((d.getWidth()!=0&&d.getHeight()!=0)&&null!=g){if(g.visible&&""!=g.image){var b=this.objDocument.getLineStyle(c.outterlineStyleKey);var f=this.objDocument.getShapeStyle(c.shapeStyleKey);if(null!=b&&null!=f){this.paintShapeStyle(f,d);this.paintLineStyle(b);this.objContext.stroke();}var a=d.newRateRect(this.nPixelRate);this.objContext.drawImage(this.pageImageList[c.imageKey],a.left,a.top,a.getWidth(),a.getHeight());}else{if(g.visible&&""==g.image){this.setInputControlInfo(d,"sign");}}}};mCR_exportCanvas.prototype.exportInputCalendar=function(a){var c=a.getRectInPage();var d=this.objDocument.documentStorage[a.primaryName];if(null!=d){if(d.visible){var b=new docRect();b.copyRect(c);this.paintText(b,a.textInfo);}}};mCR_exportCanvas.prototype.exportInputSelectBox=function(a){var c=a.getRectInPage();var d=this.objDocument.documentStorage[a.primaryName];if(null!=d){if(d.visible){var b=new docRect();b.copyRect(c);this.paintText(b,a.textInfo);}}};mCR_exportCanvas.prototype.exportInputButton=function(a){var c=a.getRectInPage();var d=this.objDocument.documentStorage[a.primaryName];if(null!=d){if(d.visible){var b=new docRect();b.copyRect(c);this.paintText(b,a.textInfo);}}};mCR_exportCanvas.prototype.exportInputbox=function(c){var b=c.getRectInPage();var d=this.objDocument.documentStorage[c.primaryName];if(null!=d){if(d.visible){var a=new docRect();a.copyRect(b);this.paintText(a,c.textInfo);}}};mCR_exportCanvas.prototype.exportLabel=function(d){var j=d.getRectInPage();var k=this.objDocument.getLineStyle(d.outterlineStyleKey);var g=this.objDocument.getShapeStyle(d.shapeStyleKey);var f=this.objDocument.getBackgroundStyle(d.backgroundStyleKey);if((null!=k&&null!=g&&null!=f)&&(j.getWidth()!=0&&j.getHeight()!=0)){this.paintShapeStyle(g,j);this.paintBackgroundStyle(f,j);this.objContext.fill();var b=new docRect();b.copyRect(j);if(d.imageInfo.imageDataKey!=-1){var h=this.objDocument.getBackgroundImageStyle(d.imageInfo.backgroundImageStyleKey);var c=this.objDocumentPage.getImageData(d.imageInfo.imageDataKey);if(null!=h&&null!=c){var a=this;this.paintBackgroundImageStyle(g,h,c,j,d.imageKey);}}this.paintLineStyle(k);this.objContext.stroke();this.paintText(b,d.textInfo);if(d.editable){this.setEditWebLinkInfo(d,d.getRectInPage(),d.textInfo,d.editableIndex);}if(d.webLinkInfo!=null){if(d.webLinkInfo.type!=-1){this.setWebLinkInfo(d.getRectInPage(),d.webLinkInfo);}}if(this.isAccessibility&&null!=d.accessibilityString){var i=d.accessibilityString;i=i.replace(/\@pc\@|\@pn\@/g,d.textInfo.getOriginalTextInfo().text);var l={type:20,msg:i};this.setWebLinkInfo(d.getRectInPage(),l);}}};mCR_exportCanvas.prototype.exportLine=function(c){var d=c.getRectInPage();var b=d.newRateRect(this.nPixelRate);var a=this.objDocument.getLineStyle(c.lineStyleKey);if(null!=a&&a.style!=0){this.lineDeduplication(b.left,b.top,b.right,b.bottom,a);this.paintLineStyle(a);this.objContext.beginPath();this.objContext.moveTo(b.left,b.top);this.objContext.lineTo(b.right,b.bottom);this.objContext.stroke();}};mCR_exportCanvas.prototype.exportShape=function(d){var c=d.getRectInPage();var b=this.objDocument.getLineStyle(d.outterlineStyleKey);var f=this.objDocument.getShapeStyle(d.shapeStyleKey);var a=this.objDocument.getBackgroundStyle(d.backgroundStyleKey);if((null!=b&&null!=f&&null!=a)&&(c.getWidth()!=0&&c.getHeight()!=0)&&(b.style!=0||a.backStyle!=1)){this.paintShapeStyle(f,c);this.paintBackgroundStyle(a,c);this.objContext.fill();this.paintLineStyle(b);this.objContext.stroke();}};mCR_exportCanvas.prototype.exportBarcode=function(d){var c=d.getRectInPage();var f=this.objDocument.getShapeStyle(d.shapeStyleKey);var a=this.objDocument.getBackgroundStyle(d.backgroundStyleKey);if((c.getWidth()!=0&&c.getHeight()!=0)){this.paintShapeStyle(f,c);this.paintBackgroundStyle(a,c);this.objContext.fill();this.barcodePainterDraw(d,c);if(this.isAccessibility&&null!=d.accessibilityString){var b={type:20,msg:d.accessibilityString};this.setWebLinkInfo(d.getRectInPage(),b);}}};mCR_exportCanvas.prototype.exportChart=function(a){if(a.dataType=="png"){this.exportChartImage(a);}else{if(a.dataType=="doc"){this.exportChartDocument(a);}}if(this.isAccessibility&&null!=a.accessibilityString){var b={type:20,msg:a.accessibilityString};this.setWebLinkInfo(a.getRectInPage(),b);}};mCR_exportCanvas.prototype.exportChartImage=function(a){var c=a.getRectInPage();if((c.getWidth()!=0&&c.getHeight()!=0)){var b=c.newRateRect(this.nPixelRate);var d=this.pageImageList[a.imageKey];if(null!=d){this.objContext.drawImage(d,b.left,b.top,b.getWidth(),b.getHeight());}if(a.webLinkInfo!=null){if(a.webLinkInfo.type!=-1){this.setWebLinkInfo(a.getRectInPage(),a.webLinkInfo);}}}};mCR_exportCanvas.prototype.exportChartDocument=function(a){var c=new mCR_exportChartPaintCanvas(this,a.getRectInPage());var b=new mCR_exportChart(c,a.svgString);b.exportt();};mCR_exportCanvas.prototype.exportVoiceEye=function(b){var c=b.getRectInPage();if((c.getWidth()!=0&&c.getHeight()!=0)){var a=c.newRateRect(this.nPixelRate);var d=this.pageImageList[b.imageKey];if(null!=d){this.objContext.drawImage(d,a.left,a.top,a.getWidth(),a.getHeight());}}};mCR_exportCanvas.prototype.exportMarkAnyVoice=function(b){var c=b.getRectInPage();if((c.getWidth()!=0&&c.getHeight()!=0)){var a=c.newRateRect(this.nPixelRate);var d=this.pageImageList[b.imageKey];if(null!=d){this.objContext.drawImage(d,a.left,a.top,a.getWidth(),a.getHeight());}}};mCR_exportCanvas.prototype.exportVerifyBarcode=function(i){var h=i.getRectInPage();var c=this.objDocument.getShapeStyle(i.shapeStyleKey);var b=this.objDocument.getBackgroundStyle(i.backgroundStyleKey);if((h.getWidth()!=0&&h.getHeight()!=0)){var j=h.getHeight();h.setWidth(j);var a=null;try{a=jQuery.parseJSON(i.text);}catch(f){a=null;window.console.log("not Found VerifyBarcode data >> "+i.text);}if(null!=a){for(var d=0;d<a.length;d++){var g=new mCR_SymbologyQRCode(true,this.objContext,i,h);g.drawPattern(a[d]);h.offsetRect(j+50,0);}}}};mCR_exportCanvas.prototype.exportCheckbox=function(a,c){var g=a.getRectInPage();var b=this.objDocument.getLineStyle(a.outterlineStyleKey);var h=this.objDocument.getShapeStyle(a.shapeStyleKey);if((null!=b&&null!=h)&&(g.getWidth()!=0&&g.getHeight()!=0)){this.paintShapeStyle(h,g);this.paintLineStyle(b);this.objContext.stroke();if(a.checkValue){var d=checkboxRevisePosition(g);this.brushCheck(d,a.checkType,a.checkColor);}if(this.isAccessibility&&!c&&null!=a.accessibilityString){var f={type:20,msg:a.accessibilityString};this.setWebLinkInfo(a.getRectInPage(),f);}}};mCR_exportCanvas.prototype.exportTable=function(a){var f=a;var d=f.getRectInPage();var b=new docCellMap();if(this.isAccessibility&&null!=f.accessibilityString&&""!=f.accessibilityString){var c={type:20,msg:f.accessibilityString};this.setWebLinkInfo(d,c);}this.paintCellsBackgroundText(d,f,b);this.paintCellsOutterLine(d,f,b);};mCR_exportCanvas.prototype.paintCellsBackgroundText=function(h,o,d){var i=o.getRowCount();for(var g=0;g<i;g++){var b=new Array();d.cellMap.push(b);var l=o.getColumnCount();for(var m=0;m<l;m++){var k=o.getTableCellNormal(g,m);if(k!=null){var c=new docCellInfo(false);c.colSpan=k.colSpan;c.rowSpan=k.rowSpan;b.push(c);this.paintCellBackground(h,k);if(k.webLinkInfo!=null){if(k.webLinkInfo.type!=-1){var j=k.getRectInPage();j.offsetRect(h.left,h.top);this.setWebLinkInfo(j,k.webLinkInfo);}}if(this.isAccessibility){if(null!=k.accessibilityString){var f=k.accessibilityString;f=f.replace(/\@pc\@|\@pn\@/g,k.detailTextInfo.getOriginalTextInfo().text);var n={type:20,ctrl:1,msg:f};var a=k.getRectInPage();a.offsetRect(h.left,h.top);this.setWebLinkInfo(a,n);}else{var n={type:400,ctrl:1,msg:""};var a=k.getRectInPage();a.offsetRect(h.left,h.top);this.setWebLinkInfo(a,n);}}}else{var c=new docCellInfo(true);b.push(c);}}}};mCR_exportCanvas.prototype.paintCellBackground=function(f,b){var d=b.getRectInPage();d.setLeft(f.getLeft()+d.getLeft());d.setTop(f.getTop()+d.getTop());d.setRight(f.getLeft()+d.getRight());d.setBottom(f.getTop()+d.getBottom());var i=new Object();i.shapeType=0;var c=this.objDocument.getBackgroundStyle(b.backgroundStyleKey);if((c!=null)&&(d.getWidth()!=0&&d.getHeight()!=0)){if(c.getBackStyle()!=mCR_BackStyleType.Transparent){this.paintShapeStyle(i,d);this.paintBackgroundStyle(c,d);this.objContext.fill();}if(b.imageInfo.imageDataKey!=-1){var g=this.objDocument.getBackgroundImageStyle(b.imageInfo.backgroundImageStyleKey);var a=this.objDocumentPage.getImageData(b.imageInfo.imageDataKey);if(g!=null&&a!=null){this.paintBackgroundImageStyle(i,g,a,d,b.imageKey);}}if(b.isCheckbox){this.shiftCheckboxPosition(b,d);this.exportCheckbox(b.documentCheckbox,true);if(b.editable){var h=b.getRectInPage();h.offsetRect(f.left,f.top);this.setCheckEditWebLinkInfo(b.documentCheckbox,h,b.editableIndex,b.documentCheckbox.checkValue);}}else{if(b.editable){var h=b.getRectInPage();h.offsetRect(f.left,f.top);this.setEditWebLinkInfo(b,h,b.detailTextInfo,b.editableIndex);}}this.paintText(d,b.detailTextInfo);}};mCR_exportCanvas.prototype.paintCellsOutterLine=function(f,k,c){this.checkingLastCell(c);var g=k.getRowCount();var h=null;for(var d=0;d<g;d++){h=k.getColumnCount();for(var i=0;i<h;i++){var j=k.getTableCellNormal(d,i);if(j!=null){this.paintCellOutterLine(f,j,k,d,g,i,h,c);}}}var a=this.objDocument.getLineStyle(k.lineFDiagonaStyleKey);if(a.style!=mCR_LineStyle.None){this.paintLineBDiagonal(c.leftBottomCell.getRectInPage().addRect(f.getLeft(),f.getTop(),f.getLeft(),f.getTop()),c.rightTopCell.getRectInPage().addRect(f.getLeft(),f.getTop(),f.getLeft(),f.getTop()),a,k.roundLeftBottom,k.roundRightTop);}var b=this.objDocument.getLineStyle(k.lineBDiagonaStyleKey);if(b.style!=mCR_LineStyle.None){this.paintLineFDiagonal(c.leftTopCell.getRectInPage().addRect(f.getLeft(),f.getTop(),f.getLeft(),f.getTop()),c.rightBottomCell.getRectInPage().addRect(f.getLeft(),f.getTop(),f.getLeft(),f.getTop()),b,k.roundLeftTop,k.roundRightBottom);}};mCR_exportCanvas.prototype.paintCellOutterLine=function(c,b,F,t,s,w,x,p){var y=b.getRectInPage();y.setLeft(c.getLeft()+y.getLeft());y.setTop(c.getTop()+y.getTop());y.setRight(c.getLeft()+y.getRight());y.setBottom(c.getTop()+y.getBottom());var n=p.cellMap[t][w];var z=this.objDocument.getLineStyle(b.leftLineStyleKey);var H=this.objDocument.getLineStyle(b.topLineStyleKey);var D=this.objDocument.getLineStyle(b.rightLineStyleKey);var h=this.objDocument.getLineStyle(b.bottomLineStyleKey);var C=this.objDocument.getLineStyle(b.frontDiagonalLineStyleKey);var I=this.objDocument.getLineStyle(b.backDiagonalLineStyleKey);if(z!=null&&H!=null&&D!=null&&h!=null&&H!=null){var v=false;var m=false;var J=false;var d=false;if(t==0){var k=this.objDocument.getLineStyle(F.outterlineStyleKey);if(k.style!=0){H=k;}}if(w==0){var k=this.objDocument.getLineStyle(F.outterlineStyleKey);if(k.style!=0){z=k;}}if(n.isLeftLast){var k=this.objDocument.getLineStyle(F.outterlineStyleKey);if(k.style!=0){D=k;}}if(n.isTopLast){var k=this.objDocument.getLineStyle(F.outterlineStyleKey);if(k.style!=0){h=k;}}var i=this.getWidthMarginNormal(z.width,z.style);var l=this.getWidthMarginNormal(D.width,D.style);var f=this.getWidthMarginNormal(H.width,H.style);var u=this.getWidthMarginNormal(h.width,h.style);var G=null;var E=null;var o=null;var g=null;var B=null;var r=null;var q=null;var a=null;if(z.style==mCR_LineStyle.DoubleLine){o=this.getWidthMarginOutter(H.width,H.style);g=this.getWidthMarginOutter(h.width,h.style);q=this.getWidthMarginInner(H.width,H.style);a=this.getWidthMarginInner(h.width,h.style);}else{if(z.style==mCR_LineStyle.InnerLine){q=this.getWidthMarginInner(H.width,H.style);a=this.getWidthMarginInner(h.width,h.style);}}if(H.style==mCR_LineStyle.DoubleLine){G=this.getWidthMarginOutter(z.width,z.style);E=this.getWidthMarginOutter(D.width,D.style);B=this.getWidthMarginInner(z.width,z.style);r=this.getWidthMarginInner(D.width,D.style);}else{if(H.style==mCR_LineStyle.InnerLine){B=this.getWidthMarginInner(z.width,z.style);r=this.getWidthMarginInner(D.width,D.style);}}if(D.style==mCR_LineStyle.DoubleLine){if(o==null){o=this.getWidthMarginOutter(H.width,H.style);}if(g==null){g=this.getWidthMarginOutter(h.width,h.style);}if(q==null){q=this.getWidthMarginInner(H.width,H.style);}if(a==null){a=this.getWidthMarginInner(h.width,h.style);}}else{if(D.style==mCR_LineStyle.InnerLine){if(q==null){q=this.getWidthMarginInner(H.width,H.style);}if(a==null){a=this.getWidthMarginInner(h.width,h.style);}}}if(h.style==mCR_LineStyle.DoubleLine){if(G==null){G=this.getWidthMarginOutter(z.width,z.style);}if(E==null){E=this.getWidthMarginOutter(D.width,D.style);}if(B==null){B=this.getWidthMarginInner(z.width,z.style);}if(r==null){r=this.getWidthMarginInner(D.width,D.style);}}else{if(h.style==mCR_LineStyle.InnerLine){if(B==null){B=this.getWidthMarginInner(z.width,z.style);}if(r==null){r=this.getWidthMarginInner(D.width,D.style);}}}if(t==0&&w==0){p.leftTopCell=b;if(F.roundLeftTop==1){v=true;}}if(t==0&&n.isLeftLast){p.rightTopCell=b;if(F.roundRightTop==1){m=true;}}if(n.isTopLast&&w==0){p.leftBottomCell=b;if(F.roundLeftBottom==1){J=true;}}if(n.isTopLast&&n.isLeftLast){p.rightBottomCell=b;if(F.roundRightBottom==1){d=true;}}if(z.style!=0){if(w!=0&&p.cellMap[t][w-1].rightLineStyleKey==0){}else{n.leftLineStyleKey=b.leftLineStyleKey;if(z.style==mCR_LineStyle.DoubleLine){var j=this.getCellLineWidth(z.width)/100*72/2.54*this.nPtToPxRate;this.paintCellLineLeft(y,z,v,J,o,g,-j);this.paintCellLineLeft(y,z,v,J,q,a,j);}else{if(z.style==mCR_LineStyle.InnerLine){var j=this.getCellLineWidth(z.width)/100*72/2.54*this.nPtToPxRate;this.paintCellLineLeft(y,z,v,J,q,a,j);}else{var j=0;this.paintCellLineLeft(y,z,v,J,f,u,j);}}}}if(H.style!=0){if(t!=0&&p.cellMap[t-1][w].bottomLineStyleKey==0){}else{n.topLineStyleKey=b.topLineStyleKey;if(H.style==mCR_LineStyle.DoubleLine){var A=this.getCellLineWidth(H.width)/100*72/2.54*this.nPtToPxRate;this.paintCellLineTop(y,H,v,m,G,E,-A);this.paintCellLineTop(y,H,v,m,B,r,A);}else{if(H.style==mCR_LineStyle.InnerLine){var A=this.getCellLineWidth(H.width)/100*72/2.54*this.nPtToPxRate;this.paintCellLineTop(y,H,v,m,B,r,A);}else{var A=0;this.paintCellLineTop(y,H,v,m,i,l,A);}}}}if(D.style!=0){if(!n.isLeftLast&&p.cellMap[t][w+1].leftLineStyleKey==0){}else{n.rightLineStyleKey=b.rightLineStyleKey;if(D.style==mCR_LineStyle.DoubleLine){var j=this.getCellLineWidth(D.width)/100*72/2.54*this.nPtToPxRate;this.paintCellLineRight(y,D,m,d,o,g,j);this.paintCellLineRight(y,D,m,d,q,a,-j);}else{if(D.style==mCR_LineStyle.InnerLine){var j=this.getCellLineWidth(D.width)/100*72/2.54*this.nPtToPxRate;this.paintCellLineRight(y,D,m,d,q,a,-j);}else{var j=0;this.paintCellLineRight(y,D,m,d,f,u,j);}}}}if(h.style!=0){if(!n.isTopLast&&p.cellMap[t+1][w].bottomLineStyleKey==0){}else{n.bottomLineStyleKey=b.bottomLineStyleKey;if(h.style==mCR_LineStyle.DoubleLine){var A=this.getCellLineWidth(h.width)/100*72/2.54*this.nPtToPxRate;this.paintCellLineBottom(y,h,J,d,G,E,A);this.paintCellLineBottom(y,h,J,d,B,r,-A);}else{if(h.style==mCR_LineStyle.InnerLine){var A=this.getCellLineWidth(h.width)/100*72/2.54*this.nPtToPxRate;this.paintCellLineBottom(y,h,J,d,B,r,-A);}else{var A=0;this.paintCellLineBottom(y,h,J,d,i,l,A);}}}}if(C.style!=0){this.paintLineBDiagonal(y,y,C,J,m);}if(I.style!=0){this.paintLineFDiagonal(y,y,I,v,d);}}};mCR_exportCanvas.prototype.paintCellLineLeft=function(h,d,f,c,j,g,b){var h=h.newRateRect(0.378);var i=b+(h.getLeft());var a=null;var k=null;if(!(f||c)){a=(h.getTop());k=(h.getBottom());}else{if(c){this.paintRoundLeftBottom(h,d,b,-b);a=(h.getTop());k=((h.getTop()+h.getHeight()/2));}else{this.paintRoundLeftTop(h,d,b,b);a=((h.getBottom()-h.getHeight()/2));k=(h.getBottom());}}a=a-j;k=k+g;this.lineDeduplication(i,a,i,k,d);this.paintLineStyle(d);this.objContext.beginPath();this.objContext.moveTo(i,a);this.objContext.lineTo(i,k);this.objContext.stroke();};mCR_exportCanvas.prototype.paintCellLineTop=function(k,h,i,b,d,g,c){var k=k.newRateRect(0.378);var j=(k.getTop())+c;var a=null;var f=null;if(!(i||b)){a=(k.getLeft());f=(k.getRight());}else{if(i){this.paintRoundTopLeft(k,h,c,c);a=((k.getRight()-k.getWidth()/2));f=(k.getRight());}else{this.paintRoundTopRight(k,h,-c,c);a=(k.getLeft());f=((k.getLeft()+k.getWidth()/2));}}a=a-d;f=f+g;this.lineDeduplication(a,j,f,j,h);this.paintLineStyle(h);this.objContext.beginPath();this.objContext.moveTo(a,j);this.objContext.lineTo(f,j);this.objContext.stroke();};mCR_exportCanvas.prototype.paintCellLineRight=function(g,d,b,i,j,f,c){var g=g.newRateRect(0.378);var h=c+(g.getRight());var a=null;var k=null;if(!(b||i)){a=(g.getTop());k=(g.getBottom());}else{if(i){this.paintRoundRightBottom(g,d,-c,-c);a=(g.getTop());k=((g.getTop()+g.getHeight()/2));}else{this.paintRoundRightTop(g,d,c,-c);a=((g.getBottom()-g.getHeight()/2));k=(g.getBottom());}}a=a-j;k=k+f;this.lineDeduplication(h,a,h,k,d);this.paintLineStyle(d);this.objContext.beginPath();this.objContext.moveTo(h,a);this.objContext.lineTo(h,k);this.objContext.stroke();};mCR_exportCanvas.prototype.paintCellLineBottom=function(j,h,f,k,c,g,b){var j=j.newRateRect(0.378);var i=(j.getBottom())+b;var a=null;var d=null;if(!(f||k)){a=(j.getLeft());d=(j.getRight());}else{if(f){this.paintRoundBottomLeft(j,h,-b,b);a=((j.getRight()-j.getWidth()/2));d=(j.getRight());}else{this.paintRoundBottomRight(j,h,-b,-b);a=(j.getLeft());d=((j.getLeft()+j.getWidth()/2));}}a=a-c;d=d+g;this.lineDeduplication(a,i,d,i,h);this.paintLineStyle(h);this.objContext.beginPath();this.objContext.moveTo(a,i);this.objContext.lineTo(d,i);this.objContext.stroke();};mCR_exportCanvas.prototype.paintLineFDiagonal=function(f,k,c,d,j){var f=f.newRateRect(0.378);var k=k.newRateRect(0.378);var h=0.7071;var b=(f.getLeft());var a=((k.getLeft()+k.getWidth()));var i=(f.getTop());var g=((k.getTop()+k.getHeight()));if(d){b+=((f.getWidth()/2*(1-h)));i+=((f.getHeight()/2*(1-h)));}if(j){a-=((k.getWidth()/2*(1-h)));g-=((k.getHeight()/2*(1-h)));}this.lineDeduplication(b,i,a,g,c);this.paintLineStyle(c);this.objContext.beginPath();this.objContext.moveTo(b,i);this.objContext.lineTo(a,g);this.objContext.stroke();};mCR_exportCanvas.prototype.paintLineBDiagonal=function(g,k,f,d,b){var g=g.newRateRect(0.378);var k=k.newRateRect(0.378);var i=0.7071;var c=(g.getLeft());var a=((k.getLeft()+k.getWidth()));var j=((g.getTop()+g.getHeight()));var h=(k.getTop());if(d){c+=((g.getWidth()/2*(1-i)));j-=((g.getHeight()/2*(1-i)));}if(b){a-=((k.getWidth()/2*(1-i)));h+=((k.getHeight()/2*(1-i)));}this.lineDeduplication(c,j,a,h,f);this.paintLineStyle(f);this.objContext.beginPath();this.objContext.moveTo(c,j);this.objContext.lineTo(a,h);this.objContext.stroke();};mCR_exportCanvas.prototype.paintRoundLeftTop=function(j,b,i,d){this.paintLineStyle(b);var a=((j.getLeft())+i).toFixed(2);var g=((j.getTop()+j.getHeight()/2)+d).toFixed(2);var h=((j.getTop()+j.getHeight()*0.2929)+d).toFixed(2);var c=(((j.getLeft()+j.getWidth()/2*0.2929))+i).toFixed(2);var f=((j.getTop()+j.getHeight()/2*0.2929)+d).toFixed(2);this.objContext.beginPath();this.objContext.moveTo(a,g);this.objContext.bezierCurveTo(a,g,a,h,c,f);this.objContext.stroke();};mCR_exportCanvas.prototype.paintRoundTopLeft=function(j,c,i,f){this.paintLineStyle(c);var a=((j.getTop())+f).toFixed(2);var g=(((j.getLeft()+j.getWidth()/2))+i).toFixed(2);var b=((j.getLeft()+j.getWidth()*0.2929)+i).toFixed(2);var d=(((j.getLeft()+j.getWidth()/2*0.2929))+i).toFixed(2);var h=((j.getTop()+j.getHeight()/2*0.2929)+f).toFixed(2);this.objContext.beginPath();this.objContext.moveTo(d,h);this.objContext.bezierCurveTo(b,a,g,a,g,a);this.objContext.stroke();};mCR_exportCanvas.prototype.paintRoundTopRight=function(j,b,h,d){this.paintLineStyle(b);var a=(j.getTop()+d).toFixed(2);var g=(j.getRight()+h).toFixed(2);var k=((j.getRight()-j.getWidth()/2)+h).toFixed(2);var c=((j.getRight()-j.getWidth()*0.2929)+h).toFixed(2);var i=(((j.getRight()-j.getWidth()/2*0.2929))+h).toFixed(2);var f=((j.getTop()+j.getHeight()/2*0.2929)+d).toFixed(2);this.objContext.beginPath();this.objContext.moveTo(i,f);this.objContext.bezierCurveTo(c,a,k,a,k,a);this.objContext.stroke();};mCR_exportCanvas.prototype.paintRoundRightTop=function(j,a,h,b){this.paintLineStyle(a);var d=(j.getRight()+h).toFixed(2);var i=(((j.getRight()-j.getWidth()/2*0.2929))+h).toFixed(2);var g=((j.getTop()+j.getHeight()*0.2929)+b).toFixed(2);var c=((j.getTop()+j.getHeight()/2*0.2929)+b).toFixed(2);var f=((j.getTop()+j.getHeight()/2)+b).toFixed(2);this.objContext.beginPath();this.objContext.moveTo(d,f);this.objContext.bezierCurveTo(d,f,d,g,i,c);this.objContext.stroke();};mCR_exportCanvas.prototype.paintRoundLeftBottom=function(j,b,i,d){this.paintLineStyle(b);var a=((j.getLeft())+i).toFixed(2);var g=((j.getBottom()-j.getHeight()/2)+d).toFixed(2);var h=((j.getBottom()-j.getHeight()*0.2929)+d).toFixed(2);var c=(((j.getLeft()+j.getWidth()/2*0.2929))+i).toFixed(2);var f=((j.getBottom()-j.getHeight()/2*0.2929)+d).toFixed(2);this.objContext.beginPath();this.objContext.moveTo(a,g);this.objContext.bezierCurveTo(a,g,a,h,c,f);this.objContext.stroke();};mCR_exportCanvas.prototype.paintRoundBottomLeft=function(i,b,h,d){this.paintLineStyle(b);var j=((i.getBottom())+d).toFixed(2);var f=(((i.getLeft()+i.getWidth()/2))+h).toFixed(2);var a=((i.getLeft()+i.getWidth()*0.2929)+h).toFixed(2);var c=(((i.getLeft()+i.getWidth()/2*0.2929))+h).toFixed(2);var g=((i.getBottom()-i.getHeight()/2*0.2929)+d).toFixed(2);this.objContext.beginPath();this.objContext.moveTo(c,g);this.objContext.bezierCurveTo(a,j,f,j,f,j);this.objContext.stroke();};mCR_exportCanvas.prototype.paintRoundRightBottom=function(j,a,h,b){this.paintLineStyle(a);var d=(j.getRight()+h).toFixed(2);var f=((j.getBottom()-j.getHeight()/2)+b).toFixed(2);var i=(((j.getRight()-j.getWidth()/2*0.2929))+h).toFixed(2);var g=((j.getBottom()-j.getHeight()*0.2929)+b).toFixed(2);var c=((j.getBottom()-j.getHeight()/2*0.2929)+b).toFixed(2);this.objContext.beginPath();this.objContext.moveTo(d,f);this.objContext.bezierCurveTo(d,f,d,g,i,c);this.objContext.stroke();};mCR_exportCanvas.prototype.paintRoundBottomRight=function(i,a,g,c){this.paintLineStyle(a);var j=((i.getBottom())+c).toFixed(2);var f=(i.getRight()+g).toFixed(2);var k=((i.getRight()-i.getWidth()/2)+g).toFixed(2);var b=((i.getRight()-i.getWidth()*0.2929)+g).toFixed(2);var h=(((i.getRight()-i.getWidth()/2*0.2929))+g).toFixed(2);var d=((i.getBottom()-i.getHeight()/2*0.2929)+c).toFixed(2);this.objContext.beginPath();this.objContext.moveTo(h,d);this.objContext.bezierCurveTo(b,j,k,j,k,j);this.objContext.stroke();};mCR_exportCanvas.prototype.getCellLineWidth=function(a){var b=4;var c=a/72*2.54;if(c<b){c=b;}return c;};mCR_exportCanvas.prototype.checkingLastCell=function(d){var a=d.cellMap.length;for(var f=0;f<a;f++){var g=d.cellMap[f].length;for(var c=0;c<g;c++){var b=d.cellMap[f][c];if(b.rowSpan>1){if(f+b.rowSpan==a){b.isTopLast=true;}}if(b.colSpan>1){if(c+b.colSpan==g){b.isLeftLast=true;}}if(f==a-1&&!b.dumy){b.isTopLast=true;}if(c==g-1&&!b.dumy){b.isLeftLast=true;}}}};mCR_exportCanvas.prototype.exportCrosstab=function(a){this.drawMatrixCells(a.matrixHeader);this.drawMatrixCells(a.matrixRow);this.drawMatrixCells(a.matrixColumn);this.drawMatrixCells(a.matrixSummarized);this.drawCrosstabOutterline(a);};mCR_exportCanvas.prototype.drawMatrixCells=function(a){var h=a.getRowCount();var i=a.getColumnCount();var d=new docStyleShape();d.shapeType=0;for(var f=0;f<h;f++){for(var j=0;j<i;j++){var b=a.getCrosstabBaseCell(f,j);if(b.getType()==mCR_DocumentControlType.TableCell){var g=b.getRectInPage();var d=new docStyleShape();d.shapeType=0;this.paintShapeStyle(d,g);var c=this.objDocument.getBackgroundStyle(b.backgroundStyleKey);this.paintBackgroundStyle(c,g);this.objContext.fill();this.paintText(g,b.detailTextInfo);if(b.editable){this.setEditWebLinkInfo(b,b.getRectInPage(),b.detailTextInfo,b.editableIndex);}if(b.webLinkInfo!=null){if(b.webLinkInfo.type!=-1){this.setWebLinkInfo(b.getRectInPage(),b.webLinkInfo);}}if(this.isAccessibility&&null!=b.accessibilityString){var k={type:20,msg:b.accessibilityString};this.setWebLinkInfo(b.getRectInPage(),k);}}}}for(var f=0;f<h;f++){for(var j=0;j<i;j++){var b=a.getCrosstabBaseCell(f,j);if(b.getType()==mCR_DocumentControlType.TableCell){this.drawCellLine(b);}}}};mCR_exportCanvas.prototype.drawCellLine=function(m){var k=m.getRectInPage();k=k.newRateRect(0.378);var i=this.objDocument.getLineStyle(m.leftLineStyleKey);var d=this.objDocument.getLineStyle(m.topLineStyleKey);var l=this.objDocument.getLineStyle(m.rightLineStyleKey);var b=this.objDocument.getLineStyle(m.bottomLineStyleKey);var j=this.objDocument.getLineStyle(m.frontDiagonalLineStyleKey);var h=this.objDocument.getLineStyle(m.backDiagonalLineStyleKey);if(i!=null&&d!=null&&l!=null&&b!=null&&d!=null){if(i.style!=0){var f=this.getWidthMarginNormal(d.width,d.style);var c=this.getWidthMarginNormal(b.width,b.style);this.lineDeduplication(k.left,k.top-f,k.left,k.bottom+c,i);this.paintLineStyle(i);this.objContext.beginPath();this.objContext.moveTo(k.left,k.top-f);this.objContext.lineTo(k.left,k.bottom+c);this.objContext.stroke();}if(d.style!=0){var a=this.getWidthMarginNormal(i.width,i.style);var g=this.getWidthMarginNormal(l.width,l.style);this.lineDeduplication(k.left-a,k.top,k.right+g,k.top,d);this.paintLineStyle(d);this.objContext.beginPath();this.objContext.moveTo(k.left-a,k.top);this.objContext.lineTo(k.right+g,k.top);this.objContext.stroke();}if(l.style!=0){var f=this.getWidthMarginNormal(d.width,d.style);var c=this.getWidthMarginNormal(b.width,b.style);this.lineDeduplication(k.right,k.top-f,k.right,k.bottom+c,l);this.paintLineStyle(l);this.objContext.beginPath();this.objContext.moveTo(k.right,k.top-f);this.objContext.lineTo(k.right,k.bottom+c);this.objContext.stroke();}if(b.style!=0){var a=this.getWidthMarginNormal(i.width,i.style);var g=this.getWidthMarginNormal(l.width,l.style);this.lineDeduplication(k.left-a,k.bottom,k.right+g,k.bottom,b);this.paintLineStyle(b);this.objContext.beginPath();this.objContext.moveTo(k.left-a,k.bottom);this.objContext.lineTo(k.right+g,k.bottom);this.objContext.stroke();}if(j.style!=0){this.lineDeduplication(k.right,k.top,k.left,k.bottom,j);this.paintLineStyle(j);this.objContext.beginPath();this.objContext.moveTo(k.right,k.top);this.objContext.lineTo(k.left,k.bottom);this.objContext.stroke();}if(h.style!=0){this.lineDeduplication(k.left,k.top,k.right,k.bottom,h);this.paintLineStyle(h);this.objContext.beginPath();this.objContext.moveTo(k.left,k.top);this.objContext.lineTo(k.right,k.bottom);this.objContext.stroke();}}};mCR_exportCanvas.prototype.drawCrosstabOutterline=function(b){var c=b.getRectInPage();var a=this.objDocument.getLineStyle(b.outterlineStyleKey);var d=new docStyleShape();d.shapeType=0;this.paintShapeStyle(d,c);this.paintLineStyle(a);this.objContext.stroke();};mCR_exportCanvas.prototype.getWidthMarginNormal=function(b,a){var c=this.getCellLineWidth(b);var d=0;if(a==mCR_LineStyle.DoubleLine||a==mCR_LineStyle.InnerLine){d=+c/2+2;}else{d=(c/2)-1;if(d<0){d=0;}}return d/100*72/2.54*this.nPtToPxRate;};mCR_exportCanvas.prototype.getWidthMarginOutter=function(b,a){var c=this.getCellLineWidth(b);var d=0;if(a==mCR_LineStyle.DoubleLine||a==mCR_LineStyle.InnerLine){d=c/2*3-2;}else{d=(c/2)-1;}return d/100*72/2.54*this.nPtToPxRate;};mCR_exportCanvas.prototype.getWidthMarginInner=function(b,a){var c=this.getCellLineWidth(b);var d=0;if(a==mCR_LineStyle.DoubleLine||a==mCR_LineStyle.InnerLine){d=-1*c/2-2;}else{d=(c/2)-1;}return d/100*72/2.54*this.nPtToPxRate;};mCR_exportCanvas.prototype.shiftCheckboxPosition=function(b,c){var f=c;var d=b.documentCheckbox.rect;var g=d.getWidth();var a=d.getHeight();var i=f.left+((f.getWidth()-g)/2);var h=f.top+((f.getHeight()-a)/2);d.left=i;d.top=h;d.right=i+g;d.bottom=h+a;};mCR_exportCanvas.prototype.exportReportControl=function(a){for(var b=0;b<a.subSectionList.length;b++){this.exportReportControlSubSection(a.subSectionList[b]);}for(var b=0;b<a.subSectionList.length;b++){this.exportControlsInSubSection(a.subSectionList[b]);}};mCR_exportCanvas.prototype.exportReportControlSubSection=function(d){var c=d.getRectInPage();var b=c.newRateRect(this.nPixelRate);var a=this.objDocument.getBackgroundStyle(d.backgroundStyleKey);if(null!=a&&a.backStyle==0){this.objContext.fillStyle=mCR_getStrColor(a.backColor);this.objContext.fillRect(b.left,b.top,b.getWidth(),b.getHeight());}};mCR_exportCanvas.prototype.exportControlsInSubSection=function(f){for(var b=0;b<f.controlPageList.length;b++){var a=f.controlPageList[b];var d=true;if(-1!=a.visibleOptionStyleKey){var c=this.objDocument.getVisibleOptionStyle(a.visibleOptionStyleKey);if(null!=c){d=c.toView;}}if(d){this.exportControl(a);}}};mCR_exportCanvas.prototype.paintShapeStyle=function(i,f){var b=f.newRateRect(this.nPixelRate);var h=b.left;var g=b.top;var d=b.getWidth();var a=b.getHeight();if(i.shapeType==0){this.objContext.beginPath();this.objContext.rect(h,g,d,a);}else{if(i.shapeType==1){this.objContext.ellipseRect(h,g,d,a);}else{var c=(Math.min(d,a)*i.roundRate/100)/2;this.objContext.roundRect(h,g,d,a,c);}}};mCR_exportCanvas.prototype.paintLineStyle=function(a,c){if(typeof c=="undefined"){c=false;}if(a.style==0){this.objContext.strokeStyle="rgba(0,0,0,0)";this.objContext.lineWidth=1;if(this.objContext.setLineDash!==undefined){this.objContext.setLineDash([]);}return;}if(a.width>75||c){this.objContext.lineWidth=(a.width/100)*this.nPtToPxRate;}else{this.objContext.lineWidth=1;}this.objContext.strokeStyle=mCR_getStrColor(a.color);var b=a.width>100?a.width/100:1;if(this.objContext.setLineDash!==undefined){this.objContext.setLineDash([]);switch(a.style){case 2:this.objContext.setLineDash([(4*b),(2*b)]);break;case 3:this.objContext.setLineDash([(1.333*b),(1.333*b)]);break;case 4:this.objContext.setLineDash([(4*b),(2*b),(1.333*b),(2*b)]);break;case 5:this.objContext.setLineDash([(4*b),(2*b),(1.333*b),(2*b),(1.333*b),(2*b)]);break;case 7:case 9:this.objContext.lineWidth=((a.width*1.5)/100)*this.nPtToPxRate;break;case 11:this.objContext.setLineDash([(4*5/3*b),(4*b)]);break;}}};mCR_exportCanvas.prototype.paintBackgroundStyle=function(a,b){if(a.backStyle==1){this.objContext.fillStyle="rgba(255,255,255,0)";return;}if(a.gradientStyle==0){switch(a.fillStyle){case 0:this.objContext.fillStyle=mCR_getStrColor(a.backColor);break;case 1:this.patternHorizontalLine(a);break;case 2:this.patternVerticalLine(a);break;case 3:this.patternCrossLine(a);break;case 4:this.patternBackDiagonalLine(a);break;case 5:this.patternFrontDiagonalLine(a);break;case 6:this.patternCrossDiagonalLine(a);break;case 7:this.patternDotDensed(a);break;case 8:this.patternDot(a);break;case 9:this.patternDotRare(a);break;}}else{switch(a.gradientStyle){case 1:this.gradientTopBottom(b,a);break;case 2:this.gradientBottomTop(b,a);break;case 3:this.gradientLeftRight(b,a);break;case 4:this.gradientRightLeft(b,a);break;case 5:this.gradientRadial(b,a);break;case 6:this.gradientDiagonalF(b,a);break;case 7:this.gradientDiagonalB(b,a);break;}}};mCR_exportCanvas.prototype.paintBackgroundImageStyle=function(h,g,a,f,d){if(null==d||-1==d){return;}var c=this.pageImageList[d];if(null==c){return;}var b=g.imageDrawMethod;switch(b){case 1:this.imageOriginalSize(h,g,a,f,d);break;case 2:this.imageStretch(h,a,f,d);break;case 3:this.imageTile(h,g,a,f,d);break;case 4:this.imageZoom(h,g,a,f,d);break;case 5:this.imageShrink(h,g,a,f,d);break;}};mCR_exportCanvas.prototype.paintText=function(c,j){var s=j.getOriginalTextInfo().getFontStyleKey();var m=this.objDocument.getTextMarginStyle(j.getOriginalTextInfo().getTextMarginStyleKey());if(j.getUseMultiLanguage()||this.objDocument.getUseMultiLanguage()){c.setLeft(c.getLeft()+m.left);c.setRight(c.getRight()-m.right);c.setTop(c.getTop()+m.top);c.setBottom(c.getBottom()-m.bottom);var x=this.objDocument.getTextOptionStyle(j.getOriginalTextInfo().getTextOptionStyleKey());var a=x.getHorizontalAlignment();var r=x.getVerticalAlignment();var n=this.objDocument.getFontStyle(s);var l=c.getTop();var f=j.getHeight();if(mCR_VerticalAlignmentMethod.Bottom==r){l=c.getBottom()-f-(f*0.15);}else{if(mCR_VerticalAlignmentMethod.Center==r){l=(c.getBottom()+c.getTop()-f)/2;}}var b=j.getTextLineCount();for(var t=0;t<b;t++){var u=j.getTextLine(t);var w=c.getLeft();var v=l+u.getHeight();v+=u.getY();if(v<=c.getBottom()+(f*0.15)){var q=false;var g="";if(n!=null){if(n.bold){q=true;g+="bold ";this.objContext.strokeStyle=mCR_getStrColor(n.color);this.objContext.lineWidth="0.1";}if(n.italic){g+="italic ";}g+=n.size+"pt ";g+=this.objDocument.getFontNameStyle(n.nameEngIndex);}this.objContext.font=g;this.objContext.fillStyle=mCR_getStrColor(n.color);var p=0;if(mCR_HorizontalAlignmentMethod.Right==a){p=this.getTextCanvasWidth(n,u);w=c.getRight()-p*254/96;}else{if(mCR_HorizontalAlignmentMethod.Middle==a){p=this.getTextCanvasWidth(n,u);w=(c.getRight()+c.getLeft()-p*254/96)/2;}}var k=j.getOriginalTextInfo().getCharDirection();if(k==0){this.objContext.direction="inherit";this.objContext.fillText(u.getText(),w*0.378,v*0.378);}else{var d=1==k?true:false;if(d){if(mCR_isEdge||mCR_isIE||mCR_isFirefox){}else{w=c.getRight();if(mCR_HorizontalAlignmentMethod.Left==a){p=this.getTextCanvasWidth(n,u,true);w=c.getLeft()+p*254/96;}else{if(mCR_HorizontalAlignmentMethod.Middle==a){p=this.getTextCanvasWidth(n,u,true);w=c.getRight()-(c.getWidth()-p*254/96)/2;}}}this.objContext.direction="rtl";}else{this.objContext.direction="inherit";}this.objContext.fillText(u.getText(),w*0.378,v*0.378);if(q){this.objContext.strokeText(u.getText(),w*0.378,v*0.378);}}}else{break;}}}else{var o=j.getOriginalTextInfo().getTextRotation();var h=c.getHeight();this.objContext.save();this.isRotation=true;if(o==90){this.objContext.translate(c.left*0.378,(c.top+c.getHeight())*0.378);this.objContext.rotate(270*Math.PI/180);h=c.getWidth();}else{if(o==180){this.objContext.translate((c.left+c.getWidth())*0.378,(c.top+c.getHeight())*0.378);this.objContext.rotate(180*Math.PI/180);}else{if(o==270){this.objContext.translate((c.left+c.getWidth())*0.378,c.getTop()*0.378);this.objContext.rotate(90*Math.PI/180);h=c.getWidth();}else{this.isRotation=false;}}}this.drawTextLine(c,m,h,o,j,s);this.objContext.restore();this.isRotation=false;}};mCR_exportCanvas.prototype.getTextCanvasWidth=function(h,g,f){if(this.elmCanvas==null){this.elmCanvas=document.createElement("canvas");}var c="";if(h.italic){c="italic ";}var d="";if(h.bold){d="bold ";}var b=this.elmCanvas.getContext("2d");if(f&&f!=null){b.direction="rtl";}else{b.direction="inherit";}b.font=c+d+h.size+"pt "+decodeURIComponent(this.objDocument.getFontNameStyle(h.nameEngIndex));var a=g.getText();return b.measureText(a).width;};mCR_exportCanvas.prototype.drawTextShape=function(p,j,b){var g=b.getTextShapeCount();var h=p.newRateRect(this.nPixelRate);for(var m=0;m<g;m++){var f=b.getTextShape(m);var l=f.rect.newRateRect(this.nPixelRate);var q=this.objDocument.getLineStyle(f.lineStyleKey);var o=f.shapeType;var d=h.left+l.left;var r=h.right+l.right;var n=h.top+l.top;var a=h.bottom+l.bottom;var c=h.left+l.getWidth();if(this.isRotation){var d=l.left;var r=l.right;var n=l.top;var a=l.bottom;var c=l.getWidth();}if(o==0){this.paintLineStyle(q);if(null!=q&&q.style!=0){this.objContext.beginPath();this.objContext.moveTo(d,n);this.objContext.lineTo(c,n);}}else{this.paintLineStyle(q,true);if(null!=q&&q.style!=0){var k=null;if(o==2){this.objContext.ellipseRect(d,n,l.getWidth(),l.getHeight());}else{this.objContext.beginPath();this.objContext.rect(d,n,l.getWidth(),l.getHeight());}}}this.objContext.stroke();}};mCR_exportCanvas.prototype.drawCharacter=function(j,a,c,h,k){var g=a.getCharacterCount();for(var f=0;f<g;f++){var l=a.getCharacter(f);var b=false;var d="";if(h!=null){if(h.bold){b=true;d+="bold ";this.objContext.strokeStyle=mCR_getStrColor(h.color);this.objContext.lineWidth="0.1";}if(h.italic){d+="italic ";}if(a.getIsSmallChar()){d+=k.size*0.65+"pt ";}else{if(a.getIsSup()||a.getIsSub()){d+=k.size*0.5+"pt ";}else{d+=h.size+"pt ";}}d+=decodeURIComponent(this.objDocument.getFontNameStyle(h.nameEngIndex));this.objContext.fillStyle=mCR_getStrColor(h.color);}else{if(k.bold){b=true;d+="bold ";this.objContext.strokeStyle=mCR_getStrColor(k.color);this.objContext.lineWidth="0.1";}if(k.italic){d+="italic ";}if(a.getIsSmallChar()){d+=k.size*0.65+"pt ";}else{if(a.getIsSup()||a.getIsSub()){d+=k.size*0.5+"pt ";}else{d+=k.size+"pt ";}}d+=decodeURIComponent(this.objDocument.getFontNameStyle(k.nameEngIndex));this.objContext.fillStyle=mCR_getStrColor(k.color);}this.objContext.font=d;if(this.isRotation){this.objContext.fillText(l.getCharacter(),(l.getX())*0.378,(c-j.top)*0.378);if(b){this.objContext.strokeText(l.getCharacter(),(l.getX())*0.378,(c-j.top)*0.378);}}else{this.objContext.fillText(l.getCharacter(),(l.getX()+j.left)*0.378,(c)*0.378);if(b){this.objContext.strokeText(l.getCharacter(),(l.getX()+j.left)*0.378,(c)*0.378);}}}};mCR_exportCanvas.prototype.adjustDescent=function(d,c,i){var h=d.getTop()+c.getY();var f=i.getIsSmallChar();var g=i.getIsSup();var b=i.getIsSub();var a=c.getHeight();if(g||b){a=a*0.5;if(b){h=h+a;}}else{if(f){a=a*0.65;h+=a;h=h-a*0.8;}}h=h+a-a*0.15;return h;};mCR_exportCanvas.prototype.drawTextLine=function(h,d,j,l,c,g){var b=c.getTextLineCount();var k=this.objDocument.getFontStyle(g);for(var f=0;f<b;f++){var a=c.getTextLine(f);if(a.getY2()<=j+a.getHeight()*0.15||((l==0||l==180)&&f==0)){this.drawCharacterBatch(h,a,g,c,k);}this.drawTextShape(h,d,a);}};mCR_exportCanvas.prototype.drawCharacterBatch=function(j,a,g,b,k){var l=a.getCharacterBatchCount();for(var f=0;f<l;f++){var c=a.getCharacterBatch(f);var h=null;if(c.getFontStyleKey()!=-1){h=this.objDocument.getFontStyle(c.getFontStyleKey());}var d=this.adjustDescent(j,a,c);this.drawCharacter(j,c,d,h,k);}};mCR_exportCanvas.prototype.lineDeduplication=function(c,g,i,a,d){var b=new Array();b.push(c);b.push(g);b.push(i);b.push(a);b.push(d.style);b.push(d.width);b.push(d.color);var j=b.join(",");var f=this.objLineHashMap[j];if(null!=f){var h=new docStyleLine();h.setStyle(d.style,d.width,16777215);this.paintLineStyle(h);this.objContext.beginPath();this.objContext.moveTo(c,g);this.objContext.lineTo(i,a);this.objContext.stroke();this.objContext.beginPath();this.objContext.moveTo(c,g);this.objContext.lineTo(i,a);this.objContext.stroke();}this.objLineHashMap[j]="temp";};mCR_exportCanvas.prototype.setWebLinkInfo=function(c,f){var d={rect:c,info:f};if(null!=f.ctrl){var a=c.toString();var b=this.objAccHashMap[a];if(null!=b){if(f.type==20){b.type=20;b.msg=b.msg+f.msg;return;}}else{this.objAccHashMap[a]=f;}}this.webLinkList.push(d);};mCR_exportCanvas.prototype.setEditWebLinkInfo=function(b,c,a,f){var h=new docWebLinkInfo();h.type=1;h.editableIndex=f;h.editText=a.getOriginalTextInfo().text;h.objControl=b;var g=a.getOriginalTextInfo().getFontStyleKey();var i=this.objDocument.getFontStyle(g);h.fontStyle="font-size:"+i.size+"pt;font-family:"+this.objDocument.getFontNameStyle(i.nameEngIndex)+";";var d={rect:c,info:h};this.webLinkList.push(d);};mCR_exportCanvas.prototype.setCheckEditWebLinkInfo=function(a,b,d,g){var f=new docWebLinkInfo();f.type=4;f.editableIndex=d;f.objControl=a;f.isChecked=g;var c={rect:b,info:f};this.webLinkList.push(c);};mCR_exportCanvas.prototype.setInputControlInfo=function(b,a){var c={rect:b,info:{type:10,ctrlName:a}};this.webLinkList.push(c);};mCR_exportCanvas.prototype.imageShrink=function(c,d,b,i,f){var a=(i.getWidth()*0.378);var g=(i.getHeight()*0.378);b.dpiX=b.dpiX>1?b.dpiX:96;b.dpiY=b.dpiY>1?b.dpiY:96;var j=(b.imageWidth/b.dpiX)*96;var h=(b.imageHeight/b.dpiY)*96;j=j*(d.rate/100);h=h*(d.rate/100);if(a>=j&&g>=h){this.imageOriginalSize(c,d,b,i,f);}else{this.imageZoom(c,d,b,i,f);}};mCR_exportCanvas.prototype.imageZoom=function(r,j,g,c,t){var f=c.left*this.nPixelRate;var s=c.top*this.nPixelRate;var C=c.right*this.nPixelRate;var m=c.bottom*this.nPixelRate;var a=C-f;var x=m-s;var d=0;var l=0;g.dpiX=g.dpiX>1?g.dpiX:96;g.dpiY=g.dpiY>1?g.dpiY:96;var n=(g.imageWidth/g.dpiX)*96;var B=(g.imageHeight/g.dpiY)*96;var A=n/B;var k=a/x;if(A>k){var D=B/n;B=a*D;n=a;if(j.verticalAlignment==1){if(x>B){l=(x-B)/2;}}else{if(j.verticalAlignment==2){if(x>B){l=(x-B);}}}}else{var D=n/B;n=x*D;B=x;if(j.horizontalAlignment==1){if(a>n){d=(a-n)/2;}}else{if(j.horizontalAlignment==2){if(a>n){d=a-n;}}}}d+=f;l+=s;this.paintShapeStyle(r,c);var y=this.pageImageList[t].width;var i=this.pageImageList[t].height;var b=1;var q=1;var o=1;q=n/y;o=B/i;if(q<o){b=q;}else{b=o;}if(b<1){b=b*2;var u=document.createElement("canvas");var v=u.getContext("2d");var p=y*b;var z=i*b;u.width=p;u.height=z;v.drawImage(this.pageImageList[t],0,0,p,z);this.objContext.drawImage(u,d,l,n,B);}else{this.objContext.drawImage(this.pageImageList[t],d,l,n,B);}};mCR_exportCanvas.prototype.imageTile=function(d,f,c,m,g){var q=document.createElement("canvas");var o=q.getContext("2d");var b=m.left*this.nPixelRate;var l=m.top*this.nPixelRate;var p=m.right*this.nPixelRate;var a=m.bottom*this.nPixelRate;q.width=p;q.height=a;var r=0;var h=0;c.dpiX=c.dpiX>1?c.dpiX:96;c.dpiY=c.dpiY>1?c.dpiY:96;var k=(c.imageWidth/c.dpiX)*96;var j=(c.imageHeight/c.dpiY)*96;k=k*(f.rate/100);j=j*(f.rate/100);r+=b;h+=l;for(var n=r;n<p;n+=k){for(var i=h;i<a;i+=j){o.drawImage(this.pageImageList[g],n,i,k,j);}}this.paintShapeStyle(d,m);this.objContext.fillStyle=this.objContext.createPattern(q,"repeat");this.objContext.fill();};mCR_exportCanvas.prototype.imageOriginalSize=function(f,g,d,n,h){var q=document.createElement("canvas");var o=q.getContext("2d");var b=n.left*this.nPixelRate;var m=n.top*this.nPixelRate;var p=n.right*this.nPixelRate;var a=n.bottom*this.nPixelRate;q.width=p;q.height=a;var r=0;var j=0;d.dpiX=d.dpiX>1?d.dpiX:96;d.dpiY=d.dpiY>1?d.dpiY:96;var l=(d.imageWidth/d.dpiX)*96;var k=(d.imageHeight/d.dpiY)*96;l=l*(g.rate/100);k=k*(g.rate/100);if(g.horizontalAlignment==1){var c=(n.getWidth()*0.378);if(c>l){r=(c-l)/2;}}else{if(g.horizontalAlignment==2){var c=(n.getWidth()*0.378);if(c>l){r=c-l;}}}if(g.verticalAlignment==1){var i=(n.getHeight()*0.378);if(i>k){j=(i-k)/2;}}else{if(g.verticalAlignment==2){var i=(n.getHeight()*0.378);if(i>k){j=(i-k);}}}r+=b;j+=m;o.drawImage(this.pageImageList[h],r,j,l,k);this.paintShapeStyle(f,n);this.objContext.fillStyle=this.objContext.createPattern(q,"no-repeat");this.objContext.fill();};mCR_exportCanvas.prototype.imageStretch=function(l,f,p,m){var d=p.left*this.nPixelRate;var o=p.top*this.nPixelRate;var a=p.getWidth()*this.nPixelRate;var r=p.getHeight()*this.nPixelRate;this.paintShapeStyle(l,p);var c=this.pageImageList[m].width;var n=this.pageImageList[m].height;var b=1;var k=1;var i=1;k=a/c;i=r/n;if(k<i){b=k;}else{b=i;}if(b<1){b=b*2;var g=document.createElement("canvas");var s=g.getContext("2d");var q=c*b;var j=n*b;g.width=q;g.height=j;s.drawImage(this.pageImageList[m],0,0,q,j);this.objContext.drawImage(g,d,o,a,r);}else{this.objContext.drawImage(this.pageImageList[m],d,o,a,r);}};mCR_exportCanvas.prototype.brushCheck=function(i,b,c){var f=i.left*0.378;var j=i.right*0.378;var h=i.top*0.378;var a=i.bottom*0.378;switch(b){case 0:var d=(j-f)/6;var k=(a-h)/6;this.objContext.beginPath();this.objContext.moveTo((f+(d*0)),(h+(d*2)));this.objContext.lineTo((f+(d*2)),(h+(d*4)));this.objContext.lineTo((f+(d*6)),(h+(d*0)));this.objContext.lineTo((f+(d*6)),(h+(d*2)));this.objContext.lineTo((f+(d*2)),(h+(d*6)));this.objContext.lineTo((f+(d*0)),(h+(d*4)));this.objContext.closePath();break;case 1:this.objContext.beginPath();this.objContext.rect(f,h,j-f,a-h);break;case 2:this.objContext.ellipseRect(f,h,j-f,a-h);break;case 3:var g=((j-f)*0.3)/2;this.objContext.roundRect(f,h,j-f,a-h,g);break;}this.objContext.fillStyle=mCR_getStrColor(c);this.objContext.fill();};mCR_exportCanvas.prototype.gradientRadial=function(i,f){var c=i.left*this.nPixelRate;var h=i.top*this.nPixelRate;var k=i.right*this.nPixelRate;var a=i.bottom*this.nPixelRate;var g=c+((k-c)/2);var d=h+((a-h)/2);var b=Math.max(k-c,a-h)/2;var j=this.objContext.createRadialGradient(g,d,5,g,d,b);j.addColorStop(0,mCR_getStrColor(f.gradientStartColor));j.addColorStop(1,mCR_getStrColor(f.gradientEndColor));this.objContext.fillStyle=j;};mCR_exportCanvas.prototype.gradientDiagonalB=function(d,a){var h=d.left*this.nPixelRate;var g=d.top*this.nPixelRate;var c=d.right*this.nPixelRate;var b=d.bottom*this.nPixelRate;var f=this.objContext.createLinearGradient(c,g,h,b);f.addColorStop(0,mCR_getStrColor(a.gradientStartColor));f.addColorStop(1,mCR_getStrColor(a.gradientEndColor));this.objContext.fillStyle=f;};mCR_exportCanvas.prototype.gradientDiagonalF=function(d,a){var h=d.left*this.nPixelRate;var g=d.top*this.nPixelRate;var c=d.right*this.nPixelRate;var b=d.bottom*this.nPixelRate;var f=this.objContext.createLinearGradient(h,g,c,b);f.addColorStop(0,mCR_getStrColor(a.gradientStartColor));f.addColorStop(1,mCR_getStrColor(a.gradientEndColor));this.objContext.fillStyle=f;};mCR_exportCanvas.prototype.gradientRightLeft=function(d,a){var h=d.left*this.nPixelRate;var g=d.top*this.nPixelRate;var c=d.right*this.nPixelRate;var b=d.bottom*this.nPixelRate;var f=this.objContext.createLinearGradient(h,g,c,g);f.addColorStop(0,mCR_getStrColor(a.gradientEndColor));f.addColorStop(1,mCR_getStrColor(a.gradientStartColor));this.objContext.fillStyle=f;};mCR_exportCanvas.prototype.gradientLeftRight=function(d,a){var h=d.left*this.nPixelRate;var g=d.top*this.nPixelRate;var c=d.right*this.nPixelRate;var b=d.bottom*this.nPixelRate;var f=this.objContext.createLinearGradient(h,g,c,g);f.addColorStop(0,mCR_getStrColor(a.gradientStartColor));f.addColorStop(1,mCR_getStrColor(a.gradientEndColor));this.objContext.fillStyle=f;};mCR_exportCanvas.prototype.gradientBottomTop=function(d,a){var h=d.left*this.nPixelRate;var g=d.top*this.nPixelRate;var c=d.right*this.nPixelRate;var b=d.bottom*this.nPixelRate;var f=this.objContext.createLinearGradient(h,g,h,b);f.addColorStop(0,mCR_getStrColor(a.gradientEndColor));f.addColorStop(1,mCR_getStrColor(a.gradientStartColor));this.objContext.fillStyle=f;};mCR_exportCanvas.prototype.gradientTopBottom=function(d,a){var h=d.left*this.nPixelRate;var g=d.top*this.nPixelRate;var c=d.right*this.nPixelRate;var b=d.bottom*this.nPixelRate;var f=this.objContext.createLinearGradient(h,g,h,b);f.addColorStop(0,mCR_getStrColor(a.gradientStartColor));f.addColorStop(1,mCR_getStrColor(a.gradientEndColor));this.objContext.fillStyle=f;};mCR_exportCanvas.prototype.patternDotRare=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=7.56;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.fillStyle=mCR_getStrColor(b.fillColor);c.fillRect(0,0,1,1);c.fillRect(a/2,a/2,1,1);this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};mCR_exportCanvas.prototype.patternDot=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=5.292;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.fillStyle=mCR_getStrColor(b.fillColor);c.fillRect(0,0,1,1);c.fillRect(a/2,a/2,1,1);this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};mCR_exportCanvas.prototype.patternDotDensed=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=3.024;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.fillStyle=mCR_getStrColor(b.fillColor);c.fillRect(0,0,1,1);c.fillRect(a/2,a/2,1,1);this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};mCR_exportCanvas.prototype.patternCrossDiagonalLine=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=6.804;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.strokeStyle=mCR_getStrColor(b.fillColor);c.lineWidth=1;c.beginPath();c.moveTo(a,0);c.lineTo(0,a);c.stroke();c.beginPath();c.moveTo(0,0);c.lineTo(a,a);c.stroke();this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};mCR_exportCanvas.prototype.patternFrontDiagonalLine=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=6.804;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.strokeStyle=mCR_getStrColor(b.fillColor);c.lineWidth=1;c.beginPath();c.moveTo(a,0);c.lineTo(0,a);c.stroke();c.beginPath();c.moveTo(0,0);c.lineTo(1,1);c.stroke();c.beginPath();c.moveTo(a,a);c.lineTo(a-1,a-1);c.stroke();this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};mCR_exportCanvas.prototype.patternBackDiagonalLine=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=6.804;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.strokeStyle=mCR_getStrColor(b.fillColor);c.lineWidth=1;c.beginPath();c.moveTo(0,0);c.lineTo(a,a);c.stroke();c.beginPath();c.moveTo(0,a);c.lineTo(1,a-1);c.stroke();c.beginPath();c.moveTo(a,0);c.lineTo(a-1,1);c.stroke();this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};mCR_exportCanvas.prototype.patternCrossLine=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=6.804;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.strokeStyle=mCR_getStrColor(b.fillColor);c.lineWidth=1;c.beginPath();c.moveTo(a/2,0);c.lineTo(a/2,a);c.stroke();c.beginPath();c.moveTo(0,a/2);c.lineTo(a,a/2);c.stroke();this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};mCR_exportCanvas.prototype.patternVerticalLine=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=6.804;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.strokeStyle=mCR_getStrColor(b.fillColor);c.lineWidth=1;c.beginPath();c.moveTo(a/2,0);c.lineTo(a/2,a);c.stroke();this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};mCR_exportCanvas.prototype.patternHorizontalLine=function(b){var d=document.createElement("canvas");var c=d.getContext("2d");var a=6.804;d.width=a;d.height=a;c.fillStyle=mCR_getStrColor(b.backColor);c.fillRect(0,0,a,a);c.strokeStyle=mCR_getStrColor(b.fillColor);c.lineWidth=1;c.beginPath();c.moveTo(0,a/2);c.lineTo(a,a/2);c.stroke();this.objContext.fillStyle=this.objContext.createPattern(d,"repeat");};if(typeof window.CanvasRenderingContext2D!="undefined"){CanvasRenderingContext2D.prototype.roundRect=function(a,f,b,c,d){if(b<2*d){d=b/2;}if(c<2*d){d=c/2;}this.beginPath();this.moveTo(a+d,f);this.arcTo(a+b,f,a+b,f+c,d);this.arcTo(a+b,f+c,a,f+c,d);this.arcTo(a,f+c,a,f,d);this.arcTo(a,f,a+b,f,d);this.closePath();return this;};CanvasRenderingContext2D.prototype.ellipseRect=function(k,j,l,d){var i=0.5522848,c=(l/2)*i,a=(d/2)*i,m=k+l,g=j+d,f=k+l/2,b=j+d/2;this.beginPath();this.moveTo(k,b);this.bezierCurveTo(k,b-a,f-c,j,f,j);this.bezierCurveTo(f+c,j,m,b-a,m,b);this.bezierCurveTo(m,b+a,f+c,g,f,g);this.bezierCurveTo(f-c,g,k,b+a,k,b);return this;};}function mCR_getFontCss(d,f,c){for(var b=0;b<f.length;b++){var a=f[b];d.push(".s_"+c.reportKey+b+"{");d.push("font-size:");d.push(a.size);d.push("pt;");d.push("font-family:");d.push(c.getFontNameStyle(a.nameEngIndex));d.push(",");d.push(c.getFontNameStyle(a.nameIndex));d.push(";");d.push("color:");d.push(mCR_getStrColor(a.color));d.push(";");d.push("fill:");d.push(mCR_getStrColor(a.color));d.push(";");if(a.bold){d.push("font-weight:bold;");}else{d.push("stroke-width:0;");}if(a.italic){d.push("font-style:italic;");}d.push("}");if(window.is_apple||window.mCR_isApple){if(a.bold){d.push(".b_"+c.reportKey+b+"{");d.push("font-weight:normal;");d.push("stroke:");d.push(mCR_getStrColor(a.color));d.push(";");d.push("stroke-width:0.8;");d.push("paint-order:stroke;");d.push("}");}}}}function mCR_changeRGBAColor(f,b){var d=f&255;var c=(f>>8)&255;var a=(f>>16)&255;return"rgba("+d+","+c+","+a+","+(b/100)+")";}function mCR_getLineStyleTag(a){var c="";var b=a.width>75?a.width:75;c+=(b/100)+"pt ";switch(a.style){case 2:case 4:case 5:c+="dashed ";break;case 3:c+="dotted ";break;case 8:c+="double ";break;default:c+="solid ";break;}c+=mCR_getStrColor(a.color)+";";return c;}function mCR_setAlignmentMethod(a,b){switch(b.horizontalAlignment){case 0:a.align="left";break;case 1:a.align="center";break;case 2:a.align="right";break;}switch(b.verticalAlignment){case 0:a.vAlign="top";break;case 1:a.vAlign="middle";break;case 2:a.vAlign="bottom";break;}}function mCR_setInputAlignmentMethod(a,b){switch(b.horizontalAlignment){case 0:a.style.textAlign="left";break;case 1:a.style.textAlign="center";break;case 2:a.style.textAlign="right";break;}}function mRe_spaceStyle(c,b,a){if(null!=b&&null!=a){c.style.lineHeight=(a.size+b.lineSpace)+"pt";c.style.letterSpacing=b.wordSpace+"pt";}}mCR_exportCanvas.prototype.barcodePainterDraw=function(c,b){var a=null;switch(c.barcodeSymbology){case 1:a=new mCR_SymbologyCode39(true,this.objContext,c,b);break;case 2:a=new mCR_SymbologyCode39A(true,this.objContext,c,b);break;case 3:a=new mCR_SymbologyCode93(true,this.objContext,c,b);break;case 4:a=new mCR_SymbologyCode93A(true,this.objContext,c,b);break;case 5:a=new mCR_SymbologyCodaBar(true,this.objContext,c,b);break;case 6:a=new mCR_SymbologyCode11(true,this.objContext,c,b);break;case 10:a=new mCR_SymbologyCode128(true,this.objContext,c,b);break;case 11:a=new mCR_SymbologyCode128A(true,this.objContext,c,b);break;case 12:a=new mCR_SymbologyCode128B(true,this.objContext,c,b);break;case 13:a=new mCR_SymbologyCode128C(true,this.objContext,c,b);break;case 15:a=new mCR_Symbology2of5IATA(true,this.objContext,c,b);break;case 16:a=new mCR_Symbology2of5Matrix(true,this.objContext,c,b);break;case 17:a=new mCR_Symbology2of5Industrial(true,this.objContext,c,b);break;case 18:a=new mCR_Symbology2of5Interleaved(true,this.objContext,c,b);break;case 20:a=new mCR_SymbologyEAN8(true,this.objContext,c,b);break;case 21:a=new mCR_SymbologyEAN13(true,this.objContext,c,b);break;case 40:a=new mCR_SymbologyKoreanPostalCode(true,this.objContext,c,b);break;case 50:a=new mCR_SymbologyQRCode(true,this.objContext,c,b);break;case 51:a=new mCR_SymbologyDataMatrix(true,this.objContext,c,b);break;case 52:a=new mCR_SymbologyPDF417(true,this.objContext,c,b);break;}if(null!=a){a.drawBarcode();}};function mCR_exportCanvasForZoom(b,c,a){mCR_exportCanvas.call(this,b,c,a);}mCR_exportCanvasForZoom.prototype=Object.create(mCR_exportCanvas.prototype);mCR_exportCanvasForZoom.prototype.constructor=mCR_exportCanvasForZoom;mCR_exportCanvasForZoom.prototype.findControlsInSubSectionImage=function(f){if(this.isEasyInput&&f.isDrilling){return;}for(var b=0;b<f.controlPageList.length;b++){var a=f.controlPageList[b];var d=true;if(-1!=a.visibleOptionStyleKey){var c=this.objDocument.getVisibleOptionStyle(a.visibleOptionStyleKey);if(null!=c){d=c.toView;}}if(d){this.findImageControl(a);}}};mCR_exportCanvasForZoom.prototype.exportSubSectionsInPage=function(){if(this.objDocumentPage.backGround&&!this.isEasyInput){this.objDocumentPage.backGround.area.right=this.objPageStyle.width-this.objPageStyle.leftMargin-this.objPageStyle.rightMargin;this.exportSubSection(this.objDocumentPage.backGround);this.exportControlsInSubSection(this.objDocumentPage.backGround);}for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){var c=this.objDocumentPage.subSectionList[a];if(c.isDrillingView){if(this.isEasyInput&&c.isDrilling){continue;}this.exportSubSection(c);}}var b=new Array();for(var a=0;a<this.objDocumentPage.subSectionList.length;a++){var c=this.objDocumentPage.subSectionList[a];if(c.isDrillingView){if(c.sectionType!=7){if(this.isEasyInput&&c.isDrilling){continue;}else{this.exportControlsInSubSection(c);}}else{b.push(c);}}}b.sort(function(f,d){if(f.area.top>d.area.top){return 1;}if(f.area.top<d.area.top){return -1;}return 0;});for(var a=0;a<b.length;a++){this.exportControlsInSubSection(b[a]);}b=null;if(this.objDocumentPage.foreGround&&!this.isEasyInput){this.exportSubSection(this.objDocumentPage.foreGround);this.exportControlsInSubSection(this.objDocumentPage.foreGround);}};mCR_exportCanvasForZoom.prototype.findImageControl=function(a){var c=true;if(a.pageCountConditionType==21){var b=this.objDocument.checkedTotalPageCount;var d=pageIndex+1==b/2+1;if(a.visible){if(d==true){c=false;}}else{c=d||a.conditionVisible;}}else{if(a.pageCountConditionType==-1){c=a.conditionVisible;}}if(c){switch(a.type){case mCR_DocumentControlType.Label:this.findImageLabel(a);break;case mCR_DocumentControlType.Table:this.findImageTable(a);break;case mCR_DocumentControlType.SubReport:this.findImageReportControl(a);break;case mCR_DocumentControlType.VoiceEye:this.findImageVoiceEye(a);break;case mCR_DocumentControlType.MarkAnyVoiceEye:this.findImageMarkAnyVoice(a);break;}}};mCR_exportCanvasForZoom.prototype.exportControl=function(a){var c=true;if(a.pageCountConditionType==21){var b=this.objDocument.checkedTotalPageCount;var d=pageIndex+1==b/2+1;if(a.visible){if(d==true){c=false;}}else{c=d||a.conditionVisible;}}else{if(a.pageCountConditionType==-1){c=a.conditionVisible;}}if(c){switch(a.type){case mCR_DocumentControlType.Line:this.exportLine(a);break;case mCR_DocumentControlType.Shape:this.exportShape(a);break;case mCR_DocumentControlType.Label:this.exportLabel(a);break;case mCR_DocumentControlType.Crosstab:this.exportCrosstab(a);break;case mCR_DocumentControlType.Table:this.exportTable(a);break;case mCR_DocumentControlType.Barcode:this.exportBarcode(a);break;case mCR_DocumentControlType.Chart:this.exportChart(a);break;case mCR_DocumentControlType.SubReport:this.exportReportControl(a);break;case mCR_DocumentControlType.Checkbox:this.exportCheckbox(a,false);break;case mCR_DocumentControlType.VoiceEye:this.exportVoiceEye(a);break;case mCR_DocumentControlType.MarkAnyVoiceEye:this.exportMarkAnyVoice(a);break;case mCR_DocumentControlType.InputSign:this.exportInputSign(a);break;}}};mCR_exportCanvasForZoom.prototype.exportInputSign=function(b){var c=b.getRectInPage();var f=this.objDocument.documentStorage[b.primaryName];if(null!=f){var a=this.objDocument.getLineStyle(b.outterlineStyleKey);var d=this.objDocument.getShapeStyle(b.shapeStyleKey);if(null!=a&&null!=d){this.paintShapeStyle(d,c);this.paintLineStyle(a);this.objContext.stroke();}}};function mCR_exportCanvasForEForm(b,c,a,d){mCR_exportCanvasForZoom.call(this,b,c,a);this.elmEFormLayoutDiv=d;this.elmLayoutTag=null;this.elmLayoutButton=null;this.pageEFormControlIDList=new Array();}mCR_exportCanvasForEForm.prototype=Object.create(mCR_exportCanvasForZoom.prototype);mCR_exportCanvasForEForm.prototype.constructor=mCR_exportCanvasForEForm;mCR_exportCanvasForEForm.prototype.exportPageEFom=function(b,a,c){this.pageEFormControlIDList=a;return this.exportPage(b,c);};mCR_exportCanvasForEForm.prototype.startPage=function(){this.objPageStyle=this.objDocument.getPageStyle(this.objDocumentPage.pageStyleKey);if(this.isEasyInput){var m=new docStylePage();m.paperType=this.objPageStyle.orientation;m.width=0;m.height=0;m.orientation=this.objPageStyle.orientation;m.leftMargin=0;m.topMargin=0;m.rightMargin=0;m.bottomMargin=0;m.pageCount=1;m.multiColumnDirection=this.objPageStyle.multiColumnDirection;for(var j=0;j<this.objDocumentPage.subSectionList.length;j++){var p=this.objDocumentPage.subSectionList[j];if(!p.isDrilling){var k=p.area.getHeight();p.area.top=m.height;m.height+=k;p.area.bottom=m.height;var d=p.area.getWidth();p.area.left=0;p.area.right=d;if(m.width<d){m.width=d;}}}this.objPageStyle=m;}this.elmCanvas=document.createElement("canvas");var o=this.objPageStyle.width*this.nPixelRate;var c=this.objPageStyle.height*this.nPixelRate;this.objDocumentPage.width=this.objPageStyle.width;this.objDocumentPage.height=this.objPageStyle.height;this.elmCanvas.setAttribute("width",o*this.nZoom);this.elmCanvas.setAttribute("height",c*this.nZoom);this.objContext=this.elmCanvas.getContext("2d");this.objContext.scale(this.nZoom,this.nZoom);this.objContext.fillStyle="rgb(255,255,255)";this.objContext.fillRect(0,0,o,c);this.pageImageList=new Array();this.objLineHashMap=function(){};this.objAccHashMap=function(){};this.elmEFormLayoutDiv.style.cssText="position:relative;background-color:transparent;display:inline-block;width:"+o+"px;height:"+c+"px;";this.elmLayoutTagP=document.createElement("div");this.elmLayoutTagP.style.position="absolute";this.elmLayoutTagP.style.left=(this.objPageStyle.leftMargin*this.nPixelRate)+"px";this.elmLayoutTagP.style.right=(this.objPageStyle.rightMargin*this.nPixelRate)+"px";this.elmLayoutTagP.style.top=(this.objPageStyle.topMargin*this.nPixelRate)+"px";this.elmLayoutTagP.style.bottom=(this.objPageStyle.bottomMargin*this.nPixelRate)+"px";this.elmLayoutTagP.setAttribute("role","text");var a="문서 전체영역 입니다.";if(""!=this.objDocument.title){a=this.objDocument.title;a=a.replace(/\'/g,"작은따옴표");a=a.replace(/\"/g,"큰따옴표");}this.elmLayoutTagP.setAttribute("aria-label",a);var f=new Array();f.push("<style type='text/css'>");f.push(".r_F_S{position:absolute;border:0px solid black !important;padding:0 0 0 0 !important;margin:0 0 0 0 !important;}");mCR_getFontCss(f,this.objDocument.styleManager.fontList,this.objDocument);f.push("</style>");this.elmLayoutTagP.innerHTML=f.join("");this.elmEFormLayoutDiv.appendChild(this.elmLayoutTagP);var n=document.createElement("div");n.id=this.objDocument.reportKey+"memo";n.style.cssText="position:absolute;overflow:hidden;left:0px;top:0px;right:0px;bottom:0px;background-color:rgba(255,255,255,0);";this.elmEFormLayoutDiv.appendChild(n);var h=document.createElement("div");h.id=this.objDocument.reportKey+"doodle";h.style.cssText="position:absolute;overflow:hidden;left:0px;top:0px;right:0px;bottom:0px;background-color:rgba(255,255,255,0);";h.innerHTML='<svg height="100%" version="1.1" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="overflow: hidden; position: relative; shape-rendering: optimizeSpeed;"></svg>';this.elmEFormLayoutDiv.appendChild(h);this.elmLayoutButtonP=document.createElement("div");this.elmLayoutButtonP.style.position="absolute";this.elmLayoutButtonP.style.left=(this.objPageStyle.leftMargin*this.nPixelRate)+"px";this.elmLayoutButtonP.style.right=(this.objPageStyle.rightMargin*this.nPixelRate)+"px";this.elmLayoutButtonP.style.top=(this.objPageStyle.topMargin*this.nPixelRate)+"px";this.elmLayoutButtonP.style.bottom=(this.objPageStyle.bottomMargin*this.nPixelRate)+"px";var b=document.createElement("div");b.id=this.objDocument.reportKey+"IndexOrder";b.className="eform_IndexOrder";var g=document.createElement("div");g.id=this.objDocument.reportKey+"IO_in";g.className="eform_IndexOrder_inner";var l=document.createElement("button");l.tabIndex="-1";l.className="eform_IndexOrder_left";var i=document.createElement("button");i.tabIndex="-1";i.className="eform_IndexOrder_right";g.appendChild(l);g.appendChild(i);this.elmLayoutButtonP.appendChild(b);this.elmLayoutButtonP.appendChild(g);this.elmEFormLayoutDiv.appendChild(this.elmLayoutButtonP);};mCR_exportCanvasForEForm.prototype.findImageControl=function(a){var c=true;if(a.pageCountConditionType==21){var b=this.objDocument.checkedTotalPageCount;var d=pageIndex+1==b/2+1;if(a.visible){if(d==true){c=false;}}else{c=d||a.conditionVisible;}}else{if(a.pageCountConditionType==-1){c=a.conditionVisible;}}if(c){switch(a.type){case mCR_DocumentControlType.Label:this.findImageLabel(a);break;case mCR_DocumentControlType.Table:this.findImageTable(a);break;case mCR_DocumentControlType.SubReport:this.findImageReportControl(a);break;case mCR_DocumentControlType.VoiceEye:this.findImageVoiceEye(a);break;case mCR_DocumentControlType.MarkAnyVoiceEye:this.findImageMarkAnyVoice(a);break;case mCR_DocumentControlType.Input:this.exportEFomInputbox(a);break;case mCR_DocumentControlType.Button:this.exportEFomInputButton(a);break;case mCR_DocumentControlType.Video:this.exportEFomInputVideo(a);break;case mCR_DocumentControlType.InputSelectBox:this.exportEFomInputSelectBox(a);break;case mCR_DocumentControlType.Calendar:this.exportEFomInputCalendar(a);break;case mCR_DocumentControlType.InputSign:this.exportEFomInputSign(a);break;case mCR_DocumentControlType.InputImage:this.exportEFomInputImage(a);break;case mCR_DocumentControlType.InputCheckbox:this.exportEFomInputCheckbox(a);break;}}};mCR_exportCanvasForEForm.prototype.findControlsInSubSectionImage=function(g){if(this.isEasyInput){this.elmLayoutTag=document.createElement("div");this.elmLayoutButton=document.createElement("div");if(g.isDrilling){this.elmLayoutTag.style.display="none";this.elmLayoutButton.style.display="none";}this.elmLayoutTagP.appendChild(this.elmLayoutTag);this.elmLayoutButtonP.appendChild(this.elmLayoutButton);var b=g.area.newRateRect(this.nPixelRate);this.elmLayoutTag.style.position=this.elmLayoutButton.style.position="relative";this.elmLayoutTag.style.top=this.elmLayoutButton.style.top="0px";this.elmLayoutTag.style.left=this.elmLayoutButton.style.left="0px";this.elmLayoutTag.style.width=this.elmLayoutButton.style.width=b.getWidth()+"px";this.elmLayoutTag.style.height=this.elmLayoutButton.style.height=b.getHeight()+"px";this.elmLayoutTag.id=this.elmLayoutButton.id=g.editEasyModeId;}else{this.elmLayoutTag=this.elmLayoutTagP;this.elmLayoutButton=this.elmLayoutButtonP;}for(var c=0;c<g.controlPageList.length;c++){var a=g.controlPageList[c];var f=true;if(-1!=a.visibleOptionStyleKey){var d=this.objDocument.getVisibleOptionStyle(a.visibleOptionStyleKey);if(null!=d){f=d.toView;}}if(f){this.findImageControl(a);}}};mCR_exportCanvasForEForm.prototype.findImageReportControl=function(d){if(this.isEasyInput){var b=this.elmLayoutTagP;var i=this.elmLayoutButtonP;var j=this.elmLayoutTag;var f=this.elmLayoutButton;var a=d.rect.newRateRect(this.nPixelRate);var h=document.createElement("div");var c=document.createElement("div");h.style.position=c.style.position="absolute";h.style.top=c.style.top=a.top+"px";h.style.left=c.style.left=a.left+"px";h.style.width=c.style.width=a.getWidth()+"px";h.style.height=c.style.height=a.getHeight()+"px";this.elmLayoutTag.appendChild(h);this.elmLayoutButton.appendChild(c);this.elmLayoutTagP=h;this.elmLayoutButtonP=c;}for(var g=0;g<d.subSectionList.length;g++){this.findControlsInSubSectionImage(d.subSectionList[g]);}if(this.isEasyInput){this.elmLayoutTagP=b;this.elmLayoutButtonP=i;this.elmLayoutTag=j;this.elmLayoutButton=f;}};mCR_exportCanvasForEForm.prototype.exportEFomInputCheckbox=function(q){var b=null;if(this.isEasyInput){b=q.rect;}else{b=q.getRectInPage();}var r=q.checkSize;this.pageEFormControlIDList.push(q.primaryName);var a=this.objDocument.documentStorage[q.primaryName];if(null!=a){var d=b.getHeight()-r;var j=this.objDocument.getLineStyle(q.outterlineStyleKey);var h=this.objDocument.getShapeStyle(q.shapeStyleKey);var f=this.objDocument.getBackgroundStyle(q.backgroundStyleKey);var l=a.imageType=="check"?"CHECK":"RADIO";l=null==q.accessibilityString?l:q.accessibilityString;var c=document.createElement("div");c.style.cssText="position:absolute;overflow:hidden;";c.style.left=(b.left*this.nPixelRate)+"px";c.style.top=(b.top*this.nPixelRate)+"px";c.style.width=(b.getWidth()*this.nPixelRate)+"px";c.style.height=(b.getHeight()*this.nPixelRate)+"px";var m=document.createElement("div");m.id=this.objDocument.reportKey+q.primaryName+"DIV";m.className="eF_Rect";if(f.backStyle==0){m.style.cssText="background-color:"+mCR_changeRGBAColor(f.backColor,q.guideTransparency);}var g=document.createElement("img");g.id=this.objDocument.reportKey+q.primaryName+"IMG";g.tabIndex="-1";var p="position:absolute;";if(q.useText){p+="left:0.009cm;top:"+((d/2)/100)+"cm;width:"+(r/100)+"cm;height:"+(r/100)+"cm;";}else{p+="left:0cm;top:0cm;width:100%;height:100%;";}if(r<1){p+="visibility:hidden;";}if(h.shapeType==1){p+="border-radius: 100%;";}if(j.style!=0){p+="border:"+mCR_getLineStyleTag(j);}p+="box-sizing: border-box;";g.style.cssText=p;var o=document.createElement("div");o.id=this.objDocument.reportKey+q.primaryName+"FOCUS";o.className="eF_Rect";c.appendChild(m);c.appendChild(g);c.appendChild(o);if(q.useText){var n=document.createElement("span");n.tabIndex="-1";n.style.left=(r/100)+"cm";n.className="s_"+this.objDocument.reportKey+q.textInfo.getOriginalTextInfo().fontStyleKey+" eF_Rect";var i=new docRect();i.copyRect(b);i.left+=r;var k=mRe_createCheckboxTextSvg(i,q.textInfo,this.objDocument);n.innerHTML=k;c.appendChild(n);}this.elmLayoutTag.appendChild(c);var s=document.createElement("button");s.tabIndex="0";s.className="eForm_hidden_button";s.id=this.objDocument.reportKey+q.primaryName;s.title=l;s.style.cssText="position:absolute;overflow:hidden;";s.style.left=(b.left*this.nPixelRate)+"px";s.style.top=(b.top*this.nPixelRate)+"px";if(q.selectArea==0&&q.useText){s.style.width=((r+5)*this.nPixelRate)+"px";}else{s.style.width=(b.getWidth()*this.nPixelRate)+"px";}s.style.height=(b.getHeight()*this.nPixelRate)+"px";s.innerHTML=l;this.elmLayoutButton.appendChild(s);}};mCR_exportCanvasForEForm.prototype.exportEFomInputImage=function(m){var i=null;if(this.isEasyInput){i=m.rect;}else{i=m.getRectInPage();}this.pageEFormControlIDList.push(m.primaryName);var f=this.objDocument.documentStorage[m.primaryName];if(null!=f){var j=this.objDocument.getLineStyle(m.outterlineStyleKey);var g=this.objDocument.getBackgroundStyle(m.backgroundStyleKey);var l=m.accessibilityString;if(null==l){l="image";}var h=document.createElement("div");h.style.cssText="position:absolute;overflow:hidden;";h.style.left=(i.left*this.nPixelRate)+"px";h.style.top=(i.top*this.nPixelRate)+"px";h.style.width=(i.getWidth()*this.nPixelRate)+"px";h.style.height=(i.getHeight()*this.nPixelRate)+"px";var b=document.createElement("span");b.id=this.objDocument.reportKey+m.primaryName+"Guide";b.className="eF_Rect";var a="";if(g.backStyle==0){a+="background-color:"+mCR_changeRGBAColor(g.backColor,m.transparencyRate)+";";}if(j.style!=0){a+="border:"+mCR_getLineStyleTag(j);a+="color:"+mCR_getStrColor(j.color)+" !important;";}a+="text-align:left !important;  padding: 0px 0px 0px 0px !important;font-size:10px !important;";b.style.cssText=a;var k=document.createElement("img");k.id=this.objDocument.reportKey+m.primaryName+"Canvas";k.className="eF_Rect2";var d=document.createElement("div");d.id=this.objDocument.reportKey+m.primaryName+"FOCUS";d.className="eF_Rect";h.appendChild(b);h.appendChild(k);h.appendChild(d);this.elmLayoutTag.appendChild(h);var c=document.createElement("button");c.tabIndex="0";c.className="eForm_hidden_button";c.id=this.objDocument.reportKey+m.primaryName;c.title=l;c.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";c.style.left=(i.left*this.nPixelRate)+"px";c.style.top=(i.top*this.nPixelRate)+"px";c.style.width=(i.getWidth()*this.nPixelRate)+"px";c.style.height=(i.getHeight()*this.nPixelRate)+"px";c.innerHTML=l;this.elmLayoutButton.appendChild(c);}};mCR_exportCanvasForEForm.prototype.exportEFomInputSign=function(h){var d=null;if(this.isEasyInput){d=h.rect;}else{d=h.getRectInPage();}this.pageEFormControlIDList.push(h.primaryName);var b=this.objDocument.documentStorage[h.primaryName];if(null!=b){var j=this.objDocument.getLineStyle(h.outterlineStyleKey);var l=this.objDocument.getShapeStyle(h.shapeStyleKey);var i=this.objDocument.getBackgroundStyle(h.backgroundStyleKey);var m=new docStyleLine();m.setStyle(h.guileLineStyle,h.guileLineWidth,h.guileLineColor);var q=h.accessibilityString;if(null==q){q="sign";}var s=document.createElement("div");s.style.cssText="position:absolute;overflow:hidden;";s.style.left=(d.left*this.nPixelRate)+"px";s.style.top=(d.top*this.nPixelRate)+"px";s.style.width=(d.getWidth()*this.nPixelRate)+"px";s.style.height=(d.getHeight()*this.nPixelRate)+"px";var f=document.createElement("span");f.id=this.objDocument.reportKey+h.primaryName+"Guide";f.className="eF_Rect";var t="";if(i.backStyle==0){t+="background-color:"+mCR_changeRGBAColor(i.backColor,h.transparencyRate)+";";}if(m.style!=0){t+="border:"+mCR_getLineStyleTag(m);t+="color:"+mCR_getStrColor(m.color)+" !important;";}t+="text-align:left !important;  padding: 0px 0px 0px 0px !important;font-size:10px !important;";f.style.cssText=t;var c=document.createElement("div");c.className="eF_Rect2 eform_sign_paint_guide";var o=document.createElement("table");o.className="eform_table";o.border="0";o.cellSpacing="0";o.cellPadding="0";var g=document.createElement("tr");var k=document.createElement("td");var a=new docStyleTextOption();a.horizontalAlignment=h.horizontalAlignmentMethod;a.verticalAlignment=h.verticalAlignmentMethod;mCR_setAlignmentMethod(k,a);k.style.cssText="word-wrap:break-word;background-color:transparent !important;";c.id=this.objDocument.reportKey+h.primaryName+"GuideInput";var r=document.createElement("canvas");r.id=this.objDocument.reportKey+h.primaryName+"Canvas";r.className="eF_Rect2";var n=document.createElement("div");n.id=this.objDocument.reportKey+h.primaryName+"FOCUS";n.className="eF_Rect";g.appendChild(k);o.appendChild(g);c.appendChild(o);s.appendChild(f);s.appendChild(c);s.appendChild(r);s.appendChild(n);this.elmLayoutTag.appendChild(s);var p=document.createElement("button");p.tabIndex="0";p.className="eForm_hidden_button";p.id=this.objDocument.reportKey+h.primaryName;p.title=q;p.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";p.style.left=(d.left*this.nPixelRate)+"px";p.style.top=(d.top*this.nPixelRate)+"px";p.style.width=(d.getWidth()*this.nPixelRate)+"px";p.style.height=(d.getHeight()*this.nPixelRate)+"px";p.innerHTML=q;this.elmLayoutButton.appendChild(p);}};mCR_exportCanvasForEForm.prototype.exportEFomInputCalendar=function(h){var o=null;if(this.isEasyInput){o=h.rect;}else{o=h.getRectInPage();}this.pageEFormControlIDList.push(h.primaryName);var j=this.objDocument.documentStorage[h.primaryName];if(null!=j){var p=this.objDocument.getLineStyle(h.outterlineStyleKey);var k=this.objDocument.getBackgroundStyle(h.backgroundStyleKey);var l=this.objDocument.getTextOptionStyle(h.textInfo.getOriginalTextInfo().textOptionStyleKey);var q=h.accessibilityString;if(null==q){q="calendar";}var i=document.createElement("div");i.style.cssText="position:absolute;overflow:hidden;";i.style.left=(o.left*this.nPixelRate)+"px";i.style.top=(o.top*this.nPixelRate)+"px";i.style.width=(o.getWidth()*this.nPixelRate)+"px";i.style.height=(o.getHeight()*this.nPixelRate)+"px";var c=document.createElement("div");c.id=this.objDocument.reportKey+h.primaryName+"SPAN";c.className="eF_Rect";var b="";if(k.backStyle==0){b+="background-color:"+mCR_changeRGBAColor(k.backColor,h.transparencyRate)+";";}if(p.style!=0){b+="border:"+mCR_getLineStyleTag(p);b+="color:"+mCR_getStrColor(p.color)+" !important;";}c.style.cssText=b;var d=document.createElement("div");d.className="eF_Rect";var n=document.createElement("table");n.className="eform_table";n.border="0";n.cellSpacing="0";n.cellPadding="0";var a=document.createElement("tr");var m=document.createElement("td");m.id=this.objDocument.reportKey+h.primaryName+"TD";mCR_setAlignmentMethod(m,l);m.style.cssText="word-wrap:break-word;background-color:transparent !important;";m.className="s_"+this.objDocument.reportKey+h.textInfo.getOriginalTextInfo().fontStyleKey;m.appendChild(document.createElement("nobr"));var g=document.createElement("div");g.id=this.objDocument.reportKey+h.primaryName+"FOCUS";g.className="eF_Rect";a.appendChild(m);n.appendChild(a);d.appendChild(n);i.appendChild(c);i.appendChild(d);i.appendChild(g);this.elmLayoutTag.appendChild(i);var f=document.createElement("button");f.tabIndex="0";f.className="eForm_hidden_button";f.id=this.objDocument.reportKey+h.primaryName;f.title=q;f.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";f.style.left=(o.left*this.nPixelRate)+"px";f.style.top=(o.top*this.nPixelRate)+"px";f.style.width=(o.getWidth()*this.nPixelRate)+"px";f.style.height=(o.getHeight()*this.nPixelRate)+"px";f.innerHTML=q;this.elmLayoutButton.appendChild(f);}};mCR_exportCanvasForEForm.prototype.exportEFomInputSelectBox=function(i){var d=null;if(this.isEasyInput){d=i.rect;}else{d=i.getRectInPage();}this.pageEFormControlIDList.push(i.primaryName);var b=this.objDocument.documentStorage[i.primaryName];if(null!=b){var m=this.objDocument.getLineStyle(i.outterlineStyleKey);var j=this.objDocument.getBackgroundStyle(i.backgroundStyleKey);var a=this.objDocument.getTextOptionStyle(i.textInfo.getOriginalTextInfo().textOptionStyleKey);var p=i.accessibilityString;if(null==p){p="selectbox";}var l=document.createElement("div");l.style.cssText="position:absolute;overflow:hidden;";l.style.left=(d.left*this.nPixelRate)+"px";l.style.top=(d.top*this.nPixelRate)+"px";l.style.width=(d.getWidth()*this.nPixelRate)+"px";l.style.height=(d.getHeight()*this.nPixelRate)+"px";var f=document.createElement("div");f.id=this.objDocument.reportKey+i.primaryName+"SPAN";f.className="eF_Rect";var s="";if(j.backStyle==0){s+="background-color:"+mCR_changeRGBAColor(j.backColor,i.transparencyRate)+";";}if(m.style!=0){s+="border:"+mCR_getLineStyleTag(m);s+="color:"+mCR_getStrColor(m.color)+" !important;";}f.style.cssText=s;var c=document.createElement("div");c.className="eF_Rect";var n=document.createElement("table");n.className="eform_table";n.border="0";n.cellSpacing="0";n.cellPadding="0";var g=document.createElement("tr");var k=document.createElement("td");var r=document.createElement("nobr");k.id=this.objDocument.reportKey+i.primaryName+"TD";mCR_setAlignmentMethod(k,a);k.style.cssText="word-wrap:break-word;background-color:transparent !important;";k.className="s_"+this.objDocument.reportKey+i.textInfo.getOriginalTextInfo().fontStyleKey;var q=document.createElement("td");q.width="20px";q.align="center";q.vAlign="middle";q.style.fontSize="8pt";q.innerHTML="▼";var o=document.createElement("div");o.id=this.objDocument.reportKey+i.primaryName+"FOCUS";o.className="eF_Rect";k.appendChild(r);g.appendChild(k);g.appendChild(q);n.appendChild(g);c.appendChild(n);l.appendChild(f);l.appendChild(c);l.appendChild(o);this.elmLayoutTag.appendChild(l);var h=document.createElement("select");h.tabIndex="0";h.className="eForm_hidden_button";h.id=this.objDocument.reportKey+i.primaryName;h.title=p;h.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";h.style.left=(d.left*this.nPixelRate)+"px";h.style.top=(d.top*this.nPixelRate)+"px";h.style.width=(d.getWidth()*this.nPixelRate)+"px";h.style.height=(d.getHeight()*this.nPixelRate)+"px";h.innerHTML=p;this.elmLayoutButton.appendChild(h);}};mCR_exportCanvasForEForm.prototype.exportEFomInputButton=function(j){var o=null;if(this.isEasyInput){o=j.rect;}else{o=j.getRectInPage();}this.pageEFormControlIDList.push(j.primaryName);var i=this.objDocument.documentStorage[j.primaryName];if(null!=i){var p=this.objDocument.getLineStyle(j.outterlineStyleKey);var k=this.objDocument.getBackgroundStyle(j.backgroundStyleKey);var l=this.objDocument.getTextOptionStyle(j.textInfo.getOriginalTextInfo().textOptionStyleKey);var q=j.accessibilityString;if(null==q){q="button";}var h=document.createElement("div");h.style.cssText="position:absolute;overflow:hidden;";h.style.left=(o.left*this.nPixelRate)+"px";h.style.top=(o.top*this.nPixelRate)+"px";h.style.width=(o.getWidth()*this.nPixelRate)+"px";h.style.height=(o.getHeight()*this.nPixelRate)+"px";var c=document.createElement("div");c.id=this.objDocument.reportKey+j.primaryName+"SPAN";c.className="eF_Rect";var b="";if(k.backStyle==0){b+="background-color:"+mCR_changeRGBAColor(k.backColor,j.transparencyRate)+";";}if(p.style!=0){b+="border:"+mCR_getLineStyleTag(p);b+="color:"+mCR_getStrColor(p.color)+" !important;";}c.style.cssText=b;var d=document.createElement("div");d.className="eF_Rect";var n=document.createElement("table");n.className="eform_table";n.border="0";n.cellSpacing="0";n.cellPadding="0";var a=document.createElement("tr");var m=document.createElement("td");m.id=this.objDocument.reportKey+j.primaryName+"TD";mCR_setAlignmentMethod(m,l);m.style.cssText="word-wrap:break-word;background-color:transparent !important;";m.className="s_"+this.objDocument.reportKey+j.textInfo.getOriginalTextInfo().fontStyleKey;var g=document.createElement("div");g.id=this.objDocument.reportKey+j.primaryName+"FOCUS";g.className="eF_Rect";a.appendChild(m);n.appendChild(a);d.appendChild(n);h.appendChild(c);h.appendChild(d);h.appendChild(g);this.elmLayoutTag.appendChild(h);var f=document.createElement("button");f.tabIndex="0";f.className="eForm_hidden_button";f.id=this.objDocument.reportKey+j.primaryName;f.title=q;f.style.cssText="position:absolute;overflow:hidden;border:0.75pt solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";f.style.left=(o.left*this.nPixelRate)+"px";f.style.top=(o.top*this.nPixelRate)+"px";f.style.width=(o.getWidth()*this.nPixelRate)+"px";f.style.height=(o.getHeight()*this.nPixelRate)+"px";f.innerHTML=q;this.elmLayoutButton.appendChild(f);}};mCR_exportCanvasForEForm.prototype.exportEFomInputVideo=function(j){var i=null;if(this.isEasyInput){i=j.rect;}else{i=j.getRectInPage();}this.pageEFormControlIDList.push(j.primaryName);var g=this.objDocument.documentStorage[j.primaryName];if(null!=g){var k=this.objDocument.getLineStyle(j.outterlineStyleKey);var h=this.objDocument.getBackgroundStyle(j.backgroundStyleKey);var l=j.accessibilityString;if(null==l){l="video";}var d=document.createElement("div");d.style.cssText="position:absolute;overflow:hidden;";d.style.left=(i.left*this.nPixelRate)+"px";d.style.top=(i.top*this.nPixelRate)+"px";d.style.width=(i.getWidth()*this.nPixelRate)+"px";d.style.height=(i.getHeight()*this.nPixelRate)+"px";var b=document.createElement("div");b.id=this.objDocument.reportKey+j.primaryName+"SPAN";b.className="eF_Rect";var a="";if(h.backStyle==0){a+="background-color:"+mCR_changeRGBAColor(h.backColor,j.transparencyRate)+";";}if(k.style!=0){a+="border:"+mCR_getLineStyleTag(k);a+="color:"+mCR_getStrColor(k.color)+" !important;";}b.style.cssText=a;var c=document.createElement("div");c.id=this.objDocument.reportKey+j.primaryName+"FOCUS";c.className="eF_Rect";d.appendChild(b);d.appendChild(c);this.elmLayoutTag.appendChild(d);var f=document.createElement("video");f.tabIndex="0";f.id=this.objDocument.reportKey+j.primaryName;f.title=l;f.style.cssText="position:absolute;overflow:hidden;border:0 solid !important; padding: 0px 0px 0px 0px !important;cursor:pointer;";f.style.left=(i.left*this.nPixelRate)+"px";f.style.top=(i.top*this.nPixelRate)+"px";f.style.width=(i.getWidth()*this.nPixelRate)+"px";f.style.height=(i.getHeight()*this.nPixelRate)+"px";f.controls=true;this.elmLayoutButton.appendChild(f);}};mCR_exportCanvasForEForm.prototype.exportEFomInputbox=function(r){var d=null;if(this.isEasyInput){d=r.rect;}else{d=r.getRectInPage();}this.pageEFormControlIDList.push(r.primaryName);var b=this.objDocument.documentStorage[r.primaryName];if(null!=b){var n=this.objDocument.getLineStyle(r.outterlineStyleKey);var i=this.objDocument.getBackgroundStyle(r.backgroundStyleKey);var a=this.objDocument.getTextOptionStyle(r.textInfo.getOriginalTextInfo().textOptionStyleKey);var k=this.objDocument.getFontStyle(r.textInfo.getOriginalTextInfo().fontStyleKey);var q=r.accessibilityString;if(null==q){q="inputbox";}var m=document.createElement("div");m.style.cssText="position:absolute;overflow:hidden;";m.style.left=(d.left*this.nPixelRate)+"px";m.style.top=(d.top*this.nPixelRate)+"px";m.style.width=(d.getWidth()*this.nPixelRate)+"px";m.style.height=(d.getHeight()*this.nPixelRate)+"px";var f=document.createElement("div");f.id=this.objDocument.reportKey+r.primaryName+"SPAN";f.className="eF_Rect";var s="";if(i.backStyle==0){s+="background-color:"+mCR_changeRGBAColor(i.backColor,r.transparencyRate)+";";}if(n.style!=0){s+="border:"+mCR_getLineStyleTag(n);s+="color:"+mCR_getStrColor(n.color)+" !important;";}f.style.cssText=s;var c=document.createElement("div");c.className="eF_Rect";var o=document.createElement("table");o.className="eform_table";o.border="0";o.cellSpacing="0";o.cellPadding="0";var g=document.createElement("tr");var l=document.createElement("td");l.id=this.objDocument.reportKey+r.primaryName+"TD";mCR_setAlignmentMethod(l,a);l.style.cssText="word-wrap:break-word;background-color:transparent !important;";l.className="s_"+this.objDocument.reportKey+r.textInfo.getOriginalTextInfo().fontStyleKey;g.appendChild(l);o.appendChild(g);c.appendChild(o);m.appendChild(f);m.appendChild(c);this.elmLayoutTag.appendChild(m);var p=document.createElement("textarea");if(b.isGuideText){var j=b.guideTextColor;var h=document.createElement("textarea");h.tabIndex="-1";h.readonly=true;h.className="eform_guide_textarea mRe_focus s_"+this.objDocument.reportKey+r.textInfo.getOriginalTextInfo().fontStyleKey;h.id=this.objDocument.reportKey+r.primaryName+"GT";h.style.left=(d.left*this.nPixelRate)+"px";h.style.top=(d.top*this.nPixelRate)+"px";h.style.width=(d.getWidth()*this.nPixelRate)+"px";h.style.height=(d.getHeight()*this.nPixelRate)+"px";h.style.color=mCR_getStrColor(j);h.value=decodeURIComponent(b.guideText);p.style.backgroundColor="RGBA(255,255,255,0)";mCR_setInputAlignmentMethod(h,a);mRe_spaceStyle(h,a,k);this.elmLayoutButton.appendChild(h);}p.tabIndex="0";p.className="eform_textarea mRe_focus s_"+this.objDocument.reportKey+r.textInfo.getOriginalTextInfo().fontStyleKey;p.title=q;p.id=this.objDocument.reportKey+r.primaryName;p.style.left=(d.left*this.nPixelRate)+"px";p.style.top=(d.top*this.nPixelRate)+"px";p.style.width=(d.getWidth()*this.nPixelRate)+"px";p.style.height=(d.getHeight()*this.nPixelRate)+"px";mCR_setInputAlignmentMethod(p,a);mRe_spaceStyle(p,a,k);this.elmLayoutButton.appendChild(p);}};function mRe_createCheckboxTextSvg(h,b,g){var d=new Array();d.push("<svg ");d.push('width="'+(h.getWidth()/100)+'cm" ');d.push('height="'+(h.getHeight()/100)+'cm" ');d.push('fill-opacity="1" xmlns:xlink="http://www.w3.org/1999/xlink" color-rendering="auto" color-interpolation="auto" text-rendering="auto"  style="overflow:hidden" stroke-linecap="square"  stroke-miterlimit="10" shape-rendering="auto" stroke-opacity="1" stroke-dasharray="none" font-weight="normal" stroke-width="1"  xmlns="http://www.w3.org/2000/svg" font-style="normal" stroke-linejoin="miter" stroke-dashoffset="0" image-rendering="auto">');d.push('<g stroke-linecap="butt" >');var a=b.getUseMultiLanguage();var i=b.textLineList;for(var f=0;f<i.length;f++){var c=i[f];if(c.isPaint(h.getHeight(),f)){mRe_textSVGLine(d,c,a,g);}else{break;}}d.push("</g>");d.push("</svg>");return d.join("");}function mRe_textSVGLine(c,b,a,f){var h=b.getY();if(a){mRe_makeLineSVGText(c,0,h+b.getHeight()-(b.getHeight()*0.15),b.getText());}else{var g=b.getCharacterBatchCount();for(var d=0;d<g;d++){mRe_characterSVGBatch(c,h+b.getHeight()-(b.getHeight()*0.15),b.getCharacterBatch(d),f);}}}function mRe_makeLineSVGText(b,a,d,c){b.push("<text  class='r_F_S' x='"+(a/100)+"cm' y='"+(d/100)+"cm' >");c=c.replace(/\</gi,"&lt;");c=c.replace(/\>/gi,"&gt;");c=c.replace(/\&/gi,"&amp;");b.push(c);b.push("</text>");}function mRe_characterSVGBatch(b,h,a,f){var d=a.getFontStyleKey();var g=null;for(var c=0;c<a.getCharacterCount();c++){g=a.getCharacter(c);mRe_makePositionSVGText(b,d,g.getX(),h,g.getCharacter(),f);}}function mRe_makePositionSVGText(b,d,a,g,f,c){b.push("<text class='r_F_S s_"+c.reportKey+d+" ");if(window.is_apple||window.mCR_isApple){b.push("r_F_S b_"+c.reportKey+d);}b.push("'");b.push("x='"+(a/100)+"cm' y='"+(g/100)+"cm'>");if("<"==f){f="&lt;";}else{if(">"==f){f="&gt;";}else{if("&"==f){f="&amp;";}}}b.push(f);b.push("</text>");}function mRe_createCheckboxTextSpan(h,b,g){var d=new Array();var a=b.getUseMultiLanguage();var i=b.textLineList;for(var f=0;f<i.length;f++){var c=i[f];if(c.isPaint(h.getHeight(),f)){mRe_textSpanLine(d,c,a,g);}else{break;}}return d.join("");}function mRe_textSpanLine(c,b,a,f){var h=b.getY();if(a){mRe_makeLineSpanText(c,0,h,b.getText());}else{var g=b.getCharacterBatchCount();for(var d=0;d<g;d++){mRe_characterSpanBatch(c,h,b.getCharacterBatch(d),f);}}}function mRe_makeLineSpanText(b,a,d,c){b.push("<span class='r_F_S' style='position:absolute;left:"+(a/100)+"cm;top:"+(d/100)+"cm;line-height:100%;'>");c=c.replace(/\</gi,"&lt;");c=c.replace(/\>/gi,"&gt;");c=c.replace(/\&/gi,"&amp;");b.push(c);b.push("</span>");}function mRe_characterSpanBatch(b,h,a,f){var d=a.getFontStyleKey();var g=null;for(var c=0;c<a.getCharacterCount();c++){g=a.getCharacter(c);mRe_makePositionSpanText(b,d,g.getX(),h,g.getCharacter(),f);}}function mRe_makePositionSpanText(b,d,a,g,f,c){b.push("<span class='r_F_S s_"+c.reportKey+d+"' ");b.push("style='position:absolute;left:"+(a/100)+"cm;top:"+(g/100)+"cm;line-height:100%;'>");if("<"==f){f="&lt;";}else{if(">"==f){f="&gt;";}else{if("&"==f){f="&amp;";}}}b.push(f);b.push("</span>");}function mCR_exportChart(d,u){var k=new mCR_exportChartShapePaint(d);var r=new mCR_exportChartShape(k);this.exportt=function(){var C=new mCR_exportChartDocument(u);n(C.panel);B(C.frameList);a(C.legend);w(C.panel);};var w=function(C){s(C.shapeLabel);};var n=function(C){s(C.shapePanel);};var a=function(C){A();s(C.shapeLegend);v();};var B=function(C){A();C.map(function(D){o(D);});v();};var o=function(C){return{0:y,1:q,2:x}[C.type](C);};var y=function(C){s(C.XYAxis.shapeListWall);b(C.seriesGroupList,C.XYAxis.vertical);s(C.XYAxis.shapeListAxis);c(C.seriesGroupList);h(C.seriesGroupList);};var b=function(D,C){D.map(function(E){if(f(E)){t(E);z(E,C);v();}else{g(E.frontRect);l(E);v();}});};var t=function(E){var C=new mCR_exportChartUtilRectangle(E.frontRect);var D=C.union(E.rearRect);g(D);};var g=function(C){k.beginClip(C);};var v=function(){k.endClip();};var A=function(){k.defaultClip();};var f=function(C){if(!C.seriesList){return false;}if(C.seriesList.length==0){return false;}exportChartLog.log("seriesTypeCode:"+C.seriesList[0].type);exportChartLog.log("seriesTypeName:"+C.seriesList[0].typeName);return(C.seriesList[0].typeName=="bar");};var z=function(E,D){var C=[];E.seriesList.map(function(F){F.seriesItemList.map(function(G){var H=m(G.rect,E.frontRect,D);C.push({key:H,value:G});});});C.sort(function(G,F){return G.key-F.key;});C.map(function(G){var F=G.value;s(F.shapeList);});};var m=function(J,I,D){var H=J.left-I.left;var G=J.bottom-I.top;var F=I.right-I.left;var C=I.bottom-I.top;var E=0;if(D==true){E=(H*C)+(C-G);}else{E=(-G*F)-(F-H);}return E;};var l=function(C){C.seriesList.map(function(D){D.seriesItemList.map(function(E){s(E.shapeList);});});};var c=function(C){j(C,function(D){s(D.pointList);});};var h=function(C){j(C,function(D){s(D.markList);});};var j=function(D,C){D.map(function(E){E.seriesList.map(function(F){F.seriesItemList.map(C);});});};var q=function(C){p(C.seriesGroupList);h(C.seriesGroupList);};var p=function(C){C.map(function(D){D.seriesList.map(function(E){var F=new mCR_exportChartSeriesPie(k);E.seriesItemList.map(function(G){G.shapeList.map(function(H){F.add(new mCR_exportChartDocumentShape(H));});});F.exportt();});});};var x=function(C){s(C.radar.shapeList);};var s=function(C){if(!C){return;}C.map(function(D){i(D);});};var i=function(D){var C=new mCR_exportChartDocumentShape(D);r.paint(C);};}function mCR_exportChartShape(k){var c=new mCR_exportChartShapePoint(k);var a=new mCR_exportChartShapeBar(k);this.paint=function(p){var o={0:h,1:i,2:m,3:n,4:b,5:g,6:j,7:d,8:l,9:f};o[p.type](p);};var h=function(o){k.rectangle(o.background,o.line,o.rect);};var l=function(o){k.rectangle(o.background,o.line,o.rect);k.text(o.font,o.option,o.rect,o.text,o.angle,o.rotate);};var n=function(o){k.line(o.line,o.start,o.end);};var j=function(o){c.paint(o);};var i=function(o){k.regularPolygon(o.background,o.line,o.rect,o.startAngle,o.slice);};var m=function(o){k.irregularPolygon(o.background,o.line,o.pointList);};var b=function(o){k.curveLine(o.line,o.pointList,o.tension);};var g=function(o){a.paint(o);};var d=function(o){};var f=function(o){k.curveSurface(o.background,o.line,o.topPointList,o.topTension,o.bottomPointList,o.bottomTension,o.lineTopOnly);};}var exportChartLog=new function(){var a=false;this.log=function(b){if(a){console.log(b);}};};function mCR_exportChartPaintSvg(f,o,j){var b=new mCR_exportChartClipDocument(f.objDocument);var s=new mCR_exportChartPaintCoordinateTranslate({x:j.left,y:j.top});var g=new mCR_exportChartPaintUnitType();var p=new mCR_exportChartPaintSvgDefs();var q=new mCR_exportChartPaintSvgBackground(p,g);var m=new mCR_exportChartPaintSvgClip(p,g,j);var h=new mCR_exportChartPaintSvgClipExport(f,o,p,m,q);var k=new mCR_exportChartPaintSvgStyle(h,g);var i=new mCR_exportChartPaintSvgRectangle(k,h,g);var n=new mCR_exportChartPaintSvgCircle(k,h,g);var l=new mCR_exportChartPaintSvgEllipse(k,h,g);var a=new mCR_exportChartPaintSvgLine(k,h,g);var c=new mCR_exportChartPaintSvgText(h,g);var u=new mCR_exportChartPaintSvgPolygon(k,h,g);var d=new mCR_exportChartPaintSvgCurve(k,h,g);var r=new mCR_exportChartPaintSvgPie(k,h,g);var t=new mCR_exportChartPaintSvgArcFace(k,h,g);this.rectangle=function(w,v,x){w=b.background(w);v=b.line(v);x=s.rect(x);i.rectangle(w,v,x);};this.circle=function(w,v,x){w=b.background(w);v=b.line(v);x=s.rect(x);n.paint(w,v,x);};this.ellipse=function(w,v,x){w=b.background(w);v=b.line(v);x=s.rect(x);l.paint(w,v,x);};this.line=function(w,x,v){w=b.line(w);x=s.point(x);v=s.point(v);a.line(w,x,v);};this.text=function(v,x,y,A,z,w){v=b.font(v);x=b.textOption(x);y=s.rect(y);c.text(v,x,y,A,z,w);};this.polygon=function(y,w,v,x){y=b.background(y);w=b.line(w);v=s.pointList(v);x=x?s.rect(x):x;u.polygon(y,w,v,x);};this.curveLine=function(w,v,x){w=b.line(w);v=s.pointList(v);d.line(w,v,x);};this.curveSurface=function(y,v,x,B,w,z,A){y=b.background(y);v=b.line(v);x=s.pointList(x);w=s.pointList(w);d.surface(y,v,x,B,w,z,A);};this.pie=function(y,w,A,x,v,z){y=b.background(y);w=b.line(w);A=s.rect(A);r.pie(y,w,A,x,v,z);};this.arcFace=function(x,v,y,w){x=b.background(x);v=b.line(v);y.map(function(z){z.rect=s.rect(z.rect);});w=w?s.rect(w):w;t.arcFace(x,v,y,w);};this.beginClip=function(v){v=s.rect(v);m.begin(v);};this.endClip=function(){m.end();};this.defaultClip=function(){m.defaultt();};}function mCR_exportChartPaintSvgDefs(){var a=document.createElementNS("http://www.w3.org/2000/svg","defs");a.setAttribute("id","clip");return a;}function mCR_exportChartPaintSvgBackground(f,b){this.radialIn=function(h,i,j){var l=c();var k=g(l,j);d(k,i);f.appendChild(k);h.setAttribute("fill","url(#"+l+")");};var d=function(i,h){i.appendChild(a(0,h.gradientEndColor));i.appendChild(a(100,h.gradientStartColor));};var a=function(j,h){var i=document.createElementNS("http://www.w3.org/2000/svg","stop");i.setAttribute("offset",j+"%");i.setAttribute("stop-color",mCR_getStrColor(h));return i;};var g=function(l,j){var k=document.createElementNS("http://www.w3.org/2000/svg","radialGradient");k.setAttribute("id",l);var h=b.cm().ellipse(j);var i=h.rx<h.ry?h.ry:h.rx;k.setAttribute("cx",h.cx+"cm");k.setAttribute("cy",h.cy+"cm");k.setAttribute("r",i+"cm");k.setAttribute("gradientUnits","userSpaceOnUse");k.setAttribute("spreadMethod","pad");return k;};var c=function(){return"grad"+mCR_UUID();};}function mCR_exportChartPaintSvgClip(b,g,i){var a="";var c="";this.begin=function(l){a=k();j(a,h(l));};this.defaultt=function(){if(c==""){c=k();j(c,h(i));}a=c;};this.end=function(){a="";};this.applyClip=function(l){if(a==""){return;}l.setAttribute("clip-path","url(#"+a+")");};var h=function(l){var m=g.cm().rect2(l);return d(m);};var d=function(m){var l=document.createElementNS("http://www.w3.org/2000/svg","rect");l.setAttribute("x",m.x+"cm");l.setAttribute("y",m.y+"cm");l.setAttribute("width",m.width+"cm");l.setAttribute("height",m.height+"cm");return l;};var k=function(){return"clip"+mCR_UUID();};var j=function(n,l){var m=f(n);m.appendChild(l);b.appendChild(m);};var f=function(m){var l=document.createElementNS("http://www.w3.org/2000/svg","clipPath");l.setAttribute("id",m);return l;};}function mCR_exportChartPaintSvgClipExport(b,d,f,c,a){d.appendChild(f);this.appendChild=function(g){c.applyClip(g);d.appendChild(g);};this.styleBackground=function(i,h,g){if(h.gradientStyle==8){a.radialIn(g,h,i);}else{b.paintBackgroundStyle(i,h,g);}};this.styleFontName=function(g){return b.objDocument.getFontNameStyle(g);};}function mCR_exportChartPaintSvgStyle(a,d){this.background=function(g,h,i){if(h){a.styleBackground(i,h,g);c(g,h.alpha);}};this.line=function(h,g){if(g){f(h,b(g));c(h,g.alpha);}};var b=function(g){return{style:g.style,width:d.cm().value(g.width),color:g.color};};var f=function(h,g){if(g.style==0){h.setAttribute("stroke","none");return;}h.setAttribute("stroke",mCR_getStrColor(g.color));h.setAttribute("stroke-width",g.width+"pt");var i=g.width>100?g.width:1;switch(g.style){case 2:h.setAttribute("stroke-dasharray",(4*i)+","+(2*i));break;case 3:h.setAttribute("stroke-dasharray",(1.333*i)+","+(1.333*i));break;case 4:h.setAttribute("stroke-dasharray",(4*i)+","+(2*i)+","+(1.333*i)+","+(2*i));break;case 5:h.setAttribute("stroke-dasharray",(4*i)+","+(2*i)+","+(1.333*i)+","+(2*i)+","+(1.333*i)+","+(2*i));break;case 7:case 9:h.setAttribute("stroke-width",g.width*1.5+"pt");break;case 11:h.setAttribute("stroke-dasharray",(4*5/3*i)+","+(4*i));break;}};var c=function(g,h){g.setAttribute("opacity",(h/255));};}function mCR_exportChartPaintSvgRectangle(b,a,c){this.rectangle=function(i,f,h){var j=c.cm().rect2(h);var g=d(j);b.background(g,i,h);b.line(g,f);a.appendChild(g);};var d=function(g){var f=document.createElementNS("http://www.w3.org/2000/svg","rect");f.setAttribute("x",g.x+"cm");f.setAttribute("y",g.y+"cm");f.setAttribute("width",g.width+"cm");f.setAttribute("height",g.height+"cm");return f;};}function mCR_exportChartPaintSvgCircle(b,a,d){this.paint=function(j,f,i){var h=d.cm().circle(i);var g=c(h);b.background(g,j,i);b.line(g,f);a.appendChild(g);};var c=function(g){var f=document.createElementNS("http://www.w3.org/2000/svg","circle");f.setAttribute("cx",g.cx+"cm");f.setAttribute("cy",g.cy+"cm");f.setAttribute("r",g.r+"cm");return f;};}function mCR_exportChartPaintSvgEllipse(b,a,c){this.paint=function(i,f,h){var j=c.cm().ellipse(h);var g=d(j);b.background(g,i,h);b.line(g,f);a.appendChild(g);};var d=function(g){var f=document.createElementNS("http://www.w3.org/2000/svg","ellipse");f.setAttribute("cx",g.cx+"cm");f.setAttribute("cy",g.cy+"cm");f.setAttribute("rx",g.rx+"cm");f.setAttribute("ry",g.ry+"cm");return f;};}function mCR_exportChartPaintSvgLine(b,a,c){this.line=function(g,k,j){var i=c.cm().point(k);var f=c.cm().point(j);var h=d(i,f);b.line(h,g);a.appendChild(h);};var d=function(h,f){var g=document.createElementNS("http://www.w3.org/2000/svg","line");g.setAttribute("x1",h.x+"cm");g.setAttribute("y1",h.y+"cm");g.setAttribute("x2",f.x+"cm");g.setAttribute("y2",f.y+"cm");return g;};}function mCR_exportChartPaintSvgText(a,m){this.text=function(t,v,w,y,x,u){exportChartLog.log("--------option");exportChartLog.log(v);var s=document.createElementNS("http://www.w3.org/2000/svg","text");r(s,v,w,x,u);f(s,t);d(s,t.color);k(s,y);a.appendChild(s);};var r=function(t,v,w,x,u){var s=n(w,v);c(t,s);h(t,v);o(t,w,x,u);};var c=function(t,s){t.setAttribute("x",m.cm().value(s.x)+"cm");t.setAttribute("y",m.cm().value(s.y)+"cm");};var n=function(t,s){return{x:j(t,s.horizontalAlignment),y:q(t,s.verticalAlignment)};};var j=function(t,s){switch(s){case 0:return t.left;case 1:return new mCR_exportChartUtilRectangle(t).center();case 2:return t.right;default:return t.left;}};var q=function(t,s){return t.top+(t.getHeight()*0.85);};var h=function(s,u){var t=g(u.horizontalAlignment);exportChartLog.log("---anchor:"+t);s.setAttribute("text-anchor",t);};var g=function(s){switch(s){case 0:return"start";case 1:return"middle";case 2:return"end";default:return"start";}};var o=function(t,v,w,u){var s={0:i,1:l,2:b,3:b};s[u](t,v,w);};var i=function(){};var l=function(s,t,u){};var b=function(s,t,u){s.setAttribute("transform","rotate("+(-u)+","+m.px().value(t.left)+","+m.px().value(t.top)+")");};var f=function(t,s){if(!s){return;}if(s.bold){t.setAttribute("font-weight","bold");}if(s.italic){t.setAttribute("font-style","italic");}t.setAttribute("font-family",p(s));t.setAttribute("font-size",(s.size)+"pt");};var d=function(t,s){t.setAttribute("fill",mCR_getStrColor(s));};var k=function(s,t){s.textContent=t;};var p=function(s){return a.styleFontName(s.nameEngIndex)+","+a.styleFontName(s.nameIndex);};}function mCR_exportChartPaintSvgPolygon(b,a,c){this.polygon=function(j,g,f,i){var h=document.createElementNS("http://www.w3.org/2000/svg","polygon");h.setAttribute("points",d(f));if(i){exportChartLog.log("gradient rect");b.background(h,j,i);}else{b.background(h,j,this.pointListToRect(f));}b.line(h,g);a.appendChild(h);};var d=function(f){var g="";f.map(function(h,i){g+=(c.px().value(h.x)+" "+c.px().value(h.y));if(i!=(f.length-1)){g+=",";}});return g;};this.pointListToRect=function(f){var g=new docRect();if(0<f.length){g.left=f[0].x;g.top=f[0].y;g.right=f[0].x;g.bottom=f[0].y;}f.map(function(h){g.left=h.x<g.left?h.x:g.left;g.top=h.y<g.top?h.y:g.top;g.right=g.right<h.x?h.x:g.right;g.bottom=g.bottom<h.y?h.y:g.bottom;});return g;};}function mCR_exportChartPaintSvgCurve(c,b,h){var g=new mCR_exportChartPaintSvgPolygon(c,b,h);this.line=function(k,j,l){a(k,j,l);};this.surface=function(n,j,m,q,l,o,p){if(p==true){d(n,m,q,l,o);a(j,m,q);}else{var k=d(n,m,q,l,o);c.line(k,j);}};var a=function(k,j,m){var l=i(j,m);c.line(l,k);b.appendChild(l);return l;};var d=function(m,l,o,k,n){var j=f(l,o,k,n);c.background(j,m,g.pointListToRect([].concat(l,k)));b.appendChild(j);return j;};var i=function(j,m){var l=h.px().pointList(j);var k=new mCR_exportChartPaintSvgCurvePath();return k.line(l,m);};var f=function(m,p,k,n){var l=h.px().pointList(m);var o=h.px().pointList(k).reverse();var j=new mCR_exportChartPaintSvgCurvePath();return j.surface(l,p,o,n);};}function mCR_exportChartPaintSvgCurvePath(){this.line=function(h,j){var k=b(h[0]);var i=f(h,j);return d(k+i);};this.surface=function(j,o,i,k){var n=b(j[0]);var m=f(j,o);var l=a(i[0]);var h=f(i,k);return d(n+m+l+h+" Z");};var b=function(h){return" M"+h.x+" "+h.y+" ";};var a=function(h){return" L"+h.x+" "+h.y+" ";};var f=function(h,i){if(i!=0&&2<h.length){var j=new mCR_exportChartPaintCatmullRomSpline(h,i);return g(h,j.controlPoints);}else{return c(h);}};var g=function(p,r){var h="";var q,m,l,o;var n=0,k=0;for(n=0;n<p.length-1;n++){q=p[n];m=r[k++];l=r[k++];o=p[n+1];h+=" C "+m.x+" "+m.y+" "+l.x+" "+l.y+" "+o.x+" "+o.y;}return h;};var c=function(j){var l="";var m,k;var h=0;for(h=0;h<j.length-1;h++){m=j[h];k=j[h+1];l+=" L"+k.x+" "+k.y;}return l;};var d=function(i){var h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttribute("d",i);return h;};}function mCR_exportChartPaintSvgPie(d,a,i){this.pie=function(o,l,q,n,k,p){var m=f(i.px().rect1(q),n,k,i.px().value(p));d.background(m,o,q);d.line(m,l);a.appendChild(m);};var f=function(q,o,k,p){var m=new mCR_exportChartUtilPie(q,p);var r=m.slice(o,k,p);var l;if(0<p){l=j(r,q,k,m.holeRect(p));}else{l=h(r,q,k);}var n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("d",l);return n;};var h=function(q,m,k){var l=g(q.outer.start);var o=c(m,k,q.outer.end);var n=b(q.inner.end);var p=" Z";return l+o+n+p;};var j=function(o,r,p,l){var s=g(o.outer.start);var k=c(r,p,o.outer.end);var m=b(o.inner.end);var n=c(l,-p,o.inner.start);var q=" Z";return s+k+m+n+q;};var c=function(q,m,l){var k=(q.right-q.left)*0.5;var n=(q.bottom-q.top)*0.5;var o=0;var r=(Math.abs(m)<180)?0:1;var p=(-1<m)?0:1;return" A"+k+" "+n+" "+o+" "+r+" "+p+" "+l.x+" "+l.y+" ";};var g=function(k){return" M"+k.x+" "+k.y+" ";};var b=function(k){return" L"+k.x+" "+k.y+" ";};}function mCR_exportChartPaintSvgArcFace(d,a,g){this.arcFace=function(n,k,o,l){var m=j(o);d.background(m,n,l);d.line(m,k);a.appendChild(m);};var j=function(l){var m=h(l);var k=document.createElementNS("http://www.w3.org/2000/svg","path");k.setAttribute("d",m);return k;};var h=function(k){var l="";k.map(function(n,m){l+=i(n,m);});l+=" Z";return l;};var i=function(m,k){var o="";var n=g.px().rect1(m.rect);var l=new mCR_exportChartUtilEllipse(n);if(k==0){o+=f(l.point(m.startAngle));}else{o+=c(l.point(m.startAngle));}o+=b(n,m.sweepAngle,l.point(m.endAngle));return o;};var f=function(k){return" M"+k.x+" "+k.y+" ";};var c=function(k){return" L"+k.x+" "+k.y+" ";};var b=function(q,m,l){var k=(q.right-q.left)*0.5;var n=(q.bottom-q.top)*0.5;var o=0;var r=(Math.abs(m)<180)?0:1;var p=(-1<m)?0:1;return" A"+k+" "+n+" "+o+" "+r+" "+p+" "+l.x+" "+l.y+" ";};}function mCR_exportChartPaintCanvas(b,k){var d=new mCR_exportChartClipDocument(b.objDocument);var q=new mCR_exportChartPaintCoordinateTranslate({x:k.left,y:k.top});var g=new mCR_exportChartPaintUnitType();var a=b.objContext;var o=new mCR_exportChartPaintCanvasBackground(a,g);var m=new mCR_exportChartPaintCanvasClip(a,g,k);var i=new mCR_exportChartPaintCanvasClipExport(b,o);var l=new mCR_exportChartPaintCanvasStyle(i,a,g);var j=new mCR_exportChartPaintCanvasRectangle(l,a,g);var n=new mCR_exportChartPaintCanvasCircle(l,a,g);var c=new mCR_exportChartPaintCanvasLine(l,a,g);var f=new mCR_exportChartPaintCanvasText(i,a,g);var s=new mCR_exportChartPaintCanvasPolygon(l,a,g);var h=new mCR_exportChartPaintCanvasCurve(l,a,g);var p=new mCR_exportChartPaintCanvasPie(l,a,g);var r=new mCR_exportChartPaintCanvasArcFace(l,a,g);this.rectangle=function(u,t,v){u=d.background(u);t=d.line(t);v=q.rect(v);j.rectangle(u,t,v);};this.circle=function(u,t,v){u=d.background(u);t=d.line(t);v=q.rect(v);n.paint(u,t,v);};this.line=function(u,v,t){u=d.line(u);v=q.point(v);t=q.point(t);c.line(u,v,t);};this.text=function(t,v,w,y,x,u){t=d.font(t);v=d.textOption(v);w=q.rect(w);f.text(t,v,w,y,x,u);};this.polygon=function(w,u,t,v){w=d.background(w);u=d.line(u);t=q.pointList(t);v=v?q.rect(v):v;s.polygon(w,u,t,v);};this.curveLine=function(u,t,v){u=d.line(u);t=q.pointList(t);h.line(u,t,v);};this.curveSurface=function(w,t,v,z,u,x,y){w=d.background(w);t=d.line(t);v=q.pointList(v);u=q.pointList(u);h.surface(w,t,v,z,u,x,y);};this.pie=function(w,u,y,v,t,x){w=d.background(w);u=d.line(u);y=q.rect(y);p.pie(w,u,y,v,t,x);};this.arcFace=function(v,t,w,u){v=d.background(v);t=d.line(t);w.map(function(x){x.rect=q.rect(x.rect);});u=u?q.rect(u):u;r.arcFace(v,t,w,u);};this.beginClip=function(t){t=q.rect(t);m.begin(t);};this.defaultClip=function(){m.defaultt();};this.endClip=function(){m.end();};}function mCR_exportChartPaintCanvasClip(a,b,c){this.begin=function(d){a.save();a.beginPath();d=b.px().rect2(d);a.rect(d.x,d.y,d.width,d.height);a.clip();};this.defaultt=function(){a.save();a.beginPath();var d=b.px().rect2(c);a.rect(d.x,d.y,d.width,d.height);a.clip();};this.end=function(){a.restore();};}var mCR_exportChartPaintCanvasBackground=function(a,b){this.radialIn=function(d,g){var c=b.px().ellipse(g);var f=c.rx<c.ry?c.ry:c.rx;var h=a.createRadialGradient(c.cx,c.cy,0,c.cx,c.cy,f);h.addColorStop(0,mCR_getStrColor(d.gradientEndColor));h.addColorStop(1,mCR_getStrColor(d.gradientStartColor));a.fillStyle=h;};};function mCR_exportChartPaintCanvasClipExport(b,a){this.styleBackground=function(d,c){if(c.gradientStyle==8){a.radialIn(c,d);}else{b.paintBackgroundStyle(c,d);}};this.styleLine=function(c){b.paintLineStyle(c);};this.styleFontName=function(c){return b.objDocument.getFontNameStyle(c);};}function mCR_exportChartPaintCanvasStyle(a,b,d){this.background=function(f,g){if(f){a.styleBackground(g,f);c(f.alpha);}};this.line=function(f){if(f){a.styleLine(f);c(f.alpha);}};var c=function(f){b.globalAlpha=f/255;};}function mCR_exportChartPaintCanvasRectangle(a,b,c){this.rectangle=function(f,d,g){var h=c.px().rect2(g);if(f){a.background(f,g);b.fillRect(h.x,h.y,h.width,h.height);}if(d){a.line(d);b.strokeRect(h.x,h.y,h.width,h.height);}};}function mCR_exportChartPaintCanvasLine(a,b,c){this.line=function(g,i,f){if(g){var h=c.px().point(i);var d=c.px().point(f);a.line(g);b.beginPath();b.moveTo(h.x,h.y);b.lineTo(d.x,d.y);b.stroke();}};}function mCR_exportChartPaintCanvasText(d,l,a){this.text=function(t,v,w,y,x,u){if(!t){return;}l.font=b(t);l.fillStyle=mCR_getStrColor(t.color);l.textAlign=r(v.horizontalAlignment);o(w,v,y,x,u);};var m=function(u,t){return{x:s(u,t.horizontalAlignment),y:p(u,t.verticalAlignment)};};var s=function(u,t){switch(t){case 0:return u.left;case 1:return new mCR_exportChartUtilRectangle(u).center();case 2:return u.right;default:return u.left;}};var p=function(u,t){return u.top+(u.getHeight()*0.85);};var r=function(t){switch(t){case 0:return"start";case 1:return"center";case 2:return"end";default:return"start";}};var o=function(w,v,y,x,u){var t={0:h,1:q,2:c,3:c};t[u](w,v,y,x);};var h=function(v,u,w){var t=m(v,u);l.fillText(w,a.px().value(t.x),a.px().value(t.y));};var q=function(u,t,w,v){};var c=function(v,u,x,w){var t=j(v,w,u.horizontalAlignment);l.save();l.translate(a.px().value(t.x),a.px().value(t.y));l.rotate(k(w));l.fillText(x,0,0);l.restore();};var j=function(u,v,t){switch(t){case 0:return g(u);case 1:return n(u,v);case 2:return i(u,v);default:return g(u);}};var g=function(t,u){return{x:t.left,y:t.top};};var n=function(v,w){var t=new mCR_exportChartUtilTrigonometry().cosSin((v.right-v.left)*0.5,w);var u=new mCR_exportChartUtilTrigonometry().cosSin((v.bottom-v.top)*0.85,w);return{x:v.left+t.width+u.width,y:v.top-t.height+u.height};};var i=function(v,w){var t=new mCR_exportChartUtilTrigonometry().cosSin((v.right-v.left),w);var u=new mCR_exportChartUtilTrigonometry().cosSin((v.bottom-v.top)*0.85,w);return{x:v.left+t.width+u.width,y:v.top-t.height+u.height};};var b=function(t){return(t.bold==true?"bold ":"")+(t.italic==true?"italic ":"")+(t.size)+"pt "+d.styleFontName(t.nameEngIndex);};var k=function(t){return f(t)*Math.PI/180;};var f=function(t){return 360-(t%360);};}function mCR_exportChartPaintCanvasCircle(a,c,b){this.paint=function(f,d,h){var g=b.px().circle(h);if(f){c.beginPath();c.arc(g.cx,g.cy,g.r,0,2*Math.PI,false);a.background(f,h);c.fill();}if(d){c.beginPath();c.arc(g.cx,g.cy,g.r,0,2*Math.PI,false);a.line(d);c.stroke();}};}function mCR_exportChartPaintCanvasPolygon(a,b,c){this.polygon=function(h,f,d,g){if(h){g=g?g:this.pointListToRect(d);b.beginPath();a.background(h,g);d.map(function(i){b.lineTo(c.px().value(i.x),c.px().value(i.y));});b.fill();}if(f){a.line(f);b.beginPath();d.map(function(i){b.lineTo(c.px().value(i.x),c.px().value(i.y));});b.closePath();b.stroke();}};this.pointListToRect=function(d){var f=new docRect();if(0<d.length){f.left=d[0].x;f.top=d[0].y;f.right=d[0].x;f.bottom=d[0].y;}d.map(function(g){f.left=g.x<f.left?g.x:f.left;f.top=g.y<f.top?g.y:f.top;f.right=f.right<g.x?g.x:f.right;f.bottom=f.bottom<g.y?g.y:f.bottom;});return f;};}function mCR_exportChartPaintCanvasCurve(b,d,h){var c=new mCR_exportChartPaintCanvasPolygon(b,d,h);var g=new mCR_exportChartPaintCanvasCurvePath(d);this.line=function(k,j,l){a(k,j,l);};this.surface=function(m,j,l,p,k,n,o){if(o==true){f(m,l,p,k,n);a(j,l,p);}else{f(m,l,p,k,n);i(j,l,p,k,n);}};var a=function(k,j,m){d.beginPath();b.line(k);var l=h.px().pointList(j);g.line(l,m);d.stroke();};var f=function(m,l,p,j,n){d.beginPath();b.background(m,c.pointListToRect([].concat(l,j)));var k=h.px().pointList(l);var o=h.px().pointList(j).reverse();g.surface(k,p,o,n);d.closePath();d.fill();};var i=function(j,m,p,k,n){d.beginPath();b.line(j);var l=h.px().pointList(m);var o=h.px().pointList(k).reverse();g.surface(l,p,o,n);d.closePath();d.stroke();};}function mCR_exportChartPaintCanvasCurvePath(d){this.line=function(h,i){b(h[0]);f(h,i);};this.surface=function(i,k,h,j){b(i[0]);f(i,k);a(h[0]);f(h,j);};var f=function(h,i){if(i!=0&&2<h.length){var j=new mCR_exportChartPaintCatmullRomSpline(h,i);g(h,j.controlPoints);}else{c(h);}};var g=function(o,h){var q,n,m,p;var l=0,k=0;for(l=0;l<o.length-1;l++){q=o[l];n=h[k++];m=h[k++];p=o[l+1];d.bezierCurveTo(n.x,n.y,m.x,m.y,p.x,p.y);}};var c=function(j){var l,k;var h=0;for(h=0;h<j.length-1;h++){l=j[h];k=j[h+1];d.lineTo(k.x,k.y);}};var b=function(h){d.moveTo(h.x,h.y);};var a=function(h){d.lineTo(h.x,h.y);};}var mCR_exportChartPaintCanvasPie=function(d,c,k){this.pie=function(o,y,u,t,w,r){var p=u;var x=k.px().rect1(u);var s=k.px().value(r);if(0<r){var q=new mCR_exportChartUtilPie(x);var v=q.slice(t,w,s);b(v,x,t,t+w,q.holeRect(s));}else{g(x,t,t+w);}m(o,p);h(y);};var m=function(p,o){if(!p){return;}d.background(p,o);c.fill();};var h=function(o){if(!o){return;}d.line(o);c.stroke();};var b=function(w,u,r,o,x){c.beginPath();var t=new mCR_exportChartUtilRectangle(u).centerMid();var s=a(u);var p=f(u);n(t.x,t.y,s,p,r,o,true);c.lineTo(w.inner.end.x,w.inner.end.y);var q=a(x);var v=f(x);n(t.x,t.y,q,v,o,r,false);c.closePath();};var g=function(s,r,q){c.beginPath();var t=new mCR_exportChartUtilRectangle(s).centerMid();var o=a(s);var p=f(s);n(t.x,t.y,o,p,r,q,true);c.lineTo(t.x,t.y);c.closePath();};var l=function(o,s,r,q,p){exportChartLog.log("startAngle:"+q+","+j(q)+"/endAngle:"+p+","+j(p));c.beginPath();c.arc(o,s,r,j(q),j(p),true);c.stroke();};var n=function(o,u,t,s,r,p,q){c.save();c.translate(o-t,u-s);c.scale(t,s);c.arc(1,1,1,j(r),j(p),q);c.restore();};var a=function(o){return(o.right-o.left)*0.5;};var f=function(o){return(o.bottom-o.top)*0.5;};var j=function(o){return i(o)*Math.PI/180;};var i=function(o){return 360-(o%360);};};var mCR_exportChartPaintCanvasArcFace=function(d,a,h){this.arcFace=function(m,k,n,l){a.beginPath();f(n);i(m,l);g(k);};var f=function(k){k.map(function(m,l){var n=h.px().rect1(m.rect);b(l,c(n,m.startAngle));j(n,m.startAngle,m.endAngle,m.startAngle<m.endAngle);});};var c=function(k,l){return new mCR_exportChartUtilEllipse(k).point(l);};var b=function(l,k){if(l==0){a.moveTo(k.x,k.y);}else{a.lineTo(k.x,k.y);}};var j=function(o,m,k,l){var n=new mCR_exportChartPaintCanvasEllipse(a);n.arc(o,m,k,l);};var i=function(l,k){if(!l){return;}d.background(l,k);a.fill();};var g=function(k){if(!k){return;}d.line(k);a.stroke();};};function mCR_exportChartPaintCanvasEllipse(a){this.arc=function(n,m,k,l){var o=h(n);var i=f(n);var j=b(n);c(o.x,o.y,i,j,m,k,l);};var c=function(i,o,n,m,l,j,k){a.save();a.translate(i-n,o-m);a.scale(n,m);a.arc(1,1,1,g(l),g(j),k);a.restore();};var h=function(i){return new mCR_exportChartUtilRectangle(i).centerMid();};var f=function(i){return(i.right-i.left)*0.5;};var b=function(i){return(i.bottom-i.top)*0.5;};var g=function(i){return d(i)*Math.PI/180;};var d=function(i){return 360-(i%360);};}function mCR_exportChartDocument(l){var m=new mCR_exportChartDocumentCoordinate();var b=function(n){return !n?{}:{rect:m.rect(n[1]),shapePanel:n[2],shapeLabel:n[3]};};var k=function(n){return !n?{}:{rect:m.rect(n[1]),shapeLegend:n[2]};};var c=function(n){return !n?null:{type:n[1],rect:m.rect(n[2]),XYAxis:a(n[3]),radar:g(n[4]),seriesGroupList:i(n[5],j)};};var a=function(n){return !n?null:{shapeListWall:n[1],shapeListAxis:n[2],vertical:n[3]};};var g=function(n){return !n?null:{shapeList:n[1]};};var j=function(n){return !n?null:{seriesList:i(n[1],f),frontRect:m.rect(n[2]),rearRect:m.rect(n[3])};};var f=function(n){return !n?null:{type:n[1],seriesItemList:i(n[2],h),typeName:n[3]};};var h=function(n){return !n?null:{rect:m.rect(n[1]),point:m.point(n[2]),shapeList:n[3],pointList:n[4],markList:n[5]};};var i=function(o,n){return d(o,n);};var d=function(p,n){if(!p){return[];}var o=[];p.map(function(q){o.push(n(q));});return o;};return{rect:m.rect(l[1]),panel:b(l[2]),legend:k(l[3]),frameList:i(l[4],c)};}function mCR_exportChartDocumentShape(l){var n=new mCR_exportChartDocumentCoordinate();var f=new mCR_exportChartDocumentElement();var b=function(o){return{type:o[1],background:f.background(o[2]),image:f.image(o[3]),line:f.line(o[4]),rect:n.rect(o[5]),rectangleType:o[6]};};var d=function(o){return{type:o[1],background:f.background(o[2]),image:f.image(o[3]),line:f.line(o[4]),rect:n.rect(o[5]),startAngle:o[6],slice:o[7]};};var j=function(o){return{type:o[1],background:f.background(o[2]),image:f.image(o[3]),line:f.line(o[4]),pointList:n.pointList(o[5])};};var k=function(o){return{type:o[1],line:f.line(o[2]),start:n.point(o[3]),end:n.point(o[4])};};var h=function(o){return{type:o[1],line:f.line(o[2]),pointList:n.pointList(o[3]),tension:o[4]};};var a=function(o){return{type:o[1],background:f.background(o[2]),image:f.image(o[3]),line:f.line(o[4]),rect:n.rect(o[5]),barType:o[6],sideLightness:o[7],edgeLightness:o[8],diagonal3D:o[9],dimensionAngle3D:o[10],enable3D:o[11],direct:o[12],origin:o[13],dur:o[14]};};var c=function(o){return{type:o[1],background:f.background(o[2]),image:f.image(o[3]),line:f.line(o[4]),point:n.point(o[5]),pointType:o[6],size:o[7]};};var m=function(o){return{type:o[1],background:f.background(o[2]),image:f.image(o[3]),line:f.line(o[4]),rect:n.rect(o[5]),startAngle:o[6],sweepAngle:o[7],depth:o[8],holeWidth:o[9],sideLightness:o[10]};};var g=function(o){return{type:o[1],background:f.background(o[2]),image:f.image(o[3]),line:f.line(o[4]),rect:n.rect(o[5]),point:n.point(o[6]),font:o[7],option:o[8],text:decodeURIComponent(o[9]),angle:o[10],axisIndex:o[11],rotate:o[12]};};var i=function(o){return{type:o[1],background:f.background(o[2]),image:f.image(o[3]),line:f.line(o[4]),topPointList:n.pointList(o[5]),topTension:o[6],bottomPointList:n.pointList(o[7]),bottomTension:o[8],lineTopOnly:o[9]};};return{0:b,1:d,2:j,3:k,4:h,5:a,6:c,7:m,8:g,9:i}[l[1]](l);}function mCR_exportChartDocumentCoordinate(){this.rect=function(a){return !a?null:{left:a[1],top:a[2],right:a[3],bottom:a[4]};};this.point=function(a){return !a?null:{x:a[1],y:a[2]};};this.pointList=function(a){var b=this;var c=[];a.map(function(d){c.push(b.point(d));});return c;};}function mCR_exportChartDocumentElement(){this.background=function(a){return !a?null:{styleKey:a[1],gradientStartLightness:a[2],gradientEndLightness:a[3],lightness:0,alpha:a[4]};};this.image=function(a){return{};};this.line=function(a){return !a?null:{styleKey:a[1],alpha:a[2]};};}function mCR_exportChartClipDocument(a){var b=new mCR_exportChartClipDocumentLightness();this.background=function(c){if(!c){return c;}var d=a.getBackgroundStyle(c.styleKey);if(d.backStyle==1&&d.gradientStyle!=0){d.backStyle=0;}d=b.background(d,c.gradientStartLightness,c.gradientEndLightness,c.lightness,c.type);d.alpha=c.alpha;return d;};this.line=function(c){if(!c){return c;}var d=a.getLineStyle(c.styleKey);d.alpha=c.alpha;return d;};this.font=function(c){return a.getFontStyle(c);};this.textOption=function(c){return a.getTextOptionStyle(c);};}function mCR_exportChartClipDocumentLightness(){var f=new mCR_exportChartShapeColorCorrection();this.background=function(j,g,h,k,i){j=d(j);c(j,k);a(j,g);b(j,h,i);return j;};var c=function(g,h){if(h!=0){g.backColor=f.bright(g.backColor,h);g.fillColor=f.bright(g.fillColor,h);g.gradientStartColor=f.bright(g.gradientStartColor,h);g.gradientEndColor=f.bright(g.gradientEndColor,h);}};var a=function(h,g){if(g!=0){h.gradientStartColor=f.bright(h.gradientStartColor,g);}};var b=function(i,g,h){if(g!=0){if(h=="side"){i.gradientEndColor=f.bright(i.gradientStartColor,g);}else{i.gradientEndColor=f.bright(i.gradientEndColor,g);}}};var d=function(h){if(h===null||typeof(h)!=="object"){return h;}var g={};Object.keys(h).map(function(i){if(h.hasOwnProperty(i)){g[i]=h[i];}});return g;};}function mCR_exportChartShapeColorCorrection(){this.bright=function(j,k){if(k==0){return j;}if(d(k)){return f(j,k);}else{return i(j,k);}};var d=function(j){return j<0;};var f=function(k,l){var n=h(k);var m=a(k);var j=g(k);n=(n+(n*l));m=(m+(m*l));j=(j+(j*l));return b(n,m,j);};var i=function(l,m){var o=h(l);var n=a(l);var j=g(l);var k=255;o=(o+(c(k,o)*m));n=(n+(c(k,n)*m));j=(j+(c(k,j)*m));return b(o,n,j);};var c=function(k,j){return(j==0)?0:k%j;};var h=function(j){return(j&255);};var a=function(j){return((j>>8)&255);};var g=function(j){return((j>>16)&255);};var b=function(l,k,j){return(j<<16)|(k<<8)|(l);};}function mCR_exportChartPaintCoordinateTranslate(a){this.rect=function(b){var c=new docRect();c.left=b.left+a.x;c.top=b.top+a.y;c.right=b.right+a.x;c.bottom=b.bottom+a.y;return c;};this.point=function(b){return{x:b.x+a.x,y:b.y+a.y};};this.pointList=function(b){var c=this;var d=[];b.map(function(f){d.push(c.point(f));});return d;};}function mCR_exportChartPaintUnit(){this.cm=function(a){return(a*0.01);};this.px=function(b){var a=96;return b*a/254;};}var mCR_exportChartPaintUnitType=function(){var a=new mCR_exportChartPaintUnit();var b=function(c){return c;};this.cm=function(){b=a.cm;return this;};this.px=function(){b=a.px;return this;};this.rect1=function(c){return{left:b(c.left),top:b(c.top),right:b(c.right),bottom:b(c.bottom)};};this.rect2=function(c){return{x:b(c.left),y:b(c.top),width:b(c.right-c.left),height:b(c.bottom-c.top)};};this.circle=function(c){var d=(c.right-c.left)*0.5;return{cx:b(c.left+d),cy:b(c.top+d),r:b(d)};};this.ellipse=function(c){var f=(c.right-c.left)*0.5;var d=(c.bottom-c.top)*0.5;return{cx:b(c.left+f),cy:b(c.top+d),rx:b(f),ry:b(d)};};this.point=function(c){return{x:b(c.x),y:b(c.y)};};this.pointList=function(d){var c=[];d.map(function(f){c.push({x:b(f.x),y:b(f.y)});});return c;};this.value=function(c){return b(c);};};function mCR_exportChartPaintCatmullRomSpline(d,b){var f=function(){var o=[];var v=[];var l=[];var r=a(d);if(r.length<3){return;}var m=(b*0.5)/0.9;var n=r[r.length-2];var q=r[r.length-1];r.push(h(q,i(q,n)));var t=h(r[0],i(r[0],r[1]));var s=r[0];var p=null;var k;for(k=0;k<r.length-1;k++){p=r[k+1];var u=c(m*g(i(t,s)),i(t,p));o.push(u);v.push(h(s,u));var j=c(m*g(i(p,s)),i(p,t));l.push(j);v.push(h(s,j));t=s;s=p;}v.shift();v.pop();return v;};var i=function(k,j){return{x:k.x-j.x,y:k.y-j.y};};var g=function(j){return Math.sqrt(j.x*j.x+j.y*j.y);};var c=function(l,j){var k=l/g(j);return{x:j.x*k,y:j.y*k};};var h=function(k,j){return{x:k.x+j.x,y:k.y+j.y};};var a=function(k){var j=[];k.map(function(l){j.push(l);});return j;};this.controlPoints=f();}function mCR_exportChartSeriesPie(m){var b={bottom:[],wall:[],top:[]};var k=new mCR_exportChartUtilRectangle({left:0,top:0,right:0,bottom:0});this.add=function(v){if(v.depth==0){n(v);}else{u(v);}};var n=function(v){b.bottom.push(v);};var u=function(v){c(v);p(v);h(v);};var c=function(v){v=o(v);v.rect=j(v.rect,v.depth);b.bottom.push(v);};var j=function(v,w){return{left:v.left,top:v.top+w,right:v.right,bottom:v.bottom};};var q=function(x,y){var w=d(x,y);var v=j(x,y);k=k.union(w).union(v);};var p=function(w){w=o(w);w.background=o(w.background);w.background.lightness=w.sideLightness;q(w.rect,w.depth);var x=d(w.rect,w.depth);var v=j(w.rect,w.depth);t(w,x,v);s(w,x,v);};var t=function(y,z,v){var A=f(y,z,v);A.map(function(C){b.wall.push(C);});exportChartLog.log("outer");exportChartLog.log(A);var x=l(z,y.holeWidth);var B=l(v,y.holeWidth);var w=f(y,x,B);w.map(function(C){b.wall.push(C);});exportChartLog.log("inner");exportChartLog.log(w);};var l=function(v,w){return mCR_exportChartUtilPie(v).holeRect(w);};var f=function(A,y,w){var z=A.startAngle;var E=A.sweepAngle;var x=z+E;var D=function(I){var K=new mCR_exportChartUtilEllipse(I.rect);var J=K.point(I.startAngle);var H=K.point(I.endAngle);return(J.y>H.y)?H.y:J.y;};var C=function(H,I){return{key:H,value:{background:A.background,line:A.line,type:"arc",value:I}};};var G=function(){var K=g(y,z,E);var I=g(w,x,-E);var J=(z<270&&270<x)?w.bottom:D(K);var H=C(J,[K,I]);return[H];};var F=function(){var J=[];var P=360-z;var T=g(y,z,P);var V=g(w,360,-P);var aa=P<=90?D(T):w.bottom;var L=C(aa,[T,V]);J.push(L);var O=x-360;if(O<=180){var R=g(y,0,O);var U=g(w,O,-O);var Z=O<=90?D(R):y.top;var I=C(Z,[R,U]);J.push(I);}else{var W=g(y,0,180);var X=g(w,180,-180);var M=y.top;var K=C(M,[W,X]);J.push(K);var N=x-(360+180);var Q=g(y,180,N);var S=g(w,x,-N);var Y=N<=90?D(Q):w.bottom;var H=C(Y,[Q,S]);J.push(H);}return J;};var B=function(){var K=g(y,z,E);var I=g(w,x,-E);var J=(z<90&&90<x)?y.top:D(K);var H=C(J,[K,I]);return[H];};var v=function(){var J=[];var P=180-z;var T=g(y,z,P);var V=g(w,180,-P);var aa=P<=90?D(T):y.top;var L=C(aa,[T,V]);J.push(L);var O=x-180;if(O<=180){var R=g(y,180,O);var U=g(w,180+O,-O);var Z=O<=90?D(R):w.bottom;var I=C(Z,[R,U]);J.push(I);}else{var W=g(y,180,180);var X=g(w,360,-180);var M=w.bottom;var K=C(M,[W,X]);J.push(K);var N=x-360;var Q=g(y,0,N);var S=g(w,N,-N);var Y=N<=90?D(Q):y.top;var H=C(Y,[Q,S]);J.push(H);}return J;};if(180<=z){if(x<=360){return G();}else{return F();}}else{if(x<=180){return B();}else{return v();}}};var g=function(x,w,v){return{rect:x,startAngle:w,sweepAngle:v,endAngle:w+v};};var s=function(y,z,w){var A=new mCR_exportChartUtilPie(z).slice(y.startAngle,y.sweepAngle,y.holeWidth);var x=new mCR_exportChartUtilPie(w).slice(y.startAngle,y.sweepAngle,y.holeWidth);var v=r(A.outer.start,A.inner.start,x.inner.start,x.outer.start,y.background,y.line);b.wall.push(v);var B=r(A.outer.end,A.inner.end,x.inner.end,x.outer.end,y.background,y.line);b.wall.push(B);};var r=function(w,C,A,z,y,v){var B=[w,C,A,z];var x=Math.min(w.y,C.y);return{key:x,value:{background:y,line:v,type:"path",path:B}};};var h=function(v){v=o(v);v.rect=d(v.rect,v.depth);b.top.push(v);};var d=function(v,w){return{left:v.left,top:v.top,right:v.right,bottom:v.bottom-w};};this.exportt=function(){b.bottom.map(function(v){a(v);});b.wall.sort(function(w,v){return w.key-v.key;});b.wall.map(function(v){i(v.value);});b.top.map(function(v){a(v);});};var i=function(v){if(v.type=="path"){m.polygon(v.background,v.line,v.path,k);}else{if(v.type=="arc"){m.arcFace(v.background,v.line,v.value,k);}}};var a=function(w){var v=360<=w.sweepAngle?359.9:w.sweepAngle;m.pie(w.background,w.line,w.rect,w.startAngle,v,w.depth,w.holeWidth,w.sideLightness);};var o=function(w){if(w===null||typeof(w)!=="object"){return w;}var v={};Object.keys(w).map(function(x){if(w.hasOwnProperty(x)){v[x]=w[x];}});return v;};}function mCR_exportChartShapeBar(c){this.paint=function(i){var h={0:b,1:g,2:a,3:d,4:f};h[i.barType](i);};var b=function(h){var i=new mCR_exportChartShapeBarRectangle(c);i.paint(h);};var g=function(h){};var a=function(h){};var d=function(h){};var f=function(h){};}function mCR_exportChartShapeBarRectangle(b){var c=new mCR_exportChartUtilTrigonometry();this.paint=function(t){if(t.enable3D==true){o(t);}else{j(t);}};var j=function(t){b.rectangle(t.background,t.line,t.rect);};var o=function(u){var t=q(u.rect);var v=p(u.rect,u.diagonal3D,u.dimensionAngle3D);f(u.line,t,v,u.dimensionAngle3D);m(u.background,t,v,u.dimensionAngle3D,u.sideLightness);s(u.background,t);a(u.line,t,v,u.dimensionAngle3D);};var q=function(t){return mCR_exportChartUtilRectangle({left:t.left,top:t.top,right:t.right,bottom:t.bottom});};var p=function(u,w,v){var t=c.cosSin(w,v);return mCR_exportChartUtilRectangle({left:u.left+t.width,top:u.top-t.height,right:u.right+t.width,bottom:u.bottom-t.height});};var f=function(u,t,w,v){if(v<=90){b.line(u,w.leftTop(),w.leftBottom());b.line(u,t.leftBottom(),w.leftBottom());b.line(u,w.rightBottom(),w.leftBottom());}else{b.line(u,w.rightTop(),w.rightBottom());b.line(u,t.rightBottom(),w.rightBottom());b.line(u,w.leftBottom(),w.rightBottom());}};var m=function(w,u,y,x,t){w.lightness=t;w.type="side";var v=i(u,y);d(w,u,y,v,x);n(w,u,y,v);};var i=function(t,u){return t.union(u);};var d=function(v,t,y,u,x){var w=g(t,y,x);b.irregularPolygon(v,null,w,u);};var g=function(t,w,v){var u=[];if(v<=90){u.push(t.rightTop());u.push(w.rightTop());u.push(w.rightBottom());u.push(t.rightBottom());}else{u.push(w.leftTop());u.push(t.leftTop());u.push(t.leftBottom());u.push(w.leftBottom());}return u;};var n=function(v,t,x,u){var w=r(t,x);b.irregularPolygon(v,null,w,u);};var r=function(t,v){var u=[];u.push(v.leftTop());u.push(v.rightTop());u.push(t.rightTop());u.push(t.leftTop());return u;};var s=function(t,u){t.lightness=0;t.type="normal";b.rectangle(t,null,u);};var a=function(u,t,w,v){h(u,t,w);k(u,t,w,v);l(u,t,w,v);};var h=function(u,t,v){b.line(u,v.leftTop(),v.rightTop());b.line(u,v.rightTop(),t.rightTop());b.line(u,t.rightTop(),t.leftTop());b.line(u,t.leftTop(),v.leftTop());};var k=function(u,t,w,v){if(v<=90){b.line(u,t.leftTop(),t.leftBottom());b.line(u,t.rightTop(),t.rightBottom());b.line(u,w.rightTop(),w.rightBottom());}else{b.line(u,w.leftTop(),w.leftBottom());b.line(u,t.leftTop(),t.leftBottom());b.line(u,t.rightTop(),t.rightBottom());}};var l=function(u,t,w,v){if(v<=90){b.line(u,t.leftBottom(),t.rightBottom());b.line(u,t.rightBottom(),w.rightBottom());}else{b.line(u,w.leftBottom(),t.leftBottom());b.line(u,t.leftBottom(),t.rightBottom());}};}function mCR_exportChartShapePaint(a){this.rectangle=function(g,f,h){if(!g&&!f){return;}if(c(h)){return;}a.rectangle(g,f,h);};this.circle=function(g,f,h){if(!g&&!f){return;}if(c(h)){return;}a.circle(g,f,h);};this.ellipse=function(g,f,h){if(!g&&!f){return;}if(c(h)){return;}a.ellipse(g,f,h);};this.line=function(g,h,f){if(!g){return;}if(d(h,f)){return;}a.line(g,h,f);};this.text=function(f,h,i,k,j,g){if(c(i)){return;}a.text(f,h,i,k,j,g);};this.regularPolygon=function(i,g,j,h,k){if(k<3){return;}var f=b(j,h,k);this.polygon(i,g,f);};var b=function(k,j,m){var h=new mCR_exportChartUtilEllipse(k);var g=new mCR_exportSVGChartUtilCircularIterator(j,-1);var n=(360/m);var f=[];var l=0;for(l=0;l<m;l++){var i=h.point(g.current());f.push(i);g.next(n);}return f;};this.irregularPolygon=function(i,g,f,h){if(f.length==0){return;}this.polygon(i,g,f,h);};this.polygon=function(i,g,f,h){a.polygon(i,g,f,h);};this.curveLine=function(g,f,h){a.curveLine(g,f,h);};this.curveSurface=function(i,f,h,l,g,j,k){if(h.length<2){return;}if(g.length<2){return;}a.curveSurface(i,f,h,l,g,j,k);};this.pie=function(j,h,l,i,f,m,k,g){a.pie(j,h,l,i,f,k);};this.arcFace=function(h,f,i,g){if(!h&&!f){return;}a.arcFace(h,f,i,g);};var c=function(f){return((f.right-f.left)==0||(f.bottom-f.top)==0);};var d=function(g,f){return(g.x==f.x&&g.y==f.y);};this.beginClip=function(f){if(!f){return;}if(c(f)){return;}a.beginClip(f);};this.endClip=function(){a.endClip();};this.defaultClip=function(){a.defaultClip();};}function mCR_exportChartShapePoint(l){this.paint=function(o){var n={0:m,1:b,2:f,3:d,4:g,5:j,6:k,7:i,8:h,9:a};n[o.pointType](o);};var m=function(n){var o=c(n.point,n.size);l.rectangle(n.background,n.line,o);};var b=function(n){var o=c(n.point,n.size);l.circle(n.background,n.line,o);};var f=function(n){};var d=function(n){};var g=function(n){};var j=function(n){};var k=function(n){};var i=function(n){};var h=function(n){};var a=function(n){};var c=function(n,o){return{left:n.x-(o/2),top:n.y-(o/2),right:n.x+(o/2),bottom:n.y+(o/2)};};}function mCR_exportSVGChartUtilCircularIterator(c,b){var a=c;this.current=function(){return a;};this.next=function(d){a=this.rotate(d);return a;};this.rotate=function(d){return((a+(d*b))+360)%360;};this.isClockwise=function(){var d=-1;return b==d;};return this;}function mCR_exportChartUtilEllipse(a){a=new mCR_exportChartUtilRectangle(a);this.point=function(c){var b=this.cosSin(c);var d=a.centerMid();return new mCR_exportChartUtilPoint(d).moveXY(b.width,-b.height);};this.cosSin=function(b){return new mCR_exportChartUtilTrigonometry().cosSinXY(a.width()/2,a.height()/2,b);};return this;}function mCR_exportChartUtilPoint(a){this.move=function(b){return this.moveXY(b,b);};this.moveXY=function(c,b){this.moveX(c);this.moveY(b);return a;};this.moveX=function(b){a.x+=b;return a;};this.moveY=function(b){a.y+=b;return a;};return this;}function mCR_exportChartUtilTrigonometry(){this.cosSin=function(a,b){return this.cosSinXY(a,a,b);};this.cosSinXY=function(c,a,b){return{width:this.cosX(c,b),height:this.sinY(a,b)};};this.cosX=function(b,a){return b*this.cos(a);};this.sinY=function(a,b){return a*this.sin(b);};this.cos=function(a){return Math.cos(this.radian(a));};this.sin=function(a){return Math.sin(this.radian(a));};this.radian=function(a){return a*Math.PI/180;};return this;}function mCR_exportChartUtilPie(a){this.holeRect=function(b){var g=new mCR_exportChartUtilRectangle(a).centerMid();var f=b/a.width()*a.height();var d=b*0.5;var c=f*0.5;return{left:g.x-d,top:g.y-c,right:g.x+d,bottom:g.y+c};};this.slice=function(f,c,b){var d={};d.inner=this.inner(f,c,b);d.outer=this.outer(f,c);return d;};this.inner=function(f,d,c){var b=new mCR_exportChartUtilEllipse(this.holeRect(c));return{start:b.point(f),end:b.point(f+d)};};this.outer=function(d,c){var b=new mCR_exportChartUtilEllipse(a);return{start:b.point(d),end:b.point(d+c)};};return this;}function mCR_exportChartUtilRectangle(b){var a=function(d,c){return{x:d,y:c};};b.x=function(){return b.left;};b.y=function(){return b.top;};b.width=function(){return b.right-b.left;};b.height=function(){return b.bottom-b.top;};b.center=function(){return(b.left+b.right)*0.5;};b.mid=function(){return(b.top+b.bottom)*0.5;};b.centerMid=function(){return a(b.center(),b.mid());};b.leftTop=function(){return a(b.left,b.top);};b.centerTop=function(){return a(b.center(),b.top);};b.rightTop=function(){return a(b.right,b.top);};b.rightMid=function(){return a(b.right,b.mid());};b.rightBottom=function(){return a(b.right,b.bottom);};b.centerBottom=function(){return a(b.center(),b.bottom);};b.leftBottom=function(){return a(b.left,b.bottom);};b.leftMid=function(){return a(b.left,b.mid());};b.union=function(c){return{left:b.left<c.left?b.left:c.left,top:b.top<c.top?b.top:c.top,right:b.right<c.right?c.right:b.right,bottom:b.bottom<c.bottom?c.bottom:b.bottom,union:b.union};};return b;}function docSpeechBubble(){this.tx=0;this.ty=0;this.width=220;this.height=200;this.text="";this.index=null;this.isReduceFontSize=false;this.radius=10;this.pointerSide="bottom";this.verticalAlign="top";this.horizontalAlign="left";this.marginRight=20;this.maxPointerSize=26;this.textDivMargin=15;this.fontName="나눔고딕";this.fontSize=10;this.fontBold=false;this.fontColorR=255;this.fontColorG=255;this.fontColorB=255;this.backgroundColorR=50;this.backgroundColorG=50;this.backgroundColorB=50;}docSpeechBubble.prototype.setFontColor=function(a){var b=a.match(/[A-Za-z0-9]{2}/g).map(function(c){return parseInt(c,16);});this.fontColorR=b[0];this.fontColorG=b[1];this.fontColorB=b[2];};docSpeechBubble.prototype.getFontColor=function(){var c=this.fontColorR.toString(16);var b=this.fontColorG.toString(16);var a=this.fontColorB.toString(16);if(c.length<2){c="0"+c;}if(b.length<2){b="0"+b;}if(a.length<2){a="0"+a;}return"#"+c+b+a;};docSpeechBubble.prototype.getFontColorRGB=function(){return"rgb("+this.fontColorR+","+this.fontColorG+","+this.fontColorB+")";};docSpeechBubble.prototype.setBackgroundColor=function(a){var b=a.match(/[A-Za-z0-9]{2}/g).map(function(c){return parseInt(c,16);});this.backgroundColorR=b[0];this.backgroundColorG=b[1];this.backgroundColorB=b[2];};docSpeechBubble.prototype.getBackgroundColor=function(){var b=this.backgroundColorR.toString(16);var a=this.backgroundColorG.toString(16);var c=this.backgroundColorB.toString(16);if(b.length<2){b="0"+b;}if(a.length<2){a="0"+a;}if(c.length<2){c="0"+c;}return"#"+b+a+c;};function mCR_ReportSpeechBubbleFrame(a,b){this.objReport=a;this.objCss={strClass:"",strStyle:""};this.selectedPage=0;this.elmReportSpeechBubbleFullFrame=null;this.elmReportSpeechBubbleFrame=null;this.elmReportSpeechBubbleText=null;this.elmReportSpeechBubbleTX=null;this.elmReportSpeechBubbleTY=null;this.elmReportSpeechBubbleWidth=null;this.elmReportSpeechBubbleHeight=null;this.elmReportSpeechBubbleFontSize=null;this.elmReportSpeechBubbleFontColor=null;this.elmReportSpeechBubbleLineType=null;this.elmReportSpeechBubbleBackgroundColor=null;this.elmTargetDom=null;this.nHeaderHeight=null;this.nZoomRate=1;this.arrSpeechBubbleArray=new Array();this.objSpeechBubbleInfo={objDocSpeechBubble:null,elmSpeechBubbleDiv:null,elmSpeechBubble:null,elmPosition:null,elmSize:null,elmDelete:null};this.isIE=b;this.arrSpeechBubbleElementArray=new Array();this.nSpeechBubbleTextSize=310;this.nToggleButtonSize=20;this.m_objLanguageMap=null;}mCR_ReportSpeechBubbleFrame.prototype.createSpeechBubbleFrame=function(a){var f=this.objReport;if(null!=window.ReportView){this.m_objLanguageMap=f.objLanguageMap;}else{this.m_objLanguageMap=f.m_languageMap;}var j=this;this.objSpeechBubbleInfo.objDocSpeechBubble=a;var d=document.createElement("div");d.id="report_speech_bubble_full_frame";d.className="report_speech_bubble_full_frame "+this.objCss.strClass;if(this.nHeaderHeight==null){if(this.objReport.objStyleInfo.strHeaderHeight!=null){d.style.top=this.objReport.objStyleInfo.strHeaderHeight;}}else{d.style.top=this.nHeaderHeight+"px";}if(this.elmTargetDom==null){this.objReport.objTargetDOM.appendChild(d);}else{this.elmTargetDom.appendChild(d);}this.elmReportSpeechBubbleFullFrame=d;var c=document.createElement("div");c.id="report_speech_bubble_title_div";c.className="report_speech_bubble_title_div";d.appendChild(c);var h=document.createElement("SPAN");h.style.position="absolute";h.style.left="10px";h.style.top="4px";var i=document.createTextNode(this.m_objLanguageMap.memoInfo);h.appendChild(i);c.appendChild(h);var g=document.createElement("button");g.id="report_speech_bubble_close_button";g.className="report_speech_bubble_close_button";g.onclick=function(){j.closeSpeechBubbleFrame();};c.appendChild(g);var b=document.createElement("div");b.id="report_speech_bubble_frame_div";b.className="report_speech_bubble_frame_div "+this.objCss.strClass;if(this.nHeaderHeight==null){if(!this.objReport.isUpperMenu){b.className=b.className+" clip_report_menu_up";}}b.style.cssText=this.objCss.strStyle;b.onscoll=function(){};this.elmReportSpeechBubbleFrame=b;d.appendChild(b);this.makingSpeechBubbleMainDiv();};mCR_ReportSpeechBubbleFrame.prototype.makingSpeechBubbleMainDiv=function(){this.makingSpeechBubbleTextDiv();this.makingSpeechBubblePositionDiv();this.makingSpeechBubbleFontStyleDiv();this.makingSpeechBubbleAlignmentDiv();this.makingSpeechBubbleMemoAlignmentDiv();};mCR_ReportSpeechBubbleFrame.prototype.makingSpeechBubbleTextDiv=function(){var b=this;var h=document.createElement("div");h.id="report_speech_bubble_detail_frame_div";h.className="report_speech_bubble_detail_frame_div ";h.style.top="3px";h.style.height="110px";this.elmReportSpeechBubbleFrame.appendChild(h);var g=document.createElement("div");g.id="report_speech_bubble_detail_title_div";g.className="report_speech_bubble_detail_title_div";h.appendChild(g);var a=document.createElement("SPAN");a.style.position="absolute";a.style.left="10px";a.style.top="4px";var c=document.createTextNode(this.m_objLanguageMap.memoText);a.appendChild(c);g.appendChild(a);var f=document.createElement("div");f.id="report_speech_bubble_detail_div";f.className="report_speech_bubble_detail_div "+this.objCss.strClass;h.appendChild(f);f.style.height="76px";var d=document.createElement("textarea");d.style.width="97%";d.style.height="100%";d.style.resize="none";f.appendChild(d);d.value=this.objSpeechBubbleInfo.objDocSpeechBubble.text;d.addEventListener("change",function(){b.setSpeechBubbleText(this.value);b.redrawTextSpeechBubble();});this.elmReportSpeechBubbleText=d;};mCR_ReportSpeechBubbleFrame.prototype.makingSpeechBubblePositionDiv=function(){var m=this;var g=document.createElement("div");g.id="report_speech_bubble_detail_frame_div";g.className="report_speech_bubble_detail_frame_div ";g.style.top="115px";g.style.height="120px";this.elmReportSpeechBubbleFrame.appendChild(g);var f=document.createElement("div");f.id="report_speech_bubble_detail_title_div";f.className="report_speech_bubble_detail_title_div";g.appendChild(f);var i=document.createElement("SPAN");i.style.position="absolute";i.style.left="10px";i.style.top="4px";var j=document.createTextNode(this.m_objLanguageMap.memoPo);i.appendChild(j);f.appendChild(i);var h=document.createElement("div");h.id="report_speech_bubble_detail_div";h.className="report_speech_bubble_detail_div";g.appendChild(h);var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="0px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoPoX+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="0px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var d=document.createElement("INPUT");d.setAttribute("type","text");d.style.width="93%";d.style.height="83%";k.appendChild(d);this.elmReportSpeechBubbleTX=d;d.value=this.objSpeechBubbleInfo.objDocSpeechBubble.tx;d.addEventListener("change",function(){m.setSpeechBubblePositionX(this.value);m.resetThisSpeechBubblePosition();});d.onkeypress=function(){m.keyCheckEvent(event);};var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="21px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoPoY+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="21px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var c=document.createElement("INPUT");c.setAttribute("type","text");c.style.width="93%";c.style.height="83%";k.appendChild(c);this.elmReportSpeechBubbleTY=c;c.value=this.objSpeechBubbleInfo.objDocSpeechBubble.ty;c.addEventListener("change",function(){m.setSpeechBubblePositionY(this.value);m.resetThisSpeechBubblePosition();});c.onkeypress=function(){m.keyCheckEvent(event);};var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="42px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoPoWidth+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="42px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var b=document.createElement("INPUT");b.setAttribute("type","text");b.style.width="93%";b.style.height="83%";k.appendChild(b);this.elmReportSpeechBubbleWidth=b;b.value=this.objSpeechBubbleInfo.objDocSpeechBubble.width-20;b.addEventListener("change",function(){m.setSpeechBubbleWidth(parseInt(this.value)+20);m.resetThisSpeechBubbleSize();m.resetThisSpeechBubbleStyle();});b.onkeypress=function(){m.keyCheckEvent(event);};var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="63px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoPoHeight+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="63px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var a=document.createElement("INPUT");a.setAttribute("type","text");a.style.width="93%";a.style.height="83%";k.appendChild(a);this.elmReportSpeechBubbleHeight=a;a.value=this.objSpeechBubbleInfo.objDocSpeechBubble.height;a.addEventListener("change",function(){m.setSpeechBubbleHeight(this.value);m.resetThisSpeechBubbleSize();m.resetThisSpeechBubbleStyle();});a.onkeypress=function(){m.keyCheckEvent(event);};};mCR_ReportSpeechBubbleFrame.prototype.makingSpeechBubbleFontStyleDiv=function(){var m=this;var g=document.createElement("div");g.id="report_speech_bubble_detail_frame_div";g.className="report_speech_bubble_detail_frame_div ";g.style.top="238px";g.style.height="120px";this.elmReportSpeechBubbleFrame.appendChild(g);var f=document.createElement("div");f.id="report_speech_bubble_detail_title_div";f.className="report_speech_bubble_detail_title_div";g.appendChild(f);var i=document.createElement("SPAN");i.style.position="absolute";i.style.left="10px";i.style.top="4px";var j=document.createTextNode(this.m_objLanguageMap.memoFont);i.appendChild(j);f.appendChild(i);var h=document.createElement("div");h.id="report_speech_bubble_detail_div";h.className="report_speech_bubble_detail_div";g.appendChild(h);var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="0px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoFontSize+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="0px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var b=document.createElement("INPUT");b.setAttribute("type","text");b.style.width="93%";b.style.height="83%";k.appendChild(b);this.elmReportSpeechBubbleFontSize=b;b.value=this.objSpeechBubbleInfo.objDocSpeechBubble.fontSize;b.addEventListener("change",function(){m.setSpeechBubbleFontSize(this.value);m.redrawTextSpeechBubble();});var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="21px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoFontColor+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="21px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var c=document.createElement("INPUT");c.setAttribute("type","color");c.style.width="93%";c.style.height="83%";k.appendChild(c);this.elmReportSpeechBubbleFontColor=c;c.value=this.getDocFontColor(this.objSpeechBubbleInfo.objDocSpeechBubble);c.addEventListener("change",function(){m.setSpeechBubbleFontColor(this.value);m.redrawTextSpeechBubble();});var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="42px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoFontReSize+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="42px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var d=document.createElement("INPUT");d.setAttribute("type","checkbox");d.style.width="93%";d.style.height="83%";k.appendChild(d);this.elmReportSpeechBubbleIsReduceFontSize=d;d.value=this.objSpeechBubbleInfo.objDocSpeechBubble.isReduceFontSize;d.addEventListener("change",function(){m.setSpeechBubbleIsReduceFontSize(this.checked);m.redrawTextSpeechBubble();});var l=document.createElement("div");l.style.position="absolute";l.style.left="0px";l.style.top="63px";l.style.width="101px";l.style.height="21px";h.appendChild(l);var j=document.createTextNode(this.m_objLanguageMap.memoFontBGColor+" : ");l.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.right="0px";k.style.top="63px";k.style.width="202px";k.style.height="21px";h.appendChild(k);var a=document.createElement("INPUT");a.setAttribute("type","color");a.style.width="93%";a.style.height="83%";k.appendChild(a);this.elmReportSpeechBubbleBackgroundColor=a;a.value=this.getDocBackgroundColor(this.objSpeechBubbleInfo.objDocSpeechBubble);a.addEventListener("change",function(){m.setSpeechBubbleBackgroundColor(this.value);m.resetThisSpeechBubbleStyle();});};mCR_ReportSpeechBubbleFrame.prototype.makingSpeechBubbleMemoAlignmentDiv=function(){var b=this;var d=document.createElement("div");d.id="report_speech_bubble_detail_frame_div";d.className="report_speech_bubble_detail_frame_div ";d.style.top="524px";d.style.height="95px";this.elmReportSpeechBubbleFrame.appendChild(d);var c=document.createElement("div");c.id="report_speech_bubble_detail_title_div";c.className="report_speech_bubble_detail_title_div";d.appendChild(c);var h=document.createElement("SPAN");h.style.position="absolute";h.style.left="10px";h.style.top="4px";var i=document.createTextNode(this.m_objLanguageMap.memoBlowingDirection);h.appendChild(i);c.appendChild(h);var g=document.createElement("div");g.id="report_speech_bubble_detail_div";g.className="report_speech_bubble_detail_div";d.appendChild(g);var j=document.createElement("div");j.style.position="absolute";j.style.left="0px";j.style.top="0px";j.style.width="59px";j.style.height="14px";g.appendChild(j);var a=document.createElement("INPUT");a.setAttribute("type","radio");a.name="memo_alignment";a.id="top";a.style.width="93%";a.style.height="83%";this.elmReportSpeechBubbleMemoAlignTopRadio=a;j.appendChild(a);if(this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide=="top"){a.checked=true;}else{a.checked=false;}j.onclick=function(){b.checkSpeechBubblePointerSide(a);};var j=document.createElement("div");j.style.position="absolute";j.style.left="59px";j.style.top="0px";j.style.width="59px";j.style.height="14px";g.appendChild(j);var n=document.createElement("INPUT");n.setAttribute("type","radio");n.name="memo_alignment";n.id="left";n.style.width="93%";n.style.height="83%";this.elmReportSpeechBubbleMemoAlignLeftRadio=n;j.appendChild(n);if(this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide=="left"){n.checked=true;}else{n.checked=false;}j.onclick=function(){b.checkSpeechBubblePointerSide(n);};var j=document.createElement("div");j.style.position="absolute";j.style.left="118px";j.style.top="0px";j.style.width="59px";j.style.height="14px";g.appendChild(j);var m=document.createElement("INPUT");m.setAttribute("type","radio");m.name="memo_alignment";m.id="bottom";m.style.width="93%";m.style.height="83%";this.elmReportSpeechBubbleMemoAlignBottomRadio=m;j.appendChild(m);if(this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide=="bottom"){m.checked=true;}else{m.checked=false;}j.onclick=function(){b.checkSpeechBubblePointerSide(m);};var j=document.createElement("div");j.style.position="absolute";j.style.left="177px";j.style.top="0px";j.style.width="59px";j.style.height="14px";g.appendChild(j);var l=document.createElement("INPUT");l.setAttribute("type","radio");l.name="memo_alignment";l.id="right";l.style.width="93%";l.style.height="83%";this.elmReportSpeechBubbleMemoAlignRightRadio=l;j.appendChild(l);if(this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide=="right"){l.checked=true;}else{l.checked=false;}j.onclick=function(){b.checkSpeechBubblePointerSide(l);};var j=document.createElement("div");j.style.position="absolute";j.style.left="236px";j.style.top="0px";j.style.width="59px";j.style.height="14px";g.appendChild(j);var f=document.createElement("INPUT");f.setAttribute("type","radio");f.name="memo_alignment";f.id="none";f.style.width="93%";f.style.height="83%";this.elmReportSpeechBubbleMemoAlignNoneRadio=f;j.appendChild(f);if(this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide=="none"){f.checked=true;}else{f.checked=false;}j.onclick=function(){b.checkSpeechBubblePointerSide(f);};var k=document.createElement("div");k.style.position="absolute";k.style.left="0px";k.style.top="14px";k.style.width="59px";k.style.height="55px";k.id="bubble_speech_frame_pointer_top_div";k.className="bubble_speech_frame_pointer_top_div";g.appendChild(k);var k=document.createElement("div");k.style.position="absolute";k.style.left="59px";k.style.top="14px";k.style.width="59px";k.style.height="55px";k.id="bubble_speech_frame_pointer_left_div";k.className="bubble_speech_frame_pointer_left_div";g.appendChild(k);var k=document.createElement("div");k.style.position="absolute";k.style.left="118px";k.style.top="14px";k.style.width="59px";k.style.height="55px";k.id="bubble_speech_frame_pointer_bottom_div";k.className="bubble_speech_frame_pointer_bottom_div";g.appendChild(k);var k=document.createElement("div");k.style.position="absolute";k.style.left="177px";k.style.top="14px";k.style.width="59px";k.style.height="55px";k.id="bubble_speech_frame_pointer_right_div";k.className="bubble_speech_frame_pointer_right_div";g.appendChild(k);var k=document.createElement("div");k.style.position="absolute";k.style.left="236px";k.style.top="14px";k.style.width="59px";k.style.height="55px";k.id="bubble_speech_frame_pointer_none_div";k.className="bubble_speech_frame_pointer_none_div";g.appendChild(k);};mCR_ReportSpeechBubbleFrame.prototype.checkSpeechBubblePointerSide=function(a){if(a.id=="top"){if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide="top";}}else{if(a.id=="left"){if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide="left";}}else{if(a.id=="bottom"){if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide="bottom";}}else{if(a.id=="right"){if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide="right";}}else{if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide="none";}}}}}this.resetThisSpeechBubbleStyle();};mCR_ReportSpeechBubbleFrame.prototype.makingSpeechBubbleAlignmentDiv=function(){var b=this;var h=document.createElement("div");h.id="report_speech_bubble_detail_frame_div";h.className="report_speech_bubble_detail_frame_div ";h.style.top="361px";h.style.height="160px";this.elmReportSpeechBubbleFrame.appendChild(h);var g=document.createElement("div");g.id="report_speech_bubble_detail_title_div";g.className="report_speech_bubble_detail_title_div";h.appendChild(g);var k=document.createElement("SPAN");k.style.position="absolute";k.style.left="10px";k.style.top="4px";var l=document.createTextNode(this.m_objLanguageMap.memoReplacement);k.appendChild(l);g.appendChild(k);var i=document.createElement("div");i.id="report_speech_bubble_detail_div";i.className="report_speech_bubble_detail_div";h.appendChild(i);var m=document.createElement("div");m.style.position="absolute";m.style.left="0px";m.style.top="0px";m.style.width="100px";m.style.height="13px";i.appendChild(m);var a=document.createElement("INPUT");a.setAttribute("type","radio");a.name="horizontal_alignment";a.id="left";a.style.width="93%";a.style.height="83%";this.elmReportSpeechBubbleHorizontalAlignLeftRadio=a;m.appendChild(a);if(this.objSpeechBubbleInfo.objDocSpeechBubble.horizontalAlign=="left"){a.checked=true;}else{a.checked=false;}m.onclick=function(){b.checkSpeechBubbleHorizontalAlign(a);};var m=document.createElement("div");m.style.position="absolute";m.style.left="100px";m.style.top="0px";m.style.width="100px";m.style.height="13px";i.appendChild(m);var o=document.createElement("INPUT");o.setAttribute("type","radio");o.name="horizontal_alignment";o.id="center";o.style.width="93%";o.style.height="83%";this.elmReportSpeechBubbleHorizontalAlignCenterRadio=o;m.appendChild(o);if(this.objSpeechBubbleInfo.objDocSpeechBubble.horizontalAlign=="center"){o.checked=true;}else{o.checked=false;}m.onclick=function(){b.checkSpeechBubbleHorizontalAlign(o);};var m=document.createElement("div");m.style.position="absolute";m.style.left="200px";m.style.top="0px";m.style.width="100px";m.style.height="13px";i.appendChild(m);var f=document.createElement("INPUT");f.setAttribute("type","radio");f.name="horizontal_alignment";f.id="right";f.style.width="93%";f.style.height="83%";this.elmReportSpeechBubbleHorizontalAlignRightRadio=f;m.appendChild(f);if(this.objSpeechBubbleInfo.objDocSpeechBubble.horizontalAlign=="right"){f.checked=true;}else{f.checked=false;}m.onclick=function(){b.checkSpeechBubbleHorizontalAlign(f);};var n=document.createElement("div");n.style.position="absolute";n.style.left="0px";n.style.top="13px";n.style.width="100px";n.style.height="52px";n.id="bubble_speech_frame_sentence_left_div";n.className="bubble_speech_frame_sentence_left_div";i.appendChild(n);var n=document.createElement("div");n.style.position="absolute";n.style.left="100px";n.style.top="13px";n.style.width="100px";n.style.height="52px";n.id="bubble_speech_frame_sentence_center_div";n.className="bubble_speech_frame_sentence_center_div";i.appendChild(n);var n=document.createElement("div");n.style.position="absolute";n.style.left="200px";n.style.top="13px";n.style.width="100px";n.style.height="52px";n.id="bubble_speech_frame_sentence_right_div";n.className="bubble_speech_frame_sentence_right_div";i.appendChild(n);var m=document.createElement("div");m.style.position="absolute";m.style.left="0px";m.style.top="65px";m.style.width="100px";m.style.height="13px";i.appendChild(m);var c=document.createElement("INPUT");c.setAttribute("type","radio");c.name="vertical_alignment";c.id="top";c.style.width="93%";c.style.height="83%";this.elmReportSpeechBubbleVerticalAlignTopRadio=c;m.appendChild(c);if(this.objSpeechBubbleInfo.objDocSpeechBubble.verticalAlign=="top"){c.checked=true;}else{c.checked=false;}m.onclick=function(){b.checkSpeechBubbleVerticalAlign(c);};var m=document.createElement("div");m.style.position="absolute";m.style.left="100px";m.style.top="65px";m.style.width="100px";m.style.height="13px";i.appendChild(m);var d=document.createElement("INPUT");d.setAttribute("type","radio");d.name="vertical_alignment";d.id="middle";d.style.width="93%";d.style.height="83%";this.elmReportSpeechBubbleVerticalAlignMiddleRadio=d;m.appendChild(d);if(this.objSpeechBubbleInfo.objDocSpeechBubble.verticalAlign=="middle"){d.checked=true;}else{d.checked=false;}m.onclick=function(){b.checkSpeechBubbleVerticalAlign(d);};var m=document.createElement("div");m.style.position="absolute";m.style.left="200px";m.style.top="65px";m.style.width="100px";m.style.height="13px";i.appendChild(m);var j=document.createElement("INPUT");j.setAttribute("type","radio");j.name="vertical_alignment";j.id="bottom";j.style.width="93%";j.style.height="83%";this.elmReportSpeechBubbleVerticalAlignBottomRadio=j;m.appendChild(j);if(this.objSpeechBubbleInfo.objDocSpeechBubble.verticalAlign=="bottom"){j.checked=true;}else{j.checked=false;}m.onclick=function(){b.checkSpeechBubbleVerticalAlign(j);};var n=document.createElement("div");n.style.position="absolute";n.style.left="0px";n.style.top="78px";n.style.width="100px";n.style.height="52px";n.id="bubble_speech_frame_sentence_top_div";n.className="bubble_speech_frame_sentence_top_div";i.appendChild(n);var n=document.createElement("div");n.style.position="absolute";n.style.left="100px";n.style.top="78px";n.style.width="100px";n.style.height="52px";n.id="bubble_speech_frame_sentence_middle_div";n.className="bubble_speech_frame_sentence_middle_div";i.appendChild(n);var n=document.createElement("div");n.style.position="absolute";n.style.left="200px";n.style.top="78px";n.style.width="100px";n.style.height="52px";n.id="bubble_speech_frame_sentence_bottom_div";n.className="bubble_speech_frame_sentence_bottom_div";i.appendChild(n);};mCR_ReportSpeechBubbleFrame.prototype.checkSpeechBubbleHorizontalAlign=function(a){if(a.id=="left"){if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.horizontalAlign="left";}}else{if(a.id=="center"){if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.horizontalAlign="center";}}else{if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.horizontalAlign="right";}}}this.reDrawTextInSpeechBubble();};mCR_ReportSpeechBubbleFrame.prototype.checkSpeechBubbleVerticalAlign=function(a){if(a.id=="top"){if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.verticalAlign="top";}}else{if(a.id=="middle"){if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.verticalAlign="middle";}}else{if(a.checked){this.objSpeechBubbleInfo.objDocSpeechBubble.verticalAlign="bottom";}}}this.reDrawTextInSpeechBubble();};mCR_ReportSpeechBubbleFrame.prototype.openSpeechBubbleFrame=function(){if(this.checkDataSpeechBubbleFrame()!=0){this.elmReportSpeechBubbleFullFrame.style.width=(this.nSpeechBubbleTextSize+this.nToggleButtonSize)+"px";this.elmReportSpeechBubbleFullFrame.style.display="block";}};mCR_ReportSpeechBubbleFrame.prototype.refreshSpeechBubbleValue=function(a){this.elmReportSpeechBubbleText.value=a.text;this.elmReportSpeechBubbleTX.value=a.tx;this.elmReportSpeechBubbleTY.value=a.ty;this.elmReportSpeechBubbleWidth.value=a.width-20;this.elmReportSpeechBubbleHeight.value=a.height;this.elmReportSpeechBubbleFontSize.value=a.fontSize;this.elmReportSpeechBubbleFontColor.value=this.getDocFontColor(a);this.elmReportSpeechBubbleIsReduceFontSize.value=a.isReduceFontSize;this.elmReportSpeechBubbleBackgroundColor.value=this.getDocBackgroundColor(a);if(a.horizontalAlign=="left"){this.elmReportSpeechBubbleHorizontalAlignLeftRadio.checked=true;}else{if(a.horizontalAlign=="center"){this.elmReportSpeechBubbleHorizontalAlignCenterRadio.checked=true;}else{this.elmReportSpeechBubbleHorizontalAlignRightRadio.checked=true;}}if(a.verticalAlign=="top"){this.elmReportSpeechBubbleVerticalAlignTopRadio.checked=true;}else{if(a.verticalAlign=="middle"){this.elmReportSpeechBubbleVerticalAlignMiddleRadio.checked=true;}else{this.elmReportSpeechBubbleVerticalAlignBottomRadio.checked=true;}}if(a.pointerSide=="top"){this.elmReportSpeechBubbleMemoAlignTopRadio.checked=true;}else{if(a.pointerSide=="left"){this.elmReportSpeechBubbleMemoAlignLeftRadio.checked=true;}else{if(a.pointerSide=="bottom"){this.elmReportSpeechBubbleMemoAlignBottomRadio.checked=true;}else{if(a.pointerSide=="right"){this.elmReportSpeechBubbleMemoAlignRightRadio.checked=true;}else{this.elmReportSpeechBubbleMemoAlignNoneRadio.checked=true;}}}}if(null!=this.objReport&&null!=this.objReport.multiView){var b=this.objReport.multiView;if(b.isSocket&&this.objReport.isMain){b.socket.sendMemoData(this.arrSpeechBubbleArray);}}};mCR_ReportSpeechBubbleFrame.prototype.closeSpeechBubbleFrame=function(){if(this.elmReportSpeechBubbleFullFrame!=null){this.elmReportSpeechBubbleFullFrame.style.width="0px";this.elmReportSpeechBubbleFullFrame.style.display="none";}this.changeSpeechBubbleStyle(null);};mCR_ReportSpeechBubbleFrame.prototype.getWidth=function(){return(this.nSpeechBubbleTextSize+this.nToggleButtonSize);};mCR_ReportSpeechBubbleFrame.prototype.changeSpeechBubbleStyle=function(a){if(this.elmSelectedSpeechBubble!=null){this.elmSelectedSpeechBubble.className=this.elmSelectedSpeechBubble.className.replace(" selected_SpeechBubble_div","");}this.elmSelectedSpeechBubble=a;if(this.elmSelectedSpeechBubble!=null){this.elmSelectedSpeechBubble.className=this.elmSelectedSpeechBubble.className+" selected_SpeechBubble_div";}};mCR_ReportSpeechBubbleFrame.prototype.keyCheckEvent=function(b){var a=b.keyCode;if(!((a>=48&&a<=57))){if(b.preventDefault){b.preventDefault();}b.returnValue=false;}else{return;}};mCR_ReportSpeechBubbleFrame.prototype.changeIsSpeechBubbleControl=function(c){if(c){this.nZoomRate=this.objSpeechBubbleInfo.elmSpeechBubbleDiv.parentElement.style.zoom;var b=this.arrSpeechBubbleElementArray.length;for(var a=0;a<b;a++){this.arrSpeechBubbleElementArray[a].elmSize.style.display="block";this.arrSpeechBubbleElementArray[a].elmDelete.style.display="block";}}else{var b=this.arrSpeechBubbleElementArray.length;for(var a=0;a<b;a++){this.arrSpeechBubbleElementArray[a].elmSize.style.display="none";this.arrSpeechBubbleElementArray[a].elmDelete.style.display="none";}}};mCR_ReportSpeechBubbleFrame.prototype.reDrawTextInSpeechBubble=function(){this.objReport.objTextBuilder.drawTextFromSpeechBubble(this.objSpeechBubbleInfo.elmSpeechBubble.firstChild.firstChild.firstChild,this.objSpeechBubbleInfo.objDocSpeechBubble,false);if(null!=this.objReport&&null!=this.objReport.multiView){var a=this.objReport.multiView;if(a.isSocket&&this.objReport.isMain){a.socket.sendMemoData(this.arrSpeechBubbleArray);}}};mCR_ReportSpeechBubbleFrame.prototype.searchDocSpeechBubble=function(b){var d=this.selectedPage;var c=this.arrSpeechBubbleElementArray.length;for(var a=0;a<c;a++){if(this.arrSpeechBubbleElementArray[a].elmSpeechBubble==b){return this.arrSpeechBubbleArray[d][a];}}};mCR_ReportSpeechBubbleFrame.prototype.deleteDocSpeechBubble=function(c){var f=this.selectedPage;var b=this.arrSpeechBubbleElementArray.length;for(var a=0;a<b;a++){if(this.arrSpeechBubbleElementArray[a].elmDelete==c){var g=this.arrSpeechBubbleElementArray[a].elmSpeechBubble;if(this.isIE){g.removeNode(this.arrSpeechBubbleElementArray[a].elmSpeechBubble);}else{g.remove(this.arrSpeechBubbleElementArray[a].elmSpeechBubble);}this.arrSpeechBubbleElementArray.splice(a,1);this.arrSpeechBubbleArray[f].splice(a,1);if(this.checkDataSpeechBubbleFrame()==0){this.closeSpeechBubbleFrame();}break;}}if(null!=this.objReport&&null!=this.objReport.multiView){var d=this.objReport.multiView;if(d.isSocket&&this.objReport.isMain){d.socket.sendMemoData(this.arrSpeechBubbleArray);}}};mCR_ReportSpeechBubbleFrame.prototype.createSpeechBubbleStyle=function(a,b){var c=document.createElement("style");c.textContent=this.createSpeechBubbleCSSText(a,b);return c;};mCR_ReportSpeechBubbleFrame.prototype.resetSpeechBubbleStyle=function(c,a,b){c.textContent=this.createSpeechBubbleCSSText(a,b);if(null!=this.objReport&&null!=this.objReport.multiView){var d=this.objReport.multiView;if(d.isSocket&&this.objReport.isMain){d.socket.sendMemoData(this.arrSpeechBubbleArray);}}};mCR_ReportSpeechBubbleFrame.prototype.resetThisSpeechBubbleStyle=function(){this.objSpeechBubbleInfo.elmSpeechBubble.firstChild.lastChild.textContent=this.createSpeechBubbleCSSText(this.objSpeechBubbleInfo.elmSpeechBubble.firstChild.className,this.objSpeechBubbleInfo.objDocSpeechBubble);if(null!=this.objReport&&null!=this.objReport.multiView){var a=this.objReport.multiView;if(a.isSocket&&this.objReport.isMain){a.socket.sendMemoData(this.arrSpeechBubbleArray);}}};mCR_ReportSpeechBubbleFrame.prototype.resetSpeechBubbleStyleSize=function(b,a){this.objSpeechBubbleInfo.elmSpeechBubble.firstChild.lastChild.textContent=this.createSpeechBubbleCSSText(this.objSpeechBubbleInfo.elmSpeechBubble.firstChild.className,this.objSpeechBubbleInfo.objDocSpeechBubble,b,a);if(null!=this.objReport&&null!=this.objReport.multiView){var c=this.objReport.multiView;if(c.isSocket&&this.objReport.isMain){c.socket.sendMemoData(this.arrSpeechBubbleArray);}}};mCR_ReportSpeechBubbleFrame.prototype.resetThisSpeechBubblePosition=function(){this.objSpeechBubbleInfo.elmSpeechBubble.style.left=this.objSpeechBubbleInfo.objDocSpeechBubble.tx+"px";this.objSpeechBubbleInfo.elmSpeechBubble.style.top=this.objSpeechBubbleInfo.objDocSpeechBubble.ty+"px";if(null!=this.objReport&&null!=this.objReport.multiView){var a=this.objReport.multiView;if(a.isSocket&&this.objReport.isMain){a.socket.sendMemoData(this.arrSpeechBubbleArray);}}};mCR_ReportSpeechBubbleFrame.prototype.resetThisSpeechBubbleSize=function(){this.objSpeechBubbleInfo.elmSpeechBubble.style.width=this.objSpeechBubbleInfo.objDocSpeechBubble.width+"px";this.objSpeechBubbleInfo.elmSpeechBubble.style.height=this.objSpeechBubbleInfo.objDocSpeechBubble.height+"px";this.reDrawTextInSpeechBubble();};mCR_ReportSpeechBubbleFrame.prototype.createSpeechBubbleCSSText=function(f,d,c,p){var m={},o={};var i=null;var q=d.pointerSide;var l=null;var b=null;var h=d.width;var n=d.height;var k=d.maxPointerSize;if(c!=null){h=c;}if(p!=null){n=p;}var g=0;var a=0;m.position="absolute";m["background-color"]=this.getDocBackgroundColor(d);m["border-radius"]=d.radius+"px";m["margin-right"]=d.marginRight+"px";m.left="0px";m.top="0px";m.right="0px";m.bottom="0px";m.cursor="all-scroll";if(q=="top"){i="left";b=this.getDocBackgroundColor(d)+" transparent";a=h-20;g=a*0.1;if(g>k){g=k;}l="0 "+g+"px "+g+"px";}if(q=="bottom"){i="left";b=this.getDocBackgroundColor(d)+" transparent";a=h-20;g=a*0.1;if(g>k){g=k;}l=g+"px "+g+"px 0";}if(q=="left"){i="top";b="transparent "+this.getDocBackgroundColor(d);a=n;g=a*0.1;if(g>k){g=k;}l=g+"px "+g+"px "+g+"px 0px";}if(q=="right"){i="top";b="transparent "+this.getDocBackgroundColor(d);a=n;g=a*0.1;if(g>k){g=k;}l=g+"px 0px "+g+"px "+g+"px";}m.border="0px";if(q!="none"){o.content="''";o.position="absolute";var j=a*0.5-g;o[i]=j+"px";o[q]="-"+g+"px";o["border-width"]=l;o["border-style"]="solid";o["border-color"]=b;o.display="block";o.width="0";o.height="0";return this.createCSSText(f,m)+"\n\n"+this.createCSSText(f+":after",o);}else{return this.createCSSText(f,m);}};mCR_ReportSpeechBubbleFrame.prototype.createCSSText=function(a,c){var b="."+a+" {\n";for(key in c){b+="	"+key+": "+c[key]+";\n";}b+="}";return b;};mCR_ReportSpeechBubbleFrame.prototype.getHighIndexNumber=function(){var d=this.arrSpeechBubbleArray[this.selectedPage].length;var c=-1;for(var b=0;b<d;b++){var a=this.arrSpeechBubbleArray[this.selectedPage][b].index;if(c<a){c=a;}}return c+1;};mCR_ReportSpeechBubbleFrame.prototype.createSpeechBubble=function(f,c,j){var k=this.objReport;var d=this;var a=document.createElement("div");a.className="bubble_speech_layout_div";a.id="bubble_speech_layout_div";a.style.width=c.width+"px";a.style.height=c.height+"px";a.style.left=c.tx+"px";a.style.top=c.ty+"px";f.appendChild(a);var h=null;if(j){h=c.index;}else{h=this.getHighIndexNumber();}var l=document.createElement("div");l.className="bubble_speech_"+h;l.id="bubble_speech";a.appendChild(l);c.index=h;var g=document.createElement("div");g.className="bubble_speech_text_div";g.id="bubble_speech_text_div";l.appendChild(g);l.appendChild(this.createSpeechBubbleStyle("bubble_speech_"+h,c));var i=document.createElement("canvas");i.className="bubble_speech_text";i.id="bubble_speech_text";g.appendChild(i);var n=document.createElement("textArea");n.className="bubble_speech_text";n.id="bubble_speech_text";n.style.display="none";n.style.resize="none";n.style.backgroundColor="rgba(0,0,0,0)";g.appendChild(n);i.onclick=i.ontouch=function(){var u=event.target?event.target:event.srcElement;var p=u.parentElement.parentElement;var v=p.parentElement.childNodes[1];var t=p.parentElement;var r=p.parentElement.childNodes[2];var s=p.parentElement.childNodes[3];d.objSpeechBubbleInfo.elmPosition=v;d.objSpeechBubbleInfo.elmSpeechBubble=t;d.objSpeechBubbleInfo.elmSize=r;d.objSpeechBubbleInfo.elmDelete=s;d.objSpeechBubbleInfo.objDocSpeechBubble=d.searchDocSpeechBubble(t);d.refreshSpeechBubbleValue(d.objSpeechBubbleInfo.objDocSpeechBubble);i.style.display="none";n.style.display="block";var q="";if(d.objSpeechBubbleInfo.objDocSpeechBubble.fontBold){q="bold ";}n.style.font=q+d.objSpeechBubbleInfo.objDocSpeechBubble.fontSize+"pt "+d.objSpeechBubbleInfo.objDocSpeechBubble.fontName;n.style.color=d.getDocFontColor(d.objSpeechBubbleInfo.objDocSpeechBubble);n.value=d.objSpeechBubbleInfo.objDocSpeechBubble.text;n.focus();};n.onkeyup=function(){d.setSpeechBubbleText(this.value);};n.onblur=function(){d.refreshSpeechBubbleValue(d.objSpeechBubbleInfo.objDocSpeechBubble);n.style.display="none";i.style.display="block";var s=event.target?event.target:event.srcElement;var q=s.parentElement.parentElement;var r=q.parentElement;var p=d.searchDocSpeechBubble(r);d.redrawTextSpeechBubbleInTextArea(i,p);};var o=document.createElement("div");o.className="bubble_speech_position_div";o.id="bubble_speech_position_div";a.appendChild(o);var b=document.createElement("div");b.className="bubble_speech_size_div";b.id="bubble_speech_size_div";a.appendChild(b);var m=document.createElement("div");m.className="bubble_speech_delete_div";m.id="bubble_speech_delete_div";a.appendChild(m);this.objSpeechBubbleInfo.elmPosition=o;this.objSpeechBubbleInfo.elmSpeechBubble=a;this.objSpeechBubbleInfo.elmSize=b;this.objSpeechBubbleInfo.elmDelete=m;this.objSpeechBubbleInfo.objDocSpeechBubble=c;this.arrSpeechBubbleElementArray.push({elmSpeechBubble:a,elmPosition:o,elmSize:b,elmDelete:m});if(!j){this.arrSpeechBubbleArray[this.selectedPage].push(c);}this.refreshSpeechBubbleValue(c);k.objTextBuilder.drawTextFromSpeechBubble(a.firstChild.firstChild.firstChild,c,false);};mCR_ReportSpeechBubbleFrame.prototype.redrawTextSpeechBubble=function(){this.objReport.objTextBuilder.drawTextFromSpeechBubble(this.objSpeechBubbleInfo.elmSpeechBubble.firstChild.firstChild.firstChild,this.objSpeechBubbleInfo.objDocSpeechBubble,false);if(null!=this.objReport&&null!=this.objReport.multiView){var a=this.objReport.multiView;if(a.isSocket&&this.objReport.isMain){a.socket.sendMemoData(this.arrSpeechBubbleArray);}}};mCR_ReportSpeechBubbleFrame.prototype.redrawTextSpeechBubbleInTextArea=function(b,a){this.objReport.objTextBuilder.drawTextFromSpeechBubble(b,a,false);};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubbleText=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.text=a;};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubbleFontSize=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.fontSize=a;};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubbleIsReduceFontSize=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.isReduceFontSize=a;};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubbleFontColor=function(a){this.setDocFontColor(a,this.objSpeechBubbleInfo.objDocSpeechBubble);};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubbleBackgroundColor=function(a){this.setDocBackgroundColor(a,this.objSpeechBubbleInfo.objDocSpeechBubble);};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubblePositionX=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.tx=parseInt(a);};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubblePositionY=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.ty=parseInt(a);};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubbleWidth=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.width=parseInt(a);};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubbleHeight=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.height=parseInt(a);};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubblePointerSide=function(a){this.objSpeechBubbleInfo.objDocSpeechBubble.pointerSide=a;};mCR_ReportSpeechBubbleFrame.prototype.setSelectedPage=function(a){this.selectedPage=a;};mCR_ReportSpeechBubbleFrame.prototype.setDocFontColor=function(b,a){var c=b.match(/[A-Za-z0-9]{2}/g).map(function(d){return parseInt(d,16);});a.fontColorR=c[0];a.fontColorG=c[1];a.fontColorB=c[2];};mCR_ReportSpeechBubbleFrame.prototype.getDocFontColor=function(b){var d=b.fontColorR.toString(16);var c=b.fontColorG.toString(16);var a=b.fontColorB.toString(16);if(d.length<2){d="0"+d;}if(c.length<2){c="0"+c;}if(a.length<2){a="0"+a;}return"#"+d+c+a;};mCR_ReportSpeechBubbleFrame.prototype.getDocFontColorRGB=function(a){return"rgb("+a.fontColorR+","+a.fontColorG+","+a.fontColorB+")";};mCR_ReportSpeechBubbleFrame.prototype.setDocBackgroundColor=function(b,a){var c=b.match(/[A-Za-z0-9]{2}/g).map(function(d){return parseInt(d,16);});a.backgroundColorR=c[0];a.backgroundColorG=c[1];a.backgroundColorB=c[2];};mCR_ReportSpeechBubbleFrame.prototype.getDocBackgroundColor=function(a){var c=a.backgroundColorR.toString(16);var b=a.backgroundColorG.toString(16);var d=a.backgroundColorB.toString(16);if(c.length<2){c="0"+c;}if(b.length<2){b="0"+b;}if(d.length<2){d="0"+d;}return"#"+c+b+d;};mCR_ReportSpeechBubbleFrame.prototype.createSpeechBubbleDiv=function(a){var b=document.createElement("div");b.style.cssText="position: absolute; left:0px; right:0px; top:0px; bottom:0px; ";a.lastChild.insertBefore(b,a.lastChild.firstChild);return b;};mCR_ReportSpeechBubbleFrame.prototype.setSpeechBubbleDiv=function(u){var d=u;this.objSpeechBubbleInfo.elmSpeechBubbleDiv=d;var p=this.nZoomRate;var l=this.objReport;var s=this;var k=d.offsetLeft;var h=d.offsetTop;var c=d.offsetWidth;var q=d.offsetHeight;var a=d.parentElement;while(true){k+=a.offsetLeft;h+=a.offsetTop;if(a.offsetLeft==0&&a.offsetTop==0){break;}a=a.parentElement;}var v=1;var t=0;var r=0;var n=0;var i=0;var f=0;var j=0;var o=0;var g=0;var m=s.objSpeechBubbleInfo.elmSpeechBubbleDiv.parentElement.parentElement;var b=0;d.onmousedown=d.ontouchstart=function(w){var E,D;p=s.nZoomRate;if(w.type=="touchstart"){E=(w.touches[0].clientX/parseFloat(p)).toFixed(0);D=(w.touches[0].clientY/parseFloat(p)).toFixed(0);}else{E=(w.clientX/parseFloat(p)).toFixed(0);D=(w.clientY/parseFloat(p)).toFixed(0);}b=m.scrollTop;var z=w.target?w.target:w.srcElement;if(z.id=="bubble_speech_position_div"){var y=z;var B=z.parentElement;var C=z.parentElement.childNodes[2];s.objSpeechBubbleInfo.elmPosition=y;s.objSpeechBubbleInfo.elmSpeechBubble=B;s.objSpeechBubbleInfo.elmSize=C;s.objSpeechBubbleInfo.objDocSpeechBubble=s.searchDocSpeechBubble(B);s.refreshSpeechBubbleValue(s.objSpeechBubbleInfo.objDocSpeechBubble);B.parentElement.appendChild(B);d.style.cursor="all-scroll";B.style.cursor="all-scroll";t=E;r=D;n=E-k-B.offsetLeft;i=D-h-B.offsetTop;f=B.offsetWidth;j=B.offsetHeight;v=2;}if(z.id=="bubble_speech_size_div"){var y=z.parentElement.childNodes[1];var B=z.parentElement;var C=z;s.objSpeechBubbleInfo.elmPosition=y;s.objSpeechBubbleInfo.elmSpeechBubble=B;s.objSpeechBubbleInfo.elmSize=C;s.objSpeechBubbleInfo.objDocSpeechBubble=s.searchDocSpeechBubble(B);s.refreshSpeechBubbleValue(s.objSpeechBubbleInfo.objDocSpeechBubble);B.parentElement.appendChild(B);d.style.cursor="nw-resize";B.style.cursor="nw-resize";t=E;r=D;f=B.offsetWidth;j=B.offsetHeight;n=k+B.offsetLeft+B.offsetWidth-E;i=h+B.offsetTop+B.offsetHeight-D;v=3;o=B.offsetWidth-B.clientWidth;g=B.offsetHeight-B.clientHeight;}if(z.id=="bubble_speech"){var A=z;var y=z.parentElement.childNodes[1];var B=z.parentElement;var C=z.parentElement.childNodes[2];s.objSpeechBubbleInfo.elmPosition=y;s.objSpeechBubbleInfo.elmSpeechBubble=B;s.objSpeechBubbleInfo.elmSize=C;s.objSpeechBubbleInfo.objDocSpeechBubble=s.searchDocSpeechBubble(B);s.refreshSpeechBubbleValue(s.objSpeechBubbleInfo.objDocSpeechBubble);B.parentElement.appendChild(B);d.style.cursor="all-scroll";A.style.cursor="all-scroll";t=E;r=D;n=E-k-B.offsetLeft;i=D-h-B.offsetTop;f=B.offsetWidth;j=B.offsetHeight;v=2;}if(z.id=="bubble_speech_delete_div"){var y=z.parentElement.childNodes[1];var B=z.parentElement;var C=z.parentElement.childNodes[2];var x=z;s.deleteDocSpeechBubble(x);v=1;}};d.onmouseout=function(w){var x=s.objSpeechBubbleInfo.elmSpeechBubble;if(v==2||v==3){if((k-c)>=w.clientX||(k+c*2)<=w.clientX||(h-q)>=w.clientY||(h+q*2)<=w.clientY){d.style.cursor="default";if(x!=null){x.style.cursor="default";}v=1;}}};d.onmousemove=d.ontouchmove=function(w){var F,D;p=s.nZoomRate;var z=s.objSpeechBubbleInfo.elmPosition;var A=s.objSpeechBubbleInfo.elmSpeechBubble;var C=s.objSpeechBubbleInfo.elmSize;if(w.type=="touchmove"){F=(w.touches[0].clientX/parseFloat(p)).toFixed(0);D=(w.touches[0].clientY/parseFloat(p)).toFixed(0);}else{F=(w.clientX/parseFloat(p)).toFixed(0);D=(w.clientY/parseFloat(p)).toFixed(0);}b=m.scrollTop;if(v==2){var y=(F/1)-n-k;var B=(D/1)-i-h;if(y<0){A.style.left=0+"px";}else{if((c)<(y+A.offsetWidth)){A.style.left=c-A.offsetWidth+"px";}else{A.style.left=y+"px";}}if(B<0){A.style.top=0+"px";}else{if((q)<(B+A.offsetHeight)){A.style.top=q-A.offsetHeight+"px";}else{A.style.top=B+"px";}}}else{if(v==3){var x=(F/1)+n-k-A.offsetLeft;var E=(D/1)+i-h-A.offsetTop;if(119>=x||c<x+A.offsetLeft||99>=E||q<E+A.offsetTop){if(119>=x||99>=E){if(119>=x){x=120;A.style.width="120px";if(99<E){A.style.height=E-g+"px";}}if(99>=E){E=100;A.style.height="100px";if(119<x){A.style.width=x-o+"px";}}s.resetSpeechBubbleStyleSize(x,E);}}else{A.style.width=x-o+"px";A.style.height=E-g+"px";s.resetSpeechBubbleStyleSize(x-o,E-g);}}}};m.addEventListener("scroll",function(){if(v==2||v==3){this.scrollTo(0,b);}},false);d.onmouseup=d.ontouchend=function(w){d.style.cursor="default";var C=s.objSpeechBubbleInfo.elmPosition;var D=s.objSpeechBubbleInfo.elmSpeechBubble;var F=s.objSpeechBubbleInfo.elmSize;p=s.nZoomRate;if(D!=null){D.style.cursor="default";}var I,G;if(w.type=="touchmove"){I=(w.touches[0].clientX/parseFloat(p)).toFixed(0);G=(w.touches[0].clientY/parseFloat(p)).toFixed(0);}else{I=(w.clientX/parseFloat(p)).toFixed(0);G=(w.clientY/parseFloat(p)).toFixed(0);}if(v==2){var y=D.parentElement;var x=D.parentElement.offsetWidth;var H=D.parentElement.offsetHeight;var z=(I/1)-n-k;var E=(G/1)-i-h;var B=x-D.offsetWidth;var A=H-D.offsetHeight;if(z<0){z=0;D.style.left=z+"px";}else{if(z>B){z=B;D.style.left=z+"px";}else{if((c)<(z+D.offsetWidth)){D.style.left=c-D.offsetWidth+"px";}else{D.style.left=z+"px";}}}if(E<0){E=0;D.style.top=E+"px";}else{if(E>A){E=A;D.style.top=E+"px";}else{if((q)<(E+D.offsetHeight)){D.style.top=q-D.offsetHeight+"px";}else{D.style.top=E+"px";}}}s.objSpeechBubbleInfo.objDocSpeechBubble.tx=z;s.objSpeechBubbleInfo.objDocSpeechBubble.ty=E;s.refreshSpeechBubbleValue(s.objSpeechBubbleInfo.objDocSpeechBubble);v=1;}else{if(v==3){var x=(I/1)+n-k-D.offsetLeft;var H=(G/1)+i-h-D.offsetTop;if(119>=x||c<x+D.offsetLeft||99>=H||q<H+D.offsetTop){if(119>=x){x=120;D.style.width="120px";}if(99>=H){H=100;D.style.height="100px";}}else{D.style.width=x-o+"px";D.style.height=H-g+"px";}v=1;s.objSpeechBubbleInfo.objDocSpeechBubble.width=x;s.objSpeechBubbleInfo.objDocSpeechBubble.height=H;s.resetThisSpeechBubbleStyle();s.refreshSpeechBubbleValue(s.objSpeechBubbleInfo.objDocSpeechBubble);l.objTextBuilder.drawTextFromSpeechBubble(D.firstChild.firstChild.firstChild,s.objSpeechBubbleInfo.objDocSpeechBubble,false);}}};return d;};mCR_ReportSpeechBubbleFrame.prototype.createSpeechBubbleArray=function(b){var b=b;this.arrSpeechBubbleArray=new Array();for(var a=0;a<b;a++){this.arrSpeechBubbleArray.push(new Array());}};mCR_ReportSpeechBubbleFrame.prototype.changeControlDivDepth=function(){if(this.objSpeechBubbleInfo.elmSpeechBubbleDiv.parentElement.firstChild==this.objSpeechBubbleInfo.elmSpeechBubbleDiv){this.objSpeechBubbleInfo.elmSpeechBubbleDiv.parentElement.appendChild(this.objSpeechBubbleInfo.elmSpeechBubbleDiv);this.changeIsSpeechBubbleControl(true);}else{this.objSpeechBubbleInfo.elmSpeechBubbleDiv.parentElement.appendChild(this.objSpeechBubbleInfo.elmSpeechBubbleDiv.parentElement.firstChild);this.changeIsSpeechBubbleControl(false);}};mCR_ReportSpeechBubbleFrame.prototype.memoPage=function(a){this.setSelectedPage(a);this.changeControlDivDepth();};mCR_ReportSpeechBubbleFrame.prototype.returnFromMemoPage=function(){this.objReport.updateMemo();this.changeControlDivDepth();};mCR_ReportSpeechBubbleFrame.prototype.checkDataSpeechBubbleFrame=function(){var a=this.arrSpeechBubbleElementArray.length;return a;};mCR_ReportSpeechBubbleFrame.prototype.makeMemo=function(){var a=new docSpeechBubble();this.objSpeechBubbleInfo.objDocSpeechBubble=a;if(this.elmReportSpeechBubbleFullFrame==null){this.createSpeechBubbleFrame(a);}this.createSpeechBubble(this.objSpeechBubbleInfo.elmSpeechBubbleDiv,a,false);};mCR_ReportSpeechBubbleFrame.prototype.toggleSpeechBubbleFrame=function(){if(this.checkDataSpeechBubbleFrame()!=0){if(this.elmReportSpeechBubbleFullFrame.offsetWidth==0){this.openSpeechBubbleFrame();}else{this.closeSpeechBubbleFrame();}}};mCR_ReportSpeechBubbleFrame.prototype.deleteElementMemo=function(){this.arrSpeechBubbleElementArray=null;this.arrSpeechBubbleElementArray=new Array();};mCR_ReportSpeechBubbleFrame.prototype.getLengthFromSpeechBubbleArray=function(a){return this.arrSpeechBubbleArray[a].length;};mCR_ReportSpeechBubbleFrame.prototype.makeAllPageMemo=function(a,d){this.deleteElementMemo();var b=this.getLengthFromSpeechBubbleArray(a);for(var c=0;c<b;c++){if(this.elmReportSpeechBubbleFullFrame==null){this.createSpeechBubbleFrame(this.arrSpeechBubbleArray[a][c]);}this.createSpeechBubble(d,this.arrSpeechBubbleArray[a][c],true);}this.changeIsSpeechBubbleControl(false);};mCR_ReportSpeechBubbleFrame.prototype.setTargetDom=function(a){this.elmTargetDom=a;};mCR_ReportSpeechBubbleFrame.prototype.setHeaderHeight=function(a){this.nHeaderHeight=a;};function mCR_TextBuilder(){this.pxToCm=0.0264583333;this.ptToPx=1.32814;this.ptToPxInFont=1.33333;}mCR_TextBuilder.prototype.drawTextFromSpeechBubble=function(n,K,b){if(n==null){return"error : canvas don't exist";}var r=K.fontName;var p=n.getContext("2d");p.scale(1,1);p.font=K.fontSize+"pt "+r;var q=K.fontSize;var J=K.horizontalAlign;var c=K.verticalAlign;var u=K.isReduceFontSize;var t=K.text;var a=K.fontBold;var x=this.getFontColorRGB(K);var l=1.2*this.ptToPxInFont;if(K.lineSpace!=null){l=K.lineSpace;l=l*this.ptToPxInFont;}var L=0;if(K.wordSpace!=null){L=K.wordSpace;L=L*this.ptToPxInFont;}var B=[];var k=0;var o=0;var H=[];var w="";var m=new textArray();var s=0;var C=t.length;var g=n.offsetHeight;var E=n.offsetWidth;var v=q*this.ptToPxInFont;var M=0;var f=v;var y=false;var D=0;var h=0;var A=0;var z=0;for(var F=0;F<q;F++){if(y){break;}else{if(!u){y=true;}for(var G=0;G<C;G++){var d=0;var I=false;if(t[G]!="\n"){d=this.getWidth(p,t[G])+L;k=k+d;}else{I=true;}if(k>E||I){if(M+(v)*2+l<(g-v*0.15)){M=M+v+l;h=h+v+l;B.push(k);D++;}else{if(u){D=0;k=0;o=0;w="";m.clear();H=[];B=[];v=(v-this.ptToPxInFont);M=0;s=0;f=0+v;p.font=(v/this.ptToPxInFont)+"pt "+K.fontName;break;}else{B.push(k);D++;h=h+v+l;break;}}H.push(w);w="";k=0;k=k+d;s++;}if(!I){w=w+t[G];m.push(new textInfo(t[G],0+k-d,f+M,D));}if(G==C-1){y=true;h=M+v;B.push(k);}}}}if(!b){n.width=E;n.height=g;return this.drawTextInfoToCanvas(n,J,E,c,g,h,v,m,D,z,A,r,a,x,B);}else{return this.drawTextInfoToSVG(n,J,E,c,g,h,v,m,D,z,A,r,a,x,B);}};mCR_TextBuilder.prototype.drawTextInfoToCanvas=function(r,o,u,b,d,c,q,l,s,n,h,m,k,f,g){var p=r.getContext("2d");p.fillStyle=f;p.lineWidth=1;p.setLineDash([]);p.beginPath();p.scale(1,1);var j=g.length;for(var t=0;t<j;t++){if(o=="center"){h=(u-g[t])/2;}else{if(o=="right"){h=(u-g[t]);}else{h=0;}}g[t]=h;}if(b=="middle"){n=(d-c)/2;}else{if(b=="bottom"){n=(d-c-q*0.3);}else{n=0;}}var a="";if(k){a="bold ";}p.font=a+(q/this.ptToPxInFont)+"pt "+m;textCount=l.array.length;for(var t=0;t<textCount;t++){p.fillText(l.array[t].character,l.array[t].tx+g[l.array[t].verticalPosition],l.array[t].ty+n);}return null;};mCR_TextBuilder.prototype.drawTextInfoToSVG=function(q,o,u,a,c,b,p,l,r,n,h,m,k,d,f){var j=f.length;for(var t=0;t<j;t++){if(o=="center"){h=(u-f[t])/2;}else{if(o=="right"){h=(u-f[t]);}else{h=0;}}f[t]=h;}if(a=="middle"){n=(c-b)/2;}else{if(a=="bottom"){n=(c-b-p*0.3);}else{n=0;}}var v=document.createElementNS("http://www.w3.org/2000/svg","svg");v.setAttribute("fill-opacity","1");v.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");v.setAttribute("xmlns","http://www.w3.org/2000/svg");v.setAttribute("color-rendering","auto");v.setAttribute("color-interpolation","auto");v.setAttribute("text-interpolation","auto");v.setAttribute("stroke-linecap","square");v.setAttribute("stroke-miterlimit","10");v.setAttribute("stroke-opacity","1");v.setAttribute("shape-rendering","auto");v.setAttribute("stroke-dasharray","none");v.setAttribute("stroke-linejoin","miter");v.setAttribute("stroke-dashoffset","0");v.setAttribute("image-rendering","auto");v.setAttribute("style","overflow:hidden");v.setAttribute("width",u);v.setAttribute("height",c);var g=document.createElementNS("http://www.w3.org/2000/svg","g");if(k){if(window.is_apple||window.mCR_isApple){g.setAttribute("font-weight","normal");g.setAttribute("stroke-width","0.8");g.setAttribute("paint-order","stroke");g.setAttribute("stroke",d);}else{g.setAttribute("font-weight","bold");}}g.setAttribute("fill",d);g.setAttribute("font-size",(p/this.ptToPxInFont)+"pt");g.setAttribute("font-family",m);v.appendChild(g);textCount=l.array.length;for(var t=0;t<textCount;t++){var s=document.createElementNS("http://www.w3.org/2000/svg","text");s.textContent=l.array[t].character;s.setAttribute("x",l.array[t].tx+f[l.array[t].verticalPosition]);s.setAttribute("y",l.array[t].ty+n);g.appendChild(s);}return v;};mCR_TextBuilder.prototype.getIsVerticalPosition=function(c,a){var d=c.length;for(var b=0;b<d;b++){if(c[b]==a){return true;}}return false;};mCR_TextBuilder.prototype.getWidth=function(b,a){return b.measureText(a).width;};mCR_TextBuilder.prototype.getFontColorRGB=function(a){return"rgb("+a.fontColorR+","+a.fontColorG+","+a.fontColorB+")";};function textArray(){this.array=new Array();}textArray.prototype.push=function(a){this.array.push(a);};textArray.prototype.clear=function(){var b=this.array.length;for(var a=0;a<b;a++){this.array.pop();}};function textInfo(d,c,a,b){this.character=d;this.tx=c;this.ty=a;this.verticalPosition=b;}