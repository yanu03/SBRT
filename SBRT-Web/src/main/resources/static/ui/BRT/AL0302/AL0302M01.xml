<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ev="http://www.w3.org/2001/xml-events"
	xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataMap baseNode="map" id="dma_search">
					<w2:keyInfo>
						<w2:key id="TYPE" name="name4" dataType="text"></w2:key>
						<w2:key id="CONTENT1" name="name1" dataType="text"></w2:key>
						<w2:key id="CONTENT2" name="name2" dataType="text"></w2:key>
						<w2:key id="CONTENT3" name="name3" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_result">
					<w2:keyInfo>
						<w2:key id="STATUS" name="STATUS" dataType="text"></w2:key>
						<w2:key id="ICNT" name="입력건수" dataType="text"></w2:key>
						<w2:key id="UCNT" name="수정건수" dataType="text"></w2:key>
						<w2:key id="DCNT" name="삭제건수" dataType="text"></w2:key>
						<w2:key id="TYPE" name="TYPE" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_repRoutItem" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선명" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_searchitem2" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="DAY_DIV" name="name1" dataType="text"></w2:column>
						<w2:column id="ROUT_NM" name="name2" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_BRT_OPER_PL_MST" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선명" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="WAY_DIV" name="상하행구분" dataType="text"></w2:column>
						<w2:column id="ST_STTN_NM" name="시작정류소" dataType="text"></w2:column>
						<w2:column id="ED_STTN_NM" name="종료정류소" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataMap baseNode="map" id="dma_param_AL0302G1">
					<w2:keyInfo>
						<w2:key id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:key>
						<w2:key id="DAY_DIV" name="요일구분" dataType="text"></w2:key>
						<w2:key id="WAY_DIV" name="상하행구분" dataType="text"></w2:key>
						<w2:key id="OPER_DT" name="운행일" dataType="text"></w2:key>
						<w2:key id="relDt" name="배포일" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_BRT_ALLOC_PL_MST" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="OPER_DT" name="운행일" dataType="date"></w2:column>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="ALLOC_NO" name="배차번호" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="WAY_DIV" name="상하행구분" dataType="text"></w2:column>
						<w2:column id="VHC_ID" name="차량ID" dataType="text"></w2:column>
						<w2:column id="VHC_NO" name="차량번호" dataType="text"></w2:column>
						<w2:column id="COMP_NM" name="운수사명" dataType="text"></w2:column>
						<w2:column id="DRV_NM" name="운전자명" dataType="text"></w2:column>
						<w2:column id="SEC_DRV_NM" name="2교대운전자명" dataType="text"></w2:column>
						<w2:column id="THR_DRV_NM" name="3교대운전자명" dataType="text"></w2:column>
						<w2:column id="DRV_ID" name="운전자ID" dataType="text"></w2:column>
						<w2:column id="SEC_DRV_ID" name="2교대운전자ID" dataType="text"></w2:column>
						<w2:column id="THR_DRV_ID" name="3교대운전자ID" dataType="text"></w2:column>
						<w2:column id="SEC_TRAN_TM" name="2교대시각" dataType="text"></w2:column>
						<w2:column id="THR_TRAN_TM" name="3교대시각" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_BRT_OPER_DT_ALLOC_PL_MST" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="OPER_DT" name="운행일" dataType="date"></w2:column>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="ALLOC_NO" name="배차번호" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="VHC_ID" name="차량ID" dataType="text"></w2:column>
						<w2:column id="VHC_NO" name="차량번호" dataType="text"></w2:column>
						<w2:column id="COMP_NM" name="운수사명" dataType="text"></w2:column>
						<w2:column id="DRV_NM" name="운전자명" dataType="text"></w2:column>
						<w2:column id="SEC_DRV_NM" name="2교대운전자명" dataType="text"></w2:column>
						<w2:column id="THR_DRV_NM" name="3교대운전자명" dataType="text"></w2:column>
						<w2:column id="DRV_ID" name="운전자ID" dataType="text"></w2:column>
						<w2:column id="SEC_DRV_ID" name="2교대운전자ID" dataType="text"></w2:column>
						<w2:column id="THR_DRV_ID" name="3교대운전자ID" dataType="text"></w2:column>
						<w2:column id="SEC_TRAN_TM" name="2교대시각" dataType="text"></w2:column>
						<w2:column id="THR_TRAN_TM" name="3교대시각" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>
			<xf:submission id="sub_AL0302G0R0" ref="data:json,dma_search" target='data:json,dlt_BRT_OPER_PL_MST' action="/al/AL0302G0R0"
				method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
				processMsg="조회 중입니다..." ev:submit="" ev:submitdone="scwin.sub_AL0302G0R0_submitdone" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_AL0302SHI0" ref="" target="data:json,dlt_repRoutItem" action="/repRout/selectRepRoutItem" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="scwin.sub_AL0302SHI0_submitdone" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_AL0302G1R0" ref="data:json,dma_param_AL0302G1" target='data:json,dlt_BRT_ALLOC_PL_MST'
				action="/al/AL0302G1R0" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
				customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="scwin.sub_AL0302G1R0_submitdone" ev:submiterror=""
				abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_AL0302G1S0" ref='data:json,{"action":"modified","id":"dlt_BRT_ALLOC_PL_MST"}'
				target="data:json,dma_result" action="/al/AL0302G1S0" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
				errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="scwin.sub_AL0302G1S0_submitdone"
				ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_AL0302SHI1" ref="data:json,dma_search" target="data:json,dlt_searchitem2" action="/al/AL0302SHI1"
				method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
				processMsg="" ev:submit="" ev:submitdone="scwin.sub_AL0302SHI1_submitdone" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_AL0302G2R0" ref="data:json,dma_param_AL0302G1" target="data:json,dlt_BRT_OPER_DT_ALLOC_PL_MST"
				action="/al/AL0302G2R0" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
				customHandler="" mode="asynchronous" processMsg="조회중입니다..." ev:submit="" ev:submitdone="scwin.sub_AL0302G2R0_submitdone"
				ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_AL0302G2S0" ref='data:json,{"action":"modified","id":"dlt_BRT_OPER_DT_ALLOC_PL_MST"}'
				target="data:json,dma_result" action="/al/AL0302G2S0" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
				errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="scwin.sub_AL0302G2S0_submitdone"
				ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_AL0302G1S1" ref='data:json,["dma_param_AL0302G1","dlt_BRT_ALLOC_PL_MST"]'
				target="data:json,dma_result" action="/al/AL0302G1S1" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
				errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="scwin.sub_AL0302G1S1_submitdone" ev:submiterror="" abortTrigger="">
			</xf:submission>
		</xf:model>
		<script type="text/javascript" lazy="false"><![CDATA[
        
	scwin.onpageload = function() {
		var autoOptions = {
			Main : { grid : AL0302G0, srchSbm : sub_AL0302G0R0, srchGrp : pgm_header , keyColumn : "REP_ROUT_ID", focusColumn : "REP_ROUT_NM", name : "운행계획 목록"},
			Sub2 : { grid : AL0302G1, srchSbm : sub_AL0302G1R0, keyColumn : "ALLOC_NO", savSbm : sub_AL0302G1S0, name : "차량 배차(배포)" },
			Sub1 : { grid : AL0302G2, srchSbm : sub_AL0302G2R0, keyColumn : "ALLOC_NO", savSbm : sub_AL0302G2S0, name : "차량 배차(일)" }	
		 };
		 		
		 var mainOptions = {
			ADD: {cbFnc:scwin.btn_distri_onclick, nm:"배포", class : "setting"},
			DEL: {disp:"hide"}
			//CNL: {disp:"hide"},
			//SAVE: {cbFnc:scwin.btn_distri_onclick, nm:"배포",class : "setting"}
		}
		com.setMainBtn2(wfm_mainBtn, gcm.DISP_TYPE.DUAL_GRID3, autoOptions, mainOptions);		

		var subOptions = {
			//SAVE: {mode:"auto"},
			SAVE: {cbFnc:scwin.btn_modify_onclick, nm:"저장",class:"save"},
			CNL: {mode:"auto"}
		};
		
		com.setSubBtn2(wfm_subBtn, autoOptions, subOptions);

		var codeOptions = [ {code : "DAY_DIV", compID : "AL0302G0:DAY_DIV" }
							,{code : "WAY_DIV", compID : "AL0302G0:WAY_DIV" }
							];		
	
		var date = new Date();
		var year = date.getFullYear().toString();
		var month = (date.getMonth()+1).toString();
		var day = date.getDate().toString();
		var zero = 0;
		
		if(day.length == 1){
			day = zero + day;
		}
		
		var today = year+month+day;
		
		OPERDATE.setValue(today);
		
		com.setCommonDtl(codeOptions, function() {
			com.searchGrid(AL0302G0, sub_AL0302G0R0);
		});	
		
		com.executeSubmission(sub_AL0302SHI0);
		
	};
	
	scwin.onpageunload = function() {
		
	};
	
	//배포
	scwin.btn_distri_onclick = function(){
		var jsondata = dlt_BRT_ALLOC_PL_MST.getAllJSON();
		var dayDiv = dlt_BRT_OPER_PL_MST.getCellData(AL0302G0.getFocusedRowIndex(), "DAY_DIV");
		
		var data = {data : jsondata, DAYDIV : dayDiv, callbackFn : "scwin.AL0302P0_callbackFn"};
		if(jsondata.length > 0){
			var options = { id : "AL0302P01",
							popupName : "배포 날짜",
							width : "450px",
							height : "330px",
							modal : true};
			com.openPopup("/ui/BRT/AL0302/AL0302P01.xml", options, data);
		}
		
		/*var startDateValue = REL_DATE_F.getValue();
		var lastDateValue = REL_DATE_L.getValue();
		
		var startDate = startDateValue.slice(0,4) + '-' + startDateValue.slice(4, 6) + '-' + startDateValue.slice(6,8)
		var lastDate = lastDateValue.slice(0,4) + '-' + lastDateValue.slice(4, 6) + '-' + lastDateValue.slice(6,8)
		
		//var regex = RegExp(/^\d{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$/);
		//if(!(regex.test(startDate) && regex.test(lastDate))) return "Not Date Format";
		var relDt = [];
		var curDate = new Date(startDate);
		while(curDate <= new Date(lastDate)) {
			relDt.push(curDate.toISOString().split("T")[0]);
			curDate.setDate(curDate.getDate() + 1);
		}
		
		dma_param_AL0302G1.set("relDt", relDt);
		
		if(dma_param_AL0302G1.get("relDt").length != 0){
			com.executeSubmission(sub_AL0302G1S1);
		}else{
			com.messagBox("alert", "배포일을 선택해주세요.");
		}*/
		
	}
	
	scwin.AL0302P0_callbackFn = function(data){
		
		var week = ['일', '월', '화', '수', '목', '금', '토']; 
		var dayDiv = dlt_BRT_OPER_PL_MST.getCellData(AL0302G0.getFocusedRowIndex(), "DAY_DIV");
		var startDateValue = data.toString().substring(0, 8);
		var lastDateValue = data.toString().substring(8);
		
		var startDate = startDateValue.slice(0,4) + '-' + startDateValue.slice(4, 6) + '-' + startDateValue.slice(6,8)
		var lastDate = lastDateValue.slice(0,4) + '-' + lastDateValue.slice(4, 6) + '-' + lastDateValue.slice(6,8)
		
		//var regex = RegExp(/^\d{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$/);
		//if(!(regex.test(startDate) && regex.test(lastDate))) return "Not Date Format";
		var relDt = [];
		var curDate = new Date(startDate);
		while(curDate <= new Date(lastDate)) {
			var dayOfWeek = week[new Date(curDate).getDay()];
			
			if(dayDiv == 'DY001'){
				if(dayOfWeek != '토' && dayOfWeek != '일'){
					relDt.push(curDate.toISOString().split("T")[0]);
					curDate.setDate(curDate.getDate() + 1);
				}else{
					curDate.setDate(curDate.getDate() + 1);
				}
			}else if(dayDiv == 'DY002'){
				if(dayOfWeek == '토' || dayOfWeek == '일'){
					relDt.push(curDate.toISOString().split("T")[0]);
					curDate.setDate(curDate.getDate() + 1);
				}else{
					curDate.setDate(curDate.getDate() + 1);
				}
			}
		}
		dma_param_AL0302G1.set("relDt", relDt);
		
		if(dma_param_AL0302G1.get("relDt").length != 0){
			com.executeSubmission(sub_AL0302G1S1);
		}else{
			com.messagBox("alert", "배포일을 선택해주세요.");
		}
	}
	
	//수정
	scwin.btn_modify_onclick = function(){
		com.executeSubmission(sub_AL0302G2S0);
	}
	
	scwin.sub_AL0302G0R0_submitdone = function(e) {
		
		com.setFocusedCell(AL0302G0, "DAY_DIV");
	};
	
	scwin.sub_AL0302G1R0_submitdone = function(e) {
		
		com.setFocusedCell(AL0302G1, "VHC_NO");	
	};
	
	scwin.AL0302G0_onrowindexchange = function(row,oldRow) {
		
		dma_param_AL0302G1.set("REP_ROUT_ID", dlt_BRT_OPER_PL_MST.getCellData(row, "REP_ROUT_ID"));
		dma_param_AL0302G1.set("DAY_DIV", dlt_BRT_OPER_PL_MST.getCellData(row, "DAY_DIV"));
		dma_param_AL0302G1.set("WAY_DIV", dlt_BRT_OPER_PL_MST.getCellData(row, "WAY_DIV"));
		dma_param_AL0302G1.set("OPER_DT", OPERDATE.getValue());
		
		var focusOption = {keyMap : dma_param_AL0302G1};
		com.changeDualGrid(AL0302G0, AL0302G1, sub_AL0302G1S0, sub_AL0302G1R0, focusOption, row, oldRow, "차량 배차(배포)");
		com.changeDualGrid(AL0302G0, AL0302G2, sub_AL0302G2S0, sub_AL0302G2R0, focusOption, row, oldRow, "차량 배차(수정)");
		//com.executeSubmission(sub_AL0302G1R0);
	};
	
	scwin.sub_AL0302G1S0_submitdone = function(e) {
		com.saveDone(AL0302G1, sub_AL0302G1R0);		
	};
	
	scwin.AL0302G1_ontextimageclick = function(row,col) {
		debugger;
		var repRoutId = dma_param_AL0302G1.get("REP_ROUT_ID");
		//var repRoutId = dlt_BRT_ALLOC_PL_MST.getCellData(AL0302G0.getFocusedRowIndex(), "REP_ROUT_ID");
		if(col == 1){
			var data = { data: repRoutId,callbackFn : "scwin.searchVhcCallback" };
					   	 
			var opt = { id : "popUpVhcList", 
						popupName : "차량번호 검색",
						//width : 600,
						//height : 500,
						modal : true};
			com.openPopup("/cm/common/popUpVhcList.xml", opt, data);
				
		}
		else if(col == 3){
			var data = { data:repRoutId, callbackFn : "scwin.searchDrvCallback" };
					   	 
			var opt = { id : "popUpDrvList", 
						popupName : "운전자 검색",
						//width : 600,
						//height : 500,
						modal : true};
			com.openPopup("/cm//common/popUpDrvList.xml", opt, data);
		}
		else if(col == 4){
			var data = { data:repRoutId, callbackFn : "scwin.searchDrv2Callback" };
					   	 
			var opt = { id : "popUpDrvList", 
						popupName : "운전자 검색",
						//width : 600,
						//height : 500,
						modal : true};
			com.openPopup("/cm//common/popUpDrvList.xml", opt, data);
		}
		else if(col == 6){
			var data = { data:repRoutId, callbackFn : "scwin.searchDrv3Callback" };
					   	 
			var opt = { id : "popUpDrvList", 
						popupName : "운전자 검색",
						//width : 600,
						//height : 500,
						modal : true};
			com.openPopup("/cm//common/popUpDrvList.xml", opt, data);
		}
	};
	
	//찾기 버튼 콜백함수
	scwin.searchVhcCallback = function(obj) {
		var vhcId =obj[0].VHC_ID;
		var vhcNo =obj[0].VHC_NO;
		var compNm =obj[0].COMP_NM;
		
		dlt_BRT_ALLOC_PL_MST.setCellData(AL0302G1.getFocusedRowIndex(), "VHC_ID", vhcId);
		dlt_BRT_ALLOC_PL_MST.setCellData(AL0302G1.getFocusedRowIndex(), "VHC_NO", vhcNo);
		dlt_BRT_ALLOC_PL_MST.setCellData(AL0302G1.getFocusedRowIndex(), "COMP_NM", compNm);
	};
	
	//찾기 버튼 콜백함수
	scwin.searchDrvCallback = function(obj) {
		var drvId =obj[0].DRV_ID;
		var drvNm =obj[0].DRV_NM;
		
		dlt_BRT_ALLOC_PL_MST.setCellData(AL0302G1.getFocusedRowIndex(), "DRV_ID", drvId);
		dlt_BRT_ALLOC_PL_MST.setCellData(AL0302G1.getFocusedRowIndex(), "DRV_NM", drvNm);
	};
	
	//찾기 버튼 콜백함수
	scwin.searchDrv2Callback = function(obj) {
		var drvId =obj[0].DRV_ID;
		var drvNm =obj[0].DRV_NM;
		
		dlt_BRT_ALLOC_PL_MST.setCellData(AL0302G1.getFocusedRowIndex(), "SEC_DRV_ID", drvId);
		dlt_BRT_ALLOC_PL_MST.setCellData(AL0302G1.getFocusedRowIndex(), "SEC_DRV_NM", drvNm);
	};
	
	//찾기 버튼 콜백함수
	scwin.searchDrv3Callback = function(obj) {
		var drvId =obj[0].DRV_ID;
		var drvNm =obj[0].DRV_NM;
		
		dlt_BRT_ALLOC_PL_MST.setCellData(AL0302G1.getFocusedRowIndex(), "THR_DRV_ID", drvId);
		dlt_BRT_ALLOC_PL_MST.setCellData(AL0302G1.getFocusedRowIndex(), "THR_DRV_NM", drvNm);
	};
	
	scwin.AL0302G2_ontextimageclick = function(row,col) {
		var repRoutId = dma_param_AL0302G1.get("REP_ROUT_ID");
		//var repRoutId = dlt_BRT_OPER_DT_ALLOC_PL_MST.getCellData(AL0302G0.getFocusedRowIndex(), "REP_ROUT_ID");
		if(col == 1){
			var data = { data: repRoutId,callbackFn : "scwin.searchVhcCallbackG2" };
					   	 
			var opt = { id : "popUpVhcList", 
						popupName : "차량번호 검색",
						//width : 600,
						//height : 500,
						modal : true};
			com.openPopup("/cm//common/popUpVhcList.xml", opt, data);
				
		}
		else if(col == 3){
			var data = { data:repRoutId, callbackFn : "scwin.searchDrvCallbackG2" };
					   	 
			var opt = { id : "popUpDrvList", 
						popupName : "운전자 검색",
						//width : 600,
						//height : 500,
						modal : true};
			com.openPopup("/cm//common/popUpDrvList.xml", opt, data);
		}
		else if(col == 4){
			var data = { data:repRoutId, callbackFn : "scwin.searchDrv2CallbackG2" };
					   	 
			var opt = { id : "popUpDrvList", 
						popupName : "운전자 검색",
						//width : 600,
						//height : 500,
						modal : true};
			com.openPopup("/cm//common/popUpDrvList.xml", opt, data);
		}
		else if(col == 6){
			var data = { data:repRoutId, callbackFn : "scwin.searchDrv3CallbackG2" };
					   	 
			var opt = { id : "popUpDrvList", 
						popupName : "운전자 검색",
						//width : 600,
						//height : 500,
						modal : true};
			com.openPopup("/cm//common/popUpDrvList.xml", opt, data);
		}
	};
	
	//찾기 버튼 콜백함수
	scwin.searchVhcCallbackG2 = function(obj) {
		var vhcId =obj[0].VHC_ID;
		var vhcNo =obj[0].VHC_NO;
		var compNm =obj[0].COMP_NM;
		
		dlt_BRT_OPER_DT_ALLOC_PL_MST.setCellData(AL0302G2.getFocusedRowIndex(), "VHC_ID", vhcId);
		dlt_BRT_OPER_DT_ALLOC_PL_MST.setCellData(AL0302G2.getFocusedRowIndex(), "VHC_NO", vhcNo);
		dlt_BRT_OPER_DT_ALLOC_PL_MST.setCellData(AL0302G2.getFocusedRowIndex(), "COMP_NM", compNm);
	};
	
	//찾기 버튼 콜백함수
	scwin.searchDrvCallbackG2 = function(obj) {
		var drvId =obj[0].DRV_ID;
		var drvNm =obj[0].DRV_NM;
		
		dlt_BRT_OPER_DT_ALLOC_PL_MST.setCellData(AL0302G2.getFocusedRowIndex(), "DRV_ID", drvId);
		dlt_BRT_OPER_DT_ALLOC_PL_MST.setCellData(AL0302G2.getFocusedRowIndex(), "DRV_NM", drvNm);
	};
	
	//찾기 버튼 콜백함수
	scwin.searchDrv2CallbackG2 = function(obj) {
		var drvId =obj[0].DRV_ID;
		var drvNm =obj[0].DRV_NM;
		
		dlt_BRT_OPER_DT_ALLOC_PL_MST.setCellData(AL0302G2.getFocusedRowIndex(), "SEC_DRV_ID", drvId);
		dlt_BRT_OPER_DT_ALLOC_PL_MST.setCellData(AL0302G2.getFocusedRowIndex(), "SEC_DRV_NM", drvNm);
	};
	
	//찾기 버튼 콜백함수
	scwin.searchDrv3CallbackG2 = function(obj) {
		var drvId =obj[0].DRV_ID;
		var drvNm =obj[0].DRV_NM;
		
		dlt_BRT_OPER_DT_ALLOC_PL_MST.setCellData(AL0302G2.getFocusedRowIndex(), "THR_DRV_ID", drvId);
		dlt_BRT_OPER_DT_ALLOC_PL_MST.setCellData(AL0302G2.getFocusedRowIndex(), "THR_DRV_NM", drvNm);
	};
	
	scwin.sub_AL0302SHI0_submitdone = function(e) {
		
		//com.setFocusedCell(AL0302G0, "DAY_DIV");
	};
	
	scwin.TYPE1_onviewchange = function(info) {
		//startMarker = 1;
		
		com.executeSubmission(sub_AL0302G0R0);
	};
	
	scwin.sub_AL0302SHI1_submitdone = function(e) {
		
		com.executeSubmission(sub_AL0302G0R0);
	};
	
	scwin.TYPE2_onviewchange = function(info) {
		
		//startMarker = 1;
		com.executeSubmission(sub_AL0302SHI1);
	};
	
	scwin.OPERDATE_onviewchange = function(info) {
		dma_param_AL0302G1.set("OPER_DT", info.newValue);
		com.executeSubmission(sub_AL0302G2R0);
	};
	
	scwin.sub_AL0302G2R0_submitdone = function(e) {
		com.setFocusedCell(AL0302G2, "VHC_NO");
	};
	
	scwin.sub_AL0302G2S0_submitdone = function(e) {
		com.saveDone(AL0302G2, sub_AL0302G2R0);
	};
	
	scwin.sub_AL0302G1S1_submitdone = function(e) {
		com.saveDone(AL0302G1, sub_AL0302G1R0);
	};
	]]></script>
    </head>
	<body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
		<xf:group id="pgm_container" class="pgm_container grdr_41_36_a" style="">
			<xf:group id="pgm_navi" class="pgm_navi" style="">
				<w2:wframe id="wfm_navi" style="" src="/cm/common/wf_navi.xml" scope="true"></w2:wframe>
			</xf:group>
			<xf:group id="pgm_header" class="pgm_header" style="">
				<xf:group id="" style="" class="gr_search">
					<xf:group class="label" id="" style="">
						<w2:span class="" id="" label="대표 노선"></w2:span>
					</xf:group>
					<xf:group class="search" id="" style="">
						<xf:select1 allOption="true" appearance="minimal" chooseOption="" direction="auto" disabled="false"
							disabledClass="w2selectbox_disabled" displayMode="label" ev:onviewchange="scwin.TYPE1_onviewchange" id="TYPE1" optionOrder="false"
							ref="data:dma_search.CONTENT1" class="search_type_100" style="" submenuSize="auto" textAlign="left" chooseOptionLabel="전체">
							<xf:choices>
								<xf:itemset nodeset="data:dlt_repRoutItem">
									<xf:label ref="REP_ROUT_NM"></xf:label>
									<xf:value ref="REP_ROUT_ID"></xf:value>
								</xf:itemset>
							</xf:choices>
						</xf:select1>
						<xf:group class="label" id="" style="">
							<w2:span class="" id="" label="요일 구분"></w2:span>
						</xf:group>
						<xf:group class="search" id="" style="">
							<xf:select1 allOption="" appearance="minimal" chooseOption="true" direction="auto" disabled="false"
								disabledClass="w2selectbox_disabled" displayMode="label" ev:onviewchange="scwin.TYPE2_onviewchange" id="TYPE2" optionOrder="false"
								ref="data:dma_search.CONTENT2" class="search_type_100" style="" submenuSize="auto" textAlign="left" chooseOptionLabel="-전체-">
								<xf:choices>
									<xf:item>
										<xf:label><![CDATA[평일]]></xf:label>
										<xf:value><![CDATA[DY001]]></xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[휴일]]></xf:label>
										<xf:value><![CDATA[DY002]]></xf:value>
									</xf:item>
								</xf:choices>
							</xf:select1>
							<!--  <xf:group class="label" id="" style="">
								<w2:span class="" id="" label="검색"></w2:span>
								</xf:group>
								<xf:input id="search_input" class="search_input" ref="data:dma_search.CONTENT3" placeholder="차번"></xf:input>-->
						</xf:group>
						<w2:wframe class="" id="wfm_mainBtn" scope="true" src="/cm/common/wf_mainBtn.xml" style=""></w2:wframe>
					</xf:group>
				</xf:group>
			</xf:group><!-- pgm_header -->
			<xf:group id="pgm_content" class="pgm_content grdc_800_20_a" style="">
				<xf:group id="pgm_list" class="pgm_list grdr_20_2_a" style="">
					<xf:group id="" class="" style="">
						<xf:group class="defaultbox" id="" style="">
							<w2:textbox class="df_tt fl" id="" label="운행계획 목록" style=""></w2:textbox>
						</xf:group>
					</xf:group>
					<xf:group></xf:group>
					<xf:group id="" class="" style="">
						<w2:gridView alwaysTriggerScrollStart="" autoFit="lastColumn" captionTitle="" class="cm_grid left"
							dataList="data:dlt_BRT_OPER_PL_MST" enterKeyMove="" ev:onafteredit="" ev:oncellclick="scwin.AL0302G0_oncellclick" ev:oneditkeyup=""
							ev:onkeyup="" ev:onrowindexchange="scwin.AL0302G0_onrowindexchange" ev:ontextimageclick="" ev:onviewchange=""
							fixedColumnWithHidden="true" id="AL0302G0" ignoreCellClick="false" nextTabID="" rowNumHeaderValue="순번" rowNumVisible="true"
							rowStatusHeaderValue="" rowStatusVisible="false" rowStatusWidth="40" scrollByColumn="false" style="" useShiftKey="true"
							visibleRowNum="" wheelRows="" autoFitMinWidth="0" disabledScrollHidden="" editModeEvent="" editModeEventIcon=""
							checkEditableInputClass="" keyMoveEditMode="" moveKeyEditMode="" moveKeyEditModeAll="" ignoreNonEditableCellTabEnter=""
							readOnly="true" keepDefaultColumnWidth="" oddEvenColorDisplay="" rowNumWidth="" summaryAuto="" excludeDeletedRows=""
							useCtrlOnMultisort="" useFilterList="" useFilterListSync="" sortedIconPosition="" sortable="" sortOrderReverse=""
							showSortableUseFilter="" focusMode="row" rowNumStatusUniqueId="" rowNumStatusResize="" ev:onbeforecolumnmove="" userData1=""
							mergeCol="REP_ROUT_NM" hammerPressTime="0" mergeCells="byrestriccol">
							<w2:caption style="" id="caption1" value="this is a grid caption."></w2:caption>
							<w2:header style="" id="header1">
								<w2:row style="" id="row1">
									<w2:column removeBorderStyle="false" width="90" inputType="text" style="height:20px" id="column22"
										value="대표노선명" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:20px" id="column20"
										value="요일구분" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:20px" id="column12"
										value="상하행" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="200" inputType="text" style="height:20px" id="column17"
										value="기점명" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="200" inputType="text" style="height:20px" id="column6"
										value="종점명" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="column1"
										value="비고" blockSelect="false" displayMode="label">
									</w2:column>
								</w2:row>
							</w2:header>
							<w2:gBody style="" id="gBody1">
								<w2:row style="" id="row2">
									<w2:column removeBorderStyle="false" width="114" inputType="text" style="height:20px" id="REP_ROUT_NM"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="165" inputType="select" style="height:20px" id="DAY_DIV"
										value="" blockSelect="false" displayMode="label" textAlign="">
									</w2:column>
									<w2:column removeBorderStyle="false" width="165" inputType="select" style="height:20px" id="WAY_DIV"
										value="" blockSelect="false" displayMode="label" textAlign="">
									</w2:column>
									<w2:column removeBorderStyle="false" width="95" inputType="text" style="height:20px" id="ST_STTN_NM"
										value="" blockSelect="false" displayMode="label" textAlign="left">
									</w2:column>
									<w2:column removeBorderStyle="false" width="95" inputType="text" style="height:20px" id="ED_STTN_NM"
										value="" blockSelect="false" displayMode="label" textAlign="left">
									</w2:column>
									<w2:column removeBorderStyle="false" width="95" inputType="text" style="height:20px" id="" value=""
										blockSelect="false" displayMode="label" textAlign="">
									</w2:column>
								</w2:row>
							</w2:gBody>
							<w2:footer id="footer2" style="">
								<w2:row id="row3" style="">
									<w2:column blockSelect="false" colSpan="15" displayMode="label"
										expression="&quot;데이터 개수 : &quot; + COUNT('COMP_ID')" id="column42" inputType="expression" removeBorderStyle="false"
										style="height:20px;" textAlign="left" width="1830">
									</w2:column>
								</w2:row>
							</w2:footer>
						</w2:gridView>
					</xf:group>
				</xf:group>
				<xf:group id="" class="vertical_line"></xf:group>
				<xf:group id="pgm_detail" class="pgm_detail grdr_20_2_280_20_20_a" style="">
					<xf:group id="" class="gr_sub_header" style="">
						<xf:group class="defaultbox" id="" style="">
							<w2:textbox class="df_tt fl" id="" label="차량배차(배포)" style=""></w2:textbox>
							<!--  <w2:span label="배포일" style="margin-right: 5px; margin-left: 15px; margin-top:5px;" id=""></w2:span>
							<w2:inputCalendar footerDiv="false" rightAlign="false" focusOnDateSelect="false"
								style="width:120px; margin-right: 10px; margin-top: 3px;" id="REL_DATE_F" renderType="component" renderDiv="true"
								calendarValueType="yearMonthDate" ref="" ev:onviewchange="" minYear="2015" maxYear="2030">
							</w2:inputCalendar>
							<w2:span label="~" style="margin-right: 10px;margin-top: 5px;" id=""></w2:span>
							<w2:inputCalendar footerDiv="false" rightAlign="false" focusOnDateSelect="false"
								style="width: 120px;margin-top: 3px;" id="REL_DATE_L" renderType="component" renderDiv="true" calendarValueType="yearMonthDate"
								ref="" ev:onviewchange="">
							</w2:inputCalendar>-->
						</xf:group>
						<!--  <w2:wframe id="wfm_subBtn" class="" style="" src="/cm/common/wf_subBtn.xml" scope="true"></w2:wframe>-->
					</xf:group>
					<xf:group></xf:group><!-- margin-->
					<xf:group id="" class="" style="">
						<w2:gridView ignoreCellClick="false" ev:onrowindexchange="" autoFit="allColumn" rowNumHeaderValue="순번"
							visibleRowNum="" class="cm_grid right" fixedColumnWithHidden="true" rowNumVisible="false" dataList="data:dlt_BRT_ALLOC_PL_MST"
							id="AL0302G1" readOnly="false" style="" useShiftKey="true" scrollByColumn="false" rowStatusVisible="false" rowStatusHeaderValue="상태"
							ev:oncellclick="" focusMode="cell" ev:ontextimageclick="scwin.AL0302G1_ontextimageclick">
							<w2:caption style="" id="caption1" value="this is a grid caption."></w2:caption>
							<w2:header style="" id="header1">
								<w2:row style="" id="row3">
									<w2:column removeBorderStyle="false" width="50" inputType="text" style="height:40px;" id="column19"
										value="배차번호" blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:40px;" id="column18"
										value="차량번호" blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="150" inputType="text" style="height:40px;" id="column17"
										value="운수사" blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px;" id="column16"
										value="1교대운전자" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="200" inputType="text" style="height:20px;" id="column15"
										value="2교대운전자" blockSelect="false" displayMode="label" colSpan="2" rowSpan="">
									</w2:column>
									<w2:column removeBorderStyle="false" width="200" inputType="text" style="height:20px;" id="column13"
										value="3교대운전자" blockSelect="false" displayMode="label" colSpan="2" rowSpan="">
									</w2:column>
								</w2:row>
								<w2:row style="" id="row1">
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="column8"
										value="운전자명" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="column5"
										value="운전자명" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="column6"
										value="교대시각" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="column1"
										value="운전자명" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="column2"
										value="교대시각" blockSelect="false" displayMode="label">
									</w2:column>
								</w2:row>
							</w2:header>
							<w2:gBody style="" id="gBody1">
								<w2:row style="" id="row2">
									<w2:column removeBorderStyle="false" width="50" inputType="text" style="height:20px" id="ALLOC_NO"
										value="" blockSelect="false" displayMode="label" readOnly="" disabled="true">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="textImage" style="height:20px" id="VHC_NO"
										value="" blockSelect="false" displayMode="label" readOnly="" imageSrc="/cm/images/inc/btn_search.png" imageHeight="20"
										imageWidth="20">
									</w2:column>
									<w2:column removeBorderStyle="false" width="150" inputType="text" style="height:20px" id="COMP_NM"
										value="" blockSelect="false" displayMode="label" readOnly="" textAlign="left" disabled="true">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="textImage" style="height:20px" id="DRV_NM"
										value="" blockSelect="false" displayMode="label" readOnly="" imageSrc="/cm/images/inc/btn_search.png" imageHeight="20"
										imageWidth="20">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="textImage" style="height:20px"
										id="SEC_DRV_NM" value="" blockSelect="false" displayMode="label" readOnly="" textAlign="" imageSrc="/cm/images/inc/btn_search.png"
										imageHeight="20" imageWidth="20">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="SEC_TRAN_TM"
										value="" blockSelect="false" displayMode="label" readOnly="" textAlign="" maxLength="5">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="textImage" style="height:20px"
										id="THR_DRV_NM" value="" blockSelect="false" displayMode="label" readOnly="" textAlign="" imageSrc="/cm/images/inc/btn_search.png"
										imageHeight="20" imageWidth="20">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="THR_TRAN_TM"
										value="" blockSelect="false" displayMode="label" readOnly="" maxLength="5">
									</w2:column>
								</w2:row>
							</w2:gBody>
						</w2:gridView>
					</xf:group>

					<xf:group id="" class="horizontal_line"></xf:group>
					<xf:group id="" class="gr_sub_header" style="">
						<xf:group class="defaultbox" id="" style="">
							<w2:textbox class="df_tt fl" id="" label="차량배차(일)" style=""></w2:textbox>
							<w2:span label="수정일" style="margin-right: 5px; margin-left: 15px; margin-top:5px;" id=""></w2:span>
							<w2:inputCalendar footerDiv="false" rightAlign="false" focusOnDateSelect="false"
								style="width:120px; margin-right: 10px; margin-top: 3px;" id="OPERDATE" renderType="component" renderDiv="true"
								calendarValueType="yearMonthDate" ref="" ev:onviewchange="scwin.OPERDATE_onviewchange" minYear="2015" maxYear="2030">
							</w2:inputCalendar>
						</xf:group>
						<w2:wframe id="wfm_subBtn" class="" style="" src="/cm/common/wf_subBtn.xml" scope="true"></w2:wframe>
					</xf:group>
					<xf:group id="" class="" style="">
						<w2:gridView ignoreCellClick="false" ev:onrowindexchange="" autoFit="allColumn" rowNumHeaderValue="순번"
							visibleRowNum="" class="cm_grid right" fixedColumnWithHidden="true" rowNumVisible="false"
							dataList="data:dlt_BRT_OPER_DT_ALLOC_PL_MST" id="AL0302G2" readOnly="false" style="" useShiftKey="true" scrollByColumn="false"
							rowStatusVisible="false" rowStatusHeaderValue="상태" ev:oncellclick="" focusMode="cell"
							ev:ontextimageclick="scwin.AL0302G2_ontextimageclick">
							<w2:caption style="" id="caption1" value="this is a grid caption."></w2:caption>
							<w2:header style="" id="header1">
								<w2:row style="" id="row3">
									<w2:column removeBorderStyle="false" width="50" inputType="text" style="height:40px;" id="column19"
										value="배차번호" blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:40px;" id="column18"
										value="차량번호" blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="150" inputType="text" style="height:40px;" id="column17"
										value="운수사" blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px;" id="column16"
										value="1교대운전자" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="200" inputType="text" style="height:20px;" id="column15"
										value="2교대운전자" blockSelect="false" displayMode="label" colSpan="2" rowSpan="">
									</w2:column>
									<w2:column removeBorderStyle="false" width="200" inputType="text" style="height:20px;" id="column13"
										value="3교대운전자" blockSelect="false" displayMode="label" colSpan="2" rowSpan="">
									</w2:column>
								</w2:row>
								<w2:row style="" id="row1">
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="column8"
										value="운전자명" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="column5"
										value="운전자명" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="column6"
										value="교대시각" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="column1"
										value="운전자명" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="column2"
										value="교대시각" blockSelect="false" displayMode="label">
									</w2:column>
								</w2:row>
							</w2:header>
							<w2:gBody style="" id="gBody1">
								<w2:row style="" id="row2">
									<w2:column removeBorderStyle="false" width="80" inputType="text" style="height:20px" id="ALLOC_NO"
										value="" blockSelect="false" displayMode="label" readOnly="" disabled="true">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="textImage" style="height:20px" id="VHC_NO"
										value="" blockSelect="false" displayMode="label" readOnly="" imageSrc="/cm/images/inc/btn_search.png" imageHeight="20"
										imageWidth="20">
									</w2:column>
									<w2:column removeBorderStyle="false" width="150" inputType="text" style="height:20px" id="COMP_NM"
										value="" blockSelect="false" displayMode="label" readOnly="" textAlign="left" disabled="true">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="textImage" style="height:20px" id="DRV_NM"
										value="" blockSelect="false" displayMode="label" readOnly="" imageSrc="/cm/images/inc/btn_search.png" imageHeight="20"
										imageWidth="20">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="textImage" style="height:20px"
										id="SEC_DRV_NM" value="" blockSelect="false" displayMode="label" readOnly="" textAlign="" imageSrc="/cm/images/inc/btn_search.png"
										imageHeight="20" imageWidth="20">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="SEC_TRAN_TM"
										value="" blockSelect="false" displayMode="label" readOnly="" textAlign="" maxLength="5">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="textImage" style="height:20px"
										id="THR_DRV_NM" value="" blockSelect="false" displayMode="label" readOnly="" textAlign="" imageSrc="/cm/images/inc/btn_search.png"
										imageHeight="20" imageWidth="20">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="THR_TRAN_TM"
										value="" blockSelect="false" displayMode="label" readOnly="" maxLength="5">
									</w2:column>
								</w2:row>
							</w2:gBody>
						</w2:gridView>
					</xf:group>
				</xf:group><!-- pgm_detail -->
			</xf:group>
		</xf:group>
	</body>
</html>
