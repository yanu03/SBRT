<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare"
	xmlns:xf="http://www.w3.org/2002/xforms">
<head>
	<script src="/webjars/sockjs-client/sockjs.min.js"></script>
	<script src="/webjars/stomp-websocket/stomp.min.js"></script>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_BMS_ETA_INFO" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REMAIN_TM" name="남은도착시간" dataType="text"></w2:column>
						<w2:column id="REMAIN_STTN" name="남은정류장수" dataType="text"></w2:column>
						<w2:column id="ROUT_ID" name="노선ID" dataType="text"></w2:column>
						<w2:column id="ROUT_NM" name="노선명" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_BMS_SOONETA_INFO" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REMAIN_TM" name="남은도착시간" dataType="text"></w2:column>
						<w2:column id="REMAIN_STTN" name="남은정류장수" dataType="text"></w2:column>
						<w2:column id="ROUT_ID" name="노선ID" dataType="text"></w2:column>
						<w2:column id="ROUT_NM" name="노선명" dataType="text"></w2:column>
						<w2:column id="VHC_TYPE" name="차량유형" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataMap baseNode="map" id="dma_search">
					<w2:keyInfo>
						<w2:key id="TYPE" name="name1" dataType="text"></w2:key>
						<w2:key id="CONTENT1" name="name2" dataType="text"></w2:key>
						<w2:key id="CONTENT2" name="name3" dataType="text"></w2:key>
						<w2:key id="CONTENT3" name="name4" dataType="text"></w2:key>
						<w2:key id="PUB_STTN_ID" name="연계정류장ID" dataType="text"></w2:key>
						<w2:key id="AREA" name="권역" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_sub_search">
					<w2:keyInfo>
						<w2:key id="NODE_ID" name="노드ID" dataType="text"></w2:key>
						<w2:key id="NODE_NM" name="노드명" dataType="text"></w2:key>
						<w2:key id="STTN_ID" name="정류소ID" dataType="text"></w2:key>
						<w2:key id="ROUT_ID" name="노선ID" dataType="text"></w2:key>
						<w2:key id="STTN_FCLT_TYPE" name="name3" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_routItem" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="ROUT_ID" name="노선ID" dataType="text"></w2:column>
						<w2:column id="ROUT_NM" name="노선명" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선명" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_BMS_NODE_MST" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="ROUT_ID" name="노선ID" dataType="text"></w2:column>
						<w2:column id="NODE_ID" name="노드ID" dataType="text"></w2:column>
						<w2:column id="MOCK_NODE_ID" name="표준노드ID" dataType="text"></w2:column>
						<w2:column id="NODE_SN" name="노드순번" dataType="number" defaultValue="0"></w2:column>
						<w2:column id="NODE_NM" name="노드명" dataType="text"></w2:column>
						<w2:column id="NODE_ENM" name="노드영문명" dataType="text"></w2:column>
						<w2:column id="NODE_TYPE" name="노드유형" dataType="text"></w2:column>
						<w2:column id="LINK_ID" name="링크ID" dataType="text"></w2:column>
						<w2:column id="STTN_ID" name="정류소ID" dataType="text"></w2:column>
						<w2:column id="STTN_NO" name="정류소번호" dataType="text"></w2:column>
						<w2:column id="CRS_ID" name="교차로ID" dataType="text"></w2:column>
						<w2:column id="GPS_X" name="경도" dataType="text"></w2:column>
						<w2:column id="GPS_Y" name="위도" dataType="text"></w2:column>
						<w2:column id="ROUT_LEN" name="노선거리" dataType="number" defaultValue="0"></w2:column>
						<w2:column id="AREA" name="권역" dataType="text"></w2:column>
						<w2:column id="MORN_STD" name="집중모니터링기준" dataType="text"></w2:column>
						<w2:column id="COND_ERROR" name="정류소고장여부" dataType="text"></w2:column>
						<w2:column id="STTN_FCLT_TYPE" name="정류소시설유형" dataType="text"></w2:column>
						<w2:column id="PUB_STTN_ID" name="공공연계정류소ID" dataType="text"></w2:column>
					</w2:columnInfo>
					<w2:data use="false">
						<w2:row></w2:row>
					</w2:data>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_routItem2" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="ORG_ID" name="기관ID" dataType="text"></w2:column>
						<w2:column id="ORG_NM" name="기관명" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_searchitem2" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="ROUT_ID" name="name1" dataType="text"></w2:column>
						<w2:column id="ROUT_NM" name="name2" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_routItem3" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="CLSFCTN_ID" name="분류ID" dataType="text"></w2:column>
						<w2:column id="CLSFCTN_NM" name="분류명" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_BMS_ROUT_NODE_DISP_VW" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="ROUT_ID" name="노선ID" dataType="text"></w2:column>
						<w2:column id="NODE_ID" name="노드ID" dataType="text"></w2:column>
						<w2:column id="NODE_SN" name="노드순번" dataType="text"></w2:column>
						<w2:column id="NODE_NM" name="노드명" dataType="text"></w2:column>
						<w2:column id="NODE_TYPE" name="노드유형" dataType="text"></w2:column>
						<w2:column id="LINK_ID" name="링크ID" dataType="text"></w2:column>
						<w2:column id="STTN_ID" name="정류소ID" dataType="text"></w2:column>
						<w2:column id="STTN_NO" name="정류소번호" dataType="text"></w2:column>
						<w2:column id="CRS_ID" name="교차로ID" dataType="text"></w2:column>
						<w2:column id="GPS_X" name="경도" dataType="text"></w2:column>
						<w2:column id="GPS_Y" name="위도" dataType="text"></w2:column>
						<w2:column id="ROUT_LEN" name="노선거리" dataType="text"></w2:column>
						<w2:column id="AREA" name="권역" dataType="text"></w2:column>
						<w2:column id="MORN_STD" name="집중모니터링기준" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataMap baseNode="map" id="dma_NODE_ID">
					<w2:keyInfo>
						<w2:key id="NODE_ID" name="노드ID" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_BRT_CUR_OPER_INFO" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="ROUT_ID" name="노선ID" dataType="text"></w2:column>
						<w2:column id="VHC_NO" name="차번" dataType="text"></w2:column>
						<w2:column id="OPER_DT" name="운행일" dataType="text"></w2:column>
						<w2:column id="VHC_ID" name="차량ID" dataType="text"></w2:column>
						<w2:column id="GPS_X" name="현재GPS_X좌표" dataType="text"></w2:column>
						<w2:column id="GPS_Y" name="현재GPS_Y좌표" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선명" dataType="text"></w2:column>
						<w2:column id="ROUT_NM" name="노선명" dataType="text"></w2:column>
						<w2:column id="CHAS_NO" name="차대번호" dataType="text"></w2:column>
						<w2:column id="MAKER" name="제조사" dataType="text"></w2:column>
						<w2:column id="DRV_NM" name="운전자" dataType="text"></w2:column>
						<w2:column id="COMP_NM" name="운수사" dataType="text"></w2:column>
						<w2:column id="BUS_STS" name="버스상태" dataType="text"></w2:column>
						<w2:column id="OPER_STS" name="운행상태" dataType="text"></w2:column>
						<w2:column id="ALLOC_NO" name="배차번호" dataType="text"></w2:column>
						<w2:column id="CUR_SPD" name="현재속도" dataType="text"></w2:column>
						<w2:column id="CUR_STOP_TM" name="현재정차시간" dataType="text"></w2:column>
						<w2:column id="NEXT_NODE_ID" name="다음노드아이디" dataType="text"></w2:column>
						<w2:column id="NEXT_NODE_NM" name="다음노드명" dataType="text"></w2:column>
						<w2:column id="PRV_PLCE_NM" name="이전장소명" dataType="text"></w2:column>
						<w2:column id="NODE_TYPE" name="노드유형" dataType="text"></w2:column>
						<w2:column id="MESSAGE" name="디스패치메시지" dataType="text"></w2:column>
						<w2:column id="EVT_TYPE" name="이벤트타입" dataType="text"></w2:column>
						<w2:column id="NEXT_NODE_TYPE" name="다음노드유형" dataType="text"></w2:column>
						<w2:column id="NODE_NM" name="이전노드명" dataType="text"></w2:column>
						<w2:column id="DSPTCH_KIND" name="디스패치종류" dataType="text"></w2:column>
						<w2:column id="DSPTCH_DIV" name="디스패치구분" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_repRoutItem" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선명" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_vhcBit" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REMAIN_STTN" name="남은정거장수" dataType="text"></w2:column>
						<w2:column id="REMAIN_TM" name="남은시간(초)" dataType="text"></w2:column>
						<w2:column id="NODE_ID" name="정류소ID" dataType="text"></w2:column>
						<w2:column id="NODE_NM" name="정류소명" dataType="text"></w2:column>
						<w2:column id="ROUT_ID" name="노선ID" dataType="text"></w2:column>
						<w2:column id="ROUT_NM" name="노선명" dataType="text"></w2:column>
						<w2:column id="VHC_KIND" name="차량종류" dataType="text"></w2:column>
						<w2:column id="VHC_TYPE" name="차량유형" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_BMS_FCLT_INFO" saveRemovedData="true">
				<w2:columnInfo>
					<w2:column id="FCLT_ID" name="시설아이디" dataType="text"></w2:column>
					<w2:column id="STTN_NM" name="정류소명" dataType="text"></w2:column>
					<w2:column id="NODE_ID" name="노드아이디" dataType="text"></w2:column>
					<w2:column id="MAKER" name="제조사" dataType="text"></w2:column>
					<w2:column id="CLSFCTN_ID" name="유지보수기관ID" dataType="text"></w2:column>
					<w2:column id="FCLT_KIND" name="시설종류" dataType="text"></w2:column>
					<w2:column id="FCLT_TYPE" name="시설유형" dataType="text"></w2:column>
					<w2:column id="INST_LOC" name="설치위치" dataType="text"></w2:column>
					<w2:column id="MNG_ID" name="관리아이디" dataType="text"></w2:column>
					<w2:column id="FILE_NM" name="파일명" dataType="text"></w2:column>
					<w2:column id="GPS_X" name="GPS_X좌표" dataType="text"></w2:column>
					<w2:column id="GPS_Y" name="GPS_Y좌표" dataType="text"></w2:column>
					<w2:column id="FCLT_IP" name="시설IP" dataType="text"></w2:column>
					<w2:column id="REL_KIND" name="관계종류" dataType="text"></w2:column>
					<w2:column id="REL_ID" name="관계아이디" dataType="text"></w2:column>
					<w2:column id="DEV_SERIAL_NO" name="시리얼번호" dataType="text"></w2:column>
					<w2:column id="MODEL_NM" name="모델명" dataType="text"></w2:column>
					<w2:column id="INST_DT" name="설치일" dataType="text"></w2:column>
					<w2:column id="BUY_DT" name="구매일" dataType="text"></w2:column>
					<w2:column id="CCTV_URL" name="CCTV_URL" dataType="text"></w2:column>
					<w2:column id="USE_YN" name="사용여부" dataType="text"></w2:column>
					<w2:column id="REMARK" name="비고" dataType="text"></w2:column>
					<w2:column id="FCLT_COND" name="시설물상태" dataType="text"></w2:column>
					<w2:column id="SEND_DATE" name="갱신일시" dataType="text"></w2:column>
					<w2:column id="CTR_YN" name="제어여부" dataType="text"></w2:column>
					<w2:column id="FCLT_COORDS" name="시설물위치좌표" dataType="text"></w2:column>
					<w2:column id="PK001" name="리셋" dataType="text"></w2:column>
					<w2:column id="PK002" name="전원(ON/OFF)" dataType="text"></w2:column>
					<w2:column id="PK003" name="화면(ON/OFF)" dataType="text"></w2:column>
					<w2:column id="PK004" name="사운드 음량" dataType="text"></w2:column>
					<w2:column id="PK005" name="LCD 휘도" dataType="text"></w2:column>
					<w2:column id="PK006" name="히터(ON/OFF)" dataType="text"></w2:column>
					<w2:column id="PK007" name="FAN(ON/OFF)" dataType="text"></w2:column>
					<w2:column id="PK008" name="커맨드" dataType="text"></w2:column>
					<w2:column id="PK009" name="BIT 캡쳐" dataType="text"></w2:column>
					<w2:column id="PK010" name="BIT 영상 녹화" dataType="text"></w2:column>
					<w2:column id="PK011" name="로그레벨" dataType="text"></w2:column>
					<w2:column id="PK012" name="IP/PORT" dataType="text"></w2:column>
					<w2:column id="PK013" name="통신" dataType="text"></w2:column>
					<w2:column id="PK014" name="AP" dataType="text"></w2:column>
					<w2:column id="PK015" name="GPS" dataType="text"></w2:column>
					<w2:column id="PK016" name="집중모니터링 여부" dataType="text"></w2:column>
					<w2:column id="PK017" name="정주기 주기" dataType="text"></w2:column>
					<w2:column id="PK018" name="배터리" dataType="text"></w2:column>
					<w2:column id="PK019" name="" dataType="text"></w2:column>
					<w2:column id="PK020" name="" dataType="text"></w2:column>
					<w2:column id="PK021" name="" dataType="text"></w2:column>
					<w2:column id="PK022" name="" dataType="text"></w2:column>
					<w2:column id="PK023" name="" dataType="text"></w2:column>
					<w2:column id="PK024" name="" dataType="text"></w2:column>
					<w2:column id="PK025" name="" dataType="text"></w2:column>
					<w2:column id="PK026" name="" dataType="text"></w2:column>
					<w2:column id="PK027" name="" dataType="text"></w2:column>
					<w2:column id="PK028" name="" dataType="text"></w2:column>
					<w2:column id="PK029" name="" dataType="text"></w2:column>
					<w2:column id="PK030" name="" dataType="text"></w2:column>
					<w2:column id="PK031" name="" dataType="text"></w2:column>
					<w2:column id="PK032" name="" dataType="text"></w2:column>
					<w2:column id="PK033" name="" dataType="text"></w2:column>
					<w2:column id="PK034" name="" dataType="text"></w2:column>
					<w2:column id="PK035" name="" dataType="text"></w2:column>
					<w2:column id="PK036" name="" dataType="text"></w2:column>
					<w2:column id="PK037" name="" dataType="text"></w2:column>
					<w2:column id="PK038" name="" dataType="text"></w2:column>
				</w2:columnInfo>
			</w2:dataList>
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>
			<xf:submission id="sub_MO0203G0R0" ref='data:json,dma_search' target='data:json,dlt_BMS_NODE_MST' action="/mo/MO0203G0R0"
				method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
				processMsg="조회 중입니다.." ev:submit="" ev:submitdone="scwin.sub_MO0203G0R0_submitdone" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_MO0203SHI0" ref="data:json,dma_search" target="data:json,dlt_routItem" action="/rout/selectRoutItem"
				method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
				processMsg="" ev:submit="" ev:submitdone="scwin.sub_MO0203SHI0_submitdone" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_MO0203G2R0" ref="data:json,dma_search" target="data:json,dlt_BMS_ROUT_NODE_DISP_VW"
				action="/rout/selectNodeDispListByRepRout" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace=""
				errorHandler="" customHandler="" mode="asynchronous" processMsg="조회 중입니다.." ev:submit="" ev:submitdone="scwin.sub_MO0203G2R0_submitdone" ev:submiterror=""
				abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_MO0203SCK" ref="data:json,dma_sub_search" target="data:json,dlt_BMS_ETA_INFO" action="/mo/MO0203SCK"
				method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
				processMsg="" ev:submit="" ev:submitdone="scwin.sub_MO0203SCK_submitdone" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_MO0203G1R0" ref="data:json,dma_search" target="data:json,dlt_BRT_CUR_OPER_INFO" action="/mo/MO0101G0R0"
				method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
				processMsg="" ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_MO0203SHI1" ref="" target="data:json,dlt_repRoutItem" action="/repRout/selectRepRoutItem" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="scwin.sub_MO0203SHI1_submitdone" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_selectVhcBit" ref="data:json,dma_search" target="data:json,dlt_vhcBit" action="/vhc/selectVhcBit" method="post" mediatype="application/json"
				encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone=""
				ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_MO0203P0R0" ref="data:json,dma_sub_search" target="data:json,dlt_BMS_FCLT_INFO" action="/mo/MO0203P0R0"
				method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous"
				processMsg="" ev:submit="" ev:submitdone="scwin.sub_MO0203P0R0_submitdone" ev:submiterror="" abortTrigger="">
			</xf:submission>			
		</xf:model>

		<style type='text/css'>
		.MO0203T0 .w2tabcontrol_container{position: absolute; left:0; top:35px; right:0; bottom:0px; border:none; float:none; height:auto !important; border-top:1px solid #c4cad6;}
		</style>

		<script type="text/javascript" lazy="false"><![CDATA[
	scwin.onpageload = function() {
		 scwin.connect();
		 var autoOptions = {
			Main : { grid : MO0203G0, srchSbm : sub_MO0203G0R0, keyColumn : "NODE_ID", srchGrp : pgm_search, name : "정류장 목록",
						focusColumn : "NODE_NM"}
					
		 };
		 
		 var mainOptions = {
			SEARCH:{},
			CNL:{}
		}; 
		 
		var codeOptions = [ {code : "NODE_TYPE", compID : "MO0203G0:NODE_TYPE" }
							,{code : "COND_ERROR", compID : "MO0203G0:COND_ERROR" }
							,{code : "STTN_FCLT_TYPE", compID : "MO0203G0:STTN_FCLT_TYPE" }
						
		 ];
		 
		com.setMainBtn2(wfm_mainBtn, gcm.DISP_TYPE.SINGLE_GRID, autoOptions, mainOptions, codeOptions);		
		var mainSrhOptions = {
			SEARCH:scwin.btn_sub_move
		};	
		com.setMainSrhBtn(wfm_mainSearchBtn, gcm.DISP_TYPE.SINGLE_GRID, autoOptions, mainSrhOptions, codeOptions);
				
		routMap.initMap2("map_MO0203", {width:"100%"
				, height:"100%"
		});
		
		
		 
		com.setCommonDtl(codeOptions//, function(){
			//com.searchGrid(MO0203G0, sub_MO0203G0R0);
		// }
		);	
		
		MO0203G0.mergeCells("byrestriccol");
		//$p.executeSubmission(sub_MO0203SHI0);	
		$p.executeSubmission(sub_MO0203SHI1);
		
		//버스 상세정보
		$("#map_MO0203").on("click", ".sttnInfo", function(e) {
			e.stopPropagation();
			scwin.sttninfo_onclick();
			//routMap.removeRightClickOverlay("map_MO0203_vehicle");
			routMap.removeRightClickOverlay("map_MO0203");
		});				
	};	
	
	scwin.btn_sub_move = function(){
		com.gridMove(MO0203G0,"NODE_NM", dma_search.get("CONTENT3"), MO0203G0.getFocusedRowIndex());
	}
	
	scwin.MO0203SCK = function () {
		//com.executeSubmission(sub_MO0203SCK);
	}
	
	//15초 간격으로 MO0203SCK 실행
	//setInterval(scwin.MO0203SCK, 15000);
	
	//정류장별 차량 도착 정보 테이블 생성
	MO0203T0_setTable = function(dataList){
//		dataList.push({"REMAIN_TM": 30});
//		dataList.push({"ROUT_NM": "B0"});
//		dataList.push({"REMAIN_STTN": "3"});
		
		
		var param = com.getParameter();
		dlt_BMS_ETA_INFO.removeAll();
		dlt_BMS_SOONETA_INFO.removeAll();
		var tableStr = '';
		var tableBody = '';
		var talbeId = '';
		var vhcImgSrc = '';
		
		//테이블 소스 시작
		tableStr = '<table id="mf_tac_layout_contents_MN00070202_body_MO0203T0" style="" class="w2group w2tb bit_tb">'
					+'<caption id="mf_tac_layout_contents_MN00070202_body_wq_uuid_505" class="w2group "></caption>'
					+'<colgroup id="mf_tac_layout_contents_MN00070202_body_wq_uuid_506" class="w2group ">'
					+'<col id="mf_tac_layout_contents_MN00070202_body_wq_uuid_507" style="width:25.00%;" class="w2group ">'
					+'<col id="mf_tac_layout_contents_MN00070202_body_wq_uuid_508" style="width:37.50%" class="w2group ">'
					+'<col id="mf_tac_layout_contents_MN00070202_body_wq_uuid_508" style="width:37.50%" class="w2group ">'
					+'</colgroup>'
					+'<tbody>';
		
		if(dataList.length != 0){
			//순서 맞추기
			dataList.sort(function(a,b) {
				return parseFloat(a.REMAIN_TM) - parseFloat(b.REMAIN_TM);
			});
			
			var j = 0;
			for(var i = 0; i < dataList.length; i++){
				//초 -> 분으로 변경. 0분 이하면 잠시후 도착
				dataList[i].REMAIN_TM = parseInt((dataList[i].REMAIN_TM%3600)/60) + '분';
				
				if(dataList[i].REMAIN_TM != '0분'){
					dlt_BMS_ETA_INFO.insertRow();
					dlt_BMS_ETA_INFO.setCellData(j, "ROUT_NM", dataList[i].ROUT_NM);
					dlt_BMS_ETA_INFO.setCellData(j, "REMAIN_TM", dataList[i].REMAIN_TM);
					dlt_BMS_ETA_INFO.setCellData(j, "REMAIN_STTN", dataList[i].REMAIN_STTN  + '전');
					j++;
				}else if(dataList[i].REMAIN_TM == '0분'){
					dlt_BMS_SOONETA_INFO.insertRow();
					dlt_BMS_SOONETA_INFO.setCellData(i, "ROUT_NM", dataList[i].ROUT_NM);
				}
			}
			
			//보내는게 1개
			if(dataList.length == 1){
				tableBody += '<tr id="mf_tac_layout_contents_MN00070202_body_wq_uuid_511" class="w2group">'
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_514" style="border-color: black; " class="w2group w2tb_td w2tb_noTH">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_515" style="width: 100px;height: 23px;font-size: 12px;" class="w2span ">'
					+dlt_BMS_ETA_INFO.getCellData(0, "ROUT_NM")
					+'</span>'
					+'</td>'
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_514" style="border-color: black; " class="w2group w2tb_td w2tb_noTH">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_515" style="width: 100px;height: 23px;font-size: 2px; color: yellow;" class="w2span ">'
					+dlt_BMS_ETA_INFO.getCellData(0, "REMAIN_STTN")
					+'</span>'
					+'</td>'
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_518" style="border-color: black;  text-align: right;" class="w2group w2tb_td w2tb_noTH">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_519" style="width: 100%;height: 23px;font-size: 2px;text-align: right;color: green;" class="w2span ">'
					+dlt_BMS_ETA_INFO.getCellData(0, "REMAIN_TM")
					+'</span>'
					+'</td>'
					+'</tr>'
					
					+'<tr id="mf_tac_layout_contents_MN00070202_body_wq_uuid_512" class="w2group">'
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_513" style="border-color: black; border-bottom-color:yellow" class="w2group w2tb_td w2tb_noTH">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_516" style="width: 100px;height: 23px;font-size: 2px;" class="w2span ">'

					+'</span>'
					+'</td>'
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_513" style="border-color: black; border-bottom-color:yellow" class="w2group w2tb_td w2tb_noTH">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_516" style="width: 100px;height: 23px;font-size: 2px;" class="w2span ">'

					+'</span>'
					+'</td>'
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_518" style="border-color: black; border-bottom-color:yellow; text-align: right;" class="w2group w2tb_td w2tb_noTH">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_519" style="width: 100%;height: 23px;font-size: 2px;text-align: right;color: green;" class="w2span ">'

					+'</span>'
					+'</td>'
					+'</tr>'
			
				tableBody +='<tr id="mf_tac_layout_contents_MN00070202_body_wq_uuid_511" class="w2group">'
							+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_514" style="border-color: yellow; border-right-color:yellow;" class="w2group w2tb_td w2tb_noTH" scope="row" colspan="3" rowspan="1">'
							+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_515" style="width: 100px;height: 23px;font-size: 10px;" class="w2span ">'
							+"곧도착 : " + dlt_BMS_SOONETA_INFO.getCellData(0, "ROUT_NM");
							+'</span>'
							+'</td>'
							+'</tr>';
			}
			//보내는게 2개 이상이면 동적으로 그리기
			else if(dataList.length > 1){
				for(var i = 0; i < dataList.length; i++){
					if(dlt_BMS_ETA_INFO.getCellData(i, "REMAIN_TM") != '0분'){
						tableBody += '<tr id="mf_tac_layout_contents_MN00070202_body_wq_uuid_511" class="w2group">'
									+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_514" style="border-color: black; " class="w2group w2tb_td w2tb_noTH">'
									+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_515" style="width: 100px;height: 23px;font-size: 2px;" class="w2span ">'
									+dlt_BMS_ETA_INFO.getCellData(i, "ROUT_NM")
									+'</span>'
									+'</td>'
									+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_514" style="border-color: black; " class="w2group w2tb_td w2tb_noTH">'
									+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_515" style="width: 100px;height: 23px;font-size: 2px; color: yellow;" class="w2span ">'
									+dlt_BMS_ETA_INFO.getCellData(i, "REMAIN_STTN")
									+'</span>'
									+'</td>'
									+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_518" style="border-color: black;  text-align: right;" class="w2group w2tb_td w2tb_noTH">'
									+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_519" style="width: 100%;height: 23px;font-size: 2px;text-align: right;color: green;" class="w2span ">'
									+dlt_BMS_ETA_INFO.getCellData(i, "REMAIN_TM")
									+'</span>'
									+'</td>'
									+'</tr>'
					}
				
				}
				//곧도착 2개 이상..
				tableBody +='<tr id="mf_tac_layout_contents_MN00070202_body_wq_uuid_511" class="w2group">'
							+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_514" style="border-color: yellow; border-right-color:yellow; border-top-style:double;" class="w2group w2tb_td w2tb_noTH" scope="row" colspan="3" rowspan="1">'
							+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_515" style="width: 100px;height: 23px;font-size: 2px;" class="w2span ">'
							+"곧도착 : " + dlt_BMS_SOONETA_INFO.getCellData(0, "ROUT_NM");
							+'</span>'
							+'</td>'
							+'</tr>';
			}
			
		}
		//데이터가 없다면 빈 테이블 그리기
		else if(dataList.length == 0){
			tableBody += '<tr id="mf_tac_layout_contents_MN00070202_body_wq_uuid_511" class="w2group">'
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_514" style="border-color: black; " class="w2group w2tb_td w2tb_noTH">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_515" style="width: 100px;height: 23px;font-size: 2px;" class="w2span ">'
					+'</span>'
					+'</td>'
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_514" style="border-color: black; " class="w2group w2tb_td w2tb_noTH">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_515" style="width: 100px;height: 23px;font-size: 2px; color: yellow;" class="w2span ">'
					+'</span>'
					+'</td>'
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_518" style="border-color: black;  text-align: right;" class="w2group w2tb_td w2tb_noTH">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_519" style="width: 100%;height: 23px;font-size: 2px;text-align: right;color: green;" class="w2span ">'
					+'</span>'
					+'</td>'
					+'</tr>'
					
					+'<tr id="mf_tac_layout_contents_MN00070202_body_wq_uuid_511" class="w2group">'
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_514" style="border-color: black; border-bottom-color:yellow" class="w2group w2tb_td w2tb_noTH">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_515" style="width: 100px;height: 23px;font-size: 2px;" class="w2span ">'
					+'</span>'
					+'</td>'
					
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_518" style="border-color: black; border-bottom-color:yellow; text-align: right;" class="w2group w2tb_td w2tb_noTH">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_519" style="width: 100%;height: 23px;font-size: 2px;text-align: right;color: green;" class="w2span ">'
					+'</span>'
					+'</td>'
					+'</tr>'
					
			tableBody +='<tr id="mf_tac_layout_contents_MN00070202_body_wq_uuid_511" class="w2group">'
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_514" style="border-color: yellow; border-right-color:yellow;" class="w2group w2tb_td w2tb_noTH" scope="row" colspan="3" rowspan="1">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_515" style="width: 100px;height: 23px;font-size: 2px;" class="w2span ">'
					+"곧도착 : "
					+'</span>'
					+'</td>'
					+'</tr>';
		}
		
		tableStr += tableBody + '</tbody></table>';
		
		$("#mf_tac_layout_contents_"+param.menuCode+"_body_MO0203T0").html(tableStr);
	}
	
	
	//빈 테이블 그리기
	MO0203T0_setEmptyTable = function(){
		var tableStr = '';
		var tableBody = '';
		
		//테이블 소스 시작
		tableStr = '<table id="mf_tac_layout_contents_MN00070202_body_MO0203T0" style="" class="w2group w2tb bit_tb">'
					+'<caption id="mf_tac_layout_contents_MN00070202_body_wq_uuid_505" class="w2group "></caption>'
					+'<colgroup id="mf_tac_layout_contents_MN00070202_body_wq_uuid_506" class="w2group ">'
					+'<col id="mf_tac_layout_contents_MN00070202_body_wq_uuid_507" style="width:25.00%;" class="w2group ">'
					+'<col id="mf_tac_layout_contents_MN00070202_body_wq_uuid_508" style="width:37.5%" class="w2group ">'
					+'<col id="mf_tac_layout_contents_MN00070202_body_wq_uuid_508" style="width:37.5%" class="w2group ">'
					+'</colgroup>'
					+'<tbody>';
					
			tableBody += '<tr id="mf_tac_layout_contents_MN00070202_body_wq_uuid_511" class="w2group">'
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_514" style="border-color: black;" class="w2group w2tb_td w2tb_noTH">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_515" style="width: 100px;height: 23px;font-size: 2px;" class="w2span ">'
					+'</span>'
					+'</td>'
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_518" style="border-color: black;text-align: right;" class="w2group w2tb_td w2tb_noTH">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_519" style="width: 100%;height: 23px;font-size: 2px;text-align: right;color: green;" class="w2span ">'
					+'</span>'
					+'</td>'
					+'</tr>'
					
					+'<tr id="mf_tac_layout_contents_MN00070202_body_wq_uuid_511" class="w2group">'
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_514" style="border-color: black; border-bottom-color:yellow" class="w2group w2tb_td w2tb_noTH">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_515" style="width: 100px;height: 23px;font-size: 2px;" class="w2span ">'
					+'</span>'
					+'</td>'
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_518" style="border-color: black; border-bottom-color:yellow; text-align: right;" class="w2group w2tb_td w2tb_noTH">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_519" style="width: 100%;height: 23px;font-size: 2px;text-align: right;color: green;" class="w2span ">'
					+'</span>'
					+'</td>'
					+'</tr>'
					
			tableBody +='<tr id="mf_tac_layout_contents_MN00070202_body_wq_uuid_511" class="w2group">'
					+'<td id="mf_tac_layout_contents_MN00070202_body_wq_uuid_514" style="border-color: yellow; border-right-color:yellow; border-top-style:double;" class="w2group w2tb_td w2tb_noTH" scope="row" colspan="3" rowspan="1">'
					+'<span id="mf_tac_layout_contents_MN00070202_body_wq_uuid_515" style="width: 100px;height: 23px;font-size: 2px;" class="w2span ">'
					+"곧도착 : " + dlt_BMS_SOONETA_INFO.getCellData(0, "ROUT_NM");
					+'</span>'
					+'</td>'
					+'</tr>';
					
		tableStr += tableBody + '</tbody></table>';
		
		$("#mf_tac_layout_contents_MN00070202_body_MO0203T0").html(tableStr);
	}
	
	
	scwin.connect = function() {
		var socket = new SockJS('/websocket');
		stompClient = Stomp.over(socket);
		
		stompClient.connect({}, scwin.onConnected, scwin.onError);
	
	}	
	
	
	scwin.onConnected = function (frame) {
		//setConnected(true);
		
		console.log('Connected: ' + frame);
		
	    // Subscribe to the Public Topic
	    

	    stompClient.subscribe('/topic/public', scwin.onMessageReceived);
	
	}
	
	scwin.onError = function (error) {
		showMessage('Could not connect to WebSocket server. ' + error);
	}	
	
	scwin.onMessageReceived = function(payload) {
		var jsonObj = JSON.parse(payload.body);
		
		var attrId = jsonObj.ATTR_ID;
		var dataList = jsonObj.LIST;
		var nodeId = dlt_BMS_NODE_MST.getCellData(MO0203G0.getFocusedRowIndex(), "NODE_ID");
		
		//attrId = 2022 : 정류장별 차량 도착 정보
		if(attrId == util.ATTR_ID.BUS_ARRIVAL_INFO && nodeId == jsonObj.STTN_ID){
			MO0203T0_setTable(dataList);
		}
		
		//attrId = 4014 : 실시간 차량 위치 정보
		else if(attrId == util.ATTR_ID.BUS_INFO){
			
		}
		
	}	
	
	scwin.sub_MO0203SCK_submitdone = function(e) {
		scwin.onMessageReceived();
	};
	
	function showMessage(message) {
		$("#mf_tac_layout_contents_MN00050202_body_message").append("<tr><td>" + message + "</td></tr>");
	}	
	
	scwin.MO0203G0_onrowindexchange = function(row,oldRow) {
		MO0203T0_setEmptyTable();
		dlt_BMS_ETA_INFO.removeAll();
		dlt_BMS_SOONETA_INFO.removeAll();
		dma_sub_search.set("NODE_ID", dlt_BMS_NODE_MST.getCellData(row, "NODE_ID"));
		
		dma_search.set("PUB_STTN_ID", dlt_BMS_NODE_MST.getCellData(row, "PUB_STTN_ID"));
		dma_search.set("AREA", dlt_BMS_NODE_MST.getCellData(row, "AREA"));
		
		//한차장님 완료하면 주석 풀어야됨
		//com.executeSubmission(sub_selectVhcBit);
		
		
		var allDataList = dlt_BMS_NODE_MST.getAllJSON();
		var focusIdx = MO0203G0.getFocusedRowIndex();
		
		//노선만 뿌리기
		routMap.showRoute("map_MO0203", dlt_BMS_ROUT_NODE_DISP_VW.getAllJSON(), null, "ONLYLINE");
		//마커 뿌리기
		routMap.showMarkerList("map_MO0203", allDataList, focusIdx, MO0203G0); 	
		//카테고리 뿌리기
		routMap.showCategory("map_MO0203", allDataList, focusIdx, MO0203G0);
		
		//com.executeSubmission(sub_MO0203SCK);
		
		var nodeId = dlt_BMS_NODE_MST.getCellData(MO0203G0.getFocusedRowIndex(), "NODE_ID");
		dma_NODE_ID.set("NODE_ID", "(정류소 ID : "+nodeId+")");
		
		
		dma_sub_search.set("STTN_FCLT_TYPE", dlt_BMS_NODE_MST.getCellData(row, "STTN_FCLT_TYPE"));
		com.executeSubmission(sub_MO0203P0R0);
		
		if(dlt_BMS_NODE_MST.getCellData(row,"STTN_FCLT_TYPE") == 'ST003'){ //폐쇄형
			document.getElementById(STTN_IMG.getID()).className = "ST003_station";
			imgDiv.show();
		}else{
			document.getElementById(STTN_IMG.getID()).className = 'ST002_station_1';
			imgDiv.hide();
		}			
		
		
		
	};
	
	scwin.sub_MO0203G0R0_submitdone = function(e) {
		//상태에 따라 클래스(백그라운드 색) 설정
		for (i=0; i<dlt_BMS_NODE_MST.getDataLength(); i++) {
			
			/*
			
			//비정상
			if (dlt_BMS_NODE_MST.getCellData(i, "COND_ERROR") == "CE001") {
				MO0203G0.setCellClass(i, "COND_ERROR", "cond_abnormal");
			}
			//정상
			else if (dlt_BMS_NODE_MST.getCellData(i, "COND_ERROR") == "CE002") {
				MO0203G0.setCellClass(i, "COND_ERROR", "cond_normal");
			}
			
			*/
			if (dlt_BMS_NODE_MST.getCellData(i, "STTN_FCLT_TYPE") == "ST003") {
				MO0203G0.setCellClass(i, "STTN_FCLT_TYPE", "cond_normal");
			}
			
		}
		
		var allDataList = dlt_BMS_NODE_MST.getAllJSON();
		var focusIdx = MO0203G0.getFocusedRowIndex();
		
		//노선만 뿌리기
		routMap.showRoute("map_MO0203", dlt_BMS_ROUT_NODE_DISP_VW.getAllJSON(), null, "ONLYLINE");
		//마커 뿌리기
		routMap.showMarkerList("map_MO0203", allDataList, focusIdx, MO0203G0); 	
		//카테고리 뿌리기
		routMap.showCategory("map_MO0203", allDataList, focusIdx, MO0203G0);
		
		com.setFocusedCell(MO0203G0, "NODE_NM");
		
	};
	
//	scwin.sub_MO0203SHI0_submitdone = function(e) {
//		TYPE.setValue("RT00000049");
//		
//		dma_sub_search.set("ROUT_ID",TYPE.getValue());
//		$p.executeSubmission(sub_MO0203G2R0);
//		com.searchGrid(MO0203G0, sub_MO0203G0R0);
//	};
	
//	scwin.TYPE_onviewchange = function(info) {
//		dma_sub_search.set("ROUT_ID",TYPE.getValue());		
//		$p.executeSubmission(sub_MO0203G2R0);
//		com.searchGrid(MO0203G0, sub_MO0203G0R0);
//	};


	scwin.TYPE1_onviewchange = function(info) {
		//$p.executeSubmission(sub_MO0203SHI0);
		$p.executeSubmission(sub_MO0203G2R0);
		com.searchGrid(MO0203G0, sub_MO0203G0R0);
	}	
	
	
	scwin.sub_MO0203SHI1_submitdone = function(e) {
		TYPE1.setValue("RR00000002");
		$p.executeSubmission(sub_MO0203G2R0);
		com.searchGrid(MO0203G0, sub_MO0203G0R0);
		//$p.executeSubmission(sub_MO0203SHI0);
	};
	
	scwin.sttninfo_onclick = function() {
		var data = { NODE_ID : dlt_BMS_NODE_MST.getCellData(MO0203G0.getFocusedRowIndex(), "NODE_ID"), 
					 NODE_NM : dlt_BMS_NODE_MST.getCellData(MO0203G0.getFocusedRowIndex(), "NODE_NM"),
					 STTN_FCLT_TYPE : dlt_BMS_NODE_MST.getCellData(MO0203G0.getFocusedRowIndex(), "STTN_FCLT_TYPE"),
					 callbackFn : ""}
					  
		var options = {
			id : "MO0203P01",
			popupName : "정류소 상태정보",
			//browserPopup으로 열면 버그 일어남
			//type : "browserPopup",
			width : 1380,
			height : 720			
		};
		
		com.openPopup(("/ui/BRT/MO0203/MO0203P01.xml"), options, data);
	}
	
	//이미지 생성 함수
	scwin.makeImage = function(){
		var str = ""
		var imgSrc = ""
		var imgId = ""
		
		for (i=0; i<dlt_BMS_FCLT_INFO.getDataLength(); i++) {
			
			var coord = dlt_BMS_FCLT_INFO.getCellData(i, "FCLT_COORDS").split(',');
			var top = coord[0];
			var left = coord[1];
			var fcltKind = dlt_BMS_FCLT_INFO.getCellData(i, "FCLT_KIND");
			var fcltId = dlt_BMS_FCLT_INFO.getCellData(i, "FCLT_ID");
			var fcltCond = dlt_BMS_FCLT_INFO.getCellData(i, "FCLT_COND");
			
			if(fcltKind == 'FK001' && (fcltCond == 'FC020'|| fcltCond == '')){
				imgSrc = "/cm/images/bms/BIT_RED_normal.png";
			}else if(fcltKind == 'FK001' && (fcltCond == 'FC021' || fcltCond == '')){
				imgSrc = "/cm/images/bms/BIT_RED_abnormal.png";
			}else if(fcltKind == 'FK004' && (fcltCond == 'FC020' || fcltCond == '')){
				imgSrc = "/cm/images/bms/AIRTUBE_normal.png";
			}else if(fcltKind == 'FK004' && (fcltCond == 'FC021' || fcltCond == '')){
				imgSrc = "/cm/images/bms/AIRTUBE_abnormal.png";
			}else if(fcltKind == 'FK005' && (fcltCond == 'FC020' || fcltCond == '')){
				imgSrc = "/cm/images/bms/AIRCON_normal.png";
			}else if(fcltKind == 'FK005' && (fcltCond == 'FC021' || fcltCond == '')){
				imgSrc = "/cm/images/bms/AIRCON_abnormal.png";
			}else if(fcltKind == 'FK007' && (fcltCond == 'FC020' || fcltCond == '')){
				imgSrc = "/cm/images/bms/SCREENDOOR_normal.png";
			}
			
			//시설물 이미지
			str += '<div id="'+fcltId+'" style="z-index: 1; position: absolute; top:'+top+'px; left: '+left+'px;" class="w2group fclt_img" onclick="imgOnclick(this.id);">';
			str += '<img xmlns="http://www.w3.org/1999/xhtml" style="" src="'+imgSrc+'" id="'+fcltId+'img'+'">';
			str += '</div>'
			
		}
		
		//정류소 이미지
		//반개방형때문인데 현재 안쓴다고함
//		if(dlt_BMS_NODE_MST.getCellData(FM0202G0.getFocusedRowIndex(), "STTN_FCLT_TYPE") == 'ST003'){
//			var imgSrc = "/cm/images/bms/ST003_1.png"
//		}else{
//			var imgSrc = "/cm/images/bms/ST002_2.jpg"
//		}
		
		var nodeId = dlt_BMS_NODE_MST.getCellData(MO0203G0.getFocusedRowIndex(), "NODE_ID");
		
		str += '<img xmlns="http://www.w3.org/1999/xhtml" style="position:absolute; cursor:default" src="'+imgSrc+'" id="'+nodeId+'img'+'">';
		
		$('#'+STTN_IMG.getID()).html(str);
		
	}		
	
	scwin.sub_MO0203P0R0_submitdone = function(e) {
		//폐쇄형정류장 임의 하드코딩
		var rowIndexArr = dlt_BMS_NODE_MST.getMatchedIndex("NODE_ID", "293064211");
		if(rowIndexArr.length > 0) {
			MO0203G0.setFocusedCell(rowIndexArr[0], "NODE_NM");	
		}
		scwin.makeImage();
		
	};
	]]></script>
	</head>
	<body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
		<xf:group id="pgm_container" class="pgm_container grdr_60_a" style="">
		
			<xf:group id="" class="grdc_2f_8f title-wrap" style="">
				<xf:group id="pgm_header_left" class="pgm_header_left" style="">
					<w2:wframe id="wfm_title" style="" src="/cm/common/wf_title.xml" scope="true"></w2:wframe>
				</xf:group>
				<xf:group id="pgm_header_right" class="pgm_header_right" style="">
					<xf:group id="pgm_rightNavi" class="pgm_rightNavi" style="">
						<w2:wframe id="rightNavi" class="" style="" src="/cm/common/wf_rightNavi.xml" scope="true"></w2:wframe>
					</xf:group>
					<xf:group id="pgm_header" class="pgm_header" style="">
						<w2:wframe id="wfm_mainBtn" class="main_Btn" style="float:right" src="/cm/common/wf_mainBtn.xml" scope="true"></w2:wframe>
					</xf:group>
				</xf:group>
			</xf:group>
		
			<xf:group id="pgm_content" class="pgm_content grdc_470_0_a" style="">
				<xf:group id="pgm_list" class="pgm_list grdr_20_50_a bms_box_wrap" style="">
					<xf:group id="" class="" style="">
						<xf:group class="defaultbox" id="" style="">
							<w2:textbox class="df_tt fl list ico-list" id="" label="정류소 목록" style=""></w2:textbox>
						</xf:group>
					</xf:group>
					
					<xf:group id="" class="" style="">
						<xf:group id="pgm_search" style="" class="gr_search">
							<xf:group class="label" id="" style="">
								<w2:span class="" id="" label="대표노선"></w2:span>
							</xf:group>
							<xf:group class="search" id="" style="">
								<xf:select1 allOption="" appearance="minimal" chooseOption="" direction="auto" disabled="false"
									disabledClass="w2selectbox_disabled" displayMode="label" ev:onviewchange="scwin.TYPE1_onviewchange" id="TYPE1" optionOrder="false"
									ref="data:dma_search.CONTENT1" class="search_type_100" style="width:50px" submenuSize="auto" textAlign="center" chooseOptionLabel="">
									<xf:choices>
										<xf:itemset nodeset="data:dlt_repRoutItem">
											<xf:label ref="REP_ROUT_NM"></xf:label>
											<xf:value ref="REP_ROUT_ID"></xf:value>
										</xf:itemset>
									</xf:choices>
								</xf:select1>
							</xf:group>
							<!-- <xf:group id="" style="" class="label">
									<w2:span id="" class="" label="노선"></w2:span>
							</xf:group>
							<xf:group id="" style="" class="search">
							
								<xf:select1 allOption="" appearance="minimal" chooseOption="" direction="auto" disabled="false"
									ev:onviewchange="scwin.TYPE_onviewchange" disabledClass="w2selectbox_disabled" displayMode="label" id="TYPE" optionOrder="false"
									ref="data:dma_search.CONTENT2" class="search_type_100" style="width:80px" submenuSize="auto" textAlign="left">
									<xf:choices>
										<xf:itemset nodeset="data:dlt_routItem">
											<xf:label ref="ROUT_NM"></xf:label>
											<xf:value ref="ROUT_ID"></xf:value>
										</xf:itemset>
									</xf:choices>
								</xf:select1>
							</xf:group>	 -->
							<xf:group class="label" id="" style="">
								<w2:span class="" id="" label="검색"></w2:span>
							</xf:group>
							<xf:group class="search" id="" style="">						
								<xf:input id="search_input" class="search_input" ref="data:dma_search.CONTENT3" placeholder="정류소명" style="width:70px"></xf:input>
								<!-- <w2:autoComplete allOption="" caseSensitive="false" chooseOption="true" chooseOptionLabel="-전체-"
									chooseOptionValue="" displayMode="label" editType="select" emptyItem="" emptyValue="" ev:onchange="" ev:onviewchange=""
									id="autoChoiceBox" interactionMode="" noResult="useData" ref="data:dma_search.CONTENT3" search="start" selectedData=""
									class="search_auto" style="display:none" submenuSize="auto" textAlign="left" useKeywordHighlight="false" visibleRowNum="">
								</w2:autoComplete> -->
							</xf:group>	
							<w2:wframe id="wfm_mainSearchBtn" class="wfm_mainSearchBtn" style="" src="/cm/common/wf_mainSrhBtn.xml" scope="true"></w2:wframe>							
						</xf:group>
					</xf:group>
				
					<xf:group id="" class="" style="">
						<w2:gridView alwaysTriggerScrollStart="" autoFit="lastColumn" captionTitle="" class="cm_grid left"
							dataList="data:dlt_BMS_NODE_MST" enterKeyMove="" ev:onafteredit="" ev:oncellclick="" ev:oneditkeyup="" ev:onkeyup=""
							ev:onrowindexchange="scwin.MO0203G0_onrowindexchange" ev:ontextimageclick="" ev:onviewchange="" fixedColumnWithHidden="true"
							id="MO0203G0" ignoreCellClick="false" nextTabID="" rowNumHeaderValue="No." rowNumVisible="true" rowStatusHeaderValue=""
							rowStatusVisible="false" rowStatusWidth="40" scrollByColumn="false" style="" useShiftKey="true" visibleRowNum="" wheelRows=""
							autoFitMinWidth="0" disabledScrollHidden="" editModeEvent="" editModeEventIcon="" checkEditableInputClass="" keyMoveEditMode=""
							moveKeyEditMode="" moveKeyEditModeAll="" ignoreNonEditableCellTabEnter="" readOnly="true" keepDefaultColumnWidth=""
							oddEvenColorDisplay="" rowNumWidth="" summaryAuto="" excludeDeletedRows="" useCtrlOnMultisort="" useFilterList=""
							useFilterListSync="" sortedIconPosition="" sortable="true" sortOrderReverse="" showSortableUseFilter="" focusMode="row"
							rowNumStatusUniqueId="" rowNumStatusResize="" ev:onbeforecolumnmove="" userData1="" preventMultisort="" showSortableImage="true"
							sortEvent="onclick">
							<w2:caption style="" id="caption2" value="this is a grid caption."></w2:caption>
							<w2:header style="" id="header2">
								<w2:row style="" id="row3">
									<w2:column removeBorderStyle="false" width="0" inputType="text" style="height:20px" id="column2"
										value="정류소ID" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="200" inputType="text" style="height:20px" id="column56"
										value="정류소명" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="column1"
										value="정류소형태" blockSelect="false" displayMode="label">
									</w2:column>
								</w2:row>
							</w2:header>
							<w2:gBody style="" id="gBody2">
								<w2:row style="" id="row4">
									<w2:column removeBorderStyle="false" width="161" inputType="text" style="height:20px" id="NODE_ID"
										value="" blockSelect="false" displayMode="label" textAlign="left">
									</w2:column>
									<w2:column removeBorderStyle="false" width="161" inputType="text" style="height:20px" id="NODE_NM"
										value="" blockSelect="false" displayMode="label" textAlign="left">
									</w2:column>
									<w2:column removeBorderStyle="false" width="161" inputType="select" style="height:20px" id="STTN_FCLT_TYPE"
										value="" blockSelect="false" displayMode="label" textAlign="">
									</w2:column>
								</w2:row>
							</w2:gBody>
							<w2:footer id="footer1" style="">
								<w2:row id="row3" style="">
									<w2:column blockSelect="false" colSpan="14" displayMode="label"
										expression="&quot;데이터 개수 : &quot; + COUNT('COMP_ID')" id="column42" inputType="expression" removeBorderStyle="false"
										style="height:20px;" textAlign="left" width="2386">
									</w2:column>
								</w2:row>
							</w2:footer>
						</w2:gridView>
					</xf:group>
				</xf:group><!-- pgm_list end -->
				
				<xf:group id="" class=""></xf:group>
				
				
							<div id="map_MO0203" style="padding:0 !important"  class="bms_box_wrap">
								<ul id="category_map_MO0203" class="category"></ul>
								<xf:group id="brt_div" class="pgm_detail" style="z-index: 10000;position: absolute;right: 52px;margin-top: 8px;margin-right: -49px;width: 140px;height: 399px;">
									<xf:group style="width: 100%; height:100%" id="bit_img">
										<xf:group id="" class="brt_bit" style="background-size: cover; height: 393px; position: relative;"></xf:group>
									</xf:group>
									<xf:group style="" id=""></xf:group>
									<xf:group style="position: absolute;top: 30%;left: 14%;width: 100px;text-align: center;">
										<w2:span label="정류소명" style="color: white;font-size: 12px;" id=""
											ref="data:dlt_BMS_NODE_MST.NODE_NM">
										</w2:span>
									</xf:group>
									<xf:group style="position: absolute; top: 40%; left: 7%; text-align: center; width: 118px;">
										<w2:span label="" style="color: white;font-size: 10px;"
												 id="" ref="data:dlt_BMS_NODE_MST.NODE_ID">
										</w2:span>
									</xf:group>
									<xf:group style="position: absolute; top: 47%; left: 7%;" id="MO0203T0" class="w2tb bit_tb">
									
									</xf:group>
									<!-- <xf:group>
										<w2:span label="NODE_ID" style="color: white;font-size: 14px;text-align: center;" id=""
											ref="data:dlt_BMS_NODE_MST.NODE_ID">
										</w2:span>
									</xf:group> -->
									<xf:group style="" id=""></xf:group>
								</xf:group>
								<xf:group id="routeMap" style="z-index: 10000; position: absolute;background: white;bottom: 0px;left: 20px;">
									<xf:group id="imgDiv" style="background: white;width: 1370px;height: 280px;">
										<xf:group style="" id="STTN_IMG" class="ST003_station"></xf:group>
									</xf:group>
									<!-- <canvas id="canvas" width="1270" height="150"></canvas> -->					
								</xf:group>									
							</div>

			</xf:group><!-- end content -->
		</xf:group><!-- end container -->
	</body>
</html>


