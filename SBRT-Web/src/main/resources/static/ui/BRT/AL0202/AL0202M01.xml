<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare"
	xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<style>
			#chartdiv {
			width: 100%;
			height: 500px;
			}

		</style>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_BRT_OPER_PL_MST" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선명" dataType="text"></w2:column>
						<w2:column id="WAY_ASC_NM" name="상행명" dataType="text"></w2:column>
						<w2:column id="WAY_DESC_NM" name="하행명" dataType="text"></w2:column>
						<w2:column id="ST_STTN_NM" name="기점명" dataType="text"></w2:column>
						<w2:column id="ED_STTN_NM" name="종점명" dataType="text"></w2:column>
						<w2:column id="WAY_ASC_STR" name="상행문구" dataType="text"></w2:column>
						<w2:column id="WAY_DESC_STR" name="하행문구" dataType="text"></w2:column>
						<w2:column id="WAY_YN" name="상하행여부" dataType="text"></w2:column>
						<w2:column id="ROUT_DIV" name="노선구분" dataType="text"></w2:column>
						<w2:column id="OPER_CNT" name="운영횟수" dataType="text"></w2:column>
						<w2:column id="ALLOC_CNT" name="배차횟수" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_OPER_ALLOC_PL_ROUT_CNT" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="CNT" name="개수" dataType="number" defaultValue="0"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataMap baseNode="map" id="dma_search">
					<w2:keyInfo>
						<w2:key id="TYPE" name="name1" dataType="text"></w2:key>
						<w2:key id="CONTENT" name="name2" dataType="text"></w2:key>
						<w2:key id="USE_YN" name="name3" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_result">
					<w2:keyInfo>
						<w2:key id="STATUS" name="STATUS" dataType="text"></w2:key>
						<w2:key id="ICNT" name="입력건수" dataType="text"></w2:key>
						<w2:key id="UCNT" name="수정건수" dataType="text"></w2:key>
						<w2:key id="DCNT" name="삭제건수" dataType="text"></w2:key>
						<w2:key id="TYPE" name="TYPE" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_repRoutItem" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선명" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_BRT_OPER_ALLOC_PL_COR_INFO" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="WAY_DIV" name="상하행구분" dataType="text"></w2:column>
						<w2:column id="ALLOC_NO" name="배차번호" dataType="text"></w2:column>
						<w2:column id="COR_ID" name="코스아이디" dataType="text"></w2:column>
						<w2:column id="COR_NM" name="코스명" dataType="text"></w2:column>
						<w2:column id="COR_SN" name="코스순번" dataType="text"></w2:column>
						<w2:column id="COR_TYPE" name="코스유형" dataType="text"></w2:column>
						<w2:column id="MOVE_TM" name="이동시간" dataType="text"></w2:column>
						<w2:column id="COR_COLOR" name="코스색" dataType="text"></w2:column>
						<w2:column id="ROUT_ID" name="노선ID" dataType="text"></w2:column>
						<w2:column id="ROUT_SN" name="노선순번" dataType="text"></w2:column>
						<w2:column id="REST_TM" name="휴게시간" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선" dataType="text"></w2:column>
						<w2:column id="ROUT_NM" name="노선명" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="WAY_DIV" name="상하행구분" dataType="text"></w2:column>
						<w2:column id="ALLOC_NO" name="배차번호" dataType="text"></w2:column>
						<w2:column id="COR_ID" name="코스아이디" dataType="text"></w2:column>
						<w2:column id="COR_NM" name="코스명" dataType="text"></w2:column>
						<w2:column id="COR_SN" name="코스순번" dataType="text"></w2:column>
						<w2:column id="COR_TYPE" name="코스유형" dataType="text"></w2:column>
						<w2:column id="MOVE_TM" name="이동시간" dataType="text"></w2:column>
						<w2:column id="COR_COLOR" name="코스색" dataType="text"></w2:column>
						<w2:column id="ROUT_ID" name="노선ID" dataType="text"></w2:column>
						<w2:column id="ROUT_SN" name="노선순번" dataType="text"></w2:column>
						<w2:column id="REST_TM" name="휴게시간" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선" dataType="text"></w2:column>
						<w2:column id="ROUT_NM" name="노선명" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_OPER_ALLOC_PL_ROUT_INFO" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="WAY_DIV" name="상하행구분" dataType="text"></w2:column>
						<w2:column id="ALLOC_NO" name="배차번호" dataType="text"></w2:column>
						<w2:column id="OPER_SN" name="운행순번" dataType="text"></w2:column>
						<w2:column id="ROUT_ST_TM" name="노선시작시간" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM" name="노선종료시간" dataType="text"></w2:column>
						<w2:column id="REST_TM" name="휴게시간" dataType="text"></w2:column>
						<w2:column id="ROUT_ID" name="노선ID" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선명" dataType="text"></w2:column>
						<w2:column id="ROUT_NM" name="노선명" dataType="text"></w2:column>
						<w2:column id="COR_ID" name="코스ID" dataType="text"></w2:column>
						<w2:column id="COR_NM" name="코스명" dataType="text"></w2:column>
						<w2:column id="COR_COLOR" name="코스ID" dataType="text"></w2:column>
						<w2:column id="WAY_ASC_NM" name="상행명" dataType="text"></w2:column>
						<w2:column id="WAY_DESC_NM" name="하행명" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList id="dlt_BRT_OPER_PL_ROUT_INFO_ASC" baseNode="list" saveRemovedData="true" repeatNode="map" ev:oncelldatachange="">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선아이디" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="WAY_DIV" name="상하행구분" dataType="text"></w2:column>
						<w2:column id="OPER_SN" name="운행순번" dataType="text"></w2:column>
						<w2:column id="ROUT_ID" name="노선아이디" dataType="text"></w2:column>
						<w2:column id="ROUT_ST_TM" name="노선시작시간" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM" name="노선종료시간" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선명" dataType="text"></w2:column>
						<w2:column id="ROUT_NM" name="노선명" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList id="dlt_BRT_OPER_PL_ROUT_INFO_DESC" baseNode="list" saveRemovedData="true" repeatNode="map" ev:oncelldatachange="">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선아이디" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="WAY_DIV" name="상하행구분" dataType="text"></w2:column>
						<w2:column id="OPER_SN" name="운행순번" dataType="text"></w2:column>
						<w2:column id="ROUT_ID" name="노선아이디" dataType="text"></w2:column>
						<w2:column id="ROUT_ST_TM" name="노선시작시간" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM" name="노선종료시간" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선명" dataType="text"></w2:column>
						<w2:column id="ROUT_NM" name="노선명" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_VIEW_OPER_PL_ROUT_INFO" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="WAY_DIV" name="상하행구분" dataType="text"></w2:column>
						<w2:column id="ALLOC_NO" name="배차번호" dataType="text"></w2:column>
						<w2:column id="INDEX_0"  dataType="text"></w2:column> <w2:column id="COR_ID_0" dataType="text"></w2:column> 
						<w2:column id="INDEX_1"  dataType="text"></w2:column> <w2:column id="COR_ID_1" dataType="text"></w2:column> 
						<w2:column id="INDEX_2"  dataType="text"></w2:column> <w2:column id="COR_ID_2" dataType="text"></w2:column> 
						<w2:column id="INDEX_3"  dataType="text"></w2:column> <w2:column id="COR_ID_3" dataType="text"></w2:column> 
						<w2:column id="INDEX_4"  dataType="text"></w2:column> <w2:column id="COR_ID_4" dataType="text"></w2:column> 
						<w2:column id="INDEX_5"  dataType="text"></w2:column> <w2:column id="COR_ID_5" dataType="text"></w2:column> 
						<w2:column id="INDEX_6"  dataType="text"></w2:column> <w2:column id="COR_ID_6" dataType="text"></w2:column> 
						<w2:column id="INDEX_7"  dataType="text"></w2:column> <w2:column id="COR_ID_7" dataType="text"></w2:column> 
						<w2:column id="INDEX_8"  dataType="text"></w2:column> <w2:column id="COR_ID_8" dataType="text"></w2:column> 
						<w2:column id="INDEX_9"  dataType="text"></w2:column> <w2:column id="COR_ID_9" dataType="text"></w2:column> 
						<w2:column id="INDEX_10" dataType="text"></w2:column> <w2:column id="COR_ID_10" dataType="text"></w2:column>
						<w2:column id="INDEX_11" dataType="text"></w2:column> <w2:column id="COR_ID_11" dataType="text"></w2:column>
						<w2:column id="INDEX_12" dataType="text"></w2:column> <w2:column id="COR_ID_12" dataType="text"></w2:column>
						<w2:column id="INDEX_13" dataType="text"></w2:column> <w2:column id="COR_ID_13" dataType="text"></w2:column>
						<w2:column id="INDEX_14" dataType="text"></w2:column> <w2:column id="COR_ID_14" dataType="text"></w2:column>
						<w2:column id="INDEX_15" dataType="text"></w2:column> <w2:column id="COR_ID_15" dataType="text"></w2:column>
						<w2:column id="INDEX_16" dataType="text"></w2:column> <w2:column id="COR_ID_16" dataType="text"></w2:column>
						<w2:column id="INDEX_17" dataType="text"></w2:column> <w2:column id="COR_ID_17" dataType="text"></w2:column>
						<w2:column id="INDEX_18" dataType="text"></w2:column> <w2:column id="COR_ID_18" dataType="text"></w2:column>
						<w2:column id="INDEX_19" dataType="text"></w2:column> <w2:column id="COR_ID_19" dataType="text"></w2:column>
						<w2:column id="INDEX_20" dataType="text"></w2:column> <w2:column id="COR_ID_20" dataType="text"></w2:column>
						<w2:column id="INDEX_21" dataType="text"></w2:column> <w2:column id="COR_ID_21" dataType="text"></w2:column>
						<w2:column id="INDEX_22" dataType="text"></w2:column> <w2:column id="COR_ID_22" dataType="text"></w2:column>
						<w2:column id="INDEX_23" dataType="text"></w2:column> <w2:column id="COR_ID_23" dataType="text"></w2:column>
						<w2:column id="INDEX_24" dataType="text"></w2:column> <w2:column id="COR_ID_24" dataType="text"></w2:column>
						<w2:column id="INDEX_25" dataType="text"></w2:column> <w2:column id="COR_ID_25" dataType="text"></w2:column>
						<w2:column id="INDEX_26" dataType="text"></w2:column> <w2:column id="COR_ID_26" dataType="text"></w2:column>
						<w2:column id="INDEX_27" dataType="text"></w2:column> <w2:column id="COR_ID_27" dataType="text"></w2:column>
						<w2:column id="INDEX_28" dataType="text"></w2:column> <w2:column id="COR_ID_28" dataType="text"></w2:column>
						<w2:column id="INDEX_29" dataType="text"></w2:column> <w2:column id="COR_ID_29" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_0"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_0"  dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_0" dataType="text"></w2:column> 
						<w2:column id="OPER_INFO_1_1"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_1"  dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_1" dataType="text"></w2:column> 
						<w2:column id="OPER_INFO_1_2"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_2"  dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_2" dataType="text"></w2:column> 
						<w2:column id="OPER_INFO_1_3"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_3"  dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_3" dataType="text"></w2:column> 
						<w2:column id="OPER_INFO_1_4"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_4"  dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_4" dataType="text"></w2:column> 
						<w2:column id="OPER_INFO_1_5"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_5"  dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_5" dataType="text"></w2:column> 
						<w2:column id="OPER_INFO_1_6"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_6"  dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_6" dataType="text"></w2:column> 
						<w2:column id="OPER_INFO_1_7"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_7"  dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_7" dataType="text"></w2:column> 
						<w2:column id="OPER_INFO_1_8"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_8"  dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_8" dataType="text"></w2:column> 
						<w2:column id="OPER_INFO_1_9"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_9"  dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_9" dataType="text"></w2:column> 
						<w2:column id="OPER_INFO_1_10" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_10" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_10" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_11" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_11" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_11" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_12" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_12" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_12" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_13" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_13" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_13" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_14" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_14" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_14" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_15" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_15" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_15" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_16" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_16" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_16" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_17" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_17" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_17" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_18" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_18" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_18" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_19" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_19" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_19" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_20" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_20" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_20" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_21" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_21" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_21" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_22" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_22" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_22" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_23" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_23" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_23" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_24" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_24" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_24" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_25" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_25" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_25" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_26" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_26" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_26" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_27" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_27" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_27" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_28" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_28" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_28" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_29" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_29" dataType="text"></w2:column>  <w2:column id="OPER_INFO_3_29" dataType="text"></w2:column>
						<w2:column id="empty_1_0"  dataType="text"></w2:column> <w2:column id="empty_2_0"  dataType="text"></w2:column>  <w2:column id="empty_3_0" dataType="text"></w2:column> 
						<w2:column id="empty_1_1"  dataType="text"></w2:column> <w2:column id="empty_2_1"  dataType="text"></w2:column>  <w2:column id="empty_3_1" dataType="text"></w2:column> 
						<w2:column id="empty_1_2"  dataType="text"></w2:column> <w2:column id="empty_2_2"  dataType="text"></w2:column>  <w2:column id="empty_3_2" dataType="text"></w2:column> 
						<w2:column id="empty_1_3"  dataType="text"></w2:column> <w2:column id="empty_2_3"  dataType="text"></w2:column>  <w2:column id="empty_3_3" dataType="text"></w2:column> 
						<w2:column id="empty_1_4"  dataType="text"></w2:column> <w2:column id="empty_2_4"  dataType="text"></w2:column>  <w2:column id="empty_3_4" dataType="text"></w2:column> 
						<w2:column id="empty_1_5"  dataType="text"></w2:column> <w2:column id="empty_2_5"  dataType="text"></w2:column>  <w2:column id="empty_3_5" dataType="text"></w2:column> 
						<w2:column id="empty_1_6"  dataType="text"></w2:column> <w2:column id="empty_2_6"  dataType="text"></w2:column>  <w2:column id="empty_3_6" dataType="text"></w2:column> 
						<w2:column id="empty_1_7"  dataType="text"></w2:column> <w2:column id="empty_2_7"  dataType="text"></w2:column>  <w2:column id="empty_3_7" dataType="text"></w2:column> 
						<w2:column id="empty_1_8"  dataType="text"></w2:column> <w2:column id="empty_2_8"  dataType="text"></w2:column>  <w2:column id="empty_3_8" dataType="text"></w2:column> 
						<w2:column id="empty_1_9"  dataType="text"></w2:column> <w2:column id="empty_2_9"  dataType="text"></w2:column>  <w2:column id="empty_3_9" dataType="text"></w2:column> 
						<w2:column id="empty_1_10" dataType="text"></w2:column> <w2:column id="empty_2_10" dataType="text"></w2:column>  <w2:column id="empty_3_10" dataType="text"></w2:column>
						<w2:column id="empty_1_11" dataType="text"></w2:column> <w2:column id="empty_2_11" dataType="text"></w2:column>  <w2:column id="empty_3_11" dataType="text"></w2:column>
						<w2:column id="empty_1_12" dataType="text"></w2:column> <w2:column id="empty_2_12" dataType="text"></w2:column>  <w2:column id="empty_3_12" dataType="text"></w2:column>
						<w2:column id="empty_1_13" dataType="text"></w2:column> <w2:column id="empty_2_13" dataType="text"></w2:column>  <w2:column id="empty_3_13" dataType="text"></w2:column>
						<w2:column id="empty_1_14" dataType="text"></w2:column> <w2:column id="empty_2_14" dataType="text"></w2:column>  <w2:column id="empty_3_14" dataType="text"></w2:column>
						<w2:column id="empty_1_15" dataType="text"></w2:column> <w2:column id="empty_2_15" dataType="text"></w2:column>  <w2:column id="empty_3_15" dataType="text"></w2:column>
						<w2:column id="empty_1_16" dataType="text"></w2:column> <w2:column id="empty_2_16" dataType="text"></w2:column>  <w2:column id="empty_3_16" dataType="text"></w2:column>
						<w2:column id="empty_1_17" dataType="text"></w2:column> <w2:column id="empty_2_17" dataType="text"></w2:column>  <w2:column id="empty_3_17" dataType="text"></w2:column>
						<w2:column id="empty_1_18" dataType="text"></w2:column> <w2:column id="empty_2_18" dataType="text"></w2:column>  <w2:column id="empty_3_18" dataType="text"></w2:column>
						<w2:column id="empty_1_19" dataType="text"></w2:column> <w2:column id="empty_2_19" dataType="text"></w2:column>  <w2:column id="empty_3_19" dataType="text"></w2:column>
						<w2:column id="empty_1_20" dataType="text"></w2:column> <w2:column id="empty_2_20" dataType="text"></w2:column>  <w2:column id="empty_3_20" dataType="text"></w2:column>
						<w2:column id="empty_1_21" dataType="text"></w2:column> <w2:column id="empty_2_21" dataType="text"></w2:column>  <w2:column id="empty_3_21" dataType="text"></w2:column>
						<w2:column id="empty_1_22" dataType="text"></w2:column> <w2:column id="empty_2_22" dataType="text"></w2:column>  <w2:column id="empty_3_22" dataType="text"></w2:column>
						<w2:column id="empty_1_23" dataType="text"></w2:column> <w2:column id="empty_2_23" dataType="text"></w2:column>  <w2:column id="empty_3_23" dataType="text"></w2:column>
						<w2:column id="empty_1_24" dataType="text"></w2:column> <w2:column id="empty_2_24" dataType="text"></w2:column>  <w2:column id="empty_3_24" dataType="text"></w2:column>
						<w2:column id="empty_1_25" dataType="text"></w2:column> <w2:column id="empty_2_25" dataType="text"></w2:column>  <w2:column id="empty_3_25" dataType="text"></w2:column>
						<w2:column id="empty_1_26" dataType="text"></w2:column> <w2:column id="empty_2_26" dataType="text"></w2:column>  <w2:column id="empty_3_26" dataType="text"></w2:column>
						<w2:column id="empty_1_27" dataType="text"></w2:column> <w2:column id="empty_2_27" dataType="text"></w2:column>  <w2:column id="empty_3_27" dataType="text"></w2:column>
						<w2:column id="empty_1_28" dataType="text"></w2:column> <w2:column id="empty_2_28" dataType="text"></w2:column>  <w2:column id="empty_3_28" dataType="text"></w2:column>
						<w2:column id="empty_1_29" dataType="text"></w2:column> <w2:column id="empty_2_29" dataType="text"></w2:column>  <w2:column id="empty_3_29" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_EXL_OPER_PL_ROUT_INFO" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="WAY_DIV" name="상하행구분" dataType="text"></w2:column>
						<w2:column id="ALLOC_NO" name="배차번호" dataType="text"></w2:column>
						<w2:column id="INDEX_0"  dataType="text"></w2:column> <w2:column id="COR_ID_0" dataType="text"></w2:column>
						<w2:column id="INDEX_1"  dataType="text"></w2:column> <w2:column id="COR_ID_1" dataType="text"></w2:column>
						<w2:column id="INDEX_2"  dataType="text"></w2:column> <w2:column id="COR_ID_2" dataType="text"></w2:column>
						<w2:column id="INDEX_3"  dataType="text"></w2:column> <w2:column id="COR_ID_3" dataType="text"></w2:column>
						<w2:column id="INDEX_4"  dataType="text"></w2:column> <w2:column id="COR_ID_4" dataType="text"></w2:column>
						<w2:column id="INDEX_5"  dataType="text"></w2:column> <w2:column id="COR_ID_5" dataType="text"></w2:column>
						<w2:column id="INDEX_6"  dataType="text"></w2:column> <w2:column id="COR_ID_6" dataType="text"></w2:column>
						<w2:column id="INDEX_7"  dataType="text"></w2:column> <w2:column id="COR_ID_7" dataType="text"></w2:column>
						<w2:column id="INDEX_8"  dataType="text"></w2:column> <w2:column id="COR_ID_8" dataType="text"></w2:column>
						<w2:column id="INDEX_9"  dataType="text"></w2:column> <w2:column id="COR_ID_9" dataType="text"></w2:column>
						<w2:column id="INDEX_10" dataType="text"></w2:column> <w2:column id="COR_ID_10" dataType="text"></w2:column>
						<w2:column id="INDEX_11" dataType="text"></w2:column> <w2:column id="COR_ID_11" dataType="text"></w2:column>
						<w2:column id="INDEX_12" dataType="text"></w2:column> <w2:column id="COR_ID_12" dataType="text"></w2:column>
						<w2:column id="INDEX_13" dataType="text"></w2:column> <w2:column id="COR_ID_13" dataType="text"></w2:column>
						<w2:column id="INDEX_14" dataType="text"></w2:column> <w2:column id="COR_ID_14" dataType="text"></w2:column>
						<w2:column id="INDEX_15" dataType="text"></w2:column> <w2:column id="COR_ID_15" dataType="text"></w2:column>
						<w2:column id="INDEX_16" dataType="text"></w2:column> <w2:column id="COR_ID_16" dataType="text"></w2:column>
						<w2:column id="INDEX_17" dataType="text"></w2:column> <w2:column id="COR_ID_17" dataType="text"></w2:column>
						<w2:column id="INDEX_18" dataType="text"></w2:column> <w2:column id="COR_ID_18" dataType="text"></w2:column>
						<w2:column id="INDEX_19" dataType="text"></w2:column> <w2:column id="COR_ID_19" dataType="text"></w2:column>
						<w2:column id="INDEX_20" dataType="text"></w2:column> <w2:column id="COR_ID_20" dataType="text"></w2:column>
						<w2:column id="INDEX_21" dataType="text"></w2:column> <w2:column id="COR_ID_21" dataType="text"></w2:column>
						<w2:column id="INDEX_22" dataType="text"></w2:column> <w2:column id="COR_ID_22" dataType="text"></w2:column>
						<w2:column id="INDEX_23" dataType="text"></w2:column> <w2:column id="COR_ID_23" dataType="text"></w2:column>
						<w2:column id="INDEX_24" dataType="text"></w2:column> <w2:column id="COR_ID_24" dataType="text"></w2:column>
						<w2:column id="INDEX_25" dataType="text"></w2:column> <w2:column id="COR_ID_25" dataType="text"></w2:column>
						<w2:column id="INDEX_26" dataType="text"></w2:column> <w2:column id="COR_ID_26" dataType="text"></w2:column>
						<w2:column id="INDEX_27" dataType="text"></w2:column> <w2:column id="COR_ID_27" dataType="text"></w2:column>
						<w2:column id="INDEX_28" dataType="text"></w2:column> <w2:column id="COR_ID_28" dataType="text"></w2:column>
						<w2:column id="INDEX_29" dataType="text"></w2:column> <w2:column id="COR_ID_29" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_0"  dataType="text"></w2:column> <w2:column id="OPER_SN_0" dataType="text"></w2:column> <w2:column id="ROUT_NM_0" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_1"  dataType="text"></w2:column> <w2:column id="OPER_SN_1" dataType="text"></w2:column> <w2:column id="ROUT_NM_1" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_2"  dataType="text"></w2:column> <w2:column id="OPER_SN_2" dataType="text"></w2:column> <w2:column id="ROUT_NM_2" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_3"  dataType="text"></w2:column> <w2:column id="OPER_SN_3" dataType="text"></w2:column> <w2:column id="ROUT_NM_3" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_4"  dataType="text"></w2:column> <w2:column id="OPER_SN_4" dataType="text"></w2:column> <w2:column id="ROUT_NM_4" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_5"  dataType="text"></w2:column> <w2:column id="OPER_SN_5" dataType="text"></w2:column> <w2:column id="ROUT_NM_5" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_6"  dataType="text"></w2:column> <w2:column id="OPER_SN_6" dataType="text"></w2:column> <w2:column id="ROUT_NM_6" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_7"  dataType="text"></w2:column> <w2:column id="OPER_SN_7" dataType="text"></w2:column> <w2:column id="ROUT_NM_7" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_8"  dataType="text"></w2:column> <w2:column id="OPER_SN_8" dataType="text"></w2:column> <w2:column id="ROUT_NM_8" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_9"  dataType="text"></w2:column> <w2:column id="OPER_SN_9" dataType="text"></w2:column> <w2:column id="ROUT_NM_9" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_10" dataType="text"></w2:column> <w2:column id="OPER_SN_10" dataType="text"></w2:column> <w2:column id="ROUT_NM_10" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_11" dataType="text"></w2:column> <w2:column id="OPER_SN_11" dataType="text"></w2:column> <w2:column id="ROUT_NM_11" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_12" dataType="text"></w2:column> <w2:column id="OPER_SN_12" dataType="text"></w2:column> <w2:column id="ROUT_NM_12" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_13" dataType="text"></w2:column> <w2:column id="OPER_SN_13" dataType="text"></w2:column> <w2:column id="ROUT_NM_13" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_14" dataType="text"></w2:column> <w2:column id="OPER_SN_14" dataType="text"></w2:column> <w2:column id="ROUT_NM_14" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_15" dataType="text"></w2:column> <w2:column id="OPER_SN_15" dataType="text"></w2:column> <w2:column id="ROUT_NM_15" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_16" dataType="text"></w2:column> <w2:column id="OPER_SN_16" dataType="text"></w2:column> <w2:column id="ROUT_NM_16" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_17" dataType="text"></w2:column> <w2:column id="OPER_SN_17" dataType="text"></w2:column> <w2:column id="ROUT_NM_17" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_18" dataType="text"></w2:column> <w2:column id="OPER_SN_18" dataType="text"></w2:column> <w2:column id="ROUT_NM_18" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_19" dataType="text"></w2:column> <w2:column id="OPER_SN_19" dataType="text"></w2:column> <w2:column id="ROUT_NM_19" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_20" dataType="text"></w2:column> <w2:column id="OPER_SN_20" dataType="text"></w2:column> <w2:column id="ROUT_NM_20" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_21" dataType="text"></w2:column> <w2:column id="OPER_SN_21" dataType="text"></w2:column> <w2:column id="ROUT_NM_21" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_22" dataType="text"></w2:column> <w2:column id="OPER_SN_22" dataType="text"></w2:column> <w2:column id="ROUT_NM_22" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_23" dataType="text"></w2:column> <w2:column id="OPER_SN_23" dataType="text"></w2:column> <w2:column id="ROUT_NM_23" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_24" dataType="text"></w2:column> <w2:column id="OPER_SN_24" dataType="text"></w2:column> <w2:column id="ROUT_NM_24" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_25" dataType="text"></w2:column> <w2:column id="OPER_SN_25" dataType="text"></w2:column> <w2:column id="ROUT_NM_25" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_26" dataType="text"></w2:column> <w2:column id="OPER_SN_26" dataType="text"></w2:column> <w2:column id="ROUT_NM_26" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_27" dataType="text"></w2:column> <w2:column id="OPER_SN_27" dataType="text"></w2:column> <w2:column id="ROUT_NM_27" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_28" dataType="text"></w2:column> <w2:column id="OPER_SN_28" dataType="text"></w2:column> <w2:column id="ROUT_NM_28" dataType="text"></w2:column>
						<w2:column id="ROUT_ID_29" dataType="text"></w2:column> <w2:column id="OPER_SN_29" dataType="text"></w2:column> <w2:column id="ROUT_NM_29" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_0"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_0"  dataType="text"></w2:column>  <w2:column id="REST_TM_0" dataType="text"></w2:column> 
						<w2:column id="ROUT_ED_TM_1"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_1"  dataType="text"></w2:column>  <w2:column id="REST_TM_1" dataType="text"></w2:column> 
						<w2:column id="ROUT_ED_TM_2"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_2"  dataType="text"></w2:column>  <w2:column id="REST_TM_2" dataType="text"></w2:column> 
						<w2:column id="ROUT_ED_TM_3"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_3"  dataType="text"></w2:column>  <w2:column id="REST_TM_3" dataType="text"></w2:column> 
						<w2:column id="ROUT_ED_TM_4"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_4"  dataType="text"></w2:column>  <w2:column id="REST_TM_4" dataType="text"></w2:column> 
						<w2:column id="ROUT_ED_TM_5"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_5"  dataType="text"></w2:column>  <w2:column id="REST_TM_5" dataType="text"></w2:column> 
						<w2:column id="ROUT_ED_TM_6"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_6"  dataType="text"></w2:column>  <w2:column id="REST_TM_6" dataType="text"></w2:column> 
						<w2:column id="ROUT_ED_TM_7"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_7"  dataType="text"></w2:column>  <w2:column id="REST_TM_7" dataType="text"></w2:column> 
						<w2:column id="ROUT_ED_TM_8"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_8"  dataType="text"></w2:column>  <w2:column id="REST_TM_8" dataType="text"></w2:column> 
						<w2:column id="ROUT_ED_TM_9"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_9"  dataType="text"></w2:column>  <w2:column id="REST_TM_9" dataType="text"></w2:column> 
						<w2:column id="ROUT_ED_TM_10" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_10" dataType="text"></w2:column>  <w2:column id="REST_TM_10" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_11" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_11" dataType="text"></w2:column>  <w2:column id="REST_TM_11" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_12" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_12" dataType="text"></w2:column>  <w2:column id="REST_TM_12" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_13" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_13" dataType="text"></w2:column>  <w2:column id="REST_TM_13" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_14" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_14" dataType="text"></w2:column>  <w2:column id="REST_TM_14" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_15" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_15" dataType="text"></w2:column>  <w2:column id="REST_TM_15" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_16" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_16" dataType="text"></w2:column>  <w2:column id="REST_TM_16" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_17" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_17" dataType="text"></w2:column>  <w2:column id="REST_TM_17" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_18" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_18" dataType="text"></w2:column>  <w2:column id="REST_TM_18" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_19" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_19" dataType="text"></w2:column>  <w2:column id="REST_TM_19" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_20" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_20" dataType="text"></w2:column>  <w2:column id="REST_TM_20" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_21" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_21" dataType="text"></w2:column>  <w2:column id="REST_TM_21" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_22" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_22" dataType="text"></w2:column>  <w2:column id="REST_TM_22" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_23" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_23" dataType="text"></w2:column>  <w2:column id="REST_TM_23" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_24" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_24" dataType="text"></w2:column>  <w2:column id="REST_TM_24" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_25" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_25" dataType="text"></w2:column>  <w2:column id="REST_TM_25" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_26" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_26" dataType="text"></w2:column>  <w2:column id="REST_TM_26" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_27" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_27" dataType="text"></w2:column>  <w2:column id="REST_TM_27" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_28" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_28" dataType="text"></w2:column>  <w2:column id="REST_TM_28" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_29" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_29" dataType="text"></w2:column>  <w2:column id="REST_TM_29" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataMap baseNode="map" id="dma_sub_search">
					<w2:keyInfo>
						<w2:key id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:key>
						<w2:key id="DAY_DIV" name="요일구분" dataType="text"></w2:key>
						<w2:key id="WAY_DIV" name="상하행구분" dataType="text"></w2:key>
						<w2:key id="OPER_SN_LIST" name="운행순번목록" dataType="text"></w2:key>
						<w2:key id="BRT_TARGET_COR_LIST" name="코스목록" dataType="text"></w2:key>
						<w2:key id="COR_ID" name="코스ID" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_save">
					<w2:keyInfo>
						<w2:key id="TYPE" name="유형" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList id="dlt_COR_CNT" baseNode="list" saveRemovedData="true" repeatNode="map" ev:oncelldatachange="">
					<w2:columnInfo>
						<w2:column id="COR_ID" name="코스아이디" dataType="text"></w2:column>
						<w2:column id="CNT" name="노선카운트" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>
			<xf:submission id="sub_AL0202G0R0" ref="data:json,dma_search" target="data:json,dlt_BRT_OPER_PL_MST"
				action="/AL/AL0202G0R0" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
				customHandler="" mode="asynchronous" processMsg="조회 중입니다..." ev:submit="" ev:submitdone="scwin.sub_AL0202G0R0_submitdone"
				ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_AL0202SHI0" ref="" target="data:json,dlt_repRoutItem" action="/repRout/selectRepRoutItem" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_AL0202G1R0" ref="data:json,dma_sub_search" target='data:json,[{"id":"dlt_OPER_ALLOC_PL_ROUT_CNT"},{"id":"dlt_OPER_ALLOC_PL_ROUT_INFO"}]'
				action="/AL/AL0202G1R0" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
				customHandler="" mode="asynchronous" processMsg="조회 중입니다..." ev:submit="" ev:submitdone="scwin.sub_AL0202G1R0_submitdone" ev:submiterror=""
				abortTrigger="">
			</xf:submission>
			<!-- <xf:submission id="sub_AL0202G1CNT" ref="data:json,dma_sub_search" target="data:json,dlt_OPER_ALLOC_PL_ROUT_CNT"
				action="/AL/AL0202G1CNT" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
				customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="scwin.sub_AL0202G1CNT_submitdone" ev:submiterror=""
				abortTrigger="">
			</xf:submission> -->
			
			<xf:submission id="sub_AL0202G1S0" ref='data:json,[{"id":"dlt_OPER_ALLOC_PL_ROUT_INFO","action":"modified"},{"id":"dlt_BRT_OPER_ALLOC_PL_COR_INFO","action":"modified"}
													,{"id":"dlt_BRT_OPER_PL_MST","action":"modified"},dma_save]' target="data:json,dma_result"
				action="/al/AL0202G1S0" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="저장중 입니다..."
				ev:submit="" ev:submitdone="scwin.sub_AL0202G1S0_submitdone" ev:submiterror="">
			</xf:submission>
			
			<xf:submission id="sub_operPlanCourseList" ref='data:json,dma_sub_search' target="data:json,dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO"
				action="/operPlan/selectOperAllocPlanCourseList" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="저장중 입니다..."
				ev:submit="" ev:submitdone="scwin.sub_operPlanCourseList_submitdone" ev:submiterror="">
			</xf:submission>
			
			<xf:submission id="sub_operPlanList" ref='data:json,dma_sub_search' target='data:json,[{"id":"dlt_BRT_OPER_PL_ROUT_INFO_ASC"},{"id":"dlt_BRT_OPER_PL_ROUT_INFO_DESC"}]' action="/operPlan/selectOperPlanRout2" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_selectCorCnt" ref='' target='data:json,dlt_COR_CNT' action="/AL/selectCorCnt" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<!-- <xf:submission id="sub_operPlanList" ref='data:json,dma_sub_search' target='data:json,[{"id":"dlt_BRT_OPER_PL_ROUT_INFO_ASC"},{"id":"dlt_BRT_OPER_PL_ROUT_INFO_DESC"}]' action="/operPlan/selectOperPlanRout2" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission> -->
	
		</xf:model>

	<style>
		<!-- .AL0202G0 thead tr th nobr {
			word-wrap: break-word;
			white-space : normal;
			padding: 0px;
		} -->
		<!-- .AL0202G0 tbody tr td nobr {
			word-wrap: break-word;
			white-space : normal;
			padding: 0px 5px 0px 5px;
		} -->
		
		.AL0202G1 tbody tr th nobr {
			word-wrap: break-word;
			white-space : normal;
			padding: 0px;
		}
		
		.WAY_DIV nobr {
			word-wrap: break-word;
			white-space : normal;
			padding: 0px;
		}
		
	</style>
	
	<script type="text/javascript" lazy="false"><![CDATA[

	var GRID_MAX = 30;
	var autoOptions = [];
	var oldAllocCnt;
	var oldOperCnt;
	var g_LEAST_REST_TM = "00:10";
	var copyViewIndex = -1;
	scwin.onpageload = function() {		
		autoOptions = {
			Main : {
				grid : AL0202G0,
				srchSbm : sub_AL0202G0R0,
				srchGrp : pgm_header,
				keyColumn : "REP_ROUT_ID, DAY_DIV",
				name : "배차편성 목록",
				undo : false //검색시 undo 동작 하지 않게 함 undo시 머지가 깨져서 undo 동작하면 안됨
			},
			Sub1 : { grid : AL0202G3, 
				cnlGridCb : scwin.cnlGridCb,
				exlGrid : AL0202G2,
				srchSbm : sub_AL0202G1R0, 
				/*srchGrp : pgm_subList,*/ 
				savSbm : sub_AL0202G1S0,
				name :  "배차편성 상세",
				undo : false //검색시 undo 동작 하지 않게 함 undo시 머지가 깨져서 undo 동작하면 안됨
			}
		};
		var mainOptions = {
			ADD: {disp:"hide"}, DEL:{disp:"hide"}, SAVE : scwin.btn_save_onclick
		};
		var codeOptions = [{code : "DAY_DIV",compID : "AL0202G0:DAY_DIV"},{code : "WAY_DIV",compID : "AL0202G1:WAY_DIV"}];
		
		com.setMainBtn2(wfm_mainBtn, gcm.DISP_TYPE.DUAL_GRID2, autoOptions, mainOptions, codeOptions);
		var mainSrhOptions = {
		};		
		com.setMainSrhBtn(wfm_mainSearchBtn, gcm.DISP_TYPE.DUAL_GRID2, autoOptions, mainSrhOptions, codeOptions);
		var subOptions = {
			
			SAVE:[{cbFnc:scwin.btn_init,nm:"초기화",class:"autoApply"},
				{cbFnc:scwin.btn_sub_sel_mult_course,nm:"배차 코스 선택",class:"search"},
				{cbFnc:scwin.btn_reInstall,nm:"재구성",class:"autoApply"},
				{cbFnc:scwin.btn_add_cell,nm:"추가",class:"add"},
				{cbFnc:scwin.btn_del_cell,nm:"셀 삭제",class:"del"}
			]
			//SETTING:{cbFnc:scwin.popUp_chart,nm:"배차 시각화",class:"setting"}
		};
		com.setSubBtn2(wfm_subBtn, autoOptions, subOptions);

		com.setCommonDtl(codeOptions, function() {
			com.searchGrid(AL0202G0, sub_AL0202G0R0);
		});
		com.executeSubmission(sub_AL0202SHI0);
		com.executeSubmission(sub_selectCorCnt);
	};

	scwin.onpageunload = function() {

	};
	
	//팝업 차트
	/*scwin.popUp_chart = function(){
		var jsonData = dlt_OPER_ALLOC_PL_ROUT_INFO.getAllJSON();
		
		var data = { jsonData: jsonData,callbackFn : "" };
		 var options = { id : "allocChart",
         				width : "1800px",
         				height : "900px",
                         popupName : "배차 시각화", 
                         modal : true};
		
		com.openPopup("/cm/common/popUpAllocChart.xml", options, data);
	}*/

	scwin.btn_save_onclick = function(){
		var idx = dlt_OPER_ALLOC_PL_ROUT_INFO.getModifiedData().length;
		if(idx>0){
			var yesno_str = "배차편성 상세가 데이터가 저장됩니다. \n 진행하시겠습니까?";
			
			com.confirm(yesno_str, function(rtn) {
				if (rtn) {
					com.executeSubmission(sub_AL0202G1S0);
				}
			});
		}
	};

	scwin.sub_AL0202G0R0_submitdone = function(e) {
		AL0202G0.setFocusedCell(0, "DAY_DIV", true);	
	};
	
	scwin.sub_AL0202G1S0_submitdone = function(e) {
		//ST_WAY.setDisabled(true);
	};
	
	scwin.sub_operPlanCourseList_submitdone = function(e) {
		scwin.courseDtlToCourse();
	};
	
	scwin.courseDtlToCourse = function(){
		
		dlt_BRT_OPER_ALLOC_PL_COR_INFO.removeAll();
		var oldroutSn = -1;
		for(var i = 0; i < dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.getRowCount(); i++){
			var routSn = dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.getCellData(i, "ROUT_SN");
			if(oldroutSn==-1||oldroutSn>=routSn){
				var rowIndex = dlt_BRT_OPER_ALLOC_PL_COR_INFO.insertRow();
				dlt_BRT_OPER_ALLOC_PL_COR_INFO.setRowJSON(rowIndex, dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.getRowJSON(i), true);
				dlt_BRT_OPER_ALLOC_PL_COR_INFO.setCellData(rowIndex, "COR_SN", rowIndex+1);
			}
			oldroutSn = routSn;
		}
	}

	scwin.AL0202G0_onrowindexchange = function(row, oldRow) {
		dlt_OPER_ALLOC_PL_ROUT_INFO.removeAll();
		dlt_OPER_ALLOC_PL_ROUT_CNT.removeAll();
		dlt_VIEW_OPER_PL_ROUT_INFO.removeAll();
		dlt_EXL_OPER_PL_ROUT_INFO.removeAll();
		dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.removeAll();
		
		ALLOC_CNT.setValue(dlt_BRT_OPER_PL_MST.getCellData(AL0202G0.getFocusedRowIndex(), "ALLOC_CNT"));
		
		
		OPER_CNT.setValue(dlt_BRT_OPER_PL_MST.getCellData(AL0202G0.getFocusedRowIndex(), "OPER_CNT"));

		
		
		var focusOption = {keyMap : dma_sub_search, keyMapColumn : "REP_ROUT_ID,DAY_DIV"};
		com.changeDualGrid(AL0202G0, AL0202G3, sub_AL0202G1S0,
					sub_AL0202G1R0, focusOption , row, oldRow, "배차순위 상세");
		com.executeSubmission(sub_operPlanList);
		com.executeSubmission(sub_operPlanCourseList);
	};
	
	scwin.sub_AL0202G1R0_submitdone = function(e) {
		var wayAscNm = dlt_BRT_OPER_PL_MST.getCellData(AL0202G0.getFocusedRowIndex(), "WAY_ASC_NM");
		if(com.isEmpty(wayAscNm))wayAscNm = "상행";
		var wayDescNm = dlt_BRT_OPER_PL_MST.getCellData(AL0202G0.getFocusedRowIndex(), "WAY_DESC_NM");
		if(com.isEmpty(wayDescNm))wayDescNm = "하행";
		
		/*
		ST_WAY.removeAll();
		ST_WAY.addItem("WD001", wayAscNm, 0);
		ST_WAY.addItem("WD002", wayDescNm, 1);
		if(dlt_OPER_ALLOC_PL_ROUT_INFO.getRowCount()==0){
			ST_WAY.setDisabled(false);
			ST_WAY.setSelectedIndex(0);
		}
		else {
			var wayDiv = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(0, "WAY_DIV");
			ST_WAY.setDisabled(true);
			if(wayDiv=='WD001')
				ST_WAY.setSelectedIndex(0);
			else
				ST_WAY.setSelectedIndex(1);
		}
		*/
		
		scwin.setGridExcelInfo(); //엑셀용 화면 및 데이터 구성
		scwin.setGridViewInfo(); //그리드 화면 및 데이터 구성
		oldAllocCnt = ALLOC_CNT.getValue();
		oldOperCnt = OPER_CNT.getValue();
	};

	scwin.cnlGridCb = function() {
		scwin.setGridViewInfo();
	}

	scwin.viewColumnIndex = function(colId){
		var colViewIndex = Number(colId.substring(colId.lastIndexOf("_")+1));
		return colViewIndex;
	}
	
	scwin.getOperAllocIndexByView = function(row,colId){
		var colViewIndex = scwin.viewColumnIndex(colId);
		return dlt_VIEW_OPER_PL_ROUT_INFO.getCellData(row, "INDEX_"+colViewIndex);
	}
	
	scwin.getOperAllocIndexByView2 = function(row,colViewIndex){
		return dlt_VIEW_OPER_PL_ROUT_INFO.getCellData(row, "INDEX_"+colViewIndex);
	}
	
	scwin.setOperAllocCellDataByView = function(index, viewColumn, column, value){
		var rIndex = scwin.getOperAllocIndexByView(index, viewColumn);
		if(rIndex<dlt_OPER_ALLOC_PL_ROUT_INFO.getRowCount()){
			dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(rIndex,column, value);
		}
		else{
			rIndex = dlt_OPER_ALLOC_PL_ROUT_INFO.insertRow();
			dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(rIndex,column, value);
		}
	}
	
	scwin.getOperAllocCellDataByView = function(index, viewColumn, column){
		var rIndex = scwin.getOperAllocIndexByView(index, viewColumn);
		return dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rIndex, column);
	}
	
	scwin.setOperAllocCellData= function(index, column, value){
		if(index < dlt_OPER_ALLOC_PL_ROUT_INFO.getRowCount()){
			dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(index,column, value);
		}
		else{
			index = dlt_OPER_ALLOC_PL_ROUT_INFO.insertRow();
			dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(index,column, value);
		}
	}
	
	scwin.getOperAllocCellData = function(index, column){
		return dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, column);
	}
	
	scwin.setOperAllocRowJsonData = function(index, rowData){
		if(index<dlt_OPER_ALLOC_PL_ROUT_INFO.getRowCount()){
			dlt_OPER_ALLOC_PL_ROUT_INFO.setRowJSON(index, rowData, true);
		}
		else{
			index = dlt_OPER_ALLOC_PL_ROUT_INFO.insertRow();
			dlt_OPER_ALLOC_PL_ROUT_INFO.setRowJSON(index, rowData, true);
		}
	}
	
	scwin.insertOperAlloc= function(index, rowData){
		if(index < dlt_OPER_ALLOC_PL_ROUT_INFO.getRowCount()){
			index = dlt_OPER_ALLOC_PL_ROUT_INFO.insertRow(index);
			dlt_OPER_ALLOC_PL_ROUT_INFO.setRowJSON(index, rowData, true);
		}
		else{
			index = dlt_OPER_ALLOC_PL_ROUT_INFO.insertRow();
			dlt_OPER_ALLOC_PL_ROUT_INFO.setRowJSON(index, rowData, true);
		}
	}
	
	scwin.delOperAlloc= function(index){
		dlt_OPER_ALLOC_PL_ROUT_INFO.removeRow(index);
	}
	
	scwin.getOperAllocRowJsonData = function(index){
		return dlt_OPER_ALLOC_PL_ROUT_INFO.getRowJSON(index);
	}
	
	scwin.insertCorDtl = function(index, rowData){
		if(index < dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.getRowCount()){
			index = dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.insertRow(index);
			dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.setRowJSON(index, rowData, true);
		}
		else{
			index = dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.insertRow();
			dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.setRowJSON(index, rowData, true);
		}
	}
	
	scwin.setCorDtlCellData= function(index, column, value){
		if(index<dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.getRowCount()){
			dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.setCellData(index,column, value);
		}
		else{
			index = dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.insertRow();
			dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.setCellData(index,column, value);
		}
	}

	scwin.setCorDtlRowJsonData = function(index, rowData){
		if(index<dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.getRowCount()){
			dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.setRowJSON(index, rowData, true);
		}
		else{
			index = dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.insertRow();
			dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.setRowJSON(index, rowData, true);
		}
	}
	
	scwin.getCorDtlRowJsonData = function(index){
		return dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.getRowJSON(index);
	}
	
	scwin.getCorDtlCellData = function(index,column){
		return dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.getCellData(index, column);
	}
	
	scwin.getFirstCorDtlByAllocIndex = function(allocNo){
		for(var i = 0; i < dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.getRowCount(); i++ ){
			if(dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.getCellData(i, "ALLOC_NO")==allocNo){
				return dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.getAllJSON()[i];
			}
		}
		return null;
	}
	
	scwin.getAllocCntData = function(index){
		return dlt_OPER_ALLOC_PL_ROUT_CNT.getCellData(index, "CNT");
	}
	
	scwin.setAllocCntData= function(index, value){
		
		var oldCnt = dlt_OPER_ALLOC_PL_ROUT_CNT.getCellData(index, "CNT")
		if(value<oldCnt){
			var delData = new Array();
			var data = dlt_OPER_ALLOC_PL_ROUT_INFO.getColData("ALLOC_NO")
			var i = 0;
			for(var j = 0; j< data.length; j++){
				if(data[j] == index+1){
					if(i>=value)delData.push(j);
					i++;
				}
			}
			for(var i = delData.length-1; i >= 0; i--){
				dlt_OPER_ALLOC_PL_ROUT_INFO.removeRow(delData[i]);
				dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.removeRow(delData[i]);
			}	
		}
		
		if(index < dlt_OPER_ALLOC_PL_ROUT_CNT.getRowCount()){
			dlt_OPER_ALLOC_PL_ROUT_CNT.setCellData(index, "CNT", value);
		}
		else{
			index = dlt_OPER_ALLOC_PL_ROUT_CNT.insertRow();
			dlt_OPER_ALLOC_PL_ROUT_CNT.setCellData(index, "CNT", value);
		}
	}

	scwin.setViewCellDataByFocus = function(index, focusedColumnID, viewColumn, value){
		var colViewIndex = scwin.viewColumnIndex(focusedColumnID);
		dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(index, viewColumn+'_'+colViewIndex, value);
	}
	
	scwin.delViewCellDataByFocus = function(index, focusedColumnID){
		var colViewIndex = scwin.viewColumnIndex(focusedColumnID);
		dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(index, 'OPER_INFO_1_'+colViewIndex, '');
		dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(index, 'OPER_INFO_2_'+colViewIndex, '');
		dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(index, 'OPER_INFO_3_'+colViewIndex, '');
	}
	
	scwin.getViewCellDataByFocus = function(index, focusedColumnID, viewColumn){
		var colViewIndex = scwin.viewColumnIndex(focusedColumnID);
		return dlt_VIEW_OPER_PL_ROUT_INFO.getCellData(index, viewColumn+'_'+colViewIndex);
	}
	
	scwin.setViewCellData = function(index, viewColumn, colViewIndex, value){
		dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(index, viewColumn+'_'+colViewIndex, value);
	}
	
	scwin.getViewCellData = function(index, viewColumn, colViewIndex){
		return dlt_VIEW_OPER_PL_ROUT_INFO.getCellData(index, viewColumn+'_'+colViewIndex);
	}
	
	scwin.delViewCellData = function(index, colViewIndex){
		dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(index, 'OPER_INFO_1_'+colViewIndex, '');
		dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(index, 'OPER_INFO_2_'+colViewIndex, '');
		dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(index, 'OPER_INFO_3_'+colViewIndex, '');
	}
	
	scwin.setExlCellDataByFocus = function(index, focusedColumnID, viewColumn, value){
		var colViewIndex = scwin.viewColumnIndex(focusedColumnID);
		dlt_EXL_OPER_PL_ROUT_INFO.setCellData(index, viewColumn+'_'+colViewIndex, value);
	}
	
	scwin.getExlCellDataByFocus = function(index, focusedColumnID, viewColumn){
		var colViewIndex = scwin.viewColumnIndex(focusedColumnID);
		return dlt_EXL_OPER_PL_ROUT_INFO.getCellData(index, viewColumn+'_'+colViewIndex);
	}
	
	scwin.setExlCellData = function(index, viewColumn, colViewIndex, value){
		if(com.isEmpty(colViewIndex)&&colViewIndex!=0){
			return dlt_EXL_OPER_PL_ROUT_INFO.setCellData(index, viewColumn, value);
		}
		else {
			return dlt_EXL_OPER_PL_ROUT_INFO.setCellData(index, viewColumn+'_'+colViewIndex, value);
		}
		
	}
	
	scwin.getExlCellData = function(index, viewColumn, colViewIndex){
		if(com.isEmpty(colViewIndex)&&colViewIndex!=0){
			return dlt_EXL_OPER_PL_ROUT_INFO.getCellData(index, viewColumn);
		}
		else {
			return dlt_EXL_OPER_PL_ROUT_INFO.getCellData(index, viewColumn+'_'+colViewIndex);
		}
	}
	
	scwin.AL0202G1_oncelldblclick = function(row,col,colId) {
	
		if((row%2==0)&&(colId.indexOf("OPER_INFO_1_")>=0)){
			var repRoutId = scwin.getOperAllocCellDataByView(row, colId, "REP_ROUT_ID");
			var dayDiv = scwin.getOperAllocCellDataByView(row, colId, "DAY_DIV");
			var wayDiv = scwin.getOperAllocCellDataByView(row, colId, "WAY_DIV");
			
			var openSnList = dlt_OPER_ALLOC_PL_ROUT_INFO.getColData("OPER_SN");
			dma_sub_search.set("REP_ROUT_ID", repRoutId);
			dma_sub_search.set("DAY_DIV", dayDiv);
			dma_sub_search.set("WAY_DIV", wayDiv);
			dma_sub_search.set("OPER_SN_LIST", openSnList);
			
			var data = { data : dma_sub_search.getJSON(), callbackFn : "scwin.insertOperRout" };
			var options = { id : "popUpOperPlanRoutList",
							popupName : "운행 계획",
							width : 635, height: 500,
							modal : true };
			com.openPopup("/cm//common/popUpOperPlanRoutList.xml", options, data);
		}	
	};
	
	
	scwin.insertOperRout = function(returnValue) {
		var focusIndex = AL0202G1.getFocusedRowIndex();
		var index = parseInt(focusIndex/2);

		dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(index,"ROUT_ID", returnValue[0].ROUT_ID);
		dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(index,"ROUT_NM", returnValue[0].ROUT_NM);
		dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(index,"OPER_SN", returnValue[0].OPER_SN);
		dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(index,"ROUT_ST_TM", returnValue[0].ROUT_ST_TM);
		dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(index,"ROUT_ED_TM", returnValue[0].ROUT_ED_TM);
		
		scwin.setViewCellDataByFocus(focusIndex, AL0202G1.getFocusedColumnID(),"OPER_INFO_1", returnValue[0].ROUT_NM +"("+returnValue[0].OPER_SN+")");
		scwin.setViewCellDataByFocus(focusIndex, AL0202G1.getFocusedColumnID(),"OPER_INFO_2", returnValue[0].ROUT_NM +"("+returnValue[0].OPER_SN+")");
		scwin.setViewCellDataByFocus(focusIndex+1, AL0202G1.getFocusedColumnID(),"OPER_INFO_1", returnValue[0].ROUT_ST_TM);
		scwin.setViewCellDataByFocus(focusIndex+1, AL0202G1.getFocusedColumnID(),"OPER_INFO_2", returnValue[0].ROUT_ST_TM);
	};

	scwin.AL0202G1_onrightkeyup = function(row,col) {
		var colId = AL0202G1.getColumnID(col);
		if((row%2==0)&&(colId.indexOf("OPER_INFO_1_")>=0)){
			var rIndex = AL0202G1.getFocusedRowIndex();
			if(rIndex<0){
				com.alert("배차편성 상세를 선택하고 코스선택 하십시오.");
				return;
			}
			var repRoutId = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rIndex, "REP_ROUT_ID");
			var repRoutNm = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rIndex, "REP_ROUT_NM");
			var dayDiv = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rIndex, "DAY_DIV");
			var wayDiv = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rIndex, "WAY_DIV");
			var allocNo = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rIndex, "ALLOC_NO");

			dma_sub_search.set("REP_ROUT_ID", repRoutId);
			dma_sub_search.set("DAY_DIV", dayDiv);
			dma_sub_search.set("WAY_DIV", wayDiv);
			
			var dayStr = (dayDiv=="DY001")?"평일":"휴일";
	
			var wayAscNm = dlt_BRT_OPER_PL_MST.getCellData(AL0202G0.getFocusedRowIndex(), "WAY_ASC_NM");
			if(com.isEmpty(wayAscNm))wayAscNm = "상행";
			var wayDescNm = dlt_BRT_OPER_PL_MST.getCellData(AL0202G0.getFocusedRowIndex(), "WAY_DESC_NM");
			if(com.isEmpty(wayDescNm))wayDescNm = "하행";
			var wayStr = (wayDiv=="WD001")?wayAscNm:wayDescNm;
			
			var title = "코스선택";
			var data = { data : dma_sub_search.getJSON(), callbackFn : "scwin.insertCourse", wayStr : wayStr };
			var options = { id : "popUpOperPlanRoutList",
							popupName : title,
							width : 700, height: 700,
							modal : true };
							
			com.openPopup("/cm/common/popUpSelCourseList.xml", options, data);
		}
	};
	
	
	scwin.setCourse = function(focusIndex, colViewIndex, data){
		
		var index = parseInt(focusIndex/2);
		var rIndex = scwin.getOperAllocIndexByView2(focusIndex, colViewIndex);
		var allocOperCnt = scwin.getAllocCntData(index);
		if((data.length+colViewIndex) > allocOperCnt){
			for(var i = 0; i<data.length; i++){
				if((colViewIndex + i) < allocOperCnt){
					scwin.setOperAllocRowJsonData(rIndex+i, data[i]);
					scwin.setCorDtlRowJsonData(rIndex+i, data[i]);
				}
				else{
					scwin.insertOperAlloc(rIndex+i, data[i]);
					scwin.insertCorDtl(rIndex+i, data[i]);
				}
			}
			OPER_CNT.setValue(dlt_OPER_ALLOC_PL_ROUT_INFO.getRowCount());
			
			//dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(AL0202G0.getFocusedRowIndex(), ", data)
			scwin.setAllocCntData(index,data.length+colViewIndex);
			scwin.setGridExcelInfo(); //엑셀용 화면 및 데이터 구성
			scwin.setGridViewInfo(); //그리드 화면 및 데이터 구성

		}
		else {
			var i = 0;
			for(i = 0; i<data.length; i++){
				var operSn = scwin.getOperAllocCellData(rIndex+i,"OPER_SN");
				var color = data[i].COR_COLOR;
				scwin.setOperAllocRowJsonData(rIndex+i, data[i]);
				scwin.setCorDtlRowJsonData(rIndex+i, data[i]);
				var value = "";
				if(com.isEmpty(operSn)){
					value = data[i].ROUT_NM;
					for(var j = 1; j <=3; j++){
						scwin.setViewCellData(focusIndex, "OPER_INFO_"+j, colViewIndex, value);
						
						if(j==3){
							scwin.setViewCellData(focusIndex+1, "OPER_INFO_"+j, colViewIndex, data[i].REST_TM);
						}
						else {
							scwin.setViewCellData(focusIndex, "empty_"+j, colViewIndex, value);
						}
						AL0202G1.setCellColor(focusIndex, "OPER_INFO_"+j+"_"+colViewIndex, color);
						AL0202G1.setCellColor(focusIndex+1, "OPER_INFO_"+j+"_"+colViewIndex, color);
					}
				}
				else {
					value = data[i].ROUT_NM +"("+operSn+")";
					for(var j = 1; j <=3; j++){
						scwin.setViewCellData(focusIndex, "OPER_INFO_"+j, colViewIndex, value);
						
						if(j==3){
							scwin.setViewCellData(focusIndex+1, "OPER_INFO_"+j, colViewIndex, data[i].REST_TM);
						}
						else {
							scwin.setViewCellData(focusIndex, "empty_"+j, colViewIndex, value);
						}
						AL0202G1.setCellColor(focusIndex, "OPER_INFO_"+j+"_"+colViewIndex, color);
						AL0202G1.setCellColor(focusIndex+1, "OPER_INFO_"+j+"_"+colViewIndex, color);
					}	
				}
				
				scwin.setExlCellData(index, "COR_ID", colViewIndex, data[i].COR_ID);
				scwin.setExlCellData(index, "ROUT_ID", colViewIndex, data[i].ROUT_ID);

				//index ++;
				colViewIndex ++;
			}	
			var color = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, "COR_COLOR");
		}
		for(var j=i-1; j<allocOperCnt; j++){
			scwin.delOperAlloc(rIndex+j);
		}
	}
	
	scwin.insertCourse = function(returnValue) {
		
		var focusIndex = AL0202G1.getFocusedRowIndex();
		var colViewIndex = scwin.viewColumnIndex(AL0202G1.getFocusedColumnID());
		var checkResult = scwin.checkCourse(focusIndex, colViewIndex, returnValue);
		
		if(checkResult==0){
			var index = parseInt(focusIndex/2); 
			var allocOperCnt = scwin.getAllocCntData(index);
			if(returnValue.length > allocOperCnt){
				var str = "B" + (index+1) + "배차의 운행정보 개수보다 큽니다. 적용하시겠습니까?";
				com.confirm(str, function(rtn){
					if (rtn) {
						scwin.setCourse(focusIndex, colViewIndex, returnValue);
					}
					return;
				});
			}
			else
			{
				scwin.setCourse(focusIndex, colViewIndex, returnValue);
			}
		}
		else if(checkResult==1){
			com.confirm("현재 코스와 다릅니다. 적용하겠습니까?", function(rtn){
				if (rtn) {
					scwin.setCourse(focusIndex, colViewIndex, returnValue);
				}
				return;
			});
		}
		else if(checkResult==2){
			com.alert("현재 노선과 다릅니다. 운행 정보를 추가하여 적용하시기 바랍니다.");
		}
	};
	
	scwin.btn_sub_sel_mult_course = function(){
		
		var focusIndex = AL0202G1.getFocusedRowIndex();
		if(focusIndex<0){
			com.alert("배차를 선택하고 코스선택 하십시오.");
			return;
		}
		if(focusIndex<0)focusIndex=0;
		var index = parseInt(focusIndex/2);
		var rIndex = scwin.getOperAllocIndexByView(focusIndex, "INDEX_0");
		
		var repRoutId = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rIndex, "REP_ROUT_ID");
		var repRoutNm = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rIndex, "REP_ROUT_NM");
		var dayDiv = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rIndex, "DAY_DIV");
		var wayDiv = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rIndex, "WAY_DIV");
		var allocNo = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rIndex, "ALLOC_NO");
		var columnCnt = dlt_OPER_ALLOC_PL_ROUT_CNT.getCellData(allocNo, "CNT");
		
		//dlt_SEL_BRT_OPER_ALLOC_PL_COR_INFO.removeAll();
		var dltBrtOperAllocPlCorInfo = dlt_BRT_OPER_ALLOC_PL_COR_INFO.getAllJSON();
		
		//해당 배차 코스 선택
		var planCorInfo = new Array();
		for(var i = 0; i < dltBrtOperAllocPlCorInfo.length; i++){
			if((allocNo==dltBrtOperAllocPlCorInfo[i].ALLOC_NO)
				&&(com.isEmpty(dltBrtOperAllocPlCorInfo[i].COR_ID)==false)){
				planCorInfo.push(dltBrtOperAllocPlCorInfo[i]);
			}
		}
		
		dma_sub_search.set("REP_ROUT_ID", repRoutId);
		dma_sub_search.set("DAY_DIV", dayDiv);
		dma_sub_search.set("WAY_DIV", wayDiv);
		dma_sub_search.set("BRT_TARGET_COR_LIST", planCorInfo);
		
		var dayStr = (dayDiv=="DY001")?"평일":"휴일";

		var wayAscNm = dlt_BRT_OPER_PL_MST.getCellData(AL0202G0.getFocusedRowIndex(), "WAY_ASC_NM");
		if(com.isEmpty(wayAscNm))wayAscNm = "상행";
		var wayDescNm = dlt_BRT_OPER_PL_MST.getCellData(AL0202G0.getFocusedRowIndex(), "WAY_DESC_NM");
		if(com.isEmpty(wayDescNm))wayDescNm = "하행";
		var wayStr = (wayDiv=="WD001")?wayAscNm:wayDescNm;
		var title = repRoutNm + " / " + dayStr + " / " + wayStr + " / " + allocNo + "회 배차";
		var data = { data : dma_sub_search.getJSON(), callbackFn : "scwin.insertMultiCourse", wayStr : wayStr , columnCnt : columnCnt, allocNo : allocNo };
		var options = { id : "popUpSelMultiCourseList",
						popupName : title,
						width : 1000, height: 800,
						modal : true };
						
		com.openPopup("/cm/common/popUpSelMultiCourseList.xml", options, data);
	}
	
	/*코스 체크(리턴 값이 공백이면 0, 코스ID가 다르면 1, 노선ID가 다르면 2)*/
	scwin.checkCourse = function(focusIndex, colViewIndex, data){
		var index = parseInt(focusIndex/2);
		var rIndex = scwin.getOperAllocIndexByView2(focusIndex, colViewIndex);
		var allocOperCnt = scwin.getAllocCntData(index);
		var result = 0;
		if((data.length+colViewIndex) > allocOperCnt){
			for(var i = 0; i<data.length; i++){
				if((colViewIndex + i) < allocOperCnt){
					var routeId = scwin.getOperAllocCellData (rIndex+i, "ROUT_ID");
					var corId = scwin.getOperAllocCellData (rIndex+i, "COR_ID");
				
					if(com.isEmpty(routeId)){
						result = 0; //공백
					}
					else if((data[i].ROUT_ID==routeId)&&(com.isEmpty(corId)==false)&&(data[i].COR_ID!=corId)){
						result = 1; //코스ID가 다름
						return result;
					}
					else if(data[i].ROUT_ID!=routeId){
						result = 2; //노선ID가 다름
						return result;
					}
				}
			}
		}
		if((data.length+colViewIndex) < allocOperCnt){
			result = 3; //현재보다 코스가 적음
			return result;
		}
		else {
			for(var i = 0; i<data.length; i++){
				var routeId = scwin.getOperAllocCellData (rIndex+i, "ROUT_ID");
			
				if(com.isEmpty(routeId)){
					result = 0; //공백
				}
				else if(data[i].ROUT_ID!=routeId){
					result = 2; //노선ID가 다름
					return result;
				}
			}
		}
		return result;
	}
	
	scwin.insertMultiCourse = function(returnValue) {
		
		var focusIndex = AL0202G1.getFocusedRowIndex(); //화면 인덱스
		if(focusIndex<0)focusIndex=0;
		var index = parseInt(focusIndex/2); 
		var checkResult = scwin.checkCourse(focusIndex, 0, returnValue);
		if(checkResult==0){
			var allocOperCnt = scwin.getAllocCntData(index);
			if(returnValue.length > allocOperCnt){
				var str = "B" + (index+1) + "배차의 운행정보 개수보다 큽니다. 적용하시겠습니까?";
				com.confirm(str, function(rtn){
					if (rtn) {
						scwin.setCourse(focusIndex, 0, returnValue);
					}
					return;
				});
			}
			else
			{
				scwin.setCourse(focusIndex, 0, returnValue);
			}
		}
		else if(checkResult==1){
			com.confirm("현재 코스와 다릅니다. 적용하겠습니까?", function(rtn){
				if (rtn) {
					scwin.setCourse(focusIndex, 0, returnValue);
				}
				return;
			});
		}
		else if(checkResult==2){
			com.confirm("현재 노선과 다릅니다. 재 구성하시겠습니까?", function(rtn){
				if (rtn) {
					scwin.setCourse(focusIndex, 0, returnValue);
					scwin.reConstruction();
				}
				return;
			});
		}
		else if(checkResult==3){
			com.confirm("현재 코스보다  선택된 코스가 적습니다. 재 구성하시겠습니까?", function(rtn){
				if (rtn) {
					scwin.setCourse(focusIndex, 0, returnValue);
					scwin.reConstruction();
				}
				return;
			});
		}
	}
	
	scwin.AL0202G1_oneditkeyup = function(info) {
		if (info.colID.indexOf("OPER_INFO_1")>=0 || info.colID.indexOf("OPER_INFO_2")>=0) {
			var value = info.newValue;
			if(info.colID.indexOf("OPER_INFO_1")>=0){
				scwin.setOperAllocCellDataByView(info.rowIndex, info.colID, "ROUT_ST_TM", value);
			}
			else if(info.colID.indexOf("OPER_INFO_2")>=0){
				scwin.setOperAllocCellDataByView(info.rowIndex, info.colID, "ROUT_ED_TM",value );
			}
		}
		
	};
	
	scwin.AL0202G1_onrowindexchange = function(row,oldRow) {
		
	};
	
	scwin.sbx_ChoiceBox_onviewchange = function(info) {
		
		if (info.newValue == "ALL") {
			autoChoiceBox.hide();
			search_input.setValue("");
			search_input.show("");
		} else if (info.newValue == "REP_ROUT_ID") {
			search_input.hide();
			autoChoiceBox.setNodeSet("data:dlt_repRoutItem", "REP_ROUT_ID", "REP_ROUT_ID");
			autoChoiceBox.show("");
		} else if (info.newValue == "REP_ROUT_NM") {
			search_input.hide();
			autoChoiceBox.setNodeSet("data:dlt_repRoutItem", "REP_ROUT_NM", "REP_ROUT_NM");
			autoChoiceBox.show("");
		}
	};
	
	var oldStWayValue = "WD001";
	scwin.ST_WAY_onviewchange = function(info) {
		
		if(oldStWayValue == -1 || oldStWayValue == info.value)return;
		
		/*if(ST_WAY.getDisabled()==false){
			scwin.reConstruction();
		}
		*/
		oldStWayValue = info.value;
	};
	
	//동적으로 datList 생성
	scwin.makeDataList = function(id, obj) {
		if(WebSquare.util.getComponentById(id)!=undefined){
			$w.data.remove(id);
		}
		$w.data.create({
			"id": id
			, "type": "dataList"
			, "option": {
				"useData": false
			  }
			, "columnInfo":obj
		});
	}
	
	scwin.cnt_oneditkeyup = function(row,col,value) {

	}
	
	scwin.btn_init = function() {
				
		var operPlRoutInfoAscLength = dlt_BRT_OPER_PL_ROUT_INFO_ASC.getAllJSON().length;
		var operPlRoutInfoDescLength = dlt_BRT_OPER_PL_ROUT_INFO_DESC.getAllJSON().length;
		if(com.isEmpty(OPER_CNT.getValue())||OPER_CNT.getValue()==0){
			OPER_CNT.setValue(operPlRoutInfoAscLength+operPlRoutInfoDescLength);
		}
		
		if(com.isEmpty(ALLOC_CNT.getValue())||ALLOC_CNT.getValue()==0){
			var allocCnt = 0;
			if(operPlRoutInfoAscLength>0){
				var ascFstStTmSec = util.timeToSecond(dlt_BRT_OPER_PL_ROUT_INFO_ASC.getAllJSON()[0].ROUT_ST_TM);
				var ascFstEdTmSec = util.timeToSecond(dlt_BRT_OPER_PL_ROUT_INFO_ASC.getAllJSON()[0].ROUT_ED_TM);
				var asclstEdTmSec = util.timeToSecond(dlt_BRT_OPER_PL_ROUT_INFO_ASC.getAllJSON()[operPlRoutInfoAscLength-1].ROUT_ED_TM);
				var ascDiff = ascFstEdTmSec - ascFstStTmSec+600;
				var i = 0;
				var ascCnt = 0;
				for(i=ascFstStTmSec;i<asclstEdTmSec;i+=ascDiff){
					ascCnt++;
				}
				
				var result = parseInt(operPlRoutInfoAscLength / ascCnt);
				//var remainder = operPlRoutInfoAscLength % ascCnt;
				allocCnt = result+1;
			}
			if(operPlRoutInfoDescLength>0){
				var descFstStTmSec = util.timeToSecond(dlt_BRT_OPER_PL_ROUT_INFO_DESC.getAllJSON()[0].ROUT_ST_TM);
				var descFstEdTmSec = util.timeToSecond(dlt_BRT_OPER_PL_ROUT_INFO_DESC.getAllJSON()[0].ROUT_ED_TM);
				var desclstEdTmSec = util.timeToSecond(dlt_BRT_OPER_PL_ROUT_INFO_DESC.getAllJSON()[operPlRoutInfoDescLength-1].ROUT_ED_TM);
				var descDiff = descFstEdTmSec - descFstStTmSec+600;
				var i = 0;
				var descCnt = 0;
				for(i=descFstStTmSec;i<desclstEdTmSec;i+=descDiff){
					descCnt++;
				}
				
				var result = parseInt(operPlRoutInfoDescLength / descCnt);
				//var remainder = operPlRoutInfoDescLength % descCnt;
				allocCnt += result+1;
			}
		
			var str = "최적의 배차횟수는 "+allocCnt+"입니다. 적용하시겠습니까?";
			com.confirm(str, function(rtn) {
				if (rtn) {
					ALLOC_CNT.setValue(allocCnt);
					scwin.btn_init2();
				}
				else{
					scwin.btn_init2();
				}
			});
		}
		else {
			scwin.btn_init2();
		}
	}
	
	scwin.btn_init2 = function() {
		var operCnt = OPER_CNT.getValue();
		var allocCnt = ALLOC_CNT.getValue();
		if(com.isEmpty(operCnt)||operCnt==0){
			com.alert("운행횟수를 입력하고 실행하세요.");
			OPER_CNT.focus();
			return;
		}
		
		if(com.isEmpty(allocCnt)||allocCnt==0){
			com.alert("배차횟수를 입력하고 실행하세요.");
			ALLOC_CNT.focus();
			return;
		}
		if(dlt_OPER_ALLOC_PL_ROUT_INFO.getRowCount()>0){				
			com.confirm("배차편성 초기화됩니다. 초기화 하시겠습니까?", function(rtn){
				if (rtn) {
					scwin.emptyInit();
				}
			});
		}
		else{
			scwin.emptyInit();
		}
	}
	
	scwin.btn_add_cell  = function() {
		
		if(AL0202G1.getFocusedColumnID()=="WAY_DIV"||AL0202G1.getFocusedColumnID()=="ALLOC_NO")return;
		var focusIndex = AL0202G1.getFocusedRowIndex();
		var index = parseInt(focusIndex/2);
		var colViewIndex = scwin.viewColumnIndex(AL0202G1.getFocusedColumnID());
		var rIndex = scwin.getOperAllocIndexByView2(focusIndex, colViewIndex);
		var allocOperCnt = scwin.getAllocCntData(index);
		
		var mainfocusIndex = AL0202G0.getFocusedRowIndex();
		var wayDiv = scwin.getOperAllocCellDataByView(focusIndex, AL0202G1.getFocusedColumnID(), "WAY_DIV");
		var dltBrtOperPlMst = dlt_BRT_OPER_PL_MST.getAllJSON();
		var repRoutId = dltBrtOperPlMst[mainfocusIndex].REP_ROUT_ID;
		var repRoutNM = dltBrtOperPlMst[mainfocusIndex].REP_ROUT_NM;
		var dayDiv = dltBrtOperPlMst[mainfocusIndex].DAY_DIV;
		var routDiv = dltBrtOperPlMst[mainfocusIndex].ROUT_DIV;
		var wayAscNm = dltBrtOperPlMst[mainfocusIndex].WAY_ASC_NM;
		var wayDescNm = dltBrtOperPlMst[mainfocusIndex].WAY_DESC_NM;
		var rowData = {
			REP_ROUT_ID : repRoutId,
			REP_ROUT_NM : repRoutNM,
			DAY_DIV : dayDiv,
			WAY_ASC_NM : wayAscNm,
			WAY_DESC_NM : wayDescNm,
			ALLOC_NO : index+1,
			WAY_DIV : wayDiv
		};

		scwin.insertOperAlloc(rIndex, rowData);
		scwin.insertCorDtl(rIndex, rowData);
		OPER_CNT.setValue(dlt_OPER_ALLOC_PL_ROUT_INFO.getRowCount());
		scwin.setAllocCntData(index, allocOperCnt+1);
		scwin.setGridExcelInfo(); //엑셀용 화면 및 데이터 구성
		scwin.setGridViewInfo(); //그리드 화면 및 데이터 구성
	}
	
	scwin.btn_del_cell  = function() {
		
		var focusIndex = AL0202G1.getFocusedRowIndex();
		var index = parseInt(focusIndex/2);
		var colViewIndex = scwin.viewColumnIndex(AL0202G1.getFocusedColumnID());
		var rIndex = scwin.getOperAllocIndexByView2(focusIndex, colViewIndex);
		var allocOperCnt = scwin.getAllocCntData(index);
	
		var routId = scwin.getOperAllocCellData(rIndex,"ROUT_ID");
		if(com.isEmpty(routId)==false){
			com.confirm("해당 데이터 셀을 삭제하시겠습니까?", function(rtn){
				if (rtn) {
					scwin.delOperAlloc(rIndex);
					//OPER_CNT.setValue(dlt_OPER_ALLOC_PL_ROUT_INFO.getRowCount());
					scwin.setAllocCntData(index, allocOperCnt-1);
					//scwin.delViewCellData(focusIndex,colViewIndex);
					scwin.setGridExcelInfo(); //엑셀용 화면 및 데이터 구성
					scwin.setGridViewInfo(); //그리드 화면 및 데이터 구성
				}
			});
		}
		else {
			scwin.delOperAlloc(rIndex);
			//OPER_CNT.setValue(dlt_OPER_ALLOC_PL_ROUT_INFO.getRowCount());
			scwin.setAllocCntData(index, allocOperCnt-1);
			scwin.delViewCellData(focusIndex,colViewIndex);
		}
	}
	
	scwin.btn_reInstall = function() {
		var operCnt = OPER_CNT.getValue();
		var allocCnt = ALLOC_CNT.getValue();
		if(com.isEmpty(operCnt)||operCnt==0){
			com.alert("운행횟수를 입력하고 실행하세요.");
			OPER_CNT.focus();
			return;
		}
		
		if(com.isEmpty(allocCnt)||allocCnt==0){
			com.alert("배차횟수를 입력하고 실행하세요.");
			ALLOC_CNT.focus();
			return;
		}
		if(dlt_OPER_ALLOC_PL_ROUT_INFO.getRowCount()>0){				
			com.confirm("배차편성 상세가 다시 구성됩니다. 새로 구성하시겠습니까?", function(rtn){
				if (rtn) {
					scwin.reConstruction();
				}
			});
		}
		else{
			scwin.reConstruction();
		}
	}
	
	var g_rowOperAllocIndex = 0;
	var g_rowColumnIndex = 0;
	
	//화면 재구성
	scwin.reConstruction = function() {

		var dltBrtOperPlRoutInfoAsc = dlt_BRT_OPER_PL_ROUT_INFO_ASC.getAllJSON();
		var dltBrtOperPlRoutInfoDesc = dlt_BRT_OPER_PL_ROUT_INFO_DESC.getAllJSON();
		var dltBrtCorDtl = dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.getAllJSON();
		g_rowOperAllocIndex = 0;
		
		if(dltBrtOperPlRoutInfoAsc.length==0&&dltBrtOperPlRoutInfoDesc.length==0){
			scwin.emptyInit();
			return;
		}
		
		var allocCnt = ALLOC_CNT.getValue();
		var halfAllocCnt = parseInt(Math.ceil(allocCnt/2));
		var operCnt = OPER_CNT.getValue();
		oldAllocCnt = allocCnt;
		oldOperCnt = operCnt;
		
		if((com.isEmpty(allocCnt)==false)&&(com.isEmpty(operCnt)==false)){
			var columnCnt = parseInt(operCnt/allocCnt);
			//dlt_OPER_ALLOC_PL_ROUT_INFO.removeAll();
			//dlt_OPER_ALLOC_PL_ROUT_CNT.removeAll();
			//dlt_VIEW_OPER_PL_ROUT_INFO.removeAll();
			dlt_EXL_OPER_PL_ROUT_INFO.removeAll();
			var focusIndex = AL0202G0.getFocusedRowIndex();
			if(focusIndex<0)focusIndex=0;
			
			var dltBrtOperPlMst = dlt_BRT_OPER_PL_MST.getAllJSON();
			var repRoutId = dltBrtOperPlMst[focusIndex].REP_ROUT_ID;
			var repRoutNM = dltBrtOperPlMst[focusIndex].REP_ROUT_NM;
			var dayDiv = dltBrtOperPlMst[focusIndex].DAY_DIV;
			var routDiv = dltBrtOperPlMst[focusIndex].ROUT_DIV;
			var wayYn = dltBrtOperPlMst[focusIndex].WAY_YN;
			var wayAscNm = dltBrtOperPlMst[focusIndex].WAY_ASC_NM;
			var wayDescNm = dltBrtOperPlMst[focusIndex].WAY_DESC_NM;
			
			var oldAllocIndex = -1;
			var allocNO = 1;
			
			var ascMax = 0;//상행최대개수
			var ascIndex = 0; //상행인덱스
			var descMax = 0;
			var descIndex = 0; //하행인덱스
			
			for(i=0;i<allocCnt;i++){
				var corDtlData = scwin.getFirstCorDtlByAllocIndex(i+1); //해당 배차의 첫번째 방향을 가져옴
				var wayDiv = corDtlData!=null?corDtlData.WAY_DIV:'';
				if(wayDiv=='WD001')ascMax++;
				else if(wayDiv=='WD002')descMax++;
			}
			
			for(i=0;i<allocCnt;i++){
				var corDtlData = scwin.getFirstCorDtlByAllocIndex(i+1); //해당 배차의 첫번째 방향을 가져옴
				var wayDiv = corDtlData!=null?corDtlData.WAY_DIV:'';
				if(wayDiv=='WD001'){
					if(dltBrtOperPlRoutInfoAsc[ascIndex].rowStatus == "D")continue;
					var routId = corDtlData.ROUT_ID;
					var routNm = corDtlData.ROUT_NM;
					var operSn = dltBrtOperPlRoutInfoAsc[ascIndex].OPER_SN;
					var routStTm = dltBrtOperPlRoutInfoAsc[ascIndex].ROUT_ST_TM;
					var routEdTm = dltBrtOperPlRoutInfoAsc[ascIndex].ROUT_ED_TM;
					var wayDiv = dltBrtOperPlRoutInfoAsc[ascIndex].WAY_DIV;
					var restTm = scwin.getViewCellData((allocNO*2-1), "OPER_INFO_3",g_rowColumnIndex);
					if(com.isEmpty(restTm))restTm=g_LEAST_REST_TM;
	
					var rowData = {
						REP_ROUT_ID : repRoutId,
						REP_ROUT_NM : repRoutNM,
						DAY_DIV : dayDiv,
						WAY_ASC_NM : wayAscNm,
						WAY_DESC_NM : wayDescNm,
						ROUT_ID : routId,
						ROUT_NM : routNm,
						OPER_SN : operSn,
						ROUT_ST_TM : routStTm,
						ROUT_ED_TM : routEdTm,
						REST_TM : restTm,
						WAY_DIV : wayDiv,
						ALLOC_NO : allocNO
					};
					
					dltBrtOperPlRoutInfoAsc[ascIndex].rowStatus = "D";

					scwin.setOperAllocRowJsonData(g_rowOperAllocIndex,rowData);
					g_rowOperAllocIndex++;
					g_rowColumnIndex++;
					scwin.recurOperRoundConstruction(dltBrtOperPlMst, dltBrtOperPlRoutInfoAsc, dltBrtOperPlRoutInfoDesc, focusIndex, allocNO, ascMax, descMax);
					allocNO++;
					ascIndex++;
				}
				else if(wayDiv=='WD002'){
					if(dltBrtOperPlRoutInfoDesc[descIndex].rowStatus == "D")continue;
					var routId = corDtlData.ROUT_ID;
					var routNm = corDtlData.ROUT_NM;
					var operSn = dltBrtOperPlRoutInfoDesc[descIndex].OPER_SN;
					var routStTm = dltBrtOperPlRoutInfoDesc[descIndex].ROUT_ST_TM;
					var routEdTm = dltBrtOperPlRoutInfoDesc[descIndex].ROUT_ED_TM;
					var restTm = scwin.getViewCellData((allocNO*2-1), "OPER_INFO_3",i);
					if(com.isEmpty(restTm))restTm=g_LEAST_REST_TM;
					var rowData = {
						REP_ROUT_ID : repRoutId,
						REP_ROUT_NM : repRoutNM,
						DAY_DIV : dayDiv,
						WAY_ASC_NM : wayAscNm,
						WAY_DESC_NM : wayDescNm,
						ROUT_ID : routId,
						ROUT_NM : routNm,
						OPER_SN : operSn,
						ROUT_ST_TM : routStTm,
						ROUT_ED_TM : routEdTm,
						REST_TM : restTm,
						WAY_DIV : wayDiv,
						ALLOC_NO : allocNO
					};
					dltBrtOperPlRoutInfoDesc[descIndex].rowStatus = "D";
					
					scwin.setOperAllocRowJsonData(g_rowOperAllocIndex,rowData);
					g_rowOperAllocIndex++;
					g_rowColumnIndex++;
					scwin.recurOperRoundConstruction(dltBrtOperPlMst, dltBrtOperPlRoutInfoAsc, dltBrtOperPlRoutInfoDesc, focusIndex, allocNO, ascMax, descMax);
					allocNO++;
					descIndex++;
				}
				else{
					break;
				}
			}
		}
		
		dma_save.set("TYPE","ALL")
		dlt_OPER_ALLOC_PL_ROUT_INFO.modifyAllStatus("C");
		dlt_BRT_OPER_ALLOC_PL_COR_INFO.modifyAllStatus("C");
		dlt_BRT_OPER_PL_ROUT_INFO_ASC.modifyAllStatus("R");
		dlt_BRT_OPER_PL_ROUT_INFO_DESC.modifyAllStatus("R");
		scwin.setGridExcelInfo(); //엑셀용 화면 및 데이터 구성
		scwin.setGridViewInfo(); //그리드 화면 및 데이터 구성
	}
	
	scwin.recurOperRoundConstruction = function(dltBrtOperPlMst, dltBrtOperPlRoutInfoAsc, dltBrtOperPlRoutInfoDesc, focusIndex, allocNO, ascStartIndex, descStartIndex){
		
		var repRoutId = dltBrtOperPlMst[focusIndex].REP_ROUT_ID;
		var repRoutNM = dltBrtOperPlMst[focusIndex].REP_ROUT_NM;
		var dayDiv = dltBrtOperPlMst[focusIndex].DAY_DIV;
		var routDiv = dltBrtOperPlMst[focusIndex].ROUT_DIV;
		var wayYn = dltBrtOperPlMst[focusIndex].WAY_YN;
		var wayAscNm = dltBrtOperPlMst[focusIndex].WAY_ASC_NM;
		var wayDescNm = dltBrtOperPlMst[focusIndex].WAY_DESC_NM;
	
		var oldRoutStTm = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData((g_rowOperAllocIndex-1), "ROUT_ST_TM");
		var oldRoutEdTm = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData((g_rowOperAllocIndex-1), "ROUT_ED_TM");
		var oldWayDiv = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData((g_rowOperAllocIndex-1), "WAY_DIV");
		var oldRestTm = scwin.getCorDtlRowJsonData(g_rowOperAllocIndex-1).REST_TM;
		var wayDiv = scwin.getCorDtlRowJsonData(g_rowOperAllocIndex).WAY_DIV;
		if(com.isEmpty(wayDiv)){
			scwin.setAllocCntData((allocNO-1), g_rowColumnIndex);
			g_rowColumnIndex = 0;
			return;
		}
		
		var i = 0;

		if(wayDiv=='WD001'){
			if(ascStartIndex<g_rowColumnIndex)ascStartIndex = g_rowColumnIndex;
			for(i=ascStartIndex;i<dltBrtOperPlRoutInfoAsc.length;i++){
				if(scwin.getAllocCntData((allocNO-1))<=g_rowColumnIndex){
					scwin.setAllocCntData((allocNO-1), g_rowColumnIndex);
					g_rowColumnIndex = 0;
					return;
				}
				if(dltBrtOperPlRoutInfoAsc[i].rowStatus == "D")continue;
				var routStTm = dltBrtOperPlRoutInfoAsc[i].ROUT_ST_TM;
				var oldRestTm = com.isEmpty(oldRestTm)?g_LEAST_REST_TM:oldRestTm;
				var compVal = util.secondToTime(util.datePlus(oldRoutEdTm + ":00", oldRestTm + ":00")); //이전노선종료시간과 휴게시간을 더함
				
				//이전 노선죵료시간과 휴게시간을 더한 값보다 큰 노선시작시간 세팅함
				if(util.dateMinus(compVal + ":00", routStTm + ":00")>0){ 
					var routId = scwin.getCorDtlRowJsonData(g_rowOperAllocIndex).ROUT_ID;
					var routNm = scwin.getCorDtlRowJsonData(g_rowOperAllocIndex).ROUT_NM;
					var operSn = dltBrtOperPlRoutInfoAsc[i].OPER_SN;
					var routEdTm = dltBrtOperPlRoutInfoAsc[i].ROUT_ED_TM;
					var wayDiv = dltBrtOperPlRoutInfoAsc[i].WAY_DIV;
					var restTm = scwin.getViewCellData((allocNO*2-1), "OPER_INFO_3",g_rowColumnIndex);
					if(com.isEmpty(restTm))restTm=g_LEAST_REST_TM;
					var rowData = {
						REP_ROUT_ID : repRoutId,
						REP_ROUT_NM : repRoutNM,
						DAY_DIV : dayDiv,
						WAY_ASC_NM : wayAscNm,
						WAY_DESC_NM : wayDescNm,
						ROUT_ID : routId,
						ROUT_NM : routNm,
						OPER_SN : operSn,
						ROUT_ST_TM : routStTm,
						ROUT_ED_TM : routEdTm,
						REST_TM : restTm,
						WAY_DIV : wayDiv,
						ALLOC_NO : allocNO
					};
					
					dltBrtOperPlRoutInfoAsc[i].rowStatus = "D";
					
					scwin.setOperAllocRowJsonData(g_rowOperAllocIndex,rowData);
					g_rowOperAllocIndex++;
					g_rowColumnIndex++;
					scwin.recurOperRoundConstruction(dltBrtOperPlMst, dltBrtOperPlRoutInfoAsc, dltBrtOperPlRoutInfoDesc, focusIndex, allocNO, ascStartIndex, descStartIndex);
					return;
				}
			}
			if(i==dltBrtOperPlRoutInfoAsc.length){
				scwin.setAllocCntData((allocNO-1), g_rowColumnIndex);
				g_rowColumnIndex = 0;
				return;
			}
		}
		else if(wayDiv=='WD002'){
			if(descStartIndex<g_rowColumnIndex)descStartIndex = g_rowColumnIndex;
			for(i=descStartIndex;i<dltBrtOperPlRoutInfoDesc.length;i++){
				if(scwin.getAllocCntData((allocNO-1))<=g_rowColumnIndex){
					scwin.setAllocCntData((allocNO-1), g_rowColumnIndex);
					g_rowColumnIndex = 0;
					return;
				}
				if(dltBrtOperPlRoutInfoDesc[i].rowStatus == "D")continue;

				var routStTm = dltBrtOperPlRoutInfoDesc[i].ROUT_ST_TM;
				var oldRestTm = com.isEmpty(oldRestTm)?g_LEAST_REST_TM:oldRestTm;
				var compVal = util.secondToTime(util.datePlus(oldRoutEdTm + ":00", oldRestTm + ":00")); //이전노선종료시간과 휴게시간을 더함
				
				//이전 노선죵료시간과 휴게시간을 더한 값보다 큰 노선시작시간 세팅함
				if(util.dateMinus(compVal, routStTm + ":00")>0){ 
					var routId = scwin.getCorDtlRowJsonData(g_rowOperAllocIndex).ROUT_ID;
					var routNm = scwin.getCorDtlRowJsonData(g_rowOperAllocIndex).ROUT_NM;
					var operSn = dltBrtOperPlRoutInfoDesc[i].OPER_SN;
					var routEdTm = dltBrtOperPlRoutInfoDesc[i].ROUT_ED_TM;
					var wayDiv = dltBrtOperPlRoutInfoDesc[i].WAY_DIV;
					var restTm = scwin.getViewCellData((allocNO*2-1), "OPER_INFO_3",g_rowColumnIndex);
					if(com.isEmpty(restTm))restTm=g_LEAST_REST_TM;
					var rowData = {
						REP_ROUT_ID : repRoutId,
						REP_ROUT_NM : repRoutNM,
						DAY_DIV : dayDiv,
						WAY_ASC_NM : wayAscNm,
						WAY_DESC_NM : wayDescNm,
						WAY_DESC_NM : wayDescNm,
						ROUT_ID : routId,
						ROUT_NM : routNm,
						OPER_SN : operSn,
						ROUT_ST_TM : routStTm,
						ROUT_ED_TM : routEdTm,
						REST_TM : restTm,
						WAY_DIV : wayDiv,
						ALLOC_NO : allocNO
					};
					
					dltBrtOperPlRoutInfoDesc[i].rowStatus = "D";
					
					scwin.setOperAllocRowJsonData(g_rowOperAllocIndex,rowData);
					g_rowOperAllocIndex++;
					g_rowColumnIndex ++;
					scwin.recurOperRoundConstruction(dltBrtOperPlMst, dltBrtOperPlRoutInfoAsc, dltBrtOperPlRoutInfoDesc, focusIndex, allocNO, ascStartIndex, descStartIndex);
					return;
				}
			}
			if(i==dltBrtOperPlRoutInfoDesc.length){
				scwin.setAllocCntData((allocNO-1), g_rowColumnIndex);
				g_rowColumnIndex = 0;
				return;
			}
		}
		g_rowColumnIndex = 0;
	}
	
	scwin.emptyInit = function() {
		
		//ST_WAY.setDisabled(false);
		
		var dltBrtOperPlRoutInfoAsc = dlt_BRT_OPER_PL_ROUT_INFO_ASC.getAllJSON();
		var dltBrtOperPlRoutInfoDesc = dlt_BRT_OPER_PL_ROUT_INFO_DESC.getAllJSON();
		
		var allocCnt = ALLOC_CNT.getValue();
		var halfAllocCnt = parseInt(Math.ceil(allocCnt/2));
		var operCnt = OPER_CNT.getValue();
		var operAllocIndex = 0;
		oldAllocCnt = allocCnt;
		oldOperCnt = operCnt;
		if((com.isEmpty(allocCnt)==false)&&(com.isEmpty(operCnt)==false)){
			var columnCnt = parseInt(operCnt/allocCnt);
			dlt_OPER_ALLOC_PL_ROUT_INFO.removeAll();
			dlt_OPER_ALLOC_PL_ROUT_CNT.removeAll();
			//dlt_VIEW_OPER_PL_ROUT_INFO.removeAll();
			dlt_EXL_OPER_PL_ROUT_INFO.removeAll();
			dlt_BRT_OPER_ALLOC_PL_COR_INFO.removeAll();
			dlt_BRT_OPER_ALLOC_PL_COR_DTL_INFO.removeAll();
			var focusIndex = AL0202G0.getFocusedRowIndex();
			
			var dltBrtOperPlMst = dlt_BRT_OPER_PL_MST.getAllJSON();
			var repRoutId = dltBrtOperPlMst[focusIndex].REP_ROUT_ID;
			var repRoutNM = dltBrtOperPlMst[focusIndex].REP_ROUT_NM;
			var dayDiv = dltBrtOperPlMst[focusIndex].DAY_DIV;
			var routDiv = dltBrtOperPlMst[focusIndex].ROUT_DIV;
			var wayYn = dltBrtOperPlMst[focusIndex].WAY_YN;
			var wayAscNm = dltBrtOperPlMst[focusIndex].WAY_ASC_NM;
			var wayDescNm = dltBrtOperPlMst[focusIndex].WAY_DESC_NM;
			
			var oldAllocIndex = -1;
			var allocNO = 1;
			
			var operIndex = 0;
			for(var i=0;i<allocCnt;i++){
				//var wayDiv = "WD001";
				var j=0;
				for(j=0;j<columnCnt;j++){
					var rowData = {
						REP_ROUT_ID : repRoutId,
						REP_ROUT_NM : repRoutNM,
						DAY_DIV : dayDiv,
						WAY_ASC_NM : wayAscNm,
						WAY_DESC_NM : wayDescNm,
						ALLOC_NO : allocNO
						//WAY_DIV : wayDiv
					};

					operAllocIndex++;
					scwin.setOperAllocRowJsonData(operAllocIndex,rowData);
					scwin.setCorDtlRowJsonData(operAllocIndex, rowData);
					operIndex ++;
					if(operIndex>=operCnt){
						j++;
						break;
					}
				}
				scwin.setAllocCntData((allocNO-1), j);
				allocNO++;
				if(operIndex>=operCnt){
					break;
				}
			}
		}
		scwin.setGridExcelInfo(); //엑셀용 화면 및 데이터 구성
		scwin.setGridViewInfo(); //그리드 화면 및 데이터 구성
		dlt_OPER_ALLOC_PL_ROUT_INFO.modifyAllStatus("R");
	}
	
	scwin.setGridViewInfo = function() {
		
		var column = {};
		var columnNmArr1 = ["REP_ROUT_ID","REP_ROUT_NM","DAY_DIV","ALLOC_NO","WAY_DIV"];
		var columnStrArr1 = ["대표노선ID","대표노선명","요일구분","배차","방향구분"];
		var columnWidthArr1 = ["0","0","70","70","75"];
		var columnNmArr2 = ["INDEX","COR_ID","ROUT_NM","OPER_SN","OPER_INFO_1","OPER_INFO_2","OPER_INFO_3"];
		var columnStrArr2 = ["인덱스","코스ID","노선명","운행순번","시작(시분)","종료(시분)","휴게(분초)"];
		var columnWidthArr2 = ["0","0","0","0","65","65","65"];	
		var gridHeader ="", gridBody="";
		var rowData = dlt_OPER_ALLOC_PL_ROUT_INFO.getAllJSON();
		var rowCntArr = dlt_OPER_ALLOC_PL_ROUT_CNT.getAllJSON();
		var maxCnt = 0;
		
		dlt_VIEW_OPER_PL_ROUT_INFO.removeAll();
				
		for(var i = 0; i < rowCntArr.length; i++) {
			if(maxCnt < rowCntArr[i].CNT)
				maxCnt = rowCntArr[i].CNT;
		}
		if(maxCnt <= 7){
			columnWidthArr2 = ["0","0","0","0","65","65","65"];	
		}

		gridHeader +='<w2:row style="" id="first_row">';
		for(var i = 3; i < columnNmArr1.length; i++) {
			//gridView의 컬럼 정보 정의
			gridHeader +='<w2:column blockSelect="false" id="'+'h'+columnNmArr1[i]+'" style="height:25px" inputType="text"'
							+' width="' + columnWidthArr1[i]+'" value="'+columnStrArr1[i]+'" rowSpan="2"></w2:column>';
				
			gridBody += '<w2:column blockSelect="false" id="'+columnNmArr1[i]+'" style="height:25px" class="'+columnNmArr1[i]+'" inputType="text"></w2:column>'
		}
		
		var operInfoIdx = 1;
		if(rowData.length == 0 ) {
			
			gridHeader +='<w2:column blockSelect="false" id="hOPER_INFO" style="height:25px" inputType="text"'
							+' width="" value="운행정보(' +operInfoIdx+ ')" colSpan="3"></w2:column>';
			operInfoIdx ++;
			gridHeader +='</w2:row>';
				
			gridHeader +='<w2:row style="" id="second_row">';
			for(var i = 4; i < columnNmArr2.length; i++) {
				gridHeader +='<w2:column blockSelect="false" id="'+'h'+columnNmArr2[i]+'" style="height:25px" inputType="text"'
								+' width="300px" value="'+columnStrArr2[i]+'" rowSpan="1"></w2:column>';
				gridBody += '<w2:column blockSelect="false" id="'+columnNmArr2[i]+'" style="height:25px" inputType="text"></w2:column>'
			}
			gridHeader +='</w2:row>';
			
			
			var gridStr = '<w2:gridView xmlns:w2="http://www.inswave.com/websquare" xmlns:ev="http://www.w3.org/2001/xml-events" dataList="dlt_VIEW_OPER_PL_ROUT_INFO" sortable="false" '
							+ 'scrollByColumn="true" id="AL0202G1" class ="cm_grid right AL0202G1" fixedColumnWithHidden="true" useShiftKey="false" mergeCells="byrestriccol" mergeCol="ALLOC_NO,WAY_DIV">'
			+ '<w2:header id="header1" style="">'
			+ gridHeader
			+'</w2:header>'
			+'<w2:gBody id="gBody1" style="">'
			+'<w2:row id="row2" style="">'
			+ gridBody
			+'</w2:row>'
			+'</w2:gBody>'
			+'</w2:gridView>' ;
			
			AL0202G1.setGridStyle(WebSquare.xml.parse( gridStr , true ));
			dlt_VIEW_OPER_PL_ROUT_INFO.removeAll();
			autoOptions.Sub1.grid = AL0202G3;
			
			return;
		}
		
		operInfoIdx = 1;
		for(var i = 0; i < maxCnt; i++) {
			if(i==maxCnt-1){
				gridHeader +='<w2:column blockSelect="false" id="hOPER_INFO'+'_'+i+'" style="height:25px" inputType="text"'
							+' width="" value="운행정보(' +operInfoIdx+ ')" colSpan="5"></w2:column>';
				operInfoIdx ++;
				gridHeader +='<w2:column blockSelect="false" id="dummy'+'_'+i+'" style="height:25px" inputType="text"'
								+' width="" value="" colSpan="1"></w2:column>';
			}
			else {
				gridHeader +='<w2:column blockSelect="false" id="hOPER_INFO'+'_'+i+'" style="height:25px" inputType="text"'
							+' width="" value="운행정보(' +operInfoIdx+ ')" colSpan="6"></w2:column>';
				operInfoIdx ++;
			}
		}
		gridHeader +='</w2:row>';
		gridHeader +='<w2:row style="" id="second_row">';
		for(var i = 0; i < maxCnt; i++) {
			for(var j = 4; j < columnNmArr2.length; j++) {
				gridHeader +='<w2:column blockSelect="false" id="'+'h'+columnNmArr2[j]+'_'+i+'" style="height:25px" inputType="text"'
								+' width="' + columnWidthArr2[j]+'" value="'+columnStrArr2[j]+'" rowSpan="1"></w2:column>';
				gridBody += '<w2:column blockSelect="false" id="'+columnNmArr2[j]+'_'+i+'" style="height:25px" inputType="text"></w2:column>'
			
				gridHeader +='<w2:column blockSelect="false" id="hempty_'+(j-3)+'_'+i+'" style="height:25px" inputType="text"'
									+' width="0" value="" rowSpan="1"></w2:column>';
				gridBody += '<w2:column blockSelect="false" id="empty_'+(j-3)+'_'+i+'" style="height:25px" inputType="text"></w2:column>'
			}
		}
		gridHeader +='</w2:row>';
		var rowIndex = 0;
		var rowCnt = 0;
		for(var i = 0; i < rowCntArr.length; i++) {
			rowIndex += rowCnt;
			rowCnt =  rowCntArr[i].CNT;
			
			var idx = dlt_VIEW_OPER_PL_ROUT_INFO.insertRow();
			
			var wayVal ="";
			var allocVal ="";
			if(dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex,"WAY_DIV") == "WD001"){
				wayVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex, "WAY_ASC_NM");
				if(com.isEmpty(wayVal))wayVal="상행";
			}
			else if(dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex, "WAY_DIV") == "WD002"){
				wayVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex, "WAY_DESC_NM");
				if(com.isEmpty(wayVal))wayVal="하행";
			}
	
			allocVal =dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex, "ALLOC_NO");
	
			dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, "WAY_DIV", wayVal+"("+allocVal+")");
			dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, "ALLOC_NO", "B"+allocVal);
			
			var routNm = "";
			var operSn = "";
			for(var j = 0; j < rowCnt; j++) {
				var index = rowIndex+j;
				for(var x = 0; x < columnNmArr2.length; x++) {
					if(columnNmArr2[x]=="INDEX"){
						dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, index);
					}
					else if(columnNmArr2[x]=="ROUT_NM"){
						routNm = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, columnNmArr2[x]);
					}
					else if(columnNmArr2[x]=="OPER_SN"){
						operSn = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, columnNmArr2[x]);
					}
					else if(columnNmArr2[x]=="OPER_INFO_1"){
						if(com.isEmpty(routNm)==false){
							dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, routNm +"("+operSn+")");
							dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, 'empty_1_'+j, routNm +"("+operSn+")");//화면 머지 않되도록 구분 처리를 위해 empty 추가
						}
						else{
							dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, "(공백)");
							dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, 'empty_1_'+j, "(공백)");//화면 머지 않되도록 구분 처리를 위해 empty 추가
						}
					}
					else if(columnNmArr2[x]=="OPER_INFO_2"){
						if(com.isEmpty(routNm)==false){
							dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, routNm +"("+operSn+")");
							dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, 'empty_2_'+j, routNm +"("+operSn+")"); //화면 머지 않되도록 구분 처리를 위해 empty 추가
						}
						else{
							dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, "(공백)");
							dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, 'empty_2_'+j, "(공백)");//화면 머지 않되도록 구분 처리를 위해 empty 추가
						}
					}
					else if(columnNmArr2[x]=="OPER_INFO_3"){
						if(com.isEmpty(routNm)==false){
							dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, routNm +"("+operSn+")");
							//dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, 'empty_3_'+j, routNm +"("+operSn+")"); //화면 머지 않되도록 구분 처리를 위해 empty 추가
						}
						else{
							dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, "(공백)");
							//dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, 'empty_3_'+j, "(공백)");//화면 머지 않되도록 구분 처리를 위해 empty 추가
						}
					}
					else {
						var columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, columnNmArr2[x]);
						dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, columnVal);
					}
				}
			}
			
			var idx = dlt_VIEW_OPER_PL_ROUT_INFO.insertRow();
			var wayVal ="";
			var allocVal ="";
			if(dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex,"WAY_DIV") == "WD001"){
				wayVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex, "WAY_ASC_NM");
			}
			else if(dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex, "WAY_DIV") == "WD002"){
				wayVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex, "WAY_DESC_NM");
			}
	
			allocVal =dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex, "ALLOC_NO");
	
			dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, "WAY_DIV", wayVal+"("+allocVal+")");
			dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, "ALLOC_NO", "B"+allocVal);
			
			for(var j = 0; j < rowCnt; j++) {
				var index = rowIndex+j;
				for(var x = 0; x < columnNmArr2.length; x++) {
					if(columnNmArr2[x]=="INDEX"){
						dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, index);
					}
					else if(columnNmArr2[x]=="OPER_INFO_1"){
						var columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, "ROUT_ST_TM");
						if(com.isEmpty(columnVal))columnVal="00:00";
						dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, columnVal);
					}
					else if(columnNmArr2[x]=="OPER_INFO_2"){
						var columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, "ROUT_ED_TM");
						if(com.isEmpty(columnVal))columnVal="00:00";
						dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, columnVal);
					}
					else if(columnNmArr2[x]=="OPER_INFO_3"){
						var columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, "REST_TM");
						if(com.isEmpty(columnVal))columnVal="00:00";
						dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, columnVal);
					}
					else {
						var columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, columnNmArr2[x]);
						dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, columnVal);
					}
				}
			}
		}
		
		//gridView 정보 정의 
		//xml 형식을 정의 하면 <w2:gridView 에 xmlns:w2="http://www.inswave.com/websquare" xmlns:ev="http://www.w3.org/2001/xml-events" 포함 합니다.
		var gridStr = '<w2:gridView xmlns:w2="http://www.inswave.com/websquare" xmlns:ev="http://www.w3.org/2001/xml-events" dataList="dlt_VIEW_OPER_PL_ROUT_INFO" '
						+ 'scrollByColumn="true" id="AL0202G1" class ="cm_grid right AL0202G1" fixedColumnWithHidden="true" useShiftKey="false"  sortable="false" '
						+ 'fixedColumn="2"  mergeCellsFixedCols="bycol"  mergeCells="bycolrec" ev:oneditkeyup="scwin.AL0202G1_oneditkeyup" ev:oncustomcopy="scwin.AL0202G1_oncustomcopy" ev:oncustompaste="scwin.AL0202G1_oncustompaste" '
						+ 'ev:onrowindexchange="scwin.AL0202G1_onrowindexchange" ev:oncelldblclick="scwin.AL0202G1_oncelldblclick" ev:onrightbuttonclick="scwin.AL0202G1_onrightkeyup" >'
		+ '<w2:header id="header1" style="text-align:left">'
		+ gridHeader
		+'</w2:header>'
		+'<w2:gBody id="gBody1" style="">'
		+'<w2:row id="row2" style="">'
		+ gridBody
		+'</w2:row>'
		+'</w2:gBody>'
		+'</w2:gridView>' ;
		
		AL0202G1.setGridStyle(WebSquare.xml.parse( gridStr , true ));
		
		autoOptions.Sub1.grid = AL0202G3;

		dlt_VIEW_OPER_PL_ROUT_INFO.modifyAllStatus("R");
		
		rowIndex = 0;
		rowCnt = 0;
		var param = com.getParameter();
		var rowNum = 0;
		for(var i = 0; i < rowCntArr.length; i++) {
			rowIndex += rowCnt;
			rowCnt =  rowCntArr[i].CNT;
			var underLineCnt = 1;
			var oldUnderLineCnt = 1;
			var num = 2;
			for(var j = 0; j < rowCnt; j++) {
				var index = rowIndex+j;
				for(var x = 4; x < columnNmArr2.length; x++) {
					var color = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, "COR_COLOR");
					AL0202G1.setCellColor(i*2, columnNmArr2[x]+'_'+j, color);
					AL0202G1.setCellColor(i*2+1, columnNmArr2[x]+'_'+j, color);
				}
				
				var corId = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, "COR_ID");
				var corCnt = dlt_COR_CNT.getMatchedJSON("COR_ID", corId)[0].CNT;
				if(underLineCnt == 1){
					$("#mf_tac_layout_contents_"+param.menuCode+"_body_AL0202G1_cell_"+rowNum+"_"+num+"").children().css({'text-decoration':'underline', 'text-underline-position':'under'});
					//AL0202G1.setCellColor(i*2, columnNmArr2[4]+'_'+j, 'red');
					//AL0202G1.setCellDataType(i*2, columnNmArr2[4]+'_'+j, "link");
					//AL0202G1.setCellCustomFormatter(i*2, columnNmArr2[4]+'_'+j, scwin.underline);
					num+=6;
					underLineCnt = corCnt;
					if(corCnt != 1){
						oldUnderLineCnt++;
					}
				}else if(underLineCnt == oldUnderLineCnt){
					num+=6;
					underLineCnt = 1;
					oldUnderLineCnt = 1;
				}else if(underLineCnt != oldUnderLineCnt){
					num+=6;
					oldUnderLineCnt++;
				}
			}
			rowNum += 2;

		}
	}
	
	
	scwin.setGridExcelInfo = function() {

		var column = {};
		var columnNmArr1 = ["REP_ROUT_ID","REP_ROUT_NM","DAY_DIV","WAY_DIV","ALLOC_NO"];
		var columnStrArr1 = ["대표노선ID","대표노선명","요일구분","방향구분","배차번호"];
		var columnWidthArr1 = ["0","0","70","70","70"];
		var columnNmArr2 = ["COR_ID","ROUT_ID","ROUT_NM","OPER_SN","ROUT_ST_TM","ROUT_ED_TM","REST_TM"];
		var columnStrArr2 = ["코스ID","노선ID","노선명","운행순번","시작시간","종료시간","휴게시간"];
		var columnWidthArr2 = ["50","50","50","50","70","70","70"];
		var columnArr = [];		
		var gridHeader ="", gridBody="";
		var rowData = dlt_OPER_ALLOC_PL_ROUT_INFO.getAllJSON();
		var rowCntArr = dlt_OPER_ALLOC_PL_ROUT_CNT.getAllJSON();
		
		var maxCnt = 0;
		
		for(var i = 0; i < rowCntArr.length; i++) {
			if(maxCnt < rowCntArr[i].CNT)
				maxCnt = rowCntArr[i].CNT;
		}
		
		if(maxCnt==0)maxCnt=30;
		
		for(var i = 3; i < columnNmArr1.length; i++) {
			//gridView의 컬럼 정보 정의
			gridHeader +='<w2:column blockSelect="false" id="'+'header'+columnNmArr1[i]+'" style="height:20px" inputType="text" width="'+columnWidthArr1[i]+'" value="'+columnStrArr1[i]+'"></w2:column>';
			gridBody += '<w2:column blockSelect="false" id="'+columnNmArr1[i]+'" style="height:20px" inputType="text" width="'+columnWidthArr1[i]+'"></w2:column>'
		}
		
		if(rowData.length == 0 ) {
			/*for(var i = 0; i < columnNmArr2.length; i++) {
				//gridView의 컬럼 정보 정의
				gridHeader +='<w2:column blockSelect="false" id="'+'header'+columnNmArr2[i]+'" style="height:25px; " textAlign="" inputType="text" width="'+columnWidthArr2[i]+'" value="'+columnStrArr2[i]+'"></w2:column>';
			}*/
			for(var i = 0; i < 30; i++) {
				for(var j = 0; j < columnNmArr2.length; j++) {
					//gridView의 컬럼 정보 정의
					gridHeader +='<w2:column blockSelect="false" id="'+'header'+columnNmArr2[j]+'_'+i+'" style="height:25px; " textAlign="" inputType="text" width="'+columnWidthArr2[j]
								+'" value="'+columnStrArr2[j]+'"></w2:column>';
					gridBody += '<w2:column blockSelect="false" id="'+columnNmArr2[j]+'_'+i+'" style="height:20px" inputType="text" width=""></w2:column>'
				}
				
			}
			
			var gridStr = '<w2:gridView xmlns:w2="http://www.inswave.com/websquare" xmlns:ev="http://www.w3.org/2001/xml-events" dataList="dlt_EXL_OPER_PL_ROUT_INFO" '
							+ 'scrollByColumn="true" id="AL0202G2" class ="" style="height:0px" fixedColumnWithHidden="true" useShiftKey="false" '
							+ 'ev:onfilereadend="scwin.AL0202G2_onfilereadend" mergeCells="byrestriccol" mergeCol="ALLOC_NO,WAY_DIV">'
			+ '<w2:header id="header1" >'
			+ '<w2:row id="row1" style="">'
			+ gridHeader
			+ '</w2:row>'
			+'</w2:header>'
			+'<w2:gBody id="gBody1" style="">'
			+'<w2:row id="row2" style="">'
			+ gridBody
			+'</w2:row>'
			+'</w2:gBody>'
			+'</w2:gridView>' ;
			
			AL0202G2.setGridStyle(WebSquare.xml.parse( gridStr , true ));
			dlt_EXL_OPER_PL_ROUT_INFO.removeAll();
			
			autoOptions.Sub1.exlGrid = AL0202G2;
			return;
		}
		
		dlt_EXL_OPER_PL_ROUT_INFO.removeAll();

		for(var i = 0; i < 30; i++) {
			for(var j = 0; j < columnNmArr2.length; j++) {
				//gridView의 컬럼 정보 정의
				gridHeader +='<w2:column blockSelect="false" id="'+'header'+columnNmArr2[j]+'_'+i+'" style="height:25px; " textAlign="" inputType="text" width="'+columnWidthArr2[j]
							+'" value="'+columnStrArr2[j]+'"></w2:column>';
				gridBody += '<w2:column blockSelect="false" id="'+columnNmArr2[j]+'_'+i+'" style="height:20px" inputType="text" width=""></w2:column>'
			}
			
		}

		var rowIndex = 0;
		var rowCnt = 0;
		
		for(var i = 0; i < rowCntArr.length; i++) {
			rowIndex += rowCnt;
			rowCnt =  rowCntArr[i].CNT;
			
			var idx = dlt_EXL_OPER_PL_ROUT_INFO.insertRow();
			for(var j = 0; j < rowCnt; j++) {
				for(var x = 0; x < columnNmArr1.length; x++) {
					var columnVal ="";
					/*if(columnNmArr1[x]=="WAY_DIV"){
						if(dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr1[x]) == "WD001"){
							columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, "WAY_ASC_NM");
						}
						else if(dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr1[x]) == "WD002"){
							columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, "WAY_DESC_NM");
						}
					}
					else*/ 
					if(columnNmArr1[x]=="ALLOC_NO"){
						columnVal = /*"B"+*/dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr1[x]);
					}
					else{
						columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr1[x]);
					}
					dlt_EXL_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr1[x], columnVal);
				}
				for(var x = 0; x < columnNmArr2.length; x++) {
					var columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr2[x]);
					dlt_EXL_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+"_"+j, columnVal);
				}
			}
		}
		
		//gridView 정보 정의 
		//xml 형식을 정의 하면 <w2:gridView 에 xmlns:w2="http://www.inswave.com/websquare" xmlns:ev="http://www.w3.org/2001/xml-events" 포함 합니다.
		var gridStr = '<w2:gridView xmlns:w2="http://www.inswave.com/websquare" xmlns:ev="http://www.w3.org/2001/xml-events" dataList="dlt_EXL_OPER_PL_ROUT_INFO" '
						+ ' ev:onfilereadend="scwin.AL0202G2_onfilereadend" scrollByColumn="true" id="AL0202G2" class ="" style="height:0px" '
						+ ' fixedColumnWithHidden="true" useShiftKey="false">'
		+ '<w2:header id="header1" style="text-align:left">'
		+ '<w2:row id="row1" style="">'
		+ gridHeader
		+ '</w2:row>'
		+'</w2:header>'
		+'<w2:gBody id="gBody1" style="">'
		+'<w2:row id="row2" style="">'
		+ gridBody
		+'</w2:row>'
		+'</w2:gBody>'
		+'</w2:gridView>' ;
		
		AL0202G2.setGridStyle(WebSquare.xml.parse( gridStr , true ));
		
		autoOptions.Sub1.exlGrid = AL0202G2;

		dlt_EXL_OPER_PL_ROUT_INFO.modifyAllStatus("R")
	};
	
	
	
	scwin.AL0202G1_oncustomcopy = function(e) {
		
		copyViewIndex = AL0202G1.getFocusedRowIndex();
		return false;
	};
	
	scwin.AL0202G1_oncustompaste = function(e) {
	
			
		var colViewIndex = 0;
		var fromAllocIndex = parseInt(copyViewIndex/2);
		var fromOperAllocIndex = scwin.getOperAllocIndexByView2(copyViewIndex, colViewIndex);
		var fromAllocOperCnt = scwin.getAllocCntData(fromAllocIndex);		
		var toViewIndex = AL0202G1.getFocusedRowIndex();
		var toAllocIndex = parseInt(toViewIndex/2);
		var toOperAllocIndex = scwin.getOperAllocIndexByView2(toViewIndex, colViewIndex);
		var toAllocOperCnt = scwin.getAllocCntData(toAllocIndex);

		if(fromAllocOperCnt > toAllocOperCnt){
			for(var i = 0; i<fromAllocOperCnt; i++){
				var data = scwin.getCorDtlRowJsonData(fromOperAllocIndex+i);
				if(i < toAllocOperCnt){
					scwin.setOperAllocRowJsonData(toOperAllocIndex+i, data);
					scwin.setCorDtlRowJsonData(toOperAllocIndex+i, data);
				}
				else{
					scwin.insertOperAlloc(toOperAllocIndex+i,data);
					scwin.insertCorDtl(toOperAllocIndex+i, data);
				}
				
				scwin.setOperAllocCellData(toOperAllocIndex+i,'ALLOC_NO',(toAllocIndex+1));
				scwin.setCorDtlCellData(toOperAllocIndex+i,'ALLOC_NO',(toAllocIndex+1));
			}
			OPER_CNT.setValue(dlt_OPER_ALLOC_PL_ROUT_INFO.getRowCount());
			scwin.setAllocCntData(toAllocIndex,fromAllocOperCnt);
			scwin.setGridExcelInfo(); //엑셀용 화면 및 데이터 구성
			scwin.setGridViewInfo(); //그리드 화면 및 데이터 구성

		}
		else {
			for(var i = 0; i<fromAllocOperCnt; i++){
				var data = scwin.getCorDtlRowJsonData(fromOperAllocIndex+i);
				scwin.setOperAllocRowJsonData(toOperAllocIndex+i, data);
				scwin.setCorDtlRowJsonData(toOperAllocIndex+i, data);
				
				scwin.setOperAllocCellData(toOperAllocIndex+i,'ALLOC_NO',(toAllocIndex+1));
				scwin.setCorDtlCellData(toOperAllocIndex+i,'ALLOC_NO',(toAllocIndex+1));
				
				var operSn = scwin.getOperAllocCellData(toOperAllocIndex+i,"OPER_SN");
				var color = data.COR_COLOR;
				var value = "";
				
				if(com.isEmpty(operSn)){
					value = data.ROUT_NM;
					for(var j = 1; j <=3; j++){
						scwin.setViewCellData(toViewIndex, "OPER_INFO_"+j, colViewIndex, value);
						scwin.setViewCellData(toViewIndex, "empty_"+j, colViewIndex, value);
						AL0202G1.setCellColor(toViewIndex, "OPER_INFO_"+j+"_"+colViewIndex, color);
						AL0202G1.setCellColor(toViewIndex+1, "OPER_INFO_"+j+"_"+colViewIndex, color);
						if(j==3){
							scwin.setViewCellData(toViewIndex+1, "OPER_INFO_"+j, colViewIndex, data.REST_TM);
						}
					}	
				}
				else {
					value = data.ROUT_NM +"("+operSn+")";
					for(var j = 1; j <=3; j++){
						scwin.setViewCellData(toViewIndex, "OPER_INFO_"+j, colViewIndex, value);
						scwin.setViewCellData(toViewIndex, "empty_"+j, colViewIndex, value);
						AL0202G1.setCellColor(toViewIndex, "OPER_INFO_"+j+"_"+colViewIndex, color);
						AL0202G1.setCellColor(toViewIndex+1, "OPER_INFO_"+j+"_"+colViewIndex, color);
						if(j==3){
							scwin.setViewCellData(toViewIndex+1, "OPER_INFO_"+j, colViewIndex, data.REST_TM);
						}
					}	
				}
					
				scwin.setExlCellData(toAllocIndex, "COR_ID", colViewIndex, data.COR_ID);
				scwin.setExlCellData(toAllocIndex, "ROUT_ID", colViewIndex, data.ROUT_ID);
				
				//index ++;
				colViewIndex ++;
			}
		}
		return false;
	};
	
	scwin.AL0202G2_onfilereadend = function(value) {
		

		dlt_OPER_ALLOC_PL_ROUT_INFO.removeAll();
		dlt_OPER_ALLOC_PL_ROUT_CNT.removeAll();
		dlt_VIEW_OPER_PL_ROUT_INFO.removeAll();
		var isBreak = false;
		var isEnd = false;
		var index = 0;
		for(var i=0;i<dlt_EXL_OPER_PL_ROUT_INFO.getRowCount();i++){
			var columnNmArr1 = ["WAY_DIV","ALLOC_NO","REP_ROUT_ID","REP_ROUT_NM","DAY_DIV"/*, "WAY_ASC_NM","WAY_DESC_NM"*/];
			var columnNmArr2 = ["COR_ID","ROUT_ID","ROUT_NM","OPER_SN","ROUT_ST_TM","ROUT_ED_TM","REST_TM"];
			
			for(var j=0;j<30;j++){
				for(var x = 0; x < columnNmArr1.length; x++) {
					var columnVal = "";
					if(x<2){
						columnVal = scwin.getExlCellData(i, columnNmArr1[x]);
					}
					else {
						columnVal = dlt_BRT_OPER_PL_MST.getCellData(AL0202G0.getFocusedRowIndex(), columnNmArr1[x])
					}
					if(com.isEmpty(columnVal)){
						isEnd = true;
						break;
					}
					scwin.setOperAllocCellData(index, columnNmArr1[x], columnVal);
					scwin.setCorDtlCellData(index, columnNmArr1[x], columnVal);
				}
				if(isEnd){
					break;
				}
				for(var x = 0; x < columnNmArr2.length; x++) {
					var columnVal = scwin.getExlCellData(i, columnNmArr2[x],j);
					if(x>3){
						columnVal = util.getExlDateToMinSec(columnVal);
					}
					if(x<(columnNmArr2.length-1)&&com.isEmpty(columnVal)){
						isBreak = true;
						break;
					}
					scwin.setOperAllocCellData(index, columnNmArr2[x], columnVal);
					scwin.setCorDtlCellData(index, columnNmArr2[x], columnVal);
				}
				
				if(isBreak){
					scwin.setAllocCntData(i,j);
					isBreak = false;
					break;
				}
				index++;
			}
			if(isEnd){
				ALLOC_CNT.setValue(i);
				break;
			}
		}
		scwin.courseDtlToCourse();
		scwin.setGridViewInfo(); //그리드 화면 및 데이터 구성
	}
	]]></script>
	</head>
	<body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
		<xf:group id="pgm_container" class="pgm_container grdr_60_a" style="">
		
			<xf:group id="" class="grdc_2f_8f title-wrap" style="">
				<xf:group id="pgm_header_left" class="pgm_header_left" style="">
					<w2:wframe id="wfm_title" style="" src="/cm/common/wf_title.xml" scope="true"></w2:wframe>
				</xf:group>
				<xf:group id="pgm_header_right" class="pgm_header_right" style="">
					<xf:group id="pgm_rightNavi" class="pgm_rightNavi" style="">
						<w2:wframe id="rightNavi" class="" style="" src="/cm/common/wf_rightNavi.xml" scope="true"></w2:wframe>
					</xf:group>
					<xf:group id="pgm_header" class="pgm_header" style="">
						<w2:wframe id="wfm_mainBtn" class="main_Btn" style="float:right" src="/cm/common/wf_mainBtn.xml" scope="true"></w2:wframe>
					</xf:group>
				</xf:group>
			</xf:group>
		
			<xf:group id="pgm_content" class="pgm_content grdc_3f_0_7f" style="">
				<xf:group id="pgm_list" class="pgm_list grdr_20_50_a bms_box_wrap" style="">
					<xf:group id="" class="" style="">
						<xf:group class="defaultbox" id="" style="">
							<w2:textbox class="df_tt fl list ico-list" id="" label="배차편성 목록" style=""></w2:textbox>
						</xf:group>
					</xf:group>
					
					<xf:group id="" class="" style="">
						<xf:group id="" style="" class="gr_search">
							<xf:group id="" style="" class="label">
									<w2:span id="" class="" label="검색 항목"></w2:span>
							</xf:group>
							<xf:group class="search" id="pgm_search" style="">
								<xf:select1 allOption="" appearance="minimal" chooseOption="" direction="auto" disabled="false"
									disabledClass="w2selectbox_disabled" displayMode="label" ev:onviewchange="scwin.sbx_ChoiceBox_onviewchange" id="TYPE10"
									optionOrder="false" ref="data:dma_search.TYPE" style="width:100px;margin-right: 10px;float:left;" submenuSize="auto"
									textAlign="left">

									<xf:choices>
										<xf:item>
											<xf:label><![CDATA[전체]]></xf:label>
											<xf:value><![CDATA[ALL]]></xf:value>
										</xf:item>
										<xf:item>
											<xf:label><![CDATA[대표노선ID]]></xf:label>
											<xf:value><![CDATA[REP_ROUT_ID]]></xf:value>
										</xf:item>
										<xf:item>
											<xf:label><![CDATA[대표노선명]]></xf:label>
											<xf:value><![CDATA[REP_ROUT_NM]]></xf:value>
										</xf:item>
									</xf:choices>
								</xf:select1>
								<xf:input id="search_input" class="search_input" ref="data:dma_search.CONTENT" placeholder="대표노선 ID 또는 대표노선명"></xf:input>
								<w2:autoComplete allOption="" caseSensitive="false" chooseOption="true" chooseOptionLabel="-전체-"
									chooseOptionValue="" displayMode="label" editType="select" emptyItem="" emptyValue="" ev:onchange="" ev:onviewchange=""
									id="autoChoiceBox" interactionMode="" noResult="useData" ref="data:dma_search.CONTENT" search="start" selectedData=""
									class="search_auto" style="display:none" submenuSize="auto" textAlign="left" useKeywordHighlight="false" visibleRowNum="">
									<w2:choices>
										<w2:itemset nodeset="data:dlt_repRoutItem">
											<w2:label ref="REP_ROUT_NM"></w2:label>
											<w2:value ref="REP_ROUT_ID"></w2:value>
										</w2:itemset>
									</w2:choices>
								</w2:autoComplete>
							</xf:group>
							<w2:wframe id="wfm_mainSearchBtn" class="wfm_mainSearchBtn" style="" src="/cm/common/wf_mainSrhBtn.xml" scope="true"></w2:wframe>							
						</xf:group>
					</xf:group>
				
					<xf:group id="" class="" style="">
						<w2:gridView alwaysTriggerScrollStart="" captionTitle="" id="AL0202G0" class="cm_grid left AL0202G0" sortable="false" 
							dataList="data:dlt_BRT_OPER_PL_MST" ev:onrowindexchange="scwin.AL0202G0_onrowindexchange" fixedColumnWithHidden="true"
							autoFit="lastColumn" ignoreCellClick="false" rowNumHeaderValue="No." rowNumVisible="true" mergeCells="byrestriccol"
							rowStatusVisible="false" rowStatusWidth="40" scrollByColumn="true" style="" useShiftKey="true"
							autoFitMinWidth="0" focusMode="row" readOnly="true" tooltipDisplay="true" tooltipPositionX="0" tooltipPositionY="5">
							<w2:header style="" id="header1">
								<w2:row style="" id="routInfo_row1">
									<w2:column removeBorderStyle="false" width="80" inputType="text" style="height:20px"
										id="col_REP_ROUT_ID" value="대표노선ID" blockSelect="false" displayMode="label"  rowSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="55" inputType="text" style="height:20px"
										id="col_REP_ROUT_NM" value="대표노선" blockSelect="false" displayMode="label"  rowSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="55" inputType="text" style="height:20px"
										id="col_DAY_DIV" value="요일구분" blockSelect="false" displayMode="label"  rowSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px"
										id="col_WAY_ASC_INFO" value="방면정보" blockSelect="false" displayMode="label"  colSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px"
										id="col_WAY_DESC_INFO" value="방면정보" blockSelect="false" displayMode="label"  colSpan="2">
									</w2:column>
								</w2:row>
								<w2:row style="" id="routInfo_row2">
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px"
										id="col_WAY_ASC_NM1" value="방면" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="150" inputType="text" style="height:20px"
										id="col_WAY_ASC_STR1" value="상세정보" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px"
										id="col_WAY_ASC_NM2" value="방면" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="150" inputType="text" style="height:20px"
										id="col_WAY_DESC_STR2" value="상세정보" blockSelect="false" displayMode="label">
									</w2:column>
								</w2:row>
							</w2:header>
							<w2:gBody style="" id="gBody1">
								<w2:row style="" id="row2">
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="REP_ROUT_ID"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="REP_ROUT_NM"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="select" style="height:20px" id="DAY_DIV"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" textAlign="left" style="height:20px; padding-left:5px" id="WAY_ASC_NM"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" textAlign="left" style="height:20px; padding-left:5px" id="WAY_ASC_STR"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" textAlign="left" style="height:20px; padding-left:5px" id="WAY_DESC_NM"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" textAlign="left" style="height:20px; padding-left:5px" id="WAY_DESC_STR"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
								</w2:row>
							</w2:gBody>
							<w2:footer style="" id="footer1">
								<w2:row style="" id="row3">
									<w2:column removeBorderStyle="false" width="NaN" inputType="expression" style="height:20px;"
										id="column42" value="" blockSelect="false" displayMode="label" colSpan="15" rowSpan=""
										expression="&quot;데이터 개수 : &quot; + COUNT(&apos;COMP_ID&apos;)" textAlign="left">
									</w2:column>
								</w2:row>
							</w2:footer>
						</w2:gridView>
					</xf:group>
				</xf:group>
				<xf:group id="" class=""></xf:group>
				<xf:group class="pgm_detail grdr_20_2_1f bms_box_wrap">
					<xf:group id="" class="gr_sub_header" style="">
						<xf:group class="defaultbox" id="" style="">
							<w2:textbox class="df_tt fl" id="" label="배차편성 상세" style=""></w2:textbox>
							<w2:span label="운행횟수 : " style="float: left; margin-left: 50px; margin-right: 8px;margin-top: 2px;" id=""></w2:span>
							<xf:input adjustMaxLength="false" id="OPER_CNT" ref="data:dlt_BRT_OPER_PL_MST.OPER_CNT" style="width: 50px; float: left; margin-right:15px" ev:onkeyup="" ev:oneditkeyup='scwin.cnt_oneditkeyup'></xf:input>
							<w2:span label="배차횟수 : " style="float: left; margin-right: 8px;margin-top: 2px;" id=""></w2:span>
							<xf:input adjustMaxLength="false" id="ALLOC_CNT" ref="data:dlt_BRT_OPER_PL_MST.ALLOC_CNT" style="width: 50px; float: left; margin-right:15px" ev:onkeyup="" ev:oneditkeyup="scwin.cnt_oneditkeyup"></xf:input>
							<!-- <w2:span label="시점방면 : " style="float: left; margin-right: 8px;margin-top: 2px;" id=""></w2:span>
							<xf:select1 id="ST_WAY" selectedIndex="-1" appearance="full" style="width: auto;height: 21px;" cols="" rows="1" ref="" ev:onviewchange="scwin.ST_WAY_onviewchange">
								<xf:choices>
									<xf:item>
										<xf:label><![CDATA[상행]]></xf:label>
										<xf:value><![CDATA[WD001]]></xf:value>
									</xf:item>
									<xf:item>
										<xf:label><![CDATA[하행]]></xf:label>
										<xf:value><![CDATA[WD002]]></xf:value>
									</xf:item>
								</xf:choices>
							</xf:select1>	 -->
						</xf:group>
						<w2:wframe id="wfm_subBtn" class="" style="" src="/cm/common/wf_subBtn.xml" scope="true"></w2:wframe>
					</xf:group>
					<xf:group class="" id="" style="">
					</xf:group>
					<xf:group class="" id="" style="">
						<w2:gridView id="AL0202G1" autoFit="" captionTitle="" class="cm_grid right AL0202G1" dataList="data:dlt_VIEW_OPER_PL_ROUT_INFO" sortable="false" 
							ev:onrowindexchange="scwin.AL0202G1_onrowindexchange" fixedColumnWithHidden="true" ignoreCellClick="false" rowNumHeaderValue="No."
							rowNumVisible="false" rowStatusVisible="false" rowStatusWidth="40" scrollByColumn="true" style="" useShiftKey="true" ev:oneditkeyup="scwin.AL0202G1_oneditkeyup"
							autoFitMinWidth="0" focusMode="cell" ev:oncelldblclick="scwin.AL0202G1_oncelldblclick" mergeCells="byrestriccol" mergeCol="ALLOC_NO,WAY_DIV" ev:onrightbuttonclick="scwin.AL0202G1_onrightkeyup" ev:oncustomcopy="scwin.AL0202G1_oncustomcopy" ev:oncustompaste="scwin.AL0202G1_oncustompaste">
							<w2:header style="" id="header1">
								<w2:row style="" id="row3">
									<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:40px;" id="col_WAY_DIV"
										value="구분" blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:40px;" id="col_ALLOC_NO"
										value="배차순번" blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px;" id="col_OPER_INFO"
										value="운행정보" blockSelect="false" displayMode="label" colSpan="3" rowSpan="">
									</w2:column>
								</w2:row>
								<w2:row style="" id="row1">
									<w2:column removeBorderStyle="false" width="300" inputType="text" style="height:20px" id="col_ROUT_INFO"
										value="노선정보" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="300" inputType="text" style="height:20px" id="col_ROUT_ED_TM"
										value="종료시간" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="300" inputType="text" style="height:20px" id="col_ROUT_ST_TM"
										value="시작시간" blockSelect="false" displayMode="label">
									</w2:column>
								</w2:row>
							</w2:header>
							<w2:gBody style="" id="gBody1">
								<w2:row style="" id="row2">
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="WAY_DIV"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="81" inputType="select" style="height:20px" id="ALLOC_NO"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="ROUT_INFO" value=""
										blockSelect="false" displayMode="label" readOnly="true">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="ROUT_ED_TM" value=""
										blockSelect="false" displayMode="label" readOnly="true">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="ROUT_ST_TM" value=""
										blockSelect="false" displayMode="label" textAlign="" readOnly="true">
									</w2:column>
								</w2:row>
							</w2:gBody>
						</w2:gridView>
						<w2:gridView id="AL0202G2" autoFit="" captionTitle="" class="" dataList="data:dlt_EXL_OPER_PL_ROUT_INFO"
							ev:onrowindexchange="" fixedColumnWithHidden="true" ignoreCellClick="false" rowNumHeaderValue="No."
							rowNumVisible="false" rowStatusVisible="false" rowStatusWidth="40" scrollByColumn="true" style="height:0px" useShiftKey="true"
							autoFitMinWidth="0" focusMode="cell" mergeCells="byrestriccol" mergeCol="ALLOC_NO,WAY_DIV">
							<w2:header style="" id="header1">
								<w2:row style="" id="row1">
									<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:25px"
										id="col_WAY_DIV" value="구분" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:25px"
										id="col_ALLOC_NO" value="배차" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column width="50" id="col_COR_ID" value="코스ID" rowSpan="" style="height:25px;" ></w2:column>
									<w2:column width="50" id="col_ROUT_ID" value="노선ID" rowSpan="" style="height:25px;" ></w2:column>
									<w2:column width="70" id="col_ROUT_ST_TM" value="시작(시분)" rowSpan="" style="height:25px;" ></w2:column>
									<w2:column width="70" id="col_ROUT_ED_TM" value="종료(시분)" rowSpan="" style="height:25px;" ></w2:column>
								</w2:row>
							</w2:header>
							<w2:gBody style="" id="gBody1">
								<w2:row style="" id="row2">
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="ALLOC_NO"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="WAY_DIV"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="COR_ID"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="ROUT_ID"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="ROUT_ED_TM"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="ROUT_ST_TM"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
								</w2:row>
							</w2:gBody>
						</w2:gridView>
						<w2:gridView id="AL0202G3" autoFit="" captionTitle="" class="" dataList="data:dlt_OPER_ALLOC_PL_ROUT_INFO"
							ev:onrowindexchange="" fixedColumnWithHidden="true" ignoreCellClick="false" rowNumHeaderValue="No."
							rowNumVisible="false" rowStatusVisible="false" rowStatusWidth="40" scrollByColumn="true" style="height:0px" useShiftKey="true"
							autoFitMinWidth="0" focusMode="cell" mergeCells="" mergeCol="">
							<w2:header style="" id="header1">
								<w2:row style="" id="row1">
									<w2:column width="50" id="col_REP_ROUT_ID" value="코스ID" rowSpan="" style="height:25px;" ></w2:column>
									<w2:column width="50" id="col_DAY_DIV" value="코스ID" rowSpan="" style="height:25px;" ></w2:column>
									<w2:column width="50" id="col_WAY_DIV" value="상하행구분" rowSpan="" style="height:25px;" ></w2:column>
									<w2:column width="50" id="col_ALLOC_NO" value="배차번호" rowSpan="" style="height:25px;" ></w2:column>
									<w2:column width="50" id="col_OPER_SN" value="운행순번" rowSpan="" style="height:25px;" ></w2:column>
									<w2:column width="50" id="col_COR_ID" value="코스ID" rowSpan="" style="height:25px;" ></w2:column>
									<w2:column width="50" id="col_ROUT_ID" value="노선ID" rowSpan="" style="height:25px;" ></w2:column>
									<w2:column width="70" id="col_ROUT_ST_TM" value="시작(시분)" rowSpan="" style="height:25px;" ></w2:column>
									<w2:column width="70" id="col_ROUT_ED_TM" value="종료(시분)" rowSpan="" style="height:25px;" ></w2:column>
									
								</w2:row>
							</w2:header>
							<w2:gBody style="" id="gBody1">
								<w2:row style="" id="row2">
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="REP_ROUT_ID"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="DAY_DIV"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="WAY_DIV"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="ALLOC_NO"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="OPER_SN"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="COR_ID"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="ROUT_ID"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="ROUT_ST_TM"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="ROUT_ED_TM"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
								</w2:row>
							</w2:gBody>
						</w2:gridView>
					</xf:group>
				</xf:group><!-- end detail -->
			</xf:group>
		</xf:group>
	</body>
</html>