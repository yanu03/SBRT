<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:w2="http://www.inswave.com/websquare"
	xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<style>
			#chartdiv {
			width: 100%;
			height: 500px;
			}

		</style>
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate />
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_BRT_OPER_PL_MST" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선명" dataType="text"></w2:column>
						<w2:column id="WAY_ASC_NM" name="상행명" dataType="text"></w2:column>
						<w2:column id="WAY_DESC_NM" name="하행명" dataType="text"></w2:column>
						<w2:column id="ST_STTN_NM" name="기점명" dataType="text"></w2:column>
						<w2:column id="ED_STTN_NM" name="종점명" dataType="text"></w2:column>
						<w2:column id="WAY_ASC_STR" name="상행문구" dataType="text"></w2:column>
						<w2:column id="WAY_DESC_STR" name="하행문구" dataType="text"></w2:column>
						<w2:column id="WAY_YN" name="상하행여부" dataType="text"></w2:column>
						<w2:column id="ROUT_DIV" name="노선구분" dataType="text"></w2:column>
						<w2:column id="OPER_CNT" name="운영횟수" dataType="text"></w2:column>
						<w2:column id="ALLOC_CNT" name="배차횟수" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_OPER_ALLOC_PL_ROUT_CNT" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="CNT" name="개수" dataType="number" defaultValue="0"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataMap baseNode="map" id="dma_search">
					<w2:keyInfo>
						<w2:key id="TYPE" name="name1" dataType="text"></w2:key>
						<w2:key id="CONTENT" name="name2" dataType="text"></w2:key>
						<w2:key id="USE_YN" name="name3" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_result">
					<w2:keyInfo>
						<w2:key id="STATUS" name="STATUS" dataType="text"></w2:key>
						<w2:key id="ICNT" name="입력건수" dataType="text"></w2:key>
						<w2:key id="UCNT" name="수정건수" dataType="text"></w2:key>
						<w2:key id="DCNT" name="삭제건수" dataType="text"></w2:key>
						<w2:key id="TYPE" name="TYPE" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_searchitem" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선명" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_OPER_ALLOC_PL_ROUT_INFO" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="WAY_DIV" name="상하행구분" dataType="text"></w2:column>
						<w2:column id="ALLOC_NO" name="배차번호" dataType="text"></w2:column>
						<w2:column id="OPER_SN" name="운행순번" dataType="text"></w2:column>
						<w2:column id="ROUT_ST_TM" name="노선시작시간" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM" name="노선종료시간" dataType="text"></w2:column>
						<w2:column id="ROUT_ID" name="노선ID" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선명" dataType="text"></w2:column>
						<w2:column id="ROUT_NM" name="노선명" dataType="text"></w2:column>
						<w2:column id="COR_ID" name="코스ID" dataType="text"></w2:column>
						<w2:column id="COR_NM" name="코스명" dataType="text"></w2:column>
						<w2:column id="COR_COLOR" name="코스ID" dataType="text"></w2:column>
						<w2:column id="WAY_ASC_NM" name="상행명" dataType="text"></w2:column>
						<w2:column id="WAY_DESC_NM" name="하행명" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList id="dlt_BRT_OPER_PL_ROUT_INFO_ASC" baseNode="list" saveRemovedData="true" repeatNode="map" ev:oncelldatachange="">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선아이디" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="WAY_DIV" name="상하행구분" dataType="text"></w2:column>
						<w2:column id="OPER_SN" name="운행순번" dataType="text"></w2:column>
						<w2:column id="ROUT_ID" name="노선아이디" dataType="text"></w2:column>
						<w2:column id="ROUT_ST_TM" name="노선시작시간" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM" name="노선종료시간" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선명" dataType="text"></w2:column>
						<w2:column id="ROUT_NM" name="노선명" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList id="dlt_BRT_OPER_PL_ROUT_INFO_DESC" baseNode="list" saveRemovedData="true" repeatNode="map" ev:oncelldatachange="">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선아이디" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="WAY_DIV" name="상하행구분" dataType="text"></w2:column>
						<w2:column id="OPER_SN" name="운행순번" dataType="text"></w2:column>
						<w2:column id="ROUT_ID" name="노선아이디" dataType="text"></w2:column>
						<w2:column id="ROUT_ST_TM" name="노선시작시간" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM" name="노선종료시간" dataType="text"></w2:column>
						<w2:column id="REP_ROUT_NM" name="대표노선명" dataType="text"></w2:column>
						<w2:column id="ROUT_NM" name="노선명" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_VIEW_OPER_PL_ROUT_INFO" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="WAY_DIV" name="상하행구분" dataType="text"></w2:column>
						<w2:column id="ALLOC_NO" name="배차번호" dataType="text"></w2:column>
						<w2:column id="INDEX_0"  dataType="text"></w2:column> <w2:column id="COR_ID_0" dataType="text"></w2:column> 
						<w2:column id="INDEX_1"  dataType="text"></w2:column> <w2:column id="COR_ID_1" dataType="text"></w2:column> 
						<w2:column id="INDEX_2"  dataType="text"></w2:column> <w2:column id="COR_ID_2" dataType="text"></w2:column> 
						<w2:column id="INDEX_3"  dataType="text"></w2:column> <w2:column id="COR_ID_3" dataType="text"></w2:column> 
						<w2:column id="INDEX_4"  dataType="text"></w2:column> <w2:column id="COR_ID_4" dataType="text"></w2:column> 
						<w2:column id="INDEX_5"  dataType="text"></w2:column> <w2:column id="COR_ID_5" dataType="text"></w2:column> 
						<w2:column id="INDEX_6"  dataType="text"></w2:column> <w2:column id="COR_ID_6" dataType="text"></w2:column> 
						<w2:column id="INDEX_7"  dataType="text"></w2:column> <w2:column id="COR_ID_7" dataType="text"></w2:column> 
						<w2:column id="INDEX_8"  dataType="text"></w2:column> <w2:column id="COR_ID_8" dataType="text"></w2:column> 
						<w2:column id="INDEX_9"  dataType="text"></w2:column> <w2:column id="COR_ID_9" dataType="text"></w2:column> 
						<w2:column id="INDEX_10" dataType="text"></w2:column> <w2:column id="COR_ID_10" dataType="text"></w2:column>
						<w2:column id="INDEX_11" dataType="text"></w2:column> <w2:column id="COR_ID_11" dataType="text"></w2:column>
						<w2:column id="INDEX_12" dataType="text"></w2:column> <w2:column id="COR_ID_12" dataType="text"></w2:column>
						<w2:column id="INDEX_13" dataType="text"></w2:column> <w2:column id="COR_ID_13" dataType="text"></w2:column>
						<w2:column id="INDEX_14" dataType="text"></w2:column> <w2:column id="COR_ID_14" dataType="text"></w2:column>
						<w2:column id="INDEX_15" dataType="text"></w2:column> <w2:column id="COR_ID_15" dataType="text"></w2:column>
						<w2:column id="INDEX_16" dataType="text"></w2:column> <w2:column id="COR_ID_16" dataType="text"></w2:column>
						<w2:column id="INDEX_17" dataType="text"></w2:column> <w2:column id="COR_ID_17" dataType="text"></w2:column>
						<w2:column id="INDEX_18" dataType="text"></w2:column> <w2:column id="COR_ID_18" dataType="text"></w2:column>
						<w2:column id="INDEX_19" dataType="text"></w2:column> <w2:column id="COR_ID_19" dataType="text"></w2:column>
						<w2:column id="INDEX_20" dataType="text"></w2:column> <w2:column id="COR_ID_20" dataType="text"></w2:column>
						<w2:column id="INDEX_21" dataType="text"></w2:column> <w2:column id="COR_ID_21" dataType="text"></w2:column>
						<w2:column id="INDEX_22" dataType="text"></w2:column> <w2:column id="COR_ID_22" dataType="text"></w2:column>
						<w2:column id="INDEX_23" dataType="text"></w2:column> <w2:column id="COR_ID_23" dataType="text"></w2:column>
						<w2:column id="INDEX_24" dataType="text"></w2:column> <w2:column id="COR_ID_24" dataType="text"></w2:column>
						<w2:column id="INDEX_25" dataType="text"></w2:column> <w2:column id="COR_ID_25" dataType="text"></w2:column>
						<w2:column id="INDEX_26" dataType="text"></w2:column> <w2:column id="COR_ID_26" dataType="text"></w2:column>
						<w2:column id="INDEX_27" dataType="text"></w2:column> <w2:column id="COR_ID_27" dataType="text"></w2:column>
						<w2:column id="INDEX_28" dataType="text"></w2:column> <w2:column id="COR_ID_28" dataType="text"></w2:column>
						<w2:column id="INDEX_29" dataType="text"></w2:column> <w2:column id="COR_ID_29" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_0"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_0"  dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_1"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_1"  dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_2"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_2"  dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_3"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_3"  dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_4"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_4"  dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_5"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_5"  dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_6"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_6"  dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_7"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_7"  dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_8"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_8"  dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_9"  dataType="text"></w2:column> <w2:column id="OPER_INFO_2_9"  dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_10" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_10" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_11" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_11" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_12" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_12" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_13" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_13" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_14" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_14" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_15" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_15" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_16" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_16" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_17" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_17" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_18" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_18" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_19" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_19" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_20" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_20" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_21" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_21" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_22" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_22" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_23" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_23" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_24" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_24" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_25" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_25" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_26" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_26" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_27" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_27" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_28" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_28" dataType="text"></w2:column>
						<w2:column id="OPER_INFO_1_29" dataType="text"></w2:column> <w2:column id="OPER_INFO_2_29" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_EXL_OPER_PL_ROUT_INFO" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:column>
						<w2:column id="DAY_DIV" name="요일구분" dataType="text"></w2:column>
						<w2:column id="WAY_DIV" name="상하행구분" dataType="text"></w2:column>
						<w2:column id="ALLOC_NO" name="배차번호" dataType="text"></w2:column>
						<w2:column id="INDEX_0"  dataType="text"></w2:column> <w2:column id="COR_ID_0" dataType="text"></w2:column>
						<w2:column id="INDEX_1"  dataType="text"></w2:column> <w2:column id="COR_ID_1" dataType="text"></w2:column>
						<w2:column id="INDEX_2"  dataType="text"></w2:column> <w2:column id="COR_ID_2" dataType="text"></w2:column>
						<w2:column id="INDEX_3"  dataType="text"></w2:column> <w2:column id="COR_ID_3" dataType="text"></w2:column>
						<w2:column id="INDEX_4"  dataType="text"></w2:column> <w2:column id="COR_ID_4" dataType="text"></w2:column>
						<w2:column id="INDEX_5"  dataType="text"></w2:column> <w2:column id="COR_ID_5" dataType="text"></w2:column>
						<w2:column id="INDEX_6"  dataType="text"></w2:column> <w2:column id="COR_ID_6" dataType="text"></w2:column>
						<w2:column id="INDEX_7"  dataType="text"></w2:column> <w2:column id="COR_ID_7" dataType="text"></w2:column>
						<w2:column id="INDEX_8"  dataType="text"></w2:column> <w2:column id="COR_ID_8" dataType="text"></w2:column>
						<w2:column id="INDEX_9"  dataType="text"></w2:column> <w2:column id="COR_ID_9" dataType="text"></w2:column>
						<w2:column id="INDEX_10" dataType="text"></w2:column> <w2:column id="COR_ID_10" dataType="text"></w2:column>
						<w2:column id="INDEX_11" dataType="text"></w2:column> <w2:column id="COR_ID_11" dataType="text"></w2:column>
						<w2:column id="INDEX_12" dataType="text"></w2:column> <w2:column id="COR_ID_12" dataType="text"></w2:column>
						<w2:column id="INDEX_13" dataType="text"></w2:column> <w2:column id="COR_ID_13" dataType="text"></w2:column>
						<w2:column id="INDEX_14" dataType="text"></w2:column> <w2:column id="COR_ID_14" dataType="text"></w2:column>
						<w2:column id="INDEX_15" dataType="text"></w2:column> <w2:column id="COR_ID_15" dataType="text"></w2:column>
						<w2:column id="INDEX_16" dataType="text"></w2:column> <w2:column id="COR_ID_16" dataType="text"></w2:column>
						<w2:column id="INDEX_17" dataType="text"></w2:column> <w2:column id="COR_ID_17" dataType="text"></w2:column>
						<w2:column id="INDEX_18" dataType="text"></w2:column> <w2:column id="COR_ID_18" dataType="text"></w2:column>
						<w2:column id="INDEX_19" dataType="text"></w2:column> <w2:column id="COR_ID_19" dataType="text"></w2:column>
						<w2:column id="INDEX_20" dataType="text"></w2:column> <w2:column id="COR_ID_20" dataType="text"></w2:column>
						<w2:column id="INDEX_21" dataType="text"></w2:column> <w2:column id="COR_ID_21" dataType="text"></w2:column>
						<w2:column id="INDEX_22" dataType="text"></w2:column> <w2:column id="COR_ID_22" dataType="text"></w2:column>
						<w2:column id="INDEX_23" dataType="text"></w2:column> <w2:column id="COR_ID_23" dataType="text"></w2:column>
						<w2:column id="INDEX_24" dataType="text"></w2:column> <w2:column id="COR_ID_24" dataType="text"></w2:column>
						<w2:column id="INDEX_25" dataType="text"></w2:column> <w2:column id="COR_ID_25" dataType="text"></w2:column>
						<w2:column id="INDEX_26" dataType="text"></w2:column> <w2:column id="COR_ID_26" dataType="text"></w2:column>
						<w2:column id="INDEX_27" dataType="text"></w2:column> <w2:column id="COR_ID_27" dataType="text"></w2:column>
						<w2:column id="INDEX_28" dataType="text"></w2:column> <w2:column id="COR_ID_28" dataType="text"></w2:column>
						<w2:column id="INDEX_29" dataType="text"></w2:column> <w2:column id="COR_ID_29" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_0"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_0"  dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_1"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_1"  dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_2"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_2"  dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_3"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_3"  dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_4"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_4"  dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_5"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_5"  dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_6"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_6"  dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_7"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_7"  dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_8"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_8"  dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_9"  dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_9"  dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_10" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_10" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_11" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_11" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_12" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_12" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_13" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_13" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_14" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_14" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_15" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_15" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_16" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_16" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_17" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_17" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_18" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_18" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_19" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_19" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_20" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_20" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_21" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_21" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_22" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_22" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_23" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_23" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_24" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_24" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_25" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_25" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_26" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_26" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_27" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_27" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_28" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_28" dataType="text"></w2:column>
						<w2:column id="ROUT_ED_TM_29" dataType="text"></w2:column> <w2:column id="ROUT_ST_TM_29" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataMap baseNode="map" id="dma_sub_search">
					<w2:keyInfo>
						<w2:key id="REP_ROUT_ID" name="대표노선ID" dataType="text"></w2:key>
						<w2:key id="DAY_DIV" name="요일구분" dataType="text"></w2:key>
						<w2:key id="WAY_DIV" name="상하행구분" dataType="text"></w2:key>
						<w2:key id="OPER_SN_LIST" name="운행순번목록" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="map" id="dma_param_AL0202P0">
					<w2:keyInfo></w2:keyInfo>
				</w2:dataMap>
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>
			<xf:submission id="sub_AL0202G0R0" ref="data:json,dma_search" target="data:json,dlt_BRT_OPER_PL_MST"
				action="/AL/AL0202G0R0" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
				customHandler="" mode="asynchronous" processMsg="조회 중입니다..." ev:submit="" ev:submitdone="scwin.sub_AL0202G0R0_submitdone"
				ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_AL0202SHI0" ref="" target="data:json,dlt_searchitem" action="/repRout/selectRepRoutItem" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_AL0202G1R0" ref="data:json,dma_sub_search" target='data:json,[{"id":"dlt_OPER_ALLOC_PL_ROUT_CNT"},{"id":"dlt_OPER_ALLOC_PL_ROUT_INFO"}]'
				action="/AL/AL0202G1R0" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
				customHandler="" mode="asynchronous" processMsg="조회 중입니다..." ev:submit="" ev:submitdone="scwin.sub_AL0202G1R0_submitdone" ev:submiterror=""
				abortTrigger="">
			</xf:submission>
			<!-- <xf:submission id="sub_AL0202G1CNT" ref="data:json,dma_sub_search" target="data:json,dlt_OPER_ALLOC_PL_ROUT_CNT"
				action="/AL/AL0202G1CNT" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler=""
				customHandler="" mode="asynchronous" processMsg="" ev:submit="" ev:submitdone="scwin.sub_AL0202G1CNT_submitdone" ev:submiterror=""
				abortTrigger="">
			</xf:submission> -->
			<xf:submission id="sub_AL0202G1S0" ref='data:json,[{"id":"dlt_OPER_ALLOC_PL_ROUT_INFO","action":"modified"},"dma_sub_search"]' target="data:json,dma_result"
				action="/al/AL0202G1S0" method="post" mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="저장중 입니다..."
				ev:submit="" ev:submitdone="scwin.sub_AL0202G1S0_submitdone" ev:submiterror="">
			</xf:submission>
			<xf:submission id="sub_operPlanList" ref='data:json,dma_sub_search' target='data:json,[{"id":"dlt_BRT_OPER_PL_ROUT_INFO_ASC"},{"id":"dlt_BRT_OPER_PL_ROUT_INFO_DESC"}]' action="/operPlan/selectOperPlanRout2" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="" ev:submiterror="" abortTrigger="">
			</xf:submission>
		</xf:model>

	<style>
		.AL0202G0 thead tr th nobr {
			word-wrap: break-word;
			white-space : normal;
			padding: 0px;
		}
		.AL0202G0 tbody tr td nobr {
			word-wrap: break-word;
			white-space : normal;
			padding: 0px 5px 0px 5px;
		}
		
		.AL0202G1 tbody tr th nobr {
			word-wrap: break-word;
			white-space : normal;
			padding: 0px;
		}
		
	</style>
	
	<script type="text/javascript" lazy="false"><![CDATA[

	var GRID_MAX = 30;
	var autoOptions = [];
	var oldAllocCnt;
	var oldOperCnt;
	scwin.onpageload = function() {		
		autoOptions = {
			Main : {
				grid : AL0202G0,
				srchSbm : sub_AL0202G0R0,
				srchGrp : pgm_header,
				keyColumn : "REP_ROUT_ID, DAY_DIV",
				name : "배차편성 목록",
				undo : false //검색시 undo 동작 하지 않게 함 undo시 머지가 깨져서 undo 동작하면 안됨
			},
			Sub1 : { grid : AL0202G1, 
				exlGrid : AL0202G1,
				srchSbm : sub_AL0202G1R0, 
				/*srchGrp : pgm_subList,*/ 
				savSbm : sub_AL0202G1S0, 
				name :  "배차편성 상세",
				undo : false //검색시 undo 동작 하지 않게 함 undo시 머지가 깨져서 undo 동작하면 안됨
			}
		};
		
		com.setMainBtn2(wfm_mainBtn, gcm.DISP_TYPE.DUAL_GRID2, autoOptions);

		var codeOptions = [{code : "DAY_DIV",compID : "AL0202G0:DAY_DIV"},{code : "WAY_DIV",compID : "AL0202G1:WAY_DIV"}];

		var subOptions = {
		
			SAVE:[{cbFnc:scwin.btn_sub_course,nm:"코스선택",class:"search"}, {cbFnc:scwin.btn_reInstall,nm:"재구성",class:"autoApply"}
			]
		};
		com.setSubBtn2(wfm_subBtn, autoOptions, subOptions);

		com.setCommonDtl(codeOptions, function() {
			com.searchGrid(AL0202G0, sub_AL0202G0R0);
		});
		com.executeSubmission(sub_AL0202SHI0);
	};

	scwin.onpageunload = function() {

	};

	scwin.sub_AL0202G0R0_submitdone = function(e) {
		AL0202G0.setFocusedCell(0, "DAY_DIV", true);	
	};
	
	scwin.sub_AL0202G1S0_submitdone = function(e) {
			
	};
	
	scwin.AL0202G0_onrowindexchange = function(row, oldRow) {
		
		var focusOption = {keyMap : dma_sub_search, keyMapColumn : "REP_ROUT_ID,DAY_DIV"};
		com.changeDualGrid(AL0202G0, AL0202G1, sub_AL0202G1S0,
					sub_AL0202G1R0, focusOption , row, oldRow, "배차순위 상세");
		com.executeSubmission(sub_operPlanList);
	};
	
	scwin.sub_AL0202G1R0_submitdone = function(e) {
		scwin.reInit();
		scwin.setGridExcelInfo(); //엑셀용 화면 및 데이터 구성
		scwin.setGridViewInfo(); //그리드 화면 및 데이터 구성
		oldAllocCnt = ALLOC_CNT.getValue();
		oldOperCnt = OPER_CNT.getValue();
	};

	scwin.get_viewColumnIndex = function(colId){
		var colViewIndex = Number(colId.substring(colId.lastIndexOf("_")+1));
		return colViewIndex;
	}
	
	scwin.get_RealIndex = function(row,colId){
		var colViewIndex = scwin.get_viewColumnIndex(colId);
		return dlt_VIEW_OPER_PL_ROUT_INFO.getCellData(row, "INDEX_"+colViewIndex);
	}
	
	scwin.AL0202G1_oncelldblclick = function(row,col,colId) {
	
		if((row%2==0)&&(colId .indexOf("OPER_INFO_1_")>=0)){
			var rIndex = scwin.get_RealIndex(row,colId);
			var repRoutId = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rIndex, "REP_ROUT_ID");
			var dayDiv = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rIndex, "DAY_DIV");
			var wayDiv = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rIndex, "WAY_DIV");
			
			var openSnList = dlt_OPER_ALLOC_PL_ROUT_INFO.getColData("OPER_SN");
			dma_sub_search.set("REP_ROUT_ID", repRoutId);
			dma_sub_search.set("DAY_DIV", dayDiv);
			dma_sub_search.set("WAY_DIV", wayDiv);
			dma_sub_search.set("OPER_SN_LIST", openSnList);
			
			var data = { data : dma_sub_search.getJSON(), callbackFn : "scwin.insertOperRout" };
			var options = { id : "popUpOperPlanRoutList",
							popupName : "운행 계획",
							width : 635, height: 500,
							modal : true };
			com.openPopup("/cm//common/popUpOperPlanRoutList.xml", options, data);
		}	
	};
	
	
	scwin.insertOperRout = function(returnValue) {
		debugger;
		var param = returnValue[0];
		var focusIdex = AL0202G1.getFocusedRowIndex();
		var index = parseInt(focusIdex/2);
		var colViewIndex = scwin.get_viewColumnIndex(AL0202G1.getFocusedColumnID());

		dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(index,"ROUT_ID", returnValue[0].ROUT_ID);
		dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(index,"ROUT_NM", returnValue[0].ROUT_NM);
		dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(index,"OPER_SN", returnValue[0].OPER_SN);
		dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(index,"ROUT_ST_TM", returnValue[0].ROUT_ST_TM);
		dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(index,"ROUT_ED_TM", returnValue[0].ROUT_ED_TM);
		dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(focusIdex, 'OPER_INFO_1_'+colViewIndex, returnValue[0].ROUT_NM +"("+returnValue[0].OPER_SN+")");
		dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(focusIdex, 'OPER_INFO_2_'+colViewIndex, returnValue[0].ROUT_NM +"("+returnValue[0].OPER_SN+")");
		dlt_VIEW_OPER_PL_ROUT_INFO
	};

	scwin.btn_sub_course = function(){

	}
	
	scwin.AL0202G1_onrowindexchange = function(row,oldRow) {
		
	};
	

	
	scwin.sbx_ChoiceBox_onviewchange = function(info) {
		
		if (info.newValue == "ALL") {
			autoChoiceBox.hide();
			search_input.setValue("");
			search_input.show("");
		} else if (info.newValue == "REP_ROUT_ID") {
			search_input.hide();
			autoChoiceBox.setNodeSet("data:dlt_searchitem", "REP_ROUT_ID", "REP_ROUT_ID");
			autoChoiceBox.show("");
		} else if (info.newValue == "REP_ROUT_NM") {
			search_input.hide();
			autoChoiceBox.setNodeSet("data:dlt_searchitem", "REP_ROUT_NM", "REP_ROUT_NM");
			autoChoiceBox.show("");
		}
	};
	
//동적으로 datList 생성
	scwin.makeDataList = function(id, obj) {
		if(WebSquare.util.getComponentById(id)!=undefined){
			$w.data.remove(id);
		}
		$w.data.create({
			"id": id
			, "type": "dataList"
			, "option": {
				"useData": false
			  }
			, "columnInfo":obj
		});
	}
	
	
	scwin.btn_reInstall = function() {
		if(dlt_OPER_ALLOC_PL_ROUT_INFO.getRowCount()>0){				
			com.confirm("배차편성 상세가 다시 구성됩니다. 새로 구성하시겠습니까?", function(rtn){
				if (rtn) {
					scwin.reInit();
				}
			});
		}
		else{
			scwin.reInit();
		}
	}
	
	var g_rowAllocIndex = 0;
	var g_rowColumnIndex = 0;
	scwin.recurOperRoundInstall = function(dltBrtOperPlMst, dltBrtOperPlRoutInfoAsc, dltBrtOperPlRoutInfoDesc, focusIndex, allocIndex){
		
		var repRoutId = dltBrtOperPlMst[focusIndex].REP_ROUT_ID;
		var repRoutNM = dltBrtOperPlMst[focusIndex].REP_ROUT_NM;
		var dayDiv = dltBrtOperPlMst[focusIndex].DAY_DIV;
		var routDiv = dltBrtOperPlMst[focusIndex].ROUT_DIV;
		var wayYn = dltBrtOperPlMst[focusIndex].WAY_YN;
		var wayAscNm = dltBrtOperPlMst[focusIndex].WAY_ASC_NM;
		var wayDescNm = dltBrtOperPlMst[focusIndex].WAY_DESC_NM;
		dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "REP_ROUT_ID", repRoutId);
		dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "REP_ROUT_NM", repRoutNM);
		dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "DAY_DIV", dayDiv);
		dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "WAY_ASC_NM", wayAscNm);
		dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "WAY_DESC_NM", wayDescNm);
		
		if((wayYn=='Y')&&(routDiv=='RD001')){
			var oldRoutStTm = dltBrtOperPlRoutInfoAsc[g_rowAllocIndex-1].ROUT_ST_TM;
			var oldRoutEdTm = dltBrtOperPlRoutInfoAsc[g_rowAllocIndex-1].ROUT_ED_TM;
			var oldWayDiv = dltBrtOperPlRoutInfoAsc[g_rowAllocIndex-1].WAY_DIV;
			var i = 0;
			if(oldWayDiv=='WD001'){
				for(i=g_rowAllocIndex;i<dltBrtOperPlRoutInfoDesc.length;i++){
					var routStTm = dltBrtOperPlRoutInfoDesc[i].ROUT_ST_TM;
					if(util.dateMinus(oldRoutEdTm + ":00", routStTm + ":00")>0){
						var routId = dltBrtOperPlRoutInfoDesc[i].ROUT_ID;
						var routNm = dltBrtOperPlRoutInfoDesc[i].ROUT_NM;
						var operSn = dltBrtOperPlRoutInfoDesc[i].OPER_SN;
						var routEdTm = dltBrtOperPlRoutInfoDesc[i].ROUT_ED_TM;
						var wayDiv = dltBrtOperPlRoutInfoDesc[i].WAY_DIV;
						var rowData = {
							ROUT_ID : routId,
							ROUT_NM : routNm,
							OPER_SN : operSn,
							ROUT_ST_TM : routStTm,
							ROUT_ED_TM : routEdTm,
							WAY_DIV : wayDiv,
							ALLOC_NO : allocIndex
						};
						
						dlt_OPER_ALLOC_PL_ROUT_INFO.setRowJSON(g_rowAllocIndex, rowData, true);
						g_rowAllocIndex++;
						g_rowColumnIndex ++;
						scwin.recurOperRoundInstall(dltBrtOperPlMst, dltBrtOperPlRoutInfoAsc, dltBrtOperPlRoutInfoDesc, focusIndex, allocIndex);
						return;
					}
				}
				if(i==dltBrtOperPlRoutInfoDesc.length){
					return;
				}
			}
			else if(oldWayDiv=='WD002'){
				for(i=g_rowAllocIndex;i<dltBrtOperPlRoutInfoAsc.length;i++){
					var routStTm = dltBrtOperPlRoutInfoAsc[i].ROUT_ST_TM;
					if(util.dateMinus(routStTm + ":00", oldRoutEdTm + ":00")>0){
						var routId = dltBrtOperPlRoutInfoAsc[i].ROUT_ID;
						var routNm = dltBrtOperPlRoutInfoAsc[i].ROUT_NM;
						var operSn = dltBrtOperPlRoutInfoAsc[i].OPER_SN;
						var routEdTm = dltBrtOperPlRoutInfoAsc[i].ROUT_ED_TM;
						var wayDiv = dltBrtOperPlRoutInfoAsc[i].WAY_DIV;
						var rowData = {
							ROUT_ID : routId,
							ROUT_NM : routNm,
							OPER_SN : operSn,
							ROUT_ST_TM : routStTm,
							ROUT_ED_TM : routEdTm,
							WAY_DIV : wayDiv,
							ALLOC_NO : allocIndex
						};
						
						dlt_OPER_ALLOC_PL_ROUT_INFO.setRowJSON(g_rowAllocIndex, rowData, true);
						g_rowAllocIndex++;
						g_rowColumnIndex++;
						scwin.recurOperRoundInstall(dltBrtOperPlMst, dltBrtOperPlRoutInfoAsc, dltBrtOperPlRoutInfoDesc, focusIndex, allocIndex);
						return;
					}
				}
				if(i==dltBrtOperPlRoutInfoAsc.length){
					var rowIndex = dlt_OPER_ALLOC_PL_ROUT_CNT.insertRow();
					dlt_OPER_ALLOC_PL_ROUT_CNT.setCellData(rowIndex, "CNT", g_rowColumnIndex);
					g_rowColumnIndex = 0;
					return;
				}
			}

		
		}
		else if ((wayYn=='Y')&&(routDiv=='RD002')){
			if(i<halfAllocCnt){
				dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "WAY_DIV", "WD001");
			}
			else{
				dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "WAY_DIV", "WD002");
			}
		}
		else {
			dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "ROUT_ID", routId);
			dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "ROUT_NM", routNm);
			dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "OPER_SN", operSn);
			dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "ROUT_ST_TM", routStTm);
			dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "ROUT_ED_TM", routEdTm);
		}
				
	}
	
	//화면 재구성
	scwin.reInit = function() {

		debugger;
		var allocCnt = ALLOC_CNT.getValue();
		var halfAllocCnt = parseInt(Math.ceil(allocCnt/2));
		var operCnt = OPER_CNT.getValue();
		oldAllocCnt = allocCnt;
		oldOperCnt = operCnt;
		
		
		if(com.isEmpty(operCnt)==false){
			var columnCnt = parseInt(operCnt/allocCnt);
			
			dlt_OPER_ALLOC_PL_ROUT_INFO.removeAll();
			dlt_OPER_ALLOC_PL_ROUT_CNT.removeAll();
			dlt_VIEW_OPER_PL_ROUT_INFO.removeAll();
			dlt_EXL_OPER_PL_ROUT_INFO.removeAll();
			var focusIndex = AL0202G0.getFocusedRowIndex();
			
			var dltBrtOperPlMst = dlt_BRT_OPER_PL_MST.getAllJSON();
			var dltBrtOperPlRoutInfoAsc = dlt_BRT_OPER_PL_ROUT_INFO_ASC.getAllJSON();
			var dltBrtOperPlRoutInfoDesc = dlt_BRT_OPER_PL_ROUT_INFO_DESC.getAllJSON();
			var repRoutId = dltBrtOperPlMst[focusIndex].REP_ROUT_ID;
			var repRoutNM = dltBrtOperPlMst[focusIndex].REP_ROUT_NM;
			var dayDiv = dltBrtOperPlMst[focusIndex].DAY_DIV;
			var routDiv = dltBrtOperPlMst[focusIndex].ROUT_DIV;
			var wayYn = dltBrtOperPlMst[focusIndex].WAY_YN;
			var wayAscNm = dltBrtOperPlMst[focusIndex].WAY_ASC_NM;
			var wayDescNm = dltBrtOperPlMst[focusIndex].WAY_DESC_NM;
			
			var allocIndex = 0;
			var oldAllocIndex = -1;
			for(i=0;i<halfAllocCnt;i++){
				g_rowAllocIndex = dlt_OPER_ALLOC_PL_ROUT_INFO.insertRow();
				dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "REP_ROUT_ID", repRoutId);
				dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "REP_ROUT_NM", repRoutNM);
				dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "DAY_DIV", dayDiv);
				dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "WAY_ASC_NM", wayAscNm);
				dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "WAY_DESC_NM", wayDescNm);
					
				if((wayYn=='Y')&&(routDiv=='RD001')){
					var routId = dltBrtOperPlRoutInfoAsc[i].ROUT_ID;
					var routNm = dltBrtOperPlRoutInfoAsc[i].ROUT_NM;
					var operSn = dltBrtOperPlRoutInfoAsc[i].OPER_SN;
					var routStTm = dltBrtOperPlRoutInfoAsc[i].ROUT_ST_TM;
					var routEdTm = dltBrtOperPlRoutInfoAsc[i].ROUT_ED_TM;
					var wayDiv = dltBrtOperPlRoutInfoAsc[i].WAY_DIV;
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "ROUT_ID", routId);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "ROUT_NM", routNm);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "OPER_SN", operSn);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "ROUT_ST_TM", routStTm);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "ROUT_ED_TM", routEdTm);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "WAY_DIV", wayDiv);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "ALLOC_NO", allocIndex);
					g_rowAllocIndex ++;
					scwin.recurOperRoundInstall(dltBrtOperPlMst, dltBrtOperPlRoutInfoAsc, dltBrtOperPlRoutInfoDesc, focusIndex, allocIndex);
					
				}
				else if ((wayYn=='Y')&&(routDiv=='RD002')){
					if(i<halfAllocCnt){
						dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "WAY_DIV", "WD001");

					}
					else{
						dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "WAY_DIV", "WD002");
					}
				}
				else {
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "ROUT_ID", routId);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "ROUT_NM", routNm);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "OPER_SN", operSn);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "ROUT_ST_TM", routStTm);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "ROUT_ED_TM", routEdTm);
				}
				
			}
			
			for(i=halfAllocCnt;i<halfAllocCnt;i++){
				g_rowAllocIndex = dlt_OPER_ALLOC_PL_ROUT_INFO.insertRow();
				dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "REP_ROUT_ID", repRoutId);
				dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "REP_ROUT_NM", repRoutNM);
				dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "DAY_DIV", dayDiv);
				dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "WAY_ASC_NM", wayAscNm);
				dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "WAY_DESC_NM", wayDescNm);
					
				if((wayYn=='Y')&&(routDiv=='RD001')){
					var routId = dltBrtOperPlRoutInfoDesc[j].ROUT_ID;
					var routNm = dltBrtOperPlRoutInfoDesc[j].ROUT_NM;
					var operSn = dltBrtOperPlRoutInfoDesc[j].OPER_SN;
					var routStTm = dltBrtOperPlRoutInfoDesc[j].ROUT_ST_TM;
					var routEdTm = dltBrtOperPlRoutInfoDesc[j].ROUT_ED_TM;
					var wayDiv = dltBrtOperPlRoutInfoDesc[j].WAY_DIV;
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "ROUT_ID", routId);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "ROUT_NM", routNm);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "OPER_SN", operSn);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "ROUT_ST_TM", routStTm);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "ROUT_ED_TM", routEdTm);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "WAY_DIV", wayDiv);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(g_rowAllocIndex, "ALLOC_NO", allocIndex);
					g_rowAllocIndex ++;
					scwin.recurOperRoundInstall(dltBrtOperPlMst, dltBrtOperPlRoutInfoAsc, dltBrtOperPlRoutInfoDesc, focusIndex, allocIndex);
					
				}
				else if ((wayYn=='Y')&&(routDiv=='RD002')){
					if(i<halfAllocCnt){
						dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "WAY_DIV", "WD001");

					}
					else{
						dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "WAY_DIV", "WD002");
					}
				}
				else {
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "ROUT_ID", routId);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "ROUT_NM", routNm);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "OPER_SN", operSn);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "ROUT_ST_TM", routStTm);
					dlt_OPER_ALLOC_PL_ROUT_INFO.setCellData(i, "ROUT_ED_TM", routEdTm);
				}
				
			}
		}
		

	}

	scwin.setGridExcelInfo = function() {
		
		var column = {};
		var columnNmArr1 = ["REP_ROUT_ID","REP_ROUT_NM","DAY_DIV","WAY_DIV","ALLOC_NO"];
		var columnStrArr1 = ["대표노선ID","대표노선명","요일구분","구분","배차"];
		var columnWidthArr1 = ["0","0","70","70","70"];
		var columnNmArr2 = ["COR_ID","COR_NM","ROUT_ED_TM","ROUT_ST_TM"];
		var columnStrArr2 = ["코스ID","코스명","도착시간","출발시간"];
		var columnWidthArr2 = ["50","50","70","70"];
		var columnArr = [];		
		var gridHeader ="", gridBody="";
		var rowData = dlt_OPER_ALLOC_PL_ROUT_INFO.getAllJSON();
		var rowCntArr = dlt_OPER_ALLOC_PL_ROUT_CNT.getAllJSON();
		
		var maxCnt = 0;
		
		debugger;
		
		for(var i = 0; i < rowCntArr.length; i++) {
			if(maxCnt < rowCntArr[i].CNT)
				maxCnt = rowCntArr[i].CNT;
		}
		
		if(maxCnt==0)maxCnt=30;
		
		for(var i = 3; i < columnNmArr1.length; i++) {
			//gridView의 컬럼 정보 정의
			gridHeader +='<w2:column blockSelect="false" id="'+'header'+columnNmArr1[i]+'" style="height:20px" inputType="text" width="'+columnWidthArr1[i]+'" value="'+columnStrArr1[i]+'"></w2:column>';
			gridBody += '<w2:column blockSelect="false" id="'+columnNmArr1[i]+'" style="height:20px" inputType="text" width="'+columnWidthArr1[i]+'"></w2:column>'
		}
		
		if(rowData.length == 0 ) {
			for(var i = 0; i < columnNmArr2.length; i++) {
				//gridView의 컬럼 정보 정의
				gridHeader +='<w2:column blockSelect="false" id="'+'header'+columnNmArr2[i]+'" style="height:25px; " textAlign="" inputType="text" width="'+columnWidthArr2[i]+'" value="'+columnStrArr2[i]+'"></w2:column>';
			}
			
			var gridStr = '<w2:gridView xmlns:w2="http://www.inswave.com/websquare" xmlns:ev="http://www.w3.org/2001/xml-events" dataList="dlt_EXL_OPER_PL_ROUT_INFO" '
							+ 'scrollByColumn="true" id="AL0202G2" class ="" style="height:0px" fixedColumnWithHidden="true" useShiftKey="false" mergeCells="byrestriccol" mergeCol="ALLOC_NO,WAY_DIV">'
			+ '<w2:header id="header1" style="height:0px">'
			+ '<w2:row id="row1" style="">'
			+ gridHeader
			+ '</w2:row>'
			+'</w2:header>'
			+'<w2:gBody id="gBody1" style="">'
			+'<w2:row id="row2" style="">'
			+ gridBody
			+'</w2:row>'
			+'</w2:gBody>'
			+'</w2:gridView>' ;
			
			AL0202G2.setGridStyle(WebSquare.xml.parse( gridStr , true ));
			dlt_EXL_OPER_PL_ROUT_INFO.removeAll();
			
			autoOptions.Sub1.exlGrid = AL0202G2;
			return;
		}
		
		dlt_EXL_OPER_PL_ROUT_INFO.removeAll();

		for(var i = 0; i < maxCnt; i++) {
			for(var j = 0; j < columnNmArr2.length; j++) {
				//gridView의 컬럼 정보 정의
				gridHeader +='<w2:column blockSelect="false" id="'+'header'+columnNmArr2[j]+'_'+i+'" style="height:25px; " textAlign="" inputType="text" width="'+columnWidthArr2[j]
							+'" value="'+columnStrArr2[j]+'"></w2:column>';
				gridBody += '<w2:column blockSelect="false" id="'+columnNmArr2[j]+'_'+i+'" style="height:20px" inputType="text" width=""></w2:column>'
			}
			
		}

		var rowIndex = 0;
		var rowCnt = 0;
		for(var i = 0; i < rowCntArr.length; i++) {
			rowIndex += rowCnt;
			rowCnt =  rowCntArr[i].CNT;
			
			var idx = dlt_EXL_OPER_PL_ROUT_INFO.insertRow();
			for(var j = 0; j < columnNmArr1.length; j++) {
				var columnVal ="";
				if(columnNmArr1[j]=="WAY_DIV"){
					if(dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr1[j]) == "WD001"){
						columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, "WAY_ASC_NM");
					}
					else if(dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr1[j]) == "WD002"){
						columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, "WAY_DESC_NM");
					}
				}
				else if(columnNmArr1[j]=="ALLOC_NO"){
					columnVal = /*"B"+*/dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr1[j]);
				}
				else{
					columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr1[j]);
				}
				dlt_EXL_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr1[j], columnVal);
			}
			for(var j = 0; j < rowCnt; j++) {
				var routStTm = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, "ROUT_ST_TM");
				var routEdTm = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, "ROUT_ED_TM");
				dlt_EXL_OPER_PL_ROUT_INFO.setCellData(idx, "ROUT_ST_TM_"+j, routStTm);
				dlt_EXL_OPER_PL_ROUT_INFO.setCellData(idx, "ROUT_ED_TM_"+j, routEdTm);
			}
		}
		
		//gridView 정보 정의 
		//xml 형식을 정의 하면 <w2:gridView 에 xmlns:w2="http://www.inswave.com/websquare" xmlns:ev="http://www.w3.org/2001/xml-events" 포함 합니다.
		var gridStr = '<w2:gridView xmlns:w2="http://www.inswave.com/websquare" xmlns:ev="http://www.w3.org/2001/xml-events" dataList="dlt_EXL_OPER_PL_ROUT_INFO" '
						+ 'scrollByColumn="true" id="AL0202G2" class ="" style="height:0px" fixedColumnWithHidden="true" useShiftKey="false">'
		+ '<w2:header id="header1" style="text-align:left">'
		+ '<w2:row id="row1" style="">'
		+ gridHeader
		+ '</w2:row>'
		+'</w2:header>'
		+'<w2:gBody id="gBody1" style="">'
		+'<w2:row id="row2" style="">'
		+ gridBody
		+'</w2:row>'
		+'</w2:gBody>'
		+'</w2:gridView>' ;
		
		AL0202G2.setGridStyle(WebSquare.xml.parse( gridStr , true ));
		
		autoOptions.Sub1.exlGrid = AL0202G2;

		dlt_EXL_OPER_PL_ROUT_INFO.modifyAllStatus("R")
	};
	
	scwin.setGridViewInfo = function() {
		
		var column = {};
		var columnNmArr1 = ["REP_ROUT_ID","REP_ROUT_NM","DAY_DIV","WAY_DIV","ALLOC_NO"];
		var columnStrArr1 = ["대표노선ID","대표노선명","요일구분","구분","배차"];
		var columnWidthArr1 = ["0","0","70","70","70"];
		var columnNmArr2 = ["INDEX","COR_ID","ROUT_NM","OPER_SN","OPER_INFO_1","OPER_INFO_2"];
		var columnStrArr2 = ["인덱스","코스ID","노선명","운행순번","도착","출발"];
		var columnWidthArr2 = ["0","0","0","0","45","45"];	
		var gridHeader ="", gridBody="";
		var rowData = dlt_OPER_ALLOC_PL_ROUT_INFO.getAllJSON();
		var rowCntArr = dlt_OPER_ALLOC_PL_ROUT_CNT.getAllJSON();
		var maxCnt = 0;
		
		dlt_VIEW_OPER_PL_ROUT_INFO.removeAll();
				
		for(var i = 0; i < rowCntArr.length; i++) {
			if(maxCnt < rowCntArr[i].CNT)
				maxCnt = rowCntArr[i].CNT;
		}
		
		if(maxCnt==0)maxCnt=30;

		gridHeader +='<w2:row style="" id="first_row">';
		for(var i = 3; i < columnNmArr1.length; i++) {
			//gridView의 컬럼 정보 정의
			gridHeader +='<w2:column blockSelect="false" id="'+'h'+columnNmArr1[i]+'" style="height:25px" inputType="text"'
							+' width="' + columnWidthArr1[i]+'" value="'+columnStrArr1[i]+'" rowSpan="2"></w2:column>';
			gridBody += '<w2:column blockSelect="false" id="'+columnNmArr1[i]+'" style="height:25px" inputType="text"></w2:column>'
		}
		
		if(rowData.length == 0 ) {
			
			gridHeader +='<w2:column blockSelect="false" id="hOPER_INFO" style="height:25px" inputType="text"'
							+' width="" value="운행정보" colSpan="2"></w2:column>';
			gridHeader +='</w2:row>';
				
			gridHeader +='<w2:row style="" id="second_row">';
			for(var i = 4; i < columnNmArr2.length; i++) {
				gridHeader +='<w2:column blockSelect="false" id="'+'h'+columnNmArr2[i]+'" style="height:25px" inputType="text"'
								+' width="300px" value="'+columnStrArr2[i]+'" rowSpan="1"></w2:column>';
				gridBody += '<w2:column blockSelect="false" id="'+columnNmArr2[i]+'" style="height:25px" inputType="text"></w2:column>'
			}
			gridHeader +='</w2:row>';
			
			var gridStr = '<w2:gridView xmlns:w2="http://www.inswave.com/websquare" xmlns:ev="http://www.w3.org/2001/xml-events" dataList="dlt_VIEW_OPER_PL_ROUT_INFO" '
							+ 'scrollByColumn="true" id="AL0202G1" class ="cm_grid right" fixedColumnWithHidden="true" useShiftKey="false" mergeCells="byrestriccol" mergeCol="ALLOC_NO,WAY_DIV">'
			+ '<w2:header id="header1" style="">'
			+ gridHeader
			+'</w2:header>'
			+'<w2:gBody id="gBody1" style="">'
			+'<w2:row id="row2" style="">'
			+ gridBody
			+'</w2:row>'
			+'</w2:gBody>'
			+'</w2:gridView>' ;
			
			AL0202G1.setGridStyle(WebSquare.xml.parse( gridStr , true ));
			dlt_VIEW_OPER_PL_ROUT_INFO.removeAll();
			autoOptions.Sub1.grid = AL0202G1;
			
			return;
		}
		
		for(var i = 0; i < maxCnt; i++) {
			gridHeader +='<w2:column blockSelect="false" id="hOPER_INFO'+'_'+i+'" style="height:25px" inputType="text"'
							+' width="" value="운행정보" colSpan="3"></w2:column>';
		}
		gridHeader +='</w2:row>';
		gridHeader +='<w2:row style="" id="second_row">';
		for(var i = 0; i < maxCnt; i++) {
			for(var j = 4; j < columnNmArr2.length; j++) {
				gridHeader +='<w2:column blockSelect="false" id="'+'h'+columnNmArr2[j]+'_'+i+'" style="height:25px" inputType="text"'
								+' width="' + columnWidthArr2[j]+'" value="'+columnStrArr2[j]+'" rowSpan="1"></w2:column>';
				gridBody += '<w2:column blockSelect="false" id="'+columnNmArr2[j]+'_'+i+'" style="height:25px" inputType="text"></w2:column>'
			}
			
			gridHeader +='<w2:column blockSelect="false" id="'+'hempty_'+i+'" style="height:25px" inputType="text"'
								+' width="0" value="'+columnStrArr2[j]+'" rowSpan="1"></w2:column>';
			gridBody += '<w2:column blockSelect="false" id="'+'bempty_'+i+'" style="height:25px" inputType="text"></w2:column>'
		}
		gridHeader +='</w2:row>';

		var rowIndex = 0;
		var rowCnt = 0;
		for(var i = 0; i < rowCntArr.length; i++) {
			rowIndex += rowCnt;
			rowCnt =  rowCntArr[i].CNT;
			
			var idx = dlt_VIEW_OPER_PL_ROUT_INFO.insertRow();
			for(var j = 0; j < columnNmArr1.length; j++) {
				var columnVal ="";
				if(columnNmArr1[j]=="WAY_DIV"){
					if(dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr1[j]) == "WD001"){
						columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, "WAY_ASC_NM");
					}
					else if(dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr1[j]) == "WD002"){
						columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, "WAY_DESC_NM");
					}
				}
				else if(columnNmArr1[j]=="ALLOC_NO"){
					columnVal = /*"B"+*/dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr1[j]);
				}
				else{
					columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr1[j]);
				}
				dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr1[j], columnVal);
			}
			
			var routNm = "";
			var operSn = "";
			for(var j = 0; j < rowCnt; j++) {
				var index = rowIndex+j;
				for(var x = 0; x < columnNmArr2.length; x++) {
					if(columnNmArr2[x]=="INDEX"){
						dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, index);
					}
					else if(columnNmArr2[x]=="ROUT_NM"){
						routNm = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, columnNmArr2[x]);
					}
					else if(columnNmArr2[x]=="OPER_SN"){
						operSn = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, columnNmArr2[x]);
					}
					else if(columnNmArr2[x]=="OPER_INFO_1"){
						dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, routNm +"("+operSn+")");
					}
					else if(columnNmArr2[x]=="OPER_INFO_2"){
						dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, routNm +"("+operSn+")");
					}
					else {
						var columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, columnNmArr2[x]);
						dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, columnVal);
					}
				}
			}
			
			var idx = dlt_VIEW_OPER_PL_ROUT_INFO.insertRow();
			for(var j = 0; j < columnNmArr1.length; j++) {
				var columnVal ="";
				if(columnNmArr1[j]=="WAY_DIV"){
					if(dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr1[j]) == "WD001"){
						columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, "WAY_ASC_NM");
					}
					else if(dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr1[j]) == "WD002"){
						columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, "WAY_DESC_NM");
					}
				}
				else if(columnNmArr1[j]=="ALLOC_NO"){
					columnVal = /*"B"+*/dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr1[j]);
				}
				else{
					columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(rowIndex+j, columnNmArr1[j]);
				}
				dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr1[j], columnVal);
			}
			
			for(var j = 0; j < rowCnt; j++) {
				var index = rowIndex+j;
				for(var x = 0; x < columnNmArr2.length; x++) {
					if(columnNmArr2[x]=="INDEX"){
						dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, index);
					}
					else if(columnNmArr2[x]=="OPER_INFO_1"){
						var columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, "ROUT_ST_TM");
						dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, columnVal);
					}
					else if(columnNmArr2[x]=="OPER_INFO_2"){
						var columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, "ROUT_ED_TM");
						dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, columnVal);
					}
					else {
						var columnVal = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, columnNmArr2[x]);
						dlt_VIEW_OPER_PL_ROUT_INFO.setCellData(idx, columnNmArr2[x]+'_'+j, columnVal);
					}
				}
			}
		}
		
		//gridView 정보 정의 
		//xml 형식을 정의 하면 <w2:gridView 에 xmlns:w2="http://www.inswave.com/websquare" xmlns:ev="http://www.w3.org/2001/xml-events" 포함 합니다.
		var gridStr = '<w2:gridView xmlns:w2="http://www.inswave.com/websquare" xmlns:ev="http://www.w3.org/2001/xml-events" dataList="dlt_VIEW_OPER_PL_ROUT_INFO" '
						+ 'scrollByColumn="true" id="AL0202G1" class ="cm_grid right" fixedColumnWithHidden="true" useShiftKey="false"  '
						+ 'fixedColumn="2"  mergeCellsFixedCols="bycol"  mergeCells="bycolrec" '
						+ 'ev:onrowindexchange="scwin.AL0202G1_onrowindexchange" ev:oncelldblclick="scwin.AL0202G1_oncelldblclick">'
		+ '<w2:header id="header1" style="text-align:left">'
		+ gridHeader
		+'</w2:header>'
		+'<w2:gBody id="gBody1" style="">'
		+'<w2:row id="row2" style="">'
		+ gridBody
		+'</w2:row>'
		+'</w2:gBody>'
		+'</w2:gridView>' ;
		
		AL0202G1.setGridStyle(WebSquare.xml.parse( gridStr , true ));
		
		autoOptions.Sub1.grid = AL0202G1;

		dlt_VIEW_OPER_PL_ROUT_INFO.modifyAllStatus("R");
		
		rowIndex = 0;
		rowCnt = 0;
		for(var i = 0; i < rowCntArr.length; i++) {
			rowIndex += rowCnt;
			rowCnt =  rowCntArr[i].CNT;
			for(var j = 0; j < rowCnt; j++) {
				var index = rowIndex+j;
				for(var x = 4; x < columnNmArr2.length; x++) {
					var color = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, "COR_COLOR");

					AL0202G1.setCellColor(i*2, columnNmArr2[x]+'_'+j, color);
					AL0202G1.setCellColor(i*2+1, columnNmArr2[x]+'_'+j, color);
					//var colId = dlt_OPER_ALLOC_PL_ROUT_INFO.getCellData(index, "COR_ID");
					//$("."+colId).css('backgroundColor', color);
					//AL0202G1.setCellClass(viewIndex, columnNmArr2[x]+'_'+j, colId);
				}
			}

		}
	}
	
	]]></script>
	</head>
	<body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
		<xf:group id="pgm_container" class="pgm_container grdr_41_36_a" style="">
			<xf:group id="pgm_navi" class="pgm_navi" style="">
				<w2:wframe id="wfm_navi" style="" src="/cm/common/wf_navi.xml" scope="true"></w2:wframe>
			</xf:group>

			<xf:group class="pgm_header" id="pgm_header" style="">
				<xf:group class="gr_search" id="" style="">
					<xf:group class="label" id="" style="">
						<w2:span class="" id="" label="검색 항목"></w2:span>
					</xf:group>
					<xf:group class="search" id="" style="">
						<xf:select1 allOption="" appearance="minimal" chooseOption="" direction="auto" disabled="false"
							disabledClass="w2selectbox_disabled" displayMode="label" ev:onviewchange="scwin.sbx_ChoiceBox_onviewchange" id="TYPE10"
							optionOrder="false" ref="data:dma_search.TYPE" style="height:20px;width:100px;margin-right: 10px;float:left;" submenuSize="auto"
							textAlign="left">

							<xf:choices>
								<xf:item>
									<xf:label><![CDATA[전체]]></xf:label>
									<xf:value><![CDATA[ALL]]></xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[대표노선ID]]></xf:label>
									<xf:value><![CDATA[REP_ROUT_ID]]></xf:value>
								</xf:item>
								<xf:item>
									<xf:label><![CDATA[대표노선명]]></xf:label>
									<xf:value><![CDATA[REP_ROUT_NM]]></xf:value>
								</xf:item>
							</xf:choices>
						</xf:select1>
						<xf:input id="search_input" class="search_input" ref="data:dma_search.CONTENT" placeholder="대표노선 ID 또는 대표노선명"></xf:input>
						<w2:autoComplete allOption="" caseSensitive="false" chooseOption="true" chooseOptionLabel="-전체-"
							chooseOptionValue="" displayMode="label" editType="select" emptyItem="" emptyValue="" ev:onchange="" ev:onviewchange=""
							id="autoChoiceBox" interactionMode="" noResult="useData" ref="data:dma_search.CONTENT" search="start" selectedData=""
							class="search_auto" style="display:none" submenuSize="auto" textAlign="left" useKeywordHighlight="false" visibleRowNum="">
							<w2:choices>
								<w2:itemset nodeset="data:dlt_searchitem">
									<w2:label ref="REP_ROUT_NM"></w2:label>
									<w2:value ref="REP_ROUT_ID"></w2:value>
								</w2:itemset>
							</w2:choices>
						</w2:autoComplete>
					</xf:group>
					<w2:wframe class="" id="wfm_mainBtn" scope="true" src="/cm/common/wf_mainBtn.xml" style=""></w2:wframe>
				</xf:group>
			</xf:group>

			<xf:group id="pgm_content" class="pgm_content grdc_3f_20_7f" style="">
				<xf:group id="pgm_list" class="pgm_list grdr_20_2_a" style="">
					<xf:group class="defaultbox" id="" style="">
						<w2:textbox class="df_tt fl" id="" label="배차편성 목록" style=""></w2:textbox>
					</xf:group>
					<xf:group></xf:group>
					<xf:group id="" class="" style="">
						<w2:gridView alwaysTriggerScrollStart="" captionTitle="" id="AL0202G0" class="cm_grid left AL0202G0"
							dataList="data:dlt_BRT_OPER_PL_MST" ev:onrowindexchange="scwin.AL0202G0_onrowindexchange" fixedColumnWithHidden="true"
							autoFit="lastColumn" ignoreCellClick="false" rowNumHeaderValue="순번" rowNumVisible="true" mergeCells="byrestriccol"
							rowStatusVisible="false" rowStatusWidth="40" scrollByColumn="true" style="" useShiftKey="true"
							autoFitMinWidth="0" focusMode="row" readOnly="true">
							<w2:header style="" id="header1">
								<w2:row style="" id="routInfo_row1">
									<w2:column removeBorderStyle="false" width="80" inputType="text" style="height:20px"
										id="col_REP_ROUT_ID" value="대표노선ID" blockSelect="false" displayMode="label"  rowSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="40" inputType="text" style="height:20px"
										id="col_REP_ROUT_NM" value="대표 노선" blockSelect="false" displayMode="label"  rowSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="40" inputType="text" style="height:20px"
										id="col_DAY_DIV" value="요일 구분" blockSelect="false" displayMode="label"  rowSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px"
										id="col_WAY_ASC_INFO" value="방면정보" blockSelect="false" displayMode="label"  colSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px"
										id="col_WAY_DESC_INFO" value="방면정보" blockSelect="false" displayMode="label"  colSpan="2">
									</w2:column>
								</w2:row>
								<w2:row style="" id="routInfo_row2">
									<w2:column removeBorderStyle="false" width="60" inputType="text" style="height:20px"
										id="col_WAY_ASC_NM1" value="방면" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="120" inputType="text" style="height:20px"
										id="col_WAY_ASC_STR1" value="상세정보" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="60" inputType="text" style="height:20px"
										id="col_WAY_ASC_NM2" value="방면" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="120" inputType="text" style="height:20px"
										id="col_WAY_DESC_STR2" value="상세정보" blockSelect="false" displayMode="label">
									</w2:column>
								</w2:row>
							</w2:header>
							<w2:gBody style="" id="gBody1">
								<w2:row style="" id="row2">
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="REP_ROUT_ID"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="REP_ROUT_NM"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="select" style="height:20px" id="DAY_DIV"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" textAlign="left" style="height:20px; padding-left:5px" id="WAY_ASC_NM"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" textAlign="left" style="height:20px; padding-left:5px" id="WAY_ASC_STR"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" textAlign="left" style="height:20px; padding-left:5px" id="WAY_DESC_NM"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" textAlign="left" style="height:20px; padding-left:5px" id="WAY_DESC_STR"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
								</w2:row>
							</w2:gBody>
							<w2:footer style="" id="footer1">
								<w2:row style="" id="row3">
									<w2:column removeBorderStyle="false" width="NaN" inputType="expression" style="height:20px;"
										id="column42" value="" blockSelect="false" displayMode="label" colSpan="15" rowSpan=""
										expression="&quot;데이터 개수 : &quot; + COUNT(&apos;COMP_ID&apos;)" textAlign="left">
									</w2:column>
								</w2:row>
							</w2:footer>
						</w2:gridView>
					</xf:group>
				</xf:group><!-- end list -->
				<xf:group id="" class="vertical_line"></xf:group>
				<xf:group id="pgm_detail" class="pgm_detail grdr_20_2_a" style="">
					<xf:group id="" class="gr_sub_header" style="">
						<xf:group class="defaultbox" id="" style="">
							<w2:textbox class="df_tt fl" id="" label="배차편성 상세" style=""></w2:textbox>
							<w2:span label="운행횟수 : " style="float: left; margin-left: 50px; margin-right: 8px;margin-top: 2px;" id=""></w2:span>
							<xf:input adjustMaxLength="false" id="OPER_CNT" ref="data:dlt_BRT_OPER_PL_MST.OPER_CNT" style="width: 50px;height: 21px; float: left; margin-right:15px" ev:onkeyup=""></xf:input>
							<w2:span label="배차횟수 : " style="float: left; margin-right: 8px;margin-top: 2px;" id=""></w2:span>
							<xf:input adjustMaxLength="false" id="ALLOC_CNT" ref="data:dlt_BRT_OPER_PL_MST.ALLOC_CNT" style="width: 50px;height: 21px; float: left; margin-right:15px" ev:onkeyup=""></xf:input>
						</xf:group>
						<w2:wframe id="wfm_subBtn" class="" style="" src="/cm/common/wf_subBtn.xml" scope="true"></w2:wframe>
					</xf:group>
					<xf:group class="" id="" style="">
					</xf:group>
					<xf:group class="" id="" style="">
						<w2:gridView id="AL0202G1" autoFit="" captionTitle="" class="cm_grid right" dataList="data:dlt_VIEW_OPER_PL_ROUT_INFO"
							ev:onrowindexchange="scwin.AL0202G1_onrowindexchange" fixedColumnWithHidden="true" ignoreCellClick="false" rowNumHeaderValue="순번"
							rowNumVisible="false" rowStatusVisible="false" rowStatusWidth="40" scrollByColumn="true" style="" useShiftKey="true"
							autoFitMinWidth="0" focusMode="cell" ev:oncelldblclick="scwin.AL0202G1_oncelldblclick" mergeCells="byrestriccol" mergeCol="ALLOC_NO,WAY_DIV">
							<w2:header style="" id="header1">
								<w2:row style="" id="row3">
									<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:40px;" id="col_WAY_DIV"
										value="구분" blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:40px;" id="col_ALLOC_NO"
										value="배차순번" blockSelect="false" displayMode="label" colSpan="" rowSpan="2">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px;" id="col_OPER_INFO"
										value="운행정보" blockSelect="false" displayMode="label" colSpan="3" rowSpan="">
									</w2:column>
								</w2:row>
								<w2:row style="" id="row1">
									<w2:column removeBorderStyle="false" width="300" inputType="text" style="height:20px" id="col_ROUT_INFO"
										value="노선정보" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="300" inputType="text" style="height:20px" id="col_ROUT_ED_TM"
										value="도착시간" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="300" inputType="text" style="height:20px" id="col_ROUT_ST_TM"
										value="출발시간" blockSelect="false" displayMode="label">
									</w2:column>
								</w2:row>
							</w2:header>
							<w2:gBody style="" id="gBody1">
								<w2:row style="" id="row2">
									<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="WAY_DIV"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="81" inputType="select" style="height:20px" id="ALLOC_NO"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="ROUT_INFO" value=""
										blockSelect="false" displayMode="label" readOnly="true">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="ROUT_ED_TM" value=""
										blockSelect="false" displayMode="label" readOnly="true">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="ROUT_ST_TM" value=""
										blockSelect="false" displayMode="label" textAlign="" readOnly="true">
									</w2:column>
								</w2:row>
							</w2:gBody>
						</w2:gridView>
						<w2:gridView id="AL0202G2" autoFit="" captionTitle="" class="" dataList="data:dlt_VIEW_OPER_PL_ROUT_INFO"
							ev:onrowindexchange="scwin.AL0202G1_onrowindexchange" fixedColumnWithHidden="true" ignoreCellClick="false" rowNumHeaderValue="순번"
							rowNumVisible="false" rowStatusVisible="false" rowStatusWidth="40" scrollByColumn="true" style="height:0px" useShiftKey="true"
							autoFitMinWidth="0" focusMode="cell" ev:oncelldblclick="scwin.AL0202G1_oncelldblclick" mergeCells="byrestriccol" mergeCol="ALLOC_NO,WAY_DIV">
							<w2:header style="" id="header1">
								<w2:row style="" id="row1">
									<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:25px"
										id="col_WAY_DIV" value="구분" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="70" inputType="text" style="height:25px"
										id="col_ALLOC_NO" value="배차" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column width="50" id="col_COR_ID" value="코스ID" rowSpan="" style="height:25px;" ></w2:column>
									<w2:column width="50" id="column102" value="코스명" rowSpan="" style="height:25px;" ></w2:column>
									<w2:column width="70" id="col_ROUT_ED_TM" value="도착시간" rowSpan="" style="height:25px;" ></w2:column>
									<w2:column width="70" id="col_ROUT_ST_TM" value="출발시간" rowSpan="" style="height:25px;" ></w2:column>
								</w2:row>
							</w2:header>
							<w2:gBody style="" id="gBody1">
								<w2:row style="" id="row2">
									<w2:column removeBorderStyle="false" width="" inputType="select" style="height:20px" id="ALLOC_NO"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="WAY_DIV"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="COR_ID"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="COR_NM"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="ROUT_ED_TM"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
									<w2:column removeBorderStyle="false" width="" inputType="text" style="height:20px" id="ROUT_ST_TM"
										value="" blockSelect="false" displayMode="label">
									</w2:column>
								</w2:row>
							</w2:gBody>
						</w2:gridView>
					</xf:group>

				</xf:group><!-- end detail -->
			</xf:group>
		</xf:group>
	</body>
</html>
