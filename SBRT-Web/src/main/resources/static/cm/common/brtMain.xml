<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="/cm/css/all.css" type="text/css"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ev="http://www.w3.org/2001/xml-events"
	xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
	<head meta_vertical_guides="" meta_horizontal_guides="">
		<w2:type>DEFAULT</w2:type>
		<w2:buildDate/>
		<xf:model>
			<xf:instance>
				<data xmlns="" />
			</xf:instance>
			<w2:dataCollection baseNode="map">
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_BRT_CUR_OPER_INFO" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="VHC_NO" name="차량번호" dataType="text"></w2:column>
						<w2:column id="OPER_STS" name="운행상태" dataType="text"></w2:column>
						<w2:column id="NODE_NM" name="다음노드명" dataType="text"></w2:column>
						<w2:column id="BUS_STS" name="차량상태" dataType="text"></w2:column>
						<w2:column id="PRV_PLCE_NM" name="이전장소명" dataType="text"></w2:column>
						<w2:column id="CUR_PLCE_NM" name="현재위치" dataType="text"></w2:column>
						<w2:column id="UPD_DTM" name="갱신일시" dataType="date"></w2:column>
						<w2:column id="VHC_ID" name="차량ID" dataType="text"></w2:column>
						<w2:column id="GPS_X" name="현재GPS_X좌표" dataType="text"></w2:column>
						<w2:column id="GPS_Y" name="현재GPS_Y좌표" dataType="text"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataList baseNode="list" repeatNode="map" id="dlt_BRT_DSPTCH_LOG" saveRemovedData="true">
					<w2:columnInfo>
						<w2:column id="VHC_NO" name="차량번호" dataType="text"></w2:column>
						<w2:column id="DSPTCH_CONTS" name="전송 메시지" dataType="text"></w2:column>
						<w2:column id="SEND_DATE" name="수신시간" dataType="date"></w2:column>
					</w2:columnInfo>
				</w2:dataList>
				<w2:dataMap baseNode="list" repeatNode="map" id="dma_BRT_INCDNT_CNT" saveRemovedData="true">
					<w2:keyInfo>
						<w2:key id="INCDNT_CNT" name="돌발횟수" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="list" repeatNode="map" id="dma_BRT_INCDNT_RES_CNT" saveRemovedData="true">
					<w2:keyInfo>
						<w2:key id="INCDNT_RES_CNT" name="돌발처리횟수" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="list" repeatNode="map" id="dma_BRT_SPEEDING_CNT" saveRemovedData="true">
					<w2:keyInfo>
						<w2:key id="SPEEDING_CNT" name="과속횟수" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
				<w2:dataMap baseNode="list" repeatNode="map" id="dma_BRT_NOSTOP_CNT" saveRemovedData="true">
					<w2:keyInfo>
						<w2:key id="NOSTOP_CNT" name="무정차횟수" dataType="text"></w2:key>
					</w2:keyInfo>
				</w2:dataMap>
			</w2:dataCollection>
			<w2:workflowCollection></w2:workflowCollection>
			->
			<xf:submission id="sub_brtMainG0R0" ref="" target="data:json,dlt_BRT_CUR_OPER_INFO" action="/bm/bmsMainG0" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="scwin.sub_brtMainG0R0_submitdone" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_brtMainG1R0" ref="" target="data:json,dlt_BRT_DSPTCH_LOG" action="/br/brtMainG1" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="scwin.sub_brtMainG1R0_submitdone" ev:submiterror="" abortTrigger="">
			</xf:submission>
			<xf:submission id="sub_brtMainF0R0" ref="" target='data:json,["dma_BRT_INCDNT_CNT","dma_BRT_INCDNT_RES_CNT","dma_BRT_SPEEDING_CNT","dma_BRT_NOSTOP_CNT"]' action="/br/brtMainF0" method="post"
				mediatype="application/json" encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg=""
				ev:submit="" ev:submitdone="scwin.sub_brtMainF0R0_submitdone" ev:submiterror="" abortTrigger="">
			</xf:submission>
		</xf:model>
		.brtMainG1 tbody tr td nobr {
			word-wrap: break-word;
			white-space : normal;
			margin-left: 5px;
		}
		<script type="text/javascript" lazy="false"><![CDATA[

	scwin.onpageload = function() {
		var map = routMap.initMap("map_brtMain", {width:"100%"
			, height:"100%"
			, draggable: false
		});
		
		//map.addOverlayMapTypeId(kakao.maps.MapTypeId.TRAFFIC);  
		
		var codeOptions = [ {code : "BUS_STS", compID : "brtMainG0:BUS_STS" }
							,{code : "OPER_STS", compID : "brtMainG0:OPER_STS" }
		 ];
		 
		com.setCommonDtl(codeOptions, function() {
			com.searchGrid(brtMainG0, sub_brtMainG0R0);
		});
		
		$p.executeSubmission(sub_brtMainG1R0);
		$p.executeSubmission(sub_brtMainF0R0);
	};
	
	scwin.onpageunload = function() {
	
	};
	
		
	scwin.sub_brtMainG0R0_submitdone = function(e) {
		var rowCnt = dlt_BRT_CUR_OPER_INFO.getRowCount();
		
		for(var i=0; i<rowCnt; i++){
			var prvPlceNm = dlt_BRT_CUR_OPER_INFO.getCellData(i, "PRV_PLCE_NM");
			var nodeNm = dlt_BRT_CUR_OPER_INFO.getCellData(i, "NODE_NM");
			var operSts = dlt_BRT_CUR_OPER_INFO.getCellData(i, "OPER_STS");
			
			if(prvPlceNm != null && prvPlceNm != "" && nodeNm != null && nodeNm != "" && 
					operSts == "OS001" && operSts == "OS002" && operSts == "OS003"){
				dlt_BRT_CUR_OPER_INFO.setCellData(i, "CUR_PLCE_NM", prvPlceNm+"에서 "+nodeNm+"으로 운행중입니다.");
			}else if(operSts == "OS005"){
				dlt_BRT_CUR_OPER_INFO.setCellData(i, "CUR_PLCE_NM", "운행 종료되었습니다.");
			}else if(operSts == "OS004"){
				dlt_BRT_CUR_OPER_INFO.setCellData(i, "CUR_PLCE_NM", "차량 정비중입니다.");
			}else if(operSts == "OS006" || operSts == "OS007" || operSts == "OS008"){
				dlt_BRT_CUR_OPER_INFO.setCellData(i, "CUR_PLCE_NM", "운행 중단되었습니다.");
			}
		}
		//com.setFocusedCell(brtMainG0, "VHC_NO");
	};
	
	scwin.sub_brtMainG1R0_submitdone = function(e) {
		//com.setFocusedCell(brtMainG1, "VHC_NO");
	};
	
	scwin.brtMainG0_onrowindexchange = function(row,oldRow) {
		routMap.showVehicle("map_brtMain", dlt_BRT_CUR_OPER_INFO.getAllJSON(),  
							dlt_BRT_CUR_OPER_INFO.getCellData(brtMainG0.getFocusedRowIndex(), "VHC_ID"), brtMainG0);
	};
	
	scwin.sub_brtMainF0R0_submitdone = function(e) {
		dma_BRT_NOSTOP_CNT.set("NOSTOP_CNT", dma_BRT_NOSTOP_CNT.get("NOSTOP_CNT")+"건");
		dma_BRT_SPEEDING_CNT.set("SPEEDING_CNT", dma_BRT_SPEEDING_CNT.get("SPEEDING_CNT")+"건");
		dma_BRT_INCDNT_RES_CNT.set("INCDNT_RES_CNT", dma_BRT_INCDNT_RES_CNT.get("INCDNT_RES_CNT")+"건");
		dma_BRT_INCDNT_CNT.set("INCDNT_CNT", dma_BRT_INCDNT_CNT.get("INCDNT_CNT")+"건");
	
	};
	
	
	]]></script>
	</head>
	<body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
		<xf:group id="pgm_container" class="pgm_container grdc_main_container" style="">
			<xf:group id="" class="" style=""></xf:group>
			<xf:group id="pgm_main" class="pgm_main grdc_brt_main" style="">
				<xf:group id="" class="grdc_brt_main_content" style="">
					<xf:group id="" class="grdc_brt_main_left" style="">
						<xf:group id="" class="" style=""></xf:group>
						<xf:group id="" class="brt_visual" style="">
		
						</xf:group>
						<xf:group id="" class="" style=""></xf:group>
						<xf:group id="" class="map_brtMain" style="">
							<div id="map_brtMain" style="overflow:hidden;"></div>
						</xf:group>
					</xf:group>
					<xf:group id="" class="" style=""></xf:group>
					<xf:group id="" class="grdc_brt_main_right" style="">
						<xf:group id="" class="" style="">
							<xf:group id="" class="grdr_20_5_320" style="">
								<xf:group class="defaultbox" id="" style="">
									<w2:textbox class="df_tt fl" id="" label="배차" style=""></w2:textbox>
								</xf:group>
								<xf:group></xf:group>
								<xf:group id="" class="" style="">
									<w2:gridView  alwaysTriggerScrollStart="" autoFit="allColumn" captionTitle=""
										class="cm_grid right" dataList="data:dlt_BRT_CUR_OPER_INFO" enterKeyMove="" ev:onafteredit="" ev:oncellclick="" ev:oneditkeyup=""
										ev:onkeyup="" ev:onrowindexchange="scwin.brtMainG0_onrowindexchange" ev:ontextimageclick="" ev:onviewchange=""
										fixedColumnWithHidden="true" id="brtMainG0" ignoreCellClick="false" nextTabID="" rowNumHeaderValue="순번" rowNumVisible="true"
										rowStatusHeaderValue="" rowStatusVisible="false" rowStatusWidth="40" scrollByColumn="false" style="" useShiftKey="true"
										visibleRowNum="" wheelRows="" autoFitMinWidth="0" disabledScrollHidden="" editModeEvent="" editModeEventIcon=""
										checkEditableInputClass="" keyMoveEditMode="" moveKeyEditMode="" moveKeyEditModeAll="" ignoreNonEditableCellTabEnter=""
										readOnly="true" keepDefaultColumnWidth="" oddEvenColorDisplay="" rowNumWidth=""  summaryAuto=""
										excludeDeletedRows="" useCtrlOnMultisort="" useFilterList="" useFilterListSync="" sortedIconPosition="" sortable=""
										sortOrderReverse="" showSortableUseFilter="" focusMode="row" rowNumStatusUniqueId="" rowNumStatusResize="" ev:onbeforecolumnmove=""
										userData1="">
										<w2:header style="" id="header1">
											<w2:row style="" id="row1">
												<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="column14"
													value="차량번호" blockSelect="false" displayMode="label">
												</w2:column>
												<w2:column removeBorderStyle="false" width="80" inputType="text" style="height:20px" id="column10"
													value="차량상태" blockSelect="false" displayMode="label">
												</w2:column>
												<w2:column removeBorderStyle="false" width="80" inputType="text" style="height:20px" id="column1"
													value="운행상태" blockSelect="false" displayMode="label">
												</w2:column>
												<w2:column removeBorderStyle="false" width="200" inputType="text" style="height:20px" id="column16"
													value="현재위치" blockSelect="false" displayMode="label">
												</w2:column>
												<w2:column removeBorderStyle="false" width="120" inputType="text" style="height:20px" id="column17"
													value="수신시간" blockSelect="false" displayMode="label">
												</w2:column>
											</w2:row>
										</w2:header>
										<w2:gBody style="" id="gBody1">
											<w2:row style="" id="row2">
												<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="VHC_NO"
													value="" blockSelect="false" displayMode="label">
												</w2:column>
												<w2:column removeBorderStyle="false" width="98" inputType="select" style="height:20px" id="BUS_STS"
													value="" blockSelect="false" displayMode="label">
												</w2:column>
												<w2:column removeBorderStyle="false" width="98" inputType="select" style="height:20px" id="OPER_STS"
													value="" blockSelect="false" displayMode="label">
												</w2:column>
												<w2:column removeBorderStyle="false" width="154" inputType="text" style="height:20px" id="CUR_PLCE_NM" value=""
													blockSelect="false" displayMode="label"  textAlign="left">
												</w2:column>
												<w2:column removeBorderStyle="false" width="95" inputType="text" style="height:20px" id="UPD_DTM"
													value="" blockSelect="false" displayMode="label">
												</w2:column>
											</w2:row>
										</w2:gBody>
									</w2:gridView>
								</xf:group>
			
							</xf:group>
						</xf:group>
						<xf:group id="" class="" style=""></xf:group>
						<xf:group id="" class="grdc_brt_main_right_content" style="">
							<xf:group id="" class="grdr_20_5_350" style="">
								<xf:group class="defaultbox" id="" style="">
									<w2:textbox class="df_tt fl" id="" label="Dispatch" style=""></w2:textbox>
								</xf:group>
								<xf:group></xf:group>
								<xf:group id="" class="" style="">
									<w2:gridView  alwaysTriggerScrollStart="" autoFit="lastColumn" captionTitle=""
										class="cm_grid right brtMainG1" dataList="data:dlt_BRT_DSPTCH_LOG" enterKeyMove="" ev:onafteredit="" ev:oncellclick="" ev:oneditkeyup=""
										ev:onkeyup="" ev:onrowindexchange="" ev:ontextimageclick="" ev:onviewchange=""
										fixedColumnWithHidden="true" id="brtMainG1" ignoreCellClick="false" nextTabID="" rowNumHeaderValue="순번" rowNumVisible="true"
										rowStatusHeaderValue="" rowStatusVisible="false" rowStatusWidth="40" scrollByColumn="false" style="" useShiftKey="true"
										visibleRowNum="" wheelRows="" autoFitMinWidth="0" disabledScrollHidden="" editModeEvent="" editModeEventIcon=""
										checkEditableInputClass="" keyMoveEditMode="" moveKeyEditMode="" moveKeyEditModeAll="" ignoreNonEditableCellTabEnter=""
										readOnly="true" keepDefaultColumnWidth="" oddEvenColorDisplay="" rowNumWidth=""  summaryAuto=""
										excludeDeletedRows="" useCtrlOnMultisort="" useFilterList="" useFilterListSync="" sortedIconPosition="" sortable=""
										sortOrderReverse="" showSortableUseFilter="" focusMode="row" rowNumStatusUniqueId="" rowNumStatusResize="" ev:onbeforecolumnmove=""
										userData1="">
										<w2:header style="" id="header1">
											<w2:row style="" id="row1">
												<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="column14"
													value="차량번호" blockSelect="false" displayMode="label">
												</w2:column>
												<w2:column removeBorderStyle="false" width="180" inputType="text" style="height:20px" id="column10"
													value="전송 메시지" blockSelect="false" displayMode="label">
												</w2:column>
												<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="column17"
													value="수신시간" blockSelect="false" displayMode="label">
												</w2:column>
											</w2:row>
										</w2:header>
										<w2:gBody style="" id="gBody1">
											<w2:row style="" id="row2">
												<w2:column removeBorderStyle="false" width="100" inputType="text" style="height:20px" id="VHC_NO"
													value="" blockSelect="false" displayMode="label">
												</w2:column>
												<w2:column removeBorderStyle="false" width="98" inputType="text" style="height:20px" id="DSPTCH_CONTS"
													value="" blockSelect="false" displayMode="label"  textAlign="left">
												</w2:column>
												<w2:column removeBorderStyle="false" width="95" inputType="text" style="height:20px" id="SEND_DATE"
													value="" blockSelect="false" displayMode="label">
												</w2:column>
											</w2:row>
										</w2:gBody>
									</w2:gridView>
								</xf:group>
							</xf:group>
							<xf:group></xf:group>
							<xf:group id="" class="grdr_20_5_350" style="">
								<xf:group class="defaultbox" id="" style="">
									<w2:textbox class="df_tt fl" id="" label="정시성/돌발/위반" style=""></w2:textbox>
								</xf:group>
								<xf:group></xf:group>
								<xf:group style="" id="" class="brt_cont">
									<xf:group style="" id="" class="brt_cont_lst" tagname="ul">
										<xf:group style="" id="" class="punct" tagname="li">
											<xf:group tagname="ul">
												<xf:group tagname="li"></xf:group>
												<xf:group class="repeat" tagname="li">
													<w2:textbox label="정시성" style="" id="" tagname="strong"></w2:textbox>
												</xf:group>
												<xf:group tagname="li">
													<xf:group style="" id="" class="">
														<w2:textbox label="운행" style="" id="" tagname="strong"></w2:textbox>
														<w2:anchor outerDiv="false" class="count" style="" id="punct_oper">
															<xf:label><![CDATA[05회]]></xf:label>
														</w2:anchor>
													</xf:group>
													<xf:group style="" id="" class="">
														<w2:textbox label="준수" style="" id="" tagname="strong"></w2:textbox>
														<w2:anchor outerDiv="false" class="count" style="" id="punct_obey">
															<xf:label><![CDATA[05회]]></xf:label>
														</w2:anchor>
													</xf:group>
												</xf:group>
											</xf:group>
										</xf:group>
										<xf:group class="outbreak" id="" style="" tagname="li">
											<xf:group tagname="ul">
												<xf:group tagname="li"></xf:group>
												<xf:group class="repeat" tagname="li">
													<w2:textbox label="돌발" style="" id="" tagname="strong"></w2:textbox>
												</xf:group>
												<xf:group tagname="li">
													<xf:group style="" id="" class="">
														<w2:textbox label="발생" style="" id="" tagname="strong"></w2:textbox>
														<w2:anchor outerDiv="false" class="count" style="" id="outbreak_occur" ref="data:dma_BRT_INCDNT_CNT.INCDNT_CNT">
															<xf:label><![CDATA[05회]]></xf:label>
														</w2:anchor>
													</xf:group>
													<xf:group style="" id="" class="">
														<w2:textbox label="처리" style="" id="" tagname="strong"></w2:textbox>
														<w2:anchor outerDiv="false" class="count" style="" id="outbreak_procs" ref="data:dma_BRT_INCDNT_RES_CNT.INCDNT_RES_CNT">
															<xf:label><![CDATA[05회]]></xf:label>
														</w2:anchor>
													</xf:group>
												</xf:group>
											</xf:group>
										</xf:group>
										<xf:group class="violation" id="" style="" tagname="li">
											<xf:group tagname="ul">
												<xf:group tagname="li"></xf:group>
												<xf:group class="repeat" tagname="li">
													<w2:textbox label="위반" style="" id="" tagname="strong"></w2:textbox>
												</xf:group>
												<xf:group tagname="li">
													<xf:group style="" id="" class="">
														<w2:textbox label="과속" style="" id="" tagname="strong"></w2:textbox>
														<w2:anchor outerDiv="false" class="count" style="" id="violation__overspeed" ref="data:dma_BRT_SPEEDING_CNT.SPEEDING_CNT">
															<xf:label><![CDATA[05회]]></xf:label>
														</w2:anchor>
													</xf:group>
													<xf:group style="" id="" class="">
														<w2:textbox label="무정차" style="" id="" tagname="strong"></w2:textbox>
														<w2:anchor outerDiv="false" class="count" style="" id="violation__nostop" ref="data:dma_BRT_NOSTOP_CNT.NOSTOP_CNT">
															<xf:label><![CDATA[05회]]></xf:label>
														</w2:anchor>
													</xf:group>
												</xf:group>
											</xf:group>
										</xf:group>
									</xf:group>
								</xf:group>
							</xf:group>
						</xf:group>
					</xf:group>
				</xf:group>
			</xf:group>
		</xf:group>
	</body>
</html>
